[System: 192.168.1.76] DEBUG | 08-08-2025 11:53:24.128 | General Service|:: CompanyIndex:0 SpName: spADM_GetClientUserDetails2C 
 'admin'
 ,1
 ,0
[System: 192.168.1.76] DEBUG | 08-08-2025 11:53:24.363 | General Service|:: CompanyIndex:0 SpName: spADM_UserLoginCheck 
 2
 ,'admin'
 ,0
 ,'192.168.1.76'
 ,'192.168.1.76'
 ,''
 ,'Web'
 ,1
[System: 192.168.1.76] DEBUG | 08-08-2025 11:53:46.892 | General Service|:: CompanyIndex:7 SpName: spADM_GetClientUserDetails 
 'admin'
 ,1
 ,'26.2.9'
 ,0
[System: 192.168.1.76] DEBUG | 08-08-2025 11:53:47.079 | General Service|:: CompanyIndex:0 SpName: spADM_UserLoginCheck 
 2
 ,'admin'
 ,7
 ,'192.168.1.76'
 ,'192.168.1.76'
 ,''
 ,'Web'
 ,1
[System: 192.168.1.76] DEBUG | 08-08-2025 11:53:47.204 | General Service|:: CompanyIndex:0 SpName: spADM_Login 
 1
 ,''
 ,''
 ,''
 ,''
 ,''
 ,7
[System: 192.168.1.76] DEBUG | 08-08-2025 11:53:47.235 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select Value from ADM_GlobalPreferences with (nolock) where name =''EnableReLogin'''
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 08-08-2025 11:53:47.235 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzU0NjM0MjI2LCJleHAiOjE3NTQ2NjMwMjYsImlhdCI6MTc1NDYzNDIyNn0.Q8kJCmcT-ZXaYWywT9EPp7UXiCYjtWMurOTIksptIrU'''
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 08-08-2025 11:53:47.282 | General Service|:: CompanyIndex:0 SpName: spADM_Login 
 4
 ,''
 ,''
 ,''
 ,'declare @Cnt int,@ExpiredGUID nvarchar(50),@AllowSession int,@GUID nvarchar(50),@CurrDate float,@UserID INT,@Instances INT,@InstancesExists INT,@LCDBIndex int
set @CurrDate= convert(float,dateadd(minute,-21,getdate()))
set @AllowSession=0
set @GUID=''cc0d383c-3cf9-4f06-b1e8-c057cde7f4ad''
set @LCDBIndex=0
select top 1 @UserID=UserID,@Instances=InstanceCount from ADM_Users with(nolock) where UserName=''admin''
if exists(select [GUID] from ADM_Login with(nolock) where [GUID]=@GUID)
begin
	update ADM_Login 
	set LastAccessTime=convert(float,getdate()),UserID=@UserID
	where [GUID]=@GUID
    set @AllowSession=1
end
else
begin
	select @Cnt=count(*) from ADM_Login with(nolock) where LCDBIndex=@LCDBIndex and [GUID]!=''ACCESSRIGHTS'' and AP =''WEB''
    if(@Cnt<100)
		set @AllowSession=1
	else
	begin
		select top 1 @ExpiredGUID=[GUID] from ADM_Login with(nolock)
		where [GUID]!=''ACCESSRIGHTS'' and LCDBIndex=@LCDBIndex and LastAccessTime<@CurrDate  and AP =''WEB''
        order by LastAccessTime asc
		if @ExpiredGUID is not null
		begin
			delete from ADM_Login where [GUID]=@ExpiredGUID
			set @AllowSession=1
		end
	end
	if @AllowSession=1
	begin
        select @InstancesExists=COUNT(*) from ADM_Login with(nolock)
		where [GUID]!=''ACCESSRIGHTS'' and LCDBIndex=@LCDBIndex and LastAccessTime>=@CurrDate and UserID=@UserID and AP =''WEB''
		if(@Instances!=0 and @Instances<=@InstancesExists)
			set @AllowSession=2
		else
		    INSERT INTO ADM_Login([GUID],[SysName],IPAddress,[Status],LoginTime,LastAccessTime,AccessRights,UserID,DBIndex,LCDBIndex,AP)
		    VALUES(@GUID,''WEB'',''192.168.1.76'',1,convert(float,getdate()),convert(float,getdate()),null,@UserID,7,@LCDBIndex, ''WEB'')
	end
end

select @AllowSession AllowSession,@Instances Instances,@InstancesExists InstancesExists
'
 ,''
 ,0
[System: 192.168.1.76] DEBUG | 08-08-2025 11:53:47.298 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzU0NjM0MjI2LCJleHAiOjE3NTQ2NjMwMjYsImlhdCI6MTc1NDYzNDIyNn0.Q8kJCmcT-ZXaYWywT9EPp7UXiCYjtWMurOTIksptIrU'''
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 08-08-2025 11:53:47.376 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'SELECT (SELECT COUNT(*) FROM COM_Location L WITH(NOLOCK) JOIN COM_Status S WITH(NOLOCK) ON S.StatusID=L.StatusID WHERE L.IsGroup=0 AND S.[Status]=''Active'') ML
,(SELECT COUNT(*) FROM ADM_Features WITH(NOLOCK) WHERE ((FeatureID>50000 AND FeatureID<=50050) OR FeatureID>=51000) AND IsEnabled=1) MD
,(SELECT ISNULL(COUNT(*),0) FROM ADM_RevenUReports WITH(NOLOCK) WHERE IsGroup=0 AND ReportID>10000 AND StaticReportType IN (0,-1)) MR'
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 08-08-2025 11:53:47.391 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzU0NjM0MjI2LCJleHAiOjE3NTQ2NjMwMjYsImlhdCI6MTc1NDYzNDIyNn0.Q8kJCmcT-ZXaYWywT9EPp7UXiCYjtWMurOTIksptIrU'''
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 08-08-2025 11:53:53.805 | General Service|:: CompanyIndex:7 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.76] DEBUG | 08-08-2025 11:53:53.805 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzU0NjM0MjI2LCJleHAiOjE3NTQ2NjMwMjYsImlhdCI6MTc1NDYzNDIyNn0.Q8kJCmcT-ZXaYWywT9EPp7UXiCYjtWMurOTIksptIrU'''
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 08-08-2025 11:53:54.117 | General Service|:: CompanyIndex:7 SpName: spADM_GetRibbonView 
 1
 ,1
 ,1
 ,1
 ,0
 ,''
[System: 192.168.1.76] DEBUG | 08-08-2025 11:53:54.133 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzU0NjM0MjI2LCJleHAiOjE3NTQ2NjMwMjYsImlhdCI6MTc1NDYzNDIyNn0.Q8kJCmcT-ZXaYWywT9EPp7UXiCYjtWMurOTIksptIrU'''
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 08-08-2025 11:53:54.664 | General Service|:: CompanyIndex:7 SpName: spRPT_GetReport 
 2
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.76] DEBUG | 08-08-2025 11:53:54.695 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzU0NjM0MjI2LCJleHAiOjE3NTQ2NjMwMjYsImlhdCI6MTc1NDYzNDIyNn0.Q8kJCmcT-ZXaYWywT9EPp7UXiCYjtWMurOTIksptIrU'''
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 08-08-2025 11:53:54.742 | General Service|:: CompanyIndex:7 SpName: spADM_GetDashBoard 
 2
 ,0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.76] DEBUG | 08-08-2025 11:53:54.920 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzU0NjM0MjI2LCJleHAiOjE3NTQ2NjMwMjYsImlhdCI6MTc1NDYzNDIyNn0.Q8kJCmcT-ZXaYWywT9EPp7UXiCYjtWMurOTIksptIrU'''
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 08-08-2025 11:53:54.951 | General Service|:: CompanyIndex:7 SpName: spCOM_ConfigValues 
 1
 ,'LandingDocs'
 ,'1'
[System: 192.168.1.76] DEBUG | 08-08-2025 11:53:54.967 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzU0NjM0MjI2LCJleHAiOjE3NTQ2NjMwMjYsImlhdCI6MTc1NDYzNDIyNn0.Q8kJCmcT-ZXaYWywT9EPp7UXiCYjtWMurOTIksptIrU'''
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 08-08-2025 11:53:55.045 | General Service|:: CompanyIndex:7 SpName: spADM_GetAllListViewsDef 
 1
 ,1
[System: 192.168.1.76] DEBUG | 08-08-2025 11:53:55.045 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzU0NjM0MjI2LCJleHAiOjE3NTQ2NjMwMjYsImlhdCI6MTc1NDYzNDIyNn0.Q8kJCmcT-ZXaYWywT9EPp7UXiCYjtWMurOTIksptIrU'''
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 08-08-2025 11:53:55.170 | General Service|:: CompanyIndex:7 SpName: spADM_GetAllListViewsDef 
 1
 ,1
[System: 192.168.1.76] DEBUG | 08-08-2025 11:53:55.170 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzU0NjM0MjI2LCJleHAiOjE3NTQ2NjMwMjYsImlhdCI6MTc1NDYzNDIyNn0.Q8kJCmcT-ZXaYWywT9EPp7UXiCYjtWMurOTIksptIrU'''
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 08-08-2025 11:53:55.373 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'Select CostCenterID,CostCenterColID,CostCenterName,SysTableName,UserColumnName,SysColumnName,ISNULL(UserDefaultValue,'''') UserDefaultValue
From AdM_CostCenterDef WITH(NOLOCK)
Where SysColumnName IN(''CreditAccount'',''DebitAccount'',''ProductID'') 
AND CostCenterID>40000 AND CostCenterID<50000 

SELECT * FROM ADM_Features WITH(NOLOCK) '
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 08-08-2025 11:53:55.373 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzU0NjM0MjI2LCJleHAiOjE3NTQ2NjMwMjYsImlhdCI6MTc1NDYzNDIyNn0.Q8kJCmcT-ZXaYWywT9EPp7UXiCYjtWMurOTIksptIrU'''
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 08-08-2025 11:53:55.436 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 '  SELECT * FROM PAY_PayrollPreferences WITH(NOLOCK) '
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 08-08-2025 11:53:55.451 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzU0NjM0MjI2LCJleHAiOjE3NTQ2NjMwMjYsImlhdCI6MTc1NDYzNDIyNn0.Q8kJCmcT-ZXaYWywT9EPp7UXiCYjtWMurOTIksptIrU'''
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 08-08-2025 11:53:56.107 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 '  --0
                                Select * FROM COM_CC50051 WITH(NOLOCK) WHERE IsGroup=0 AND LoginUserID=''admin''
                                --1                                
                                Select * FROM COM_CC50051 WITH(NOLOCK) WHERE RptManager IN (Select NodeID FROM COM_CC50051 WITH(NOLOCK) WHERE IsGroup=0 AND LoginUserID=''admin'')
                                UNION ALL
                                Select * FROM COM_CC50051 WITH(NOLOCK) WHERE RptManager IN 
                                (
	                                Select NodeID FROM COM_CC50051 WITH(NOLOCK) 
	                                WHERE IsGroup=0 AND LoginUserID IN
	                                (
	                                SELECT fe.LoginUserID
	                                FROM INV_DocDetails a WITH(NOLOCK) 
	                                JOIN COM_DocCCData b WITH(NOLOCK) ON b.InvDocDetailsID=a.InvDocDetailsID
	                                JOIN COM_DocNumData c WITH(NOLOCK) ON c.InvDocDetailsID=a.InvDocDetailsID
	                                JOIN COM_DocTextData d WITH(NOLOCK) ON d.InvDocDetailsID=a.InvDocDetailsID
	                                JOIN COM_CC50051 fe WITH(NOLOCK) on fe.NodeID=b.dcCCNID51
	                                JOIN COM_CC50051 te WITH(NOLOCK) on CONVERT(NVARCHAR,te.NodeID)=d.dcAlpha1
	                                WHERE a.CostCenterID=40098 and a.StatusID=369 AND d.dcAlpha3=''Temporary''
	                                AND te.LoginUserID=''admin'' 
	                                AND ISDATE(d.dcAlpha4)=1 AND ISDATE(d.dcAlpha5)=1 
	                                AND CONVERT(DATETIME,''08 Aug 2025'') BETWEEN CONVERT(DATETIME,d.dcAlpha4) AND CONVERT(DATETIME,d.dcAlpha5)
	                                )
                                )
                                --2
                                Select * FROM ADM_USERS WITH(NOLOCK) WHERE USERID=1
                                --3
                                Select * FROM COM_CostCenterCostCenterMap WITH(NOLOCK) WHERE ParentCostCenterID=7 AND ParentNodeID=1
                                --4                                
                                Select * FROM COM_CostCenterCostCenterMap WITH(NOLOCK) WHERE ParentCostCenterID=7 AND ParentNodeID=1
                                AND CostCenterID IN(Select ColumnCostCenterID From ADM_CostCenterDef Where CostCenterID=50051 AND IsColumnInUse=1 AND SysColumnName LIKE ''CCNID%'')
                                --5
                                Select * from COM_Files WITH(NOLOCK) WHERE FeatureID=50051 AND FeaturePK IN (Select NodeID FROM COM_CC50051 WITH(NOLOCK) WHERE IsGroup=0 AND LoginUserID=''admin'')                         
'
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 08-08-2025 11:53:56.107 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzU0NjM0MjI2LCJleHAiOjE3NTQ2NjMwMjYsImlhdCI6MTc1NDYzNDIyNn0.Q8kJCmcT-ZXaYWywT9EPp7UXiCYjtWMurOTIksptIrU'''
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 08-08-2025 11:53:56.248 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'UPDATE C SET STATUSID=CASE WHEN ResignType=''Resigned'' THEN 302 WHEN ResignType=''Terminated With Cause'' THEN 303 WHEN ResignType=''Terminated Without Cause'' THEN 304 END 
                            FROM COM_CC50051 C WITH(NOLOCK)
                            WHERE ResignStatus=''Posted'' AND ResignType NOT IN(''Pending'',''Rejected'') 
                            AND DOResign IS NOT NULL AND DORelieve IS NOT NULL
                            AND STATUSID NOT IN(302,303,304)
                            AND DATEDIFF(D,GETDATE(),DORelieve)<0'
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 08-08-2025 11:53:56.264 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzU0NjM0MjI2LCJleHAiOjE3NTQ2NjMwMjYsImlhdCI6MTc1NDYzNDIyNn0.Q8kJCmcT-ZXaYWywT9EPp7UXiCYjtWMurOTIksptIrU'''
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 08-08-2025 11:53:56.607 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 08-08-2025 11:53:56.607 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzU0NjM0MjI2LCJleHAiOjE3NTQ2NjMwMjYsImlhdCI6MTc1NDYzNDIyNn0.Q8kJCmcT-ZXaYWywT9EPp7UXiCYjtWMurOTIksptIrU'''
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 08-08-2025 11:53:56.779 | General Service|:: CompanyIndex:7 SpName: spADM_GetDashBoard 
 1
 ,39
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.76] DEBUG | 08-08-2025 11:53:56.779 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzU0NjM0MjI2LCJleHAiOjE3NTQ2NjMwMjYsImlhdCI6MTc1NDYzNDIyNn0.Q8kJCmcT-ZXaYWywT9EPp7UXiCYjtWMurOTIksptIrU'''
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 08-08-2025 11:53:56.951 | General Service|:: CompanyIndex:7 SpName: spCOM_GetFavorites 
 'VIEW'
 ,25495
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.76] DEBUG | 08-08-2025 11:53:56.951 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzU0NjM0MjI2LCJleHAiOjE3NTQ2NjMwMjYsImlhdCI6MTc1NDYzNDIyNn0.Q8kJCmcT-ZXaYWywT9EPp7UXiCYjtWMurOTIksptIrU'''
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 08-08-2025 11:54:03.788 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=2'
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 08-08-2025 11:54:03.788 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzU0NjM0MjI2LCJleHAiOjE3NTQ2NjMwMjYsImlhdCI6MTc1NDYzNDIyNn0.Q8kJCmcT-ZXaYWywT9EPp7UXiCYjtWMurOTIksptIrU'''
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 08-08-2025 11:54:03.976 | General Service|:: CompanyIndex:7 SpName: spRPT_GetReport 
 0
 ,2
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.76] DEBUG | 08-08-2025 11:54:03.991 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzU0NjM0MjI2LCJleHAiOjE3NTQ2NjMwMjYsImlhdCI6MTc1NDYzNDIyNn0.Q8kJCmcT-ZXaYWywT9EPp7UXiCYjtWMurOTIksptIrU'''
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 08-08-2025 11:54:04.101 | General Service|:: CompanyIndex:7 SpName: spDOC_GetVPTPrintCopies 
 4
 ,50
 ,2
 ,2
 ,4
 ,'View~98cab7ee-e70b-42d5-b339-b5ed4057d2e2'
 ,'admin'
 ,1
[System: 192.168.1.76] DEBUG | 08-08-2025 11:54:04.101 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzU0NjM0MjI2LCJleHAiOjE3NTQ2NjMwMjYsImlhdCI6MTc1NDYzNDIyNn0.Q8kJCmcT-ZXaYWywT9EPp7UXiCYjtWMurOTIksptIrU'''
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 08-08-2025 11:54:08.537 | General Service|:: CompanyIndex:7 SpName: spRPT_GetReportCategoryandField 
 -1
 ,0
 ,1
 ,0
 ,'1'
 ,1
[System: 192.168.1.76] DEBUG | 08-08-2025 11:54:08.537 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzU0NjM0MjI2LCJleHAiOjE3NTQ2NjMwMjYsImlhdCI6MTc1NDYzNDIyNn0.Q8kJCmcT-ZXaYWywT9EPp7UXiCYjtWMurOTIksptIrU'''
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 08-08-2025 11:54:08.756 | General Service|:: CompanyIndex:7 SpName: spRPT_GetReportFields 
 400
 ,0
 ,'1'
 ,1
[System: 192.168.1.76] DEBUG | 08-08-2025 11:54:08.756 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzU0NjM0MjI2LCJleHAiOjE3NTQ2NjMwMjYsImlhdCI6MTc1NDYzNDIyNn0.Q8kJCmcT-ZXaYWywT9EPp7UXiCYjtWMurOTIksptIrU'''
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 08-08-2025 11:54:08.818 | General Service|:: CompanyIndex:7 SpName: spRPT_GetReportFields 
 40001
 ,0
 ,'1'
 ,1
[System: 192.168.1.76] DEBUG | 08-08-2025 11:54:08.818 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzU0NjM0MjI2LCJleHAiOjE3NTQ2NjMwMjYsImlhdCI6MTc1NDYzNDIyNn0.Q8kJCmcT-ZXaYWywT9EPp7UXiCYjtWMurOTIksptIrU'''
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 08-08-2025 11:54:08.865 | General Service|:: CompanyIndex:7 SpName: spRPT_GetReportFields 
 2
 ,0
 ,'1'
 ,1
[System: 192.168.1.76] DEBUG | 08-08-2025 11:54:08.865 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzU0NjM0MjI2LCJleHAiOjE3NTQ2NjMwMjYsImlhdCI6MTc1NDYzNDIyNn0.Q8kJCmcT-ZXaYWywT9EPp7UXiCYjtWMurOTIksptIrU'''
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 08-08-2025 11:54:08.897 | General Service|:: CompanyIndex:7 SpName: spRPT_GetReportFields 
 110
 ,0
 ,'1'
 ,1
[System: 192.168.1.76] DEBUG | 08-08-2025 11:54:08.897 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzU0NjM0MjI2LCJleHAiOjE3NTQ2NjMwMjYsImlhdCI6MTc1NDYzNDIyNn0.Q8kJCmcT-ZXaYWywT9EPp7UXiCYjtWMurOTIksptIrU'''
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 08-08-2025 11:54:08.912 | General Service|:: CompanyIndex:7 SpName: spRPT_GetReportFields 
 50008
 ,0
 ,'1'
 ,1
[System: 192.168.1.76] DEBUG | 08-08-2025 11:54:08.912 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzU0NjM0MjI2LCJleHAiOjE3NTQ2NjMwMjYsImlhdCI6MTc1NDYzNDIyNn0.Q8kJCmcT-ZXaYWywT9EPp7UXiCYjtWMurOTIksptIrU'''
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 08-08-2025 11:54:09.256 | General Service|:: CompanyIndex:7 SpName: spADM_GetCostCenterGridViewList 
 2
 ,1
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 08-08-2025 11:54:09.271 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzU0NjM0MjI2LCJleHAiOjE3NTQ2NjMwMjYsImlhdCI6MTc1NDYzNDIyNn0.Q8kJCmcT-ZXaYWywT9EPp7UXiCYjtWMurOTIksptIrU'''
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 08-08-2025 11:54:09.881 | General Service|:: CompanyIndex:7 SpName: spCom_GetCostCenterSummary 
 126
 ,-1
 ,1000
 ,''
 ,''
 ,''
 ,0
 ,'08-Aug-2025'
 ,NULL
 ,''
 ,1
 ,1
 ,0
 ,0
 ,False
 ,1
[System: 192.168.1.76] DEBUG | 08-08-2025 11:54:09.896 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzU0NjM0MjI2LCJleHAiOjE3NTQ2NjMwMjYsImlhdCI6MTc1NDYzNDIyNn0.Q8kJCmcT-ZXaYWywT9EPp7UXiCYjtWMurOTIksptIrU'''
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 08-08-2025 11:54:09.959 | General Service|:: CompanyIndex:7 SpName: spADM_GetLocationRole 
 50002
 ,1
 message=Saved Succesfully
[System: 192.168.1.76] DEBUG | 08-08-2025 11:54:09.959 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzU0NjM0MjI2LCJleHAiOjE3NTQ2NjMwMjYsImlhdCI6MTc1NDYzNDIyNn0.Q8kJCmcT-ZXaYWywT9EPp7UXiCYjtWMurOTIksptIrU'''
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 08-08-2025 11:54:09.974 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'SELECT CL.RESOURCEDATA Name FROM [ADM_Features] ADF WITH(NOLOCK),COM_LANGUAGERESOURCES CL WITH(NOLOCK) WHERE ADF.RESOURCEID=CL.RESOURCEID AND ADF.FeatureID=50002 AND CL.LanguageID=1'
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 08-08-2025 11:54:09.974 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzU0NjM0MjI2LCJleHAiOjE3NTQ2NjMwMjYsImlhdCI6MTc1NDYzNDIyNn0.Q8kJCmcT-ZXaYWywT9EPp7UXiCYjtWMurOTIksptIrU'''
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 08-08-2025 11:54:09.990 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'SELECT AF.FEATUREID FEATUREID,CL.ResourceData NAME FROM ADM_FEATURES AF WITH(NOLOCK),COM_LANGUAGERESOURCES CL WITH(NOLOCK) WHERE AF.RESOURCEID=CL.RESOURCEID AND  AF.FEATUREID>50000 and AF.ISEnabled=1 AND CL.LANGUAGEID=1'
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 08-08-2025 11:54:10.006 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzU0NjM0MjI2LCJleHAiOjE3NTQ2NjMwMjYsImlhdCI6MTc1NDYzNDIyNn0.Q8kJCmcT-ZXaYWywT9EPp7UXiCYjtWMurOTIksptIrU'''
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 08-08-2025 11:54:10.037 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'SELECT CurrencyID,Name,ExchangeRate FROM COM_Currency WITH(NOLOCK)'
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 08-08-2025 11:54:10.037 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzU0NjM0MjI2LCJleHAiOjE3NTQ2NjMwMjYsImlhdCI6MTc1NDYzNDIyNn0.Q8kJCmcT-ZXaYWywT9EPp7UXiCYjtWMurOTIksptIrU'''
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 08-08-2025 11:54:10.052 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'SELECT CurrencyID,Name,ExchangeRate FROM COM_Currency WITH(NOLOCK)'
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 08-08-2025 11:54:10.052 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzU0NjM0MjI2LCJleHAiOjE3NTQ2NjMwMjYsImlhdCI6MTc1NDYzNDIyNn0.Q8kJCmcT-ZXaYWywT9EPp7UXiCYjtWMurOTIksptIrU'''
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 08-08-2025 11:54:10.146 | General Service|:: CompanyIndex:7 SpName: spCom_GetCostCenterSummary 
 126
 ,1000
 ,1000
 ,''
 ,''
 ,''
 ,1995
 ,'08-Aug-2025'
 ,NULL
 ,''
 ,1
 ,1
 ,0
 ,0
 ,False
 ,1
[System: 192.168.1.76] DEBUG | 08-08-2025 11:54:10.146 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzU0NjM0MjI2LCJleHAiOjE3NTQ2NjMwMjYsImlhdCI6MTc1NDYzNDIyNn0.Q8kJCmcT-ZXaYWywT9EPp7UXiCYjtWMurOTIksptIrU'''
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 08-08-2025 11:54:10.240 | General Service|:: CompanyIndex:7 SpName: spCom_GetCostCenterSummary 
 126
 ,2000
 ,1000
 ,''
 ,''
 ,''
 ,3995
 ,'08-Aug-2025'
 ,NULL
 ,''
 ,1
 ,1
 ,0
 ,0
 ,False
 ,1
[System: 192.168.1.76] DEBUG | 08-08-2025 11:54:10.240 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzU0NjM0MjI2LCJleHAiOjE3NTQ2NjMwMjYsImlhdCI6MTc1NDYzNDIyNn0.Q8kJCmcT-ZXaYWywT9EPp7UXiCYjtWMurOTIksptIrU'''
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 08-08-2025 11:54:29.132 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'SELECT A1.AccountID,A1.AccountTypeID,A1.AccountName,A1.GLClubTranBy,A1.AccountName AS [C969dbd8988724b91adfd70a8b261194c],A1.AccountCode AS [Caeb82d0209c846dd916e98fc8fea50a1],A1.AccountCode AS [Cd8ffd8610aef496cbfa6b04dac1c17b0],A1.AccountName AS [C3c75048416c9418fbd61a5ef5f9ddfc4],A1.AccountCode FROM ACC_Accounts A1 with(nolock) WHERE (A1.IsGroup=0 and A1.AccountID>1  AND (A1.AccountID IN (SELECT CreditAccount FROM ACC_DocDetails AS Cr with(nolock) UNION SELECT DebitAccount FROM ACC_DocDetails AS Dr with(nolock)))) Order By A1.AccountCode'
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 08-08-2025 11:54:29.132 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzU0NjM0MjI2LCJleHAiOjE3NTQ2NjMwMjYsImlhdCI6MTc1NDYzNDIyNn0.Q8kJCmcT-ZXaYWywT9EPp7UXiCYjtWMurOTIksptIrU'''
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 08-08-2025 11:54:56.604 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 08-08-2025 11:54:56.604 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzU0NjM0MjI2LCJleHAiOjE3NTQ2NjMwMjYsImlhdCI6MTc1NDYzNDIyNn0.Q8kJCmcT-ZXaYWywT9EPp7UXiCYjtWMurOTIksptIrU'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 11:55:37.818 | General Service|:: CompanyIndex:0 SpName: spADM_GetClientUserDetails2C 
 'admin'
 ,1
 ,0
[System: 192.168.1.99] DEBUG | 08-08-2025 11:55:37.865 | General Service|:: CompanyIndex:0 SpName: spADM_UserLoginCheck 
 2
 ,'admin'
 ,0
 ,'192.168.1.99'
 ,'192.168.1.99'
 ,''
 ,'Web'
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 11:55:42.481 | General Service|:: CompanyIndex:53 SpName: spADM_GetClientUserDetails 
 'admin'
 ,1
 ,'26.2.9'
 ,0
[System: 192.168.1.99] DEBUG | 08-08-2025 11:55:42.543 | General Service|:: CompanyIndex:0 SpName: spADM_UserLoginCheck 
 2
 ,'admin'
 ,53
 ,'192.168.1.99'
 ,'192.168.1.99'
 ,''
 ,'Web'
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 11:55:42.592 | General Service|:: CompanyIndex:0 SpName: spADM_Login 
 1
 ,''
 ,''
 ,''
 ,''
 ,''
 ,53
[System: 192.168.1.99] DEBUG | 08-08-2025 11:55:42.607 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select Value from ADM_GlobalPreferences with (nolock) where name =''EnableReLogin'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 11:55:42.607 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 11:55:42.670 | General Service|:: CompanyIndex:0 SpName: spADM_Login 
 4
 ,''
 ,''
 ,''
 ,'declare @Cnt int,@ExpiredGUID nvarchar(50),@AllowSession int,@GUID nvarchar(50),@CurrDate float,@UserID INT,@Instances INT,@InstancesExists INT,@LCDBIndex int
set @CurrDate= convert(float,dateadd(minute,-21,getdate()))
set @AllowSession=0
set @GUID=''0487a41c-8997-4838-bb25-c25f47d7ca93''
set @LCDBIndex=0
select top 1 @UserID=UserID,@Instances=InstanceCount from ADM_Users with(nolock) where UserName=''admin''
if exists(select [GUID] from ADM_Login with(nolock) where [GUID]=@GUID)
begin
	update ADM_Login 
	set LastAccessTime=convert(float,getdate()),UserID=@UserID
	where [GUID]=@GUID
    set @AllowSession=1
end
else
begin
	select @Cnt=count(*) from ADM_Login with(nolock) where LCDBIndex=@LCDBIndex and [GUID]!=''ACCESSRIGHTS'' and AP =''WEB''
    if(@Cnt<100)
		set @AllowSession=1
	else
	begin
		select top 1 @ExpiredGUID=[GUID] from ADM_Login with(nolock)
		where [GUID]!=''ACCESSRIGHTS'' and LCDBIndex=@LCDBIndex and LastAccessTime<@CurrDate  and AP =''WEB''
        order by LastAccessTime asc
		if @ExpiredGUID is not null
		begin
			delete from ADM_Login where [GUID]=@ExpiredGUID
			set @AllowSession=1
		end
	end
	if @AllowSession=1
	begin
        select @InstancesExists=COUNT(*) from ADM_Login with(nolock)
		where [GUID]!=''ACCESSRIGHTS'' and LCDBIndex=@LCDBIndex and LastAccessTime>=@CurrDate and UserID=@UserID and AP =''WEB''
		if(@Instances!=0 and @Instances<=@InstancesExists)
			set @AllowSession=2
		else
		    INSERT INTO ADM_Login([GUID],[SysName],IPAddress,[Status],LoginTime,LastAccessTime,AccessRights,UserID,DBIndex,LCDBIndex,AP)
		    VALUES(@GUID,''WEB'',''192.168.1.99'',1,convert(float,getdate()),convert(float,getdate()),null,@UserID,53,@LCDBIndex, ''WEB'')
	end
end

select @AllowSession AllowSession,@Instances Instances,@InstancesExists InstancesExists
'
 ,''
 ,0
[System: 192.168.1.99] DEBUG | 08-08-2025 11:55:42.685 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 11:55:42.717 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT (SELECT COUNT(*) FROM COM_Location L WITH(NOLOCK) JOIN COM_Status S WITH(NOLOCK) ON S.StatusID=L.StatusID WHERE L.IsGroup=0 AND S.[Status]=''Active'') ML
,(SELECT COUNT(*) FROM ADM_Features WITH(NOLOCK) WHERE ((FeatureID>50000 AND FeatureID<=50050) OR FeatureID>=51000) AND IsEnabled=1) MD
,(SELECT ISNULL(COUNT(*),0) FROM ADM_RevenUReports WITH(NOLOCK) WHERE IsGroup=0 AND ReportID>10000 AND StaticReportType IN (0,-1)) MR'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 11:55:42.717 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 11:55:42.732 | General Service|:: CompanyIndex:53 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.99] DEBUG | 08-08-2025 11:55:42.732 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 11:55:42.951 | General Service|:: CompanyIndex:53 SpName: spADM_GetRibbonView 
 1
 ,1
 ,1
 ,1
 ,0
 ,''
[System: 192.168.1.99] DEBUG | 08-08-2025 11:55:42.951 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 11:55:43.201 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 2
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 11:55:43.201 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 11:55:43.295 | General Service|:: CompanyIndex:53 SpName: spADM_GetDashBoard 
 2
 ,0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 11:55:43.295 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 11:55:43.310 | General Service|:: CompanyIndex:53 SpName: spCOM_ConfigValues 
 1
 ,'LandingDocs'
 ,'1'
[System: 192.168.1.99] DEBUG | 08-08-2025 11:55:43.326 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 11:55:43.451 | General Service|:: CompanyIndex:53 SpName: spCOM_GetFavorites 
 'GETLIST0'
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 11:55:43.451 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 11:55:43.466 | General Service|:: CompanyIndex:53 SpName: spADM_GetAllListViewsDef 
 1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 11:55:43.466 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 11:55:43.560 | General Service|:: CompanyIndex:53 SpName: spADM_GetAllListViewsDef 
 1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 11:55:43.576 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 11:55:43.779 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'Select CostCenterID,CostCenterColID,CostCenterName,SysTableName,UserColumnName,SysColumnName,ISNULL(UserDefaultValue,'''') UserDefaultValue
From AdM_CostCenterDef WITH(NOLOCK)
Where SysColumnName IN(''CreditAccount'',''DebitAccount'',''ProductID'') 
AND CostCenterID>40000 AND CostCenterID<50000 

SELECT * FROM ADM_Features WITH(NOLOCK) '
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 11:55:43.779 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 11:55:43.857 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 '  SELECT * FROM PAY_PayrollPreferences WITH(NOLOCK) '
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 11:55:43.857 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 11:55:44.123 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 '  --0
                                Select * FROM COM_CC50051 WITH(NOLOCK) WHERE IsGroup=0 AND LoginUserID=''admin''
                                --1                                
                                Select * FROM COM_CC50051 WITH(NOLOCK) WHERE RptManager IN (Select NodeID FROM COM_CC50051 WITH(NOLOCK) WHERE IsGroup=0 AND LoginUserID=''admin'')
                                UNION ALL
                                Select * FROM COM_CC50051 WITH(NOLOCK) WHERE RptManager IN 
                                (
	                                Select NodeID FROM COM_CC50051 WITH(NOLOCK) 
	                                WHERE IsGroup=0 AND LoginUserID IN
	                                (
	                                SELECT fe.LoginUserID
	                                FROM INV_DocDetails a WITH(NOLOCK) 
	                                JOIN COM_DocCCData b WITH(NOLOCK) ON b.InvDocDetailsID=a.InvDocDetailsID
	                                JOIN COM_DocNumData c WITH(NOLOCK) ON c.InvDocDetailsID=a.InvDocDetailsID
	                                JOIN COM_DocTextData d WITH(NOLOCK) ON d.InvDocDetailsID=a.InvDocDetailsID
	                                JOIN COM_CC50051 fe WITH(NOLOCK) on fe.NodeID=b.dcCCNID51
	                                JOIN COM_CC50051 te WITH(NOLOCK) on CONVERT(NVARCHAR,te.NodeID)=d.dcAlpha1
	                                WHERE a.CostCenterID=40098 and a.StatusID=369 AND d.dcAlpha3=''Temporary''
	                                AND te.LoginUserID=''admin'' 
	                                AND ISDATE(d.dcAlpha4)=1 AND ISDATE(d.dcAlpha5)=1 
	                                AND CONVERT(DATETIME,''08 Aug 2025'') BETWEEN CONVERT(DATETIME,d.dcAlpha4) AND CONVERT(DATETIME,d.dcAlpha5)
	                                )
                                )
                                --2
                                Select * FROM ADM_USERS WITH(NOLOCK) WHERE USERID=1
                                --3
                                Select * FROM COM_CostCenterCostCenterMap WITH(NOLOCK) WHERE ParentCostCenterID=7 AND ParentNodeID=1
                                --4                                
                                Select * FROM COM_CostCenterCostCenterMap WITH(NOLOCK) WHERE ParentCostCenterID=7 AND ParentNodeID=1
                                AND CostCenterID IN(Select ColumnCostCenterID From ADM_CostCenterDef Where CostCenterID=50051 AND IsColumnInUse=1 AND SysColumnName LIKE ''CCNID%'')
                                --5
                                Select * from COM_Files WITH(NOLOCK) WHERE FeatureID=50051 AND FeaturePK IN (Select NodeID FROM COM_CC50051 WITH(NOLOCK) WHERE IsGroup=0 AND LoginUserID=''admin'')                         
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 11:55:44.138 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 11:55:44.185 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 11:55:44.185 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 11:55:44.688 | General Service|:: CompanyIndex:53 SpName: spADM_GetDashBoard 
 1
 ,41
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 11:55:44.688 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 11:55:44.704 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,60583
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 11:55:44.719 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 11:55:44.735 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,60584
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 11:55:44.735 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,60587
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 11:55:44.735 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 11:55:44.751 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 11:55:44.751 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,60586
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 11:55:44.751 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 11:55:44.751 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,60585
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 11:55:44.751 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 11:55:44.751 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,60588
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 11:55:44.751 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 11:55:44.751 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 11:55:44.766 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,60583
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 11:55:44.766 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 11:55:44.766 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 11:55:44.766 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,60584
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 11:55:44.766 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,60586
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 11:55:44.766 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,60587
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 11:55:44.766 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 11:55:44.782 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 11:55:44.782 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 11:55:44.782 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 11:55:44.782 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,60585
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 11:55:44.782 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,60588
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 11:55:44.782 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 11:55:44.782 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 11:55:44.782 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 11:55:44.798 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 11:55:44.813 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 11:55:44.829 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 11:55:44.829 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 11:55:44.844 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 11:55:44.844 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 11:55:44.860 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 11:55:44.860 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 11:55:44.860 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 11:55:44.860 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 11:55:44.876 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 11:55:44.876 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 11:55:44.891 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 11:55:44.891 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 11:55:44.891 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 11:55:44.891 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 11:55:44.907 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 11:55:44.907 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 11:55:44.923 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 11:55:44.923 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 11:55:45.016 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60583'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 11:55:45.016 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 11:55:45.375 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReportCategoryandField 
 -1
 ,0
 ,1
 ,0
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 11:55:45.375 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 11:55:45.422 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60584'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 11:55:45.422 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 11:55:45.438 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60585'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 11:55:45.438 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 11:55:45.454 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select * from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0  
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) a --where UStatus like ''%Hold%'' 
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 11:55:45.469 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 11:55:45.469 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select * from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0  
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) a where UnitStatus=''Vacant''
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 11:55:45.469 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 11:55:45.469 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60586'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 11:55:45.469 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select * from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0  
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) a where UnitStatus=''Occupied'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 11:55:45.485 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 11:55:45.485 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 11:55:45.500 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60587'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 11:55:45.500 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 11:55:45.500 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select * from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0  
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) a  where UnitStatus=''Expired'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 11:55:45.500 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 11:55:45.500 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60588'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 11:55:45.500 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 11:55:45.516 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60583'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 11:55:45.516 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 11:55:45.532 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select * from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0  
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) a where UStatus like ''%Case%'' 
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 11:55:45.532 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 11:55:45.547 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60584'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 11:55:45.563 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 11:55:45.563 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select * from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0  
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) a --where UStatus like ''%Hold%'' 
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 11:55:45.563 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 11:55:45.579 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 '/*
DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select * from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0  
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) a where UStatus like ''%Reserve%'' 
*/

DECLARE @FROM FLOAT
SET @FROM=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @UnitID BIGINT,@StatusID BIGINT,@TotalAmount FLOAT,@I INT,@COUNT INT,@ContractID BIGINT
DECLARE @NoofDays INT,@VacantSince DATETIME

DECLARE @TAB TABLE(ID INT IDENTITY(1,1) PRIMARY KEY,UnitID BIGINT,CurrentRent FLOAT,Status NVARCHAR(10),NoofDays INT,VacantSince DATETIME,ContractID BIGINT)

INSERT INTO @TAB (UnitID)
SELECT U.UnitID
FROM REN_Units U WITH(NOLOCK) 
LEFT JOIN REN_Property P WITH(NOLOCK) ON P.NodeID=U.PropertyID
LEFT JOIN COM_Lookup LK WITH(NOLOCK) ON U.UnitStatus=LK.NodeID
WHERE U.UnitID>1 AND P.Name <> U.Name AND U.IsGroup=0 AND U.Status=424 and U.UnitStatus=306 
-- AND P.NodeID IN (207)
SELECT @I=1,@COUNT=COUNT(*) FROM @TAB
WHILE(@I<=@COUNT)
BEGIN
	SET @StatusID=0
	SET @TotalAmount=0
	SET @ContractID=0
	SELECT @UnitID=UnitID FROM @TAB WHERE ID=@I

	SELECT TOP 1 @ContractID=(CASE WHEN RefContractID>0 THEN RefContractID ELSE ContractID END),@StatusID=StatusID
	,@VacantSince=(CASE WHEN StatusID = 450 THEN ( CASE WHEN RefundDate IS NOT NULL THEN CONVERT(DATETIME,RefundDate) ELSE CONVERT(DATETIME,VacancyDate) END ) 
			ELSE CONVERT(DATETIME,TerminationDate) END )
	,@NoofDays=(CASE WHEN StatusID = 450 THEN (CASE WHEN RefundDate IS NOT NULL THEN DATEDIFF(DAY, CONVERT(DATETIME,RefundDate),CONVERT(DATETIME,@FROM) ) 
			ELSE DATEDIFF(DAY, CONVERT(DATETIME,VacancyDate),CONVERT(DATETIME,@FROM) ) END )
			ELSE DATEDIFF(DAY, CONVERT(DATETIME,TerminationDate),CONVERT(DATETIME,@FROM) ) END )  
	FROM REN_Contract WITH(NOLOCK) WHERE StatusID<>451 AND StartDate<@FROM AND UNITID=@UnitID 
	ORDER BY StartDate DESC,StatusID
	
	SELECT @TotalAmount=ISNULL(SUM(RPD.Amount),MAX(RentAmount)/(CASE WHEN MAX(RC.NoOfUnits)=0 THEN 1 ELSE MAX(RC.NoOfUnits) END)) 
	FROM REN_Contract RC WITH(NOLOCK)
	JOIN REN_ContractParticulars RP WITH(NOLOCK) ON RP.ContractID=RC.ContractID AND RP.Sno=1
	LEFT JOIN REN_ContractParticularsDetail RPD WITH(NOLOCK) ON RPD.ParticularNodeID=RP.NodeID AND RPD.Unit=@UnitID 
	AND @FROM BETWEEN ISNULL(RPD.FromDate,@FROM) AND ISNULL(RPD.ToDate,@FROM)
	WHERE RC.ContractID=@ContractID
	
	IF @StatusID=427 OR @StatusID=426 OR @StatusID=466
	BEGIN
		UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Occupied'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
	END
	ELSE IF @StatusID=440
	BEGIN
		UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''UnAproved'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
	END
	ELSE IF @StatusID=428 OR @StatusID=450
	BEGIN 
		IF EXISTS (SELECT * FROM REN_Quotation WITH(NOLOCK) WHERE COSTCENTERID=129 AND UNITID=@UnitID AND CONVERT(DATETIME,@FROM) BETWEEN CONVERT(DATETIME,STARTDATE) AND CONVERT(DATETIME,ENDDATE) and statusid=467 )
			UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Reserved'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
		ELSE IF EXISTS (SELECT * FROM REN_Quotation WITH(NOLOCK) WHERE COSTCENTERID=103 AND UNITID=@UnitID AND CONVERT(DATETIME,@FROM) BETWEEN CONVERT(DATETIME,STARTDATE) AND CONVERT(DATETIME,ENDDATE) and statusid=426 )
			UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Quoted'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
		ELSE
			UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Vacant'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
	END
	ELSE
	BEGIN 
		IF EXISTS (SELECT * FROM REN_Quotation WITH(NOLOCK) WHERE COSTCENTERID=129 AND UNITID=@UnitID AND CONVERT(DATETIME,@FROM) BETWEEN CONVERT(DATETIME,STARTDATE) AND CONVERT(DATETIME,ENDDATE) and statusid=467 )
			UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Reserved'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
		ELSE IF EXISTS (SELECT * FROM REN_Quotation WITH(NOLOCK) WHERE COSTCENTERID=103 AND UNITID=@UnitID AND CONVERT(DATETIME,@FROM) BETWEEN CONVERT(DATETIME,STARTDATE) AND CONVERT(DATETIME,ENDDATE) and statusid=426 )
			UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Quoted'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
		ELSE
			UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Vacant'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
	END
	set @I=@I+1
END

select * from (
SELECT TEMP.*,RP.NodeID Building_ID,RP.NAME Property,TEMP.UnitID Unit_ID,RU.NAME Unit,C18.NAME UnitType,RU.UnitStatus,RU.RentableArea UnitArea,RU.RentPerSQFT UnitRate
,RU.AnnualRent 
,T.FirstName AS [C98c7d2679f99489e9f0e010026eeb563]
,RUL.Name LandLord , RUC.Name Location 
,1 Cnt
FROM @TAB TEMP
JOIN REN_Units RU WITH(NOLOCK) ON TEMP.UnitID=RU.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
LEFT JOIN COM_CC50018 C18 WITH(NOLOCK) ON C18.NodeID=RU.NodeID
LEFT JOIN REN_Contract C WITH(NOLOCK) ON TEMP.ContractID=C.ContractID
LEFT JOIN REN_Tenant T WITH(NOLOCK) ON T.TenantID=C.TenantID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID

 )a where a.Status =''Reserved''
 order by Property,VacantSince'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 11:55:45.579 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 11:55:45.579 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60585'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 11:55:45.579 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 11:55:45.594 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60586'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 11:55:45.594 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select * from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0  
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) a where UnitStatus=''Occupied'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 11:55:45.594 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select * from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0  
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) a where UnitStatus=''Vacant''
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 11:55:45.594 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 11:55:45.594 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 11:55:45.594 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 11:55:45.625 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select * from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0  
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) a  where UnitStatus=''Expired'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 11:55:45.625 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 11:55:45.641 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60587'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 11:55:45.641 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 11:55:45.641 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60588'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 11:55:45.641 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 11:55:45.672 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select * from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0  
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) a where UStatus like ''%Case%'' 
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 11:55:45.672 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 11:55:45.704 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 '/*
DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select * from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0  
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) a where UStatus like ''%Reserve%'' 
*/

DECLARE @FROM FLOAT
SET @FROM=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @UnitID BIGINT,@StatusID BIGINT,@TotalAmount FLOAT,@I INT,@COUNT INT,@ContractID BIGINT
DECLARE @NoofDays INT,@VacantSince DATETIME

DECLARE @TAB TABLE(ID INT IDENTITY(1,1) PRIMARY KEY,UnitID BIGINT,CurrentRent FLOAT,Status NVARCHAR(10),NoofDays INT,VacantSince DATETIME,ContractID BIGINT)

INSERT INTO @TAB (UnitID)
SELECT U.UnitID
FROM REN_Units U WITH(NOLOCK) 
LEFT JOIN REN_Property P WITH(NOLOCK) ON P.NodeID=U.PropertyID
LEFT JOIN COM_Lookup LK WITH(NOLOCK) ON U.UnitStatus=LK.NodeID
WHERE U.UnitID>1 AND P.Name <> U.Name AND U.IsGroup=0 AND U.Status=424 and U.UnitStatus=306 
-- AND P.NodeID IN (207)
SELECT @I=1,@COUNT=COUNT(*) FROM @TAB
WHILE(@I<=@COUNT)
BEGIN
	SET @StatusID=0
	SET @TotalAmount=0
	SET @ContractID=0
	SELECT @UnitID=UnitID FROM @TAB WHERE ID=@I

	SELECT TOP 1 @ContractID=(CASE WHEN RefContractID>0 THEN RefContractID ELSE ContractID END),@StatusID=StatusID
	,@VacantSince=(CASE WHEN StatusID = 450 THEN ( CASE WHEN RefundDate IS NOT NULL THEN CONVERT(DATETIME,RefundDate) ELSE CONVERT(DATETIME,VacancyDate) END ) 
			ELSE CONVERT(DATETIME,TerminationDate) END )
	,@NoofDays=(CASE WHEN StatusID = 450 THEN (CASE WHEN RefundDate IS NOT NULL THEN DATEDIFF(DAY, CONVERT(DATETIME,RefundDate),CONVERT(DATETIME,@FROM) ) 
			ELSE DATEDIFF(DAY, CONVERT(DATETIME,VacancyDate),CONVERT(DATETIME,@FROM) ) END )
			ELSE DATEDIFF(DAY, CONVERT(DATETIME,TerminationDate),CONVERT(DATETIME,@FROM) ) END )  
	FROM REN_Contract WITH(NOLOCK) WHERE StatusID<>451 AND StartDate<@FROM AND UNITID=@UnitID 
	ORDER BY StartDate DESC,StatusID
	
	SELECT @TotalAmount=ISNULL(SUM(RPD.Amount),MAX(RentAmount)/(CASE WHEN MAX(RC.NoOfUnits)=0 THEN 1 ELSE MAX(RC.NoOfUnits) END)) 
	FROM REN_Contract RC WITH(NOLOCK)
	JOIN REN_ContractParticulars RP WITH(NOLOCK) ON RP.ContractID=RC.ContractID AND RP.Sno=1
	LEFT JOIN REN_ContractParticularsDetail RPD WITH(NOLOCK) ON RPD.ParticularNodeID=RP.NodeID AND RPD.Unit=@UnitID 
	AND @FROM BETWEEN ISNULL(RPD.FromDate,@FROM) AND ISNULL(RPD.ToDate,@FROM)
	WHERE RC.ContractID=@ContractID
	
	IF @StatusID=427 OR @StatusID=426 OR @StatusID=466
	BEGIN
		UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Occupied'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
	END
	ELSE IF @StatusID=440
	BEGIN
		UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''UnAproved'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
	END
	ELSE IF @StatusID=428 OR @StatusID=450
	BEGIN 
		IF EXISTS (SELECT * FROM REN_Quotation WITH(NOLOCK) WHERE COSTCENTERID=129 AND UNITID=@UnitID AND CONVERT(DATETIME,@FROM) BETWEEN CONVERT(DATETIME,STARTDATE) AND CONVERT(DATETIME,ENDDATE) and statusid=467 )
			UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Reserved'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
		ELSE IF EXISTS (SELECT * FROM REN_Quotation WITH(NOLOCK) WHERE COSTCENTERID=103 AND UNITID=@UnitID AND CONVERT(DATETIME,@FROM) BETWEEN CONVERT(DATETIME,STARTDATE) AND CONVERT(DATETIME,ENDDATE) and statusid=426 )
			UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Quoted'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
		ELSE
			UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Vacant'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
	END
	ELSE
	BEGIN 
		IF EXISTS (SELECT * FROM REN_Quotation WITH(NOLOCK) WHERE COSTCENTERID=129 AND UNITID=@UnitID AND CONVERT(DATETIME,@FROM) BETWEEN CONVERT(DATETIME,STARTDATE) AND CONVERT(DATETIME,ENDDATE) and statusid=467 )
			UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Reserved'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
		ELSE IF EXISTS (SELECT * FROM REN_Quotation WITH(NOLOCK) WHERE COSTCENTERID=103 AND UNITID=@UnitID AND CONVERT(DATETIME,@FROM) BETWEEN CONVERT(DATETIME,STARTDATE) AND CONVERT(DATETIME,ENDDATE) and statusid=426 )
			UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Quoted'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
		ELSE
			UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Vacant'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
	END
	set @I=@I+1
END

select * from (
SELECT TEMP.*,RP.NodeID Building_ID,RP.NAME Property,TEMP.UnitID Unit_ID,RU.NAME Unit,C18.NAME UnitType,RU.UnitStatus,RU.RentableArea UnitArea,RU.RentPerSQFT UnitRate
,RU.AnnualRent 
,T.FirstName AS [C98c7d2679f99489e9f0e010026eeb563]
,RUL.Name LandLord , RUC.Name Location 
,1 Cnt
FROM @TAB TEMP
JOIN REN_Units RU WITH(NOLOCK) ON TEMP.UnitID=RU.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
LEFT JOIN COM_CC50018 C18 WITH(NOLOCK) ON C18.NodeID=RU.NodeID
LEFT JOIN REN_Contract C WITH(NOLOCK) ON TEMP.ContractID=C.ContractID
LEFT JOIN REN_Tenant T WITH(NOLOCK) ON T.TenantID=C.TenantID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID

 )a where a.Status =''Reserved''
 order by Property,VacantSince'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 11:55:45.704 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 08-08-2025 11:55:56.412 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 08-08-2025 11:55:56.412 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzU0NjM0MjI2LCJleHAiOjE3NTQ2NjMwMjYsImlhdCI6MTc1NDYzNDIyNn0.Q8kJCmcT-ZXaYWywT9EPp7UXiCYjtWMurOTIksptIrU'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 11:56:45.348 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 11:56:45.395 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 08-08-2025 11:56:56.780 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 08-08-2025 11:56:56.780 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzU0NjM0MjI2LCJleHAiOjE3NTQ2NjMwMjYsImlhdCI6MTc1NDYzNDIyNn0.Q8kJCmcT-ZXaYWywT9EPp7UXiCYjtWMurOTIksptIrU'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 11:57:45.426 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 11:57:45.691 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 08-08-2025 11:57:56.861 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 08-08-2025 11:57:57.001 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzU0NjM0MjI2LCJleHAiOjE3NTQ2NjMwMjYsImlhdCI6MTc1NDYzNDIyNn0.Q8kJCmcT-ZXaYWywT9EPp7UXiCYjtWMurOTIksptIrU'''
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 08-08-2025 11:58:13.122 | General Service|:: CompanyIndex:7 SpName: spRPT_GeneralLedger 
 '2575,9,117,118,119,120,121,122,124,125,2320,127,128,129,130,131,132,134,135,139,140,141,142,143,144,145,2236,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,2365,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,179,15,182,183,2237,185,186,187,188,189,190,191,192,193,195,2334,2335,2336,2337,2378,2381,2406,2486,198,199,200,201,202,203,360,363,205,206,2244,12581,12586,12587,208,209,210,211'
 ,''
 ,NULL
 ,False
 ,0
 ,'04/Jun/2015 12:00:00 AM'
 ,'08/Aug/2025 11:54:08 AM'
 ,'371'
 ,True
 ,True
 ,True
 ,True
 ,True
 ,'DocDate'
 ,'ChequeMaturityDate'
 ,0
 ,1
 ,''
 ,''
 ,''
 ,False
 ,''
 ,True
 ,''
 ,True
 ,1
 ,0
 ,0
 ,False
 ,''
 ,',T1.Name AS [Ca07ce1942b974117858fed956fd4977d],T2.Name AS [C78f395a1e83643d78e283db7f7444a44],T3.Name AS [C3e33b62d402c43828996dd8a9fdb5e0f],T4.Name AS [Cb934d1ca1d10414d8c8eb42b9bd23c7a],T5.Name AS [Cb33dd9f3cc874400a0ad0fbba27ce08c],T5.NodeID [Cb33dd9f3cc874400a0ad0fbba27ce08c_ID],D.DocAbbr AS [C0fdfb5913bc84bb28ff009508a291d34],D.LineNarration AS [Cbe5fea06113c402fa81ef5850c24a3b6],T6.Name AS [C0d104ba1bbe64d0389b9917e1b8a2508],T7.Name AS [Cba7ef610f6964cc2ad4a5704fb49b9c2],D.LineNarration AS [C0ccb5e9a660944858557b303e7e687d8],D.CommonNarration AS [Cdb56fe2fb89a456b8bc0ba0a58605511],CONVERT(DATETIME,D.DocDate) AS [C46fcb237a6394d9ba1a68b62552cbb60],stuff((select '',''+[GUID]+''.''+FileExtension from COM_Files WITH(NOLOCK) WHERE FeatureID=D.CostCenterID AND FeaturePK=D.DocID FOR XML PATH('''')),1,1,'''') Cc25aef0affff43399d87121b6f170443_ID,stuff((select '', ''+ActualFileName from COM_Files WITH(NOLOCK) WHERE FeatureID=D.CostCenterID AND FeaturePK=D.DocID FOR XML PATH('''')),1,2,'''') AS [Cc25aef0affff43399d87121b6f170443],T8.Status AS [Cfdcd1cf0b0ab426e8d14ceb37f18d1b0],(SELECT VoucherNo FROM INV_DocDetails with(nolock)	WHERE InvDocDetailsID IN (select LinkedInvDocDetailsID from INV_DocDetails with(nolock) WHERE InvDocDetailsID=D.InvDocDetailsID and LinkedInvDocDetailsID>0)) AS [Ce50c7344cbc04090868faaf45e29d1c0],T9.Name AS [C316c240ba519495898382b0954ed543f],T10.Name AS [Ced3eee10411347a5bbcc1421783b0a5a],T11.Name AS [C6fe09ef1a7924984b4bdb26ff33c8a25],T12.Name AS [C0cc600a19cc945e89beaa20894313c9b],DocumentType.DocumentName AS [C6a1698c7afe34da59f10a87c63928d03],T6.Name AS [C885109baecb04a0ba746d9fb88a66c7a],T13.Name AS [Cfda038eadefa4d5fb45c93c086d9741b],T14.Name AS [C88f60b4527c94d35addf4414633d521a],T15.ccAlpha1 AS [C720569aa037e4fdbb10e1f9daa826490],T16.UserName AS [Cc3447cddb7024d9cbcece6c4465c606c],CONVERT(DATETIME,D.CreatedDate) AS [Ceb36660f3b9846e0811f4f677261bb50],A1.AccountName AS [C969dbd8988724b91adfd70a8b261194c],A1.AccountCode AS [Caeb82d0209c846dd916e98fc8fea50a1],A1.AccountCode AS [Cd8ffd8610aef496cbfa6b04dac1c17b0],A1.AccountName AS [C3c75048416c9418fbd61a5ef5f9ddfc4]'
 ,' LEFT JOIN COM_CC50009 AS T1 with(nolock) ON T1.NodeID=DCC.dcCCNID9 LEFT JOIN COM_CC50013 AS T2 with(nolock) ON T2.NodeID=DCC.dcCCNID13 LEFT JOIN COM_Salesman AS T3 with(nolock) ON T3.NodeID=DCC.dcCCNID5 LEFT JOIN COM_CC50010 AS T4 with(nolock) ON T4.NodeID=DCC.dcCCNID10 LEFT JOIN COM_CC50019 AS T5 with(nolock) ON T5.NodeID=DCC.dcCCNID19 LEFT JOIN COM_CC50011 AS T6 with(nolock) ON T6.NodeID=DCC.dcCCNID11 LEFT JOIN COM_Area AS T7 with(nolock) ON T7.NodeID=DCC.dcCCNID7 LEFT JOIN COM_Status AS T8 with(nolock) ON T8.StatusID=D.StatusID LEFT JOIN COM_Location AS T9 with(nolock) ON T9.NodeID=DCC.dcCCNID2 LEFT JOIN COM_CC50155 AS T10 with(nolock) ON T10.NodeID=DCC.dcCCNID155 LEFT JOIN COM_CC50156 AS T11 with(nolock) ON T11.NodeID=DCC.dcCCNID156 LEFT JOIN COM_CC50157 AS T12 with(nolock) ON T12.NodeID=DCC.dcCCNID157 LEFT JOIN ADM_DocumentTypes AS DocumentType with(nolock) ON DocumentType.CostCenterID=D.CostCenterID LEFT JOIN COM_CC50059 AS T13 with(nolock) ON T13.NodeID=DCC.dcCCNID59 LEFT JOIN COM_CC50061 AS T14 with(nolock) ON T14.NodeID=DCC.dcCCNID61 LEFT JOIN COM_Teritory AS T15 with(nolock) ON T15.NodeID=DCC.dcCCNID8 LEFT JOIN ADM_Users AS T16 with(nolock) ON T16.Username=D.CreatedBy'
 ,',Ca07ce1942b974117858fed956fd4977d,C78f395a1e83643d78e283db7f7444a44,C3e33b62d402c43828996dd8a9fdb5e0f,Cb934d1ca1d10414d8c8eb42b9bd23c7a,Cb33dd9f3cc874400a0ad0fbba27ce08c,Cb33dd9f3cc874400a0ad0fbba27ce08c_ID,C0fdfb5913bc84bb28ff009508a291d34,Cbe5fea06113c402fa81ef5850c24a3b6,C0d104ba1bbe64d0389b9917e1b8a2508,Cba7ef610f6964cc2ad4a5704fb49b9c2,C0ccb5e9a660944858557b303e7e687d8,Cdb56fe2fb89a456b8bc0ba0a58605511,C46fcb237a6394d9ba1a68b62552cbb60,Cc25aef0affff43399d87121b6f170443_ID,Cc25aef0affff43399d87121b6f170443,Cfdcd1cf0b0ab426e8d14ceb37f18d1b0,Ce50c7344cbc04090868faaf45e29d1c0,C316c240ba519495898382b0954ed543f,Ced3eee10411347a5bbcc1421783b0a5a,C6fe09ef1a7924984b4bdb26ff33c8a25,C0cc600a19cc945e89beaa20894313c9b,C6a1698c7afe34da59f10a87c63928d03,C885109baecb04a0ba746d9fb88a66c7a,Cfda038eadefa4d5fb45c93c086d9741b,C88f60b4527c94d35addf4414633d521a,C720569aa037e4fdbb10e1f9daa826490,Cc3447cddb7024d9cbcece6c4465c606c,Ceb36660f3b9846e0811f4f677261bb50,C969dbd8988724b91adfd70a8b261194c,Caeb82d0209c846dd916e98fc8fea50a1,Cd8ffd8610aef496cbfa6b04dac1c17b0,C3c75048416c9418fbd61a5ef5f9ddfc4'
 ,0
 ,'371'
 ,False
 ,1
[System: 192.168.1.76] DEBUG | 08-08-2025 11:58:13.138 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzU0NjM0MjI2LCJleHAiOjE3NTQ2NjMwMjYsImlhdCI6MTc1NDYzNDIyNn0.Q8kJCmcT-ZXaYWywT9EPp7UXiCYjtWMurOTIksptIrU'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 11:58:45.146 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 11:58:45.193 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 08-08-2025 11:58:55.238 | General Service|:: CompanyIndex:7 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.76] DEBUG | 08-08-2025 11:58:55.831 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzU0NjM0MjI2LCJleHAiOjE3NTQ2NjMwMjYsImlhdCI6MTc1NDYzNDIyNn0.Q8kJCmcT-ZXaYWywT9EPp7UXiCYjtWMurOTIksptIrU'''
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 08-08-2025 11:58:58.050 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 08-08-2025 11:58:58.096 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzU0NjM0MjI2LCJleHAiOjE3NTQ2NjMwMjYsImlhdCI6MTc1NDYzNDIyNn0.Q8kJCmcT-ZXaYWywT9EPp7UXiCYjtWMurOTIksptIrU'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 11:59:45.133 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 11:59:45.180 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 08-08-2025 11:59:56.818 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 08-08-2025 11:59:56.865 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzU0NjM0MjI2LCJleHAiOjE3NTQ2NjMwMjYsImlhdCI6MTc1NDYzNDIyNn0.Q8kJCmcT-ZXaYWywT9EPp7UXiCYjtWMurOTIksptIrU'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 12:00:43.074 | General Service|:: CompanyIndex:53 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.99] DEBUG | 08-08-2025 12:00:43.074 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 08-08-2025 12:00:56.778 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 08-08-2025 12:00:56.778 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzU0NjM0MjI2LCJleHAiOjE3NTQ2NjMwMjYsImlhdCI6MTc1NDYzNDIyNn0.Q8kJCmcT-ZXaYWywT9EPp7UXiCYjtWMurOTIksptIrU'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 12:01:33.094 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 12:01:33.110 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 08-08-2025 12:01:57.742 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 08-08-2025 12:01:57.757 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzU0NjM0MjI2LCJleHAiOjE3NTQ2NjMwMjYsImlhdCI6MTc1NDYzNDIyNn0.Q8kJCmcT-ZXaYWywT9EPp7UXiCYjtWMurOTIksptIrU'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 12:02:33.098 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 12:02:33.098 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 08-08-2025 12:02:58.750 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 08-08-2025 12:02:58.750 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzU0NjM0MjI2LCJleHAiOjE3NTQ2NjMwMjYsImlhdCI6MTc1NDYzNDIyNn0.Q8kJCmcT-ZXaYWywT9EPp7UXiCYjtWMurOTIksptIrU'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 12:03:33.081 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 12:03:33.096 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 08-08-2025 12:03:54.636 | General Service|:: CompanyIndex:7 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.76] DEBUG | 08-08-2025 12:03:54.652 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzU0NjM0MjI2LCJleHAiOjE3NTQ2NjMwMjYsImlhdCI6MTc1NDYzNDIyNn0.Q8kJCmcT-ZXaYWywT9EPp7UXiCYjtWMurOTIksptIrU'''
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 08-08-2025 12:03:59.810 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 08-08-2025 12:03:59.810 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzU0NjM0MjI2LCJleHAiOjE3NTQ2NjMwMjYsImlhdCI6MTc1NDYzNDIyNn0.Q8kJCmcT-ZXaYWywT9EPp7UXiCYjtWMurOTIksptIrU'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 12:04:33.098 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 12:04:33.098 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 08-08-2025 12:04:56.763 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 08-08-2025 12:04:56.763 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzU0NjM0MjI2LCJleHAiOjE3NTQ2NjMwMjYsImlhdCI6MTc1NDYzNDIyNn0.Q8kJCmcT-ZXaYWywT9EPp7UXiCYjtWMurOTIksptIrU'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 12:05:33.102 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 12:05:33.102 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 12:05:43.066 | General Service|:: CompanyIndex:53 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.99] DEBUG | 08-08-2025 12:05:43.066 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 08-08-2025 12:05:57.770 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 08-08-2025 12:05:57.770 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzU0NjM0MjI2LCJleHAiOjE3NTQ2NjMwMjYsImlhdCI6MTc1NDYzNDIyNn0.Q8kJCmcT-ZXaYWywT9EPp7UXiCYjtWMurOTIksptIrU'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 12:06:33.093 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 12:06:33.093 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 08-08-2025 12:06:58.753 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 08-08-2025 12:06:58.753 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzU0NjM0MjI2LCJleHAiOjE3NTQ2NjMwMjYsImlhdCI6MTc1NDYzNDIyNn0.Q8kJCmcT-ZXaYWywT9EPp7UXiCYjtWMurOTIksptIrU'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 12:07:33.088 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 12:07:33.088 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 08-08-2025 12:07:56.775 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 08-08-2025 12:07:56.931 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzU0NjM0MjI2LCJleHAiOjE3NTQ2NjMwMjYsImlhdCI6MTc1NDYzNDIyNn0.Q8kJCmcT-ZXaYWywT9EPp7UXiCYjtWMurOTIksptIrU'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 12:08:33.092 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 12:08:33.092 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 08-08-2025 12:08:47.690 | General Service|:: CompanyIndex:0 SpName: spADM_Login 
 4
 ,''
 ,''
 ,''
 ,'declare @AllowSession bit,@GUID nvarchar(50)
set @AllowSession=0
set @GUID=''cc0d383c-3cf9-4f06-b1e8-c057cde7f4ad''
if exists(select [GUID] from ADM_Login with(nolock) where [GUID]=@GUID)
begin
    update ADM_Login  set LastAccessTime=convert(float,getdate()) where [GUID]=@GUID
    set @AllowSession=1
end
select @AllowSession AllowSession
'
 ,''
 ,0
[System: 192.168.1.76] DEBUG | 08-08-2025 12:08:47.690 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzU0NjM0MjI2LCJleHAiOjE3NTQ2NjMwMjYsImlhdCI6MTc1NDYzNDIyNn0.Q8kJCmcT-ZXaYWywT9EPp7UXiCYjtWMurOTIksptIrU'''
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 08-08-2025 12:08:54.644 | General Service|:: CompanyIndex:7 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.76] DEBUG | 08-08-2025 12:08:54.659 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzU0NjM0MjI2LCJleHAiOjE3NTQ2NjMwMjYsImlhdCI6MTc1NDYzNDIyNn0.Q8kJCmcT-ZXaYWywT9EPp7UXiCYjtWMurOTIksptIrU'''
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 08-08-2025 12:08:56.759 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 08-08-2025 12:08:56.759 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzU0NjM0MjI2LCJleHAiOjE3NTQ2NjMwMjYsImlhdCI6MTc1NDYzNDIyNn0.Q8kJCmcT-ZXaYWywT9EPp7UXiCYjtWMurOTIksptIrU'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 12:09:33.086 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 12:09:33.101 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 08-08-2025 12:09:57.771 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 08-08-2025 12:09:57.771 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzU0NjM0MjI2LCJleHAiOjE3NTQ2NjMwMjYsImlhdCI6MTc1NDYzNDIyNn0.Q8kJCmcT-ZXaYWywT9EPp7UXiCYjtWMurOTIksptIrU'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 12:10:33.088 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 12:10:33.088 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 12:10:43.086 | General Service|:: CompanyIndex:53 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.99] DEBUG | 08-08-2025 12:10:43.086 | General Service|:: CompanyIndex:0 SpName: spADM_Login 
 4
 ,''
 ,''
 ,''
 ,'declare @AllowSession bit,@GUID nvarchar(50)
set @AllowSession=0
set @GUID=''0487a41c-8997-4838-bb25-c25f47d7ca93''
if exists(select [GUID] from ADM_Login with(nolock) where [GUID]=@GUID)
begin
    update ADM_Login  set LastAccessTime=convert(float,getdate()) where [GUID]=@GUID
    set @AllowSession=1
end
select @AllowSession AllowSession
'
 ,''
 ,0
[System: 192.168.1.99] DEBUG | 08-08-2025 12:10:43.086 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 12:10:43.101 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 08-08-2025 12:10:58.773 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 08-08-2025 12:10:58.773 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzU0NjM0MjI2LCJleHAiOjE3NTQ2NjMwMjYsImlhdCI6MTc1NDYzNDIyNn0.Q8kJCmcT-ZXaYWywT9EPp7UXiCYjtWMurOTIksptIrU'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 12:11:33.081 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 12:11:33.096 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 08-08-2025 12:11:59.756 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 08-08-2025 12:11:59.771 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzU0NjM0MjI2LCJleHAiOjE3NTQ2NjMwMjYsImlhdCI6MTc1NDYzNDIyNn0.Q8kJCmcT-ZXaYWywT9EPp7UXiCYjtWMurOTIksptIrU'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 12:12:33.083 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 12:12:33.099 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 08-08-2025 12:13:00.772 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 08-08-2025 12:13:00.772 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzU0NjM0MjI2LCJleHAiOjE3NTQ2NjMwMjYsImlhdCI6MTc1NDYzNDIyNn0.Q8kJCmcT-ZXaYWywT9EPp7UXiCYjtWMurOTIksptIrU'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 12:13:33.093 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 12:13:33.093 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 08-08-2025 12:13:54.664 | General Service|:: CompanyIndex:7 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.76] DEBUG | 08-08-2025 12:13:54.664 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzU0NjM0MjI2LCJleHAiOjE3NTQ2NjMwMjYsImlhdCI6MTc1NDYzNDIyNn0.Q8kJCmcT-ZXaYWywT9EPp7UXiCYjtWMurOTIksptIrU'''
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 08-08-2025 12:14:01.756 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 08-08-2025 12:14:01.772 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzU0NjM0MjI2LCJleHAiOjE3NTQ2NjMwMjYsImlhdCI6MTc1NDYzNDIyNn0.Q8kJCmcT-ZXaYWywT9EPp7UXiCYjtWMurOTIksptIrU'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 12:14:33.085 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 12:14:33.085 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 08-08-2025 12:15:02.842 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 08-08-2025 12:15:02.936 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzU0NjM0MjI2LCJleHAiOjE3NTQ2NjMwMjYsImlhdCI6MTc1NDYzNDIyNn0.Q8kJCmcT-ZXaYWywT9EPp7UXiCYjtWMurOTIksptIrU'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 12:15:33.110 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 12:15:33.110 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 12:15:43.053 | General Service|:: CompanyIndex:53 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.99] DEBUG | 08-08-2025 12:15:43.053 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 08-08-2025 12:16:03.798 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 08-08-2025 12:16:03.798 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzU0NjM0MjI2LCJleHAiOjE3NTQ2NjMwMjYsImlhdCI6MTc1NDYzNDIyNn0.Q8kJCmcT-ZXaYWywT9EPp7UXiCYjtWMurOTIksptIrU'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 12:16:33.072 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 12:16:33.072 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 08-08-2025 12:16:56.460 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 08-08-2025 12:16:56.460 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzU0NjM0MjI2LCJleHAiOjE3NTQ2NjMwMjYsImlhdCI6MTc1NDYzNDIyNn0.Q8kJCmcT-ZXaYWywT9EPp7UXiCYjtWMurOTIksptIrU'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 12:17:33.083 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 12:17:33.099 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 08-08-2025 12:17:56.797 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 08-08-2025 12:17:56.797 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzU0NjM0MjI2LCJleHAiOjE3NTQ2NjMwMjYsImlhdCI6MTc1NDYzNDIyNn0.Q8kJCmcT-ZXaYWywT9EPp7UXiCYjtWMurOTIksptIrU'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 12:18:33.093 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 12:18:33.093 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 08-08-2025 12:18:54.671 | General Service|:: CompanyIndex:7 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.76] DEBUG | 08-08-2025 12:18:54.671 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzU0NjM0MjI2LCJleHAiOjE3NTQ2NjMwMjYsImlhdCI6MTc1NDYzNDIyNn0.Q8kJCmcT-ZXaYWywT9EPp7UXiCYjtWMurOTIksptIrU'''
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 08-08-2025 12:18:57.787 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 08-08-2025 12:18:57.787 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzU0NjM0MjI2LCJleHAiOjE3NTQ2NjMwMjYsImlhdCI6MTc1NDYzNDIyNn0.Q8kJCmcT-ZXaYWywT9EPp7UXiCYjtWMurOTIksptIrU'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 12:19:33.076 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 12:19:33.076 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 08-08-2025 12:19:58.786 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 08-08-2025 12:19:58.786 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzU0NjM0MjI2LCJleHAiOjE3NTQ2NjMwMjYsImlhdCI6MTc1NDYzNDIyNn0.Q8kJCmcT-ZXaYWywT9EPp7UXiCYjtWMurOTIksptIrU'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 12:20:33.075 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 12:20:33.091 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 08-08-2025 12:20:59.797 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 08-08-2025 12:20:59.797 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzU0NjM0MjI2LCJleHAiOjE3NTQ2NjMwMjYsImlhdCI6MTc1NDYzNDIyNn0.Q8kJCmcT-ZXaYWywT9EPp7UXiCYjtWMurOTIksptIrU'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 12:21:33.044 | General Service|:: CompanyIndex:53 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.99] DEBUG | 08-08-2025 12:21:33.044 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 12:21:33.107 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 12:21:33.107 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 08-08-2025 12:22:00.791 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 08-08-2025 12:22:00.791 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzU0NjM0MjI2LCJleHAiOjE3NTQ2NjMwMjYsImlhdCI6MTc1NDYzNDIyNn0.Q8kJCmcT-ZXaYWywT9EPp7UXiCYjtWMurOTIksptIrU'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 12:22:33.083 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 12:22:33.083 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 08-08-2025 12:23:01.795 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 08-08-2025 12:23:01.795 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzU0NjM0MjI2LCJleHAiOjE3NTQ2NjMwMjYsImlhdCI6MTc1NDYzNDIyNn0.Q8kJCmcT-ZXaYWywT9EPp7UXiCYjtWMurOTIksptIrU'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 12:23:33.087 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 12:23:33.087 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 08-08-2025 12:23:47.691 | General Service|:: CompanyIndex:0 SpName: spADM_Login 
 4
 ,''
 ,''
 ,''
 ,'declare @AllowSession bit,@GUID nvarchar(50)
set @AllowSession=0
set @GUID=''cc0d383c-3cf9-4f06-b1e8-c057cde7f4ad''
if exists(select [GUID] from ADM_Login with(nolock) where [GUID]=@GUID)
begin
    update ADM_Login  set LastAccessTime=convert(float,getdate()) where [GUID]=@GUID
    set @AllowSession=1
end
select @AllowSession AllowSession
'
 ,''
 ,0
[System: 192.168.1.76] DEBUG | 08-08-2025 12:23:47.691 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzU0NjM0MjI2LCJleHAiOjE3NTQ2NjMwMjYsImlhdCI6MTc1NDYzNDIyNn0.Q8kJCmcT-ZXaYWywT9EPp7UXiCYjtWMurOTIksptIrU'''
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 08-08-2025 12:23:54.674 | General Service|:: CompanyIndex:7 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.76] DEBUG | 08-08-2025 12:23:54.674 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzU0NjM0MjI2LCJleHAiOjE3NTQ2NjMwMjYsImlhdCI6MTc1NDYzNDIyNn0.Q8kJCmcT-ZXaYWywT9EPp7UXiCYjtWMurOTIksptIrU'''
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 08-08-2025 12:24:02.785 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 08-08-2025 12:24:02.785 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzU0NjM0MjI2LCJleHAiOjE3NTQ2NjMwMjYsImlhdCI6MTc1NDYzNDIyNn0.Q8kJCmcT-ZXaYWywT9EPp7UXiCYjtWMurOTIksptIrU'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 12:24:33.101 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 12:24:33.101 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 08-08-2025 12:25:03.801 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 08-08-2025 12:25:03.801 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzU0NjM0MjI2LCJleHAiOjE3NTQ2NjMwMjYsImlhdCI6MTc1NDYzNDIyNn0.Q8kJCmcT-ZXaYWywT9EPp7UXiCYjtWMurOTIksptIrU'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 12:25:33.068 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 12:25:33.083 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 12:25:43.041 | General Service|:: CompanyIndex:0 SpName: spADM_Login 
 4
 ,''
 ,''
 ,''
 ,'declare @AllowSession bit,@GUID nvarchar(50)
set @AllowSession=0
set @GUID=''0487a41c-8997-4838-bb25-c25f47d7ca93''
if exists(select [GUID] from ADM_Login with(nolock) where [GUID]=@GUID)
begin
    update ADM_Login  set LastAccessTime=convert(float,getdate()) where [GUID]=@GUID
    set @AllowSession=1
end
select @AllowSession AllowSession
'
 ,''
 ,0
[System: 192.168.1.99] DEBUG | 08-08-2025 12:25:43.041 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 08-08-2025 12:26:04.794 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 08-08-2025 12:26:04.794 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzU0NjM0MjI2LCJleHAiOjE3NTQ2NjMwMjYsImlhdCI6MTc1NDYzNDIyNn0.Q8kJCmcT-ZXaYWywT9EPp7UXiCYjtWMurOTIksptIrU'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 12:26:33.040 | General Service|:: CompanyIndex:53 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.99] DEBUG | 08-08-2025 12:26:33.040 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 12:26:33.087 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 12:26:33.087 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 08-08-2025 12:27:05.793 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 08-08-2025 12:27:05.793 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzU0NjM0MjI2LCJleHAiOjE3NTQ2NjMwMjYsImlhdCI6MTc1NDYzNDIyNn0.Q8kJCmcT-ZXaYWywT9EPp7UXiCYjtWMurOTIksptIrU'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 12:27:33.085 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 12:27:33.085 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 08-08-2025 12:28:06.800 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 08-08-2025 12:28:06.800 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzU0NjM0MjI2LCJleHAiOjE3NTQ2NjMwMjYsImlhdCI6MTc1NDYzNDIyNn0.Q8kJCmcT-ZXaYWywT9EPp7UXiCYjtWMurOTIksptIrU'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 12:28:33.069 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 12:28:33.085 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 08-08-2025 12:28:54.683 | General Service|:: CompanyIndex:7 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.76] DEBUG | 08-08-2025 12:28:54.698 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzU0NjM0MjI2LCJleHAiOjE3NTQ2NjMwMjYsImlhdCI6MTc1NDYzNDIyNn0.Q8kJCmcT-ZXaYWywT9EPp7UXiCYjtWMurOTIksptIrU'''
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 08-08-2025 12:28:56.807 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 08-08-2025 12:28:56.807 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzU0NjM0MjI2LCJleHAiOjE3NTQ2NjMwMjYsImlhdCI6MTc1NDYzNDIyNn0.Q8kJCmcT-ZXaYWywT9EPp7UXiCYjtWMurOTIksptIrU'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 12:29:33.095 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 12:29:33.095 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 08-08-2025 12:29:57.814 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 08-08-2025 12:29:57.814 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzU0NjM0MjI2LCJleHAiOjE3NTQ2NjMwMjYsImlhdCI6MTc1NDYzNDIyNn0.Q8kJCmcT-ZXaYWywT9EPp7UXiCYjtWMurOTIksptIrU'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 12:30:33.077 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 12:30:33.092 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 08-08-2025 12:30:58.804 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 08-08-2025 12:30:58.804 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzU0NjM0MjI2LCJleHAiOjE3NTQ2NjMwMjYsImlhdCI6MTc1NDYzNDIyNn0.Q8kJCmcT-ZXaYWywT9EPp7UXiCYjtWMurOTIksptIrU'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 12:31:33.031 | General Service|:: CompanyIndex:53 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.99] DEBUG | 08-08-2025 12:31:33.031 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 12:31:33.109 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 12:31:33.124 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 08-08-2025 12:31:56.791 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 08-08-2025 12:31:56.807 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzU0NjM0MjI2LCJleHAiOjE3NTQ2NjMwMjYsImlhdCI6MTc1NDYzNDIyNn0.Q8kJCmcT-ZXaYWywT9EPp7UXiCYjtWMurOTIksptIrU'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 12:32:33.077 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 12:32:33.077 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 08-08-2025 12:32:57.804 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 08-08-2025 12:32:57.804 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzU0NjM0MjI2LCJleHAiOjE3NTQ2NjMwMjYsImlhdCI6MTc1NDYzNDIyNn0.Q8kJCmcT-ZXaYWywT9EPp7UXiCYjtWMurOTIksptIrU'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 12:33:33.053 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 12:33:33.069 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 08-08-2025 12:33:55.698 | General Service|:: CompanyIndex:7 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.76] DEBUG | 08-08-2025 12:33:55.698 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzU0NjM0MjI2LCJleHAiOjE3NTQ2NjMwMjYsImlhdCI6MTc1NDYzNDIyNn0.Q8kJCmcT-ZXaYWywT9EPp7UXiCYjtWMurOTIksptIrU'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 12:34:33.059 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 12:34:33.059 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 08-08-2025 12:34:55.815 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 08-08-2025 12:34:55.815 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzU0NjM0MjI2LCJleHAiOjE3NTQ2NjMwMjYsImlhdCI6MTc1NDYzNDIyNn0.Q8kJCmcT-ZXaYWywT9EPp7UXiCYjtWMurOTIksptIrU'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 12:35:33.076 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 12:35:33.076 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 08-08-2025 12:35:56.821 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 08-08-2025 12:35:56.821 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzU0NjM0MjI2LCJleHAiOjE3NTQ2NjMwMjYsImlhdCI6MTc1NDYzNDIyNn0.Q8kJCmcT-ZXaYWywT9EPp7UXiCYjtWMurOTIksptIrU'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 12:36:33.030 | General Service|:: CompanyIndex:53 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.99] DEBUG | 08-08-2025 12:36:33.045 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 12:36:33.092 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 12:36:33.092 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 08-08-2025 12:36:57.829 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 08-08-2025 12:36:57.829 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzU0NjM0MjI2LCJleHAiOjE3NTQ2NjMwMjYsImlhdCI6MTc1NDYzNDIyNn0.Q8kJCmcT-ZXaYWywT9EPp7UXiCYjtWMurOTIksptIrU'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 12:37:33.064 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 12:37:33.079 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 08-08-2025 12:37:58.824 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 08-08-2025 12:37:58.824 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzU0NjM0MjI2LCJleHAiOjE3NTQ2NjMwMjYsImlhdCI6MTc1NDYzNDIyNn0.Q8kJCmcT-ZXaYWywT9EPp7UXiCYjtWMurOTIksptIrU'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 12:38:33.081 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 12:38:33.081 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 08-08-2025 12:38:47.722 | General Service|:: CompanyIndex:0 SpName: spADM_Login 
 4
 ,''
 ,''
 ,''
 ,'declare @AllowSession bit,@GUID nvarchar(50)
set @AllowSession=0
set @GUID=''cc0d383c-3cf9-4f06-b1e8-c057cde7f4ad''
if exists(select [GUID] from ADM_Login with(nolock) where [GUID]=@GUID)
begin
    update ADM_Login  set LastAccessTime=convert(float,getdate()) where [GUID]=@GUID
    set @AllowSession=1
end
select @AllowSession AllowSession
'
 ,''
 ,0
[System: 192.168.1.76] DEBUG | 08-08-2025 12:38:47.738 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzU0NjM0MjI2LCJleHAiOjE3NTQ2NjMwMjYsImlhdCI6MTc1NDYzNDIyNn0.Q8kJCmcT-ZXaYWywT9EPp7UXiCYjtWMurOTIksptIrU'''
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 08-08-2025 12:38:55.709 | General Service|:: CompanyIndex:7 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.76] DEBUG | 08-08-2025 12:38:55.709 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzU0NjM0MjI2LCJleHAiOjE3NTQ2NjMwMjYsImlhdCI6MTc1NDYzNDIyNn0.Q8kJCmcT-ZXaYWywT9EPp7UXiCYjtWMurOTIksptIrU'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 12:39:33.066 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 12:39:33.066 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 08-08-2025 12:39:55.839 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 08-08-2025 12:39:55.839 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzU0NjM0MjI2LCJleHAiOjE3NTQ2NjMwMjYsImlhdCI6MTc1NDYzNDIyNn0.Q8kJCmcT-ZXaYWywT9EPp7UXiCYjtWMurOTIksptIrU'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 12:40:33.062 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 12:40:33.078 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 12:40:43.025 | General Service|:: CompanyIndex:0 SpName: spADM_Login 
 4
 ,''
 ,''
 ,''
 ,'declare @AllowSession bit,@GUID nvarchar(50)
set @AllowSession=0
set @GUID=''0487a41c-8997-4838-bb25-c25f47d7ca93''
if exists(select [GUID] from ADM_Login with(nolock) where [GUID]=@GUID)
begin
    update ADM_Login  set LastAccessTime=convert(float,getdate()) where [GUID]=@GUID
    set @AllowSession=1
end
select @AllowSession AllowSession
'
 ,''
 ,0
[System: 192.168.1.99] DEBUG | 08-08-2025 12:40:43.041 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 08-08-2025 12:40:56.825 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 08-08-2025 12:40:56.825 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzU0NjM0MjI2LCJleHAiOjE3NTQ2NjMwMjYsImlhdCI6MTc1NDYzNDIyNn0.Q8kJCmcT-ZXaYWywT9EPp7UXiCYjtWMurOTIksptIrU'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 12:41:33.036 | General Service|:: CompanyIndex:53 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.99] DEBUG | 08-08-2025 12:41:33.036 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 12:41:33.067 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 12:41:33.083 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 08-08-2025 12:41:57.822 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 08-08-2025 12:41:57.822 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzU0NjM0MjI2LCJleHAiOjE3NTQ2NjMwMjYsImlhdCI6MTc1NDYzNDIyNn0.Q8kJCmcT-ZXaYWywT9EPp7UXiCYjtWMurOTIksptIrU'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 12:42:33.085 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 12:42:33.085 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 08-08-2025 12:42:58.821 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 08-08-2025 12:42:58.836 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzU0NjM0MjI2LCJleHAiOjE3NTQ2NjMwMjYsImlhdCI6MTc1NDYzNDIyNn0.Q8kJCmcT-ZXaYWywT9EPp7UXiCYjtWMurOTIksptIrU'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 12:43:33.054 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 12:43:33.054 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 08-08-2025 12:43:54.715 | General Service|:: CompanyIndex:7 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.76] DEBUG | 08-08-2025 12:43:54.731 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzU0NjM0MjI2LCJleHAiOjE3NTQ2NjMwMjYsImlhdCI6MTc1NDYzNDIyNn0.Q8kJCmcT-ZXaYWywT9EPp7UXiCYjtWMurOTIksptIrU'''
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 08-08-2025 12:43:56.840 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 08-08-2025 12:43:56.840 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzU0NjM0MjI2LCJleHAiOjE3NTQ2NjMwMjYsImlhdCI6MTc1NDYzNDIyNn0.Q8kJCmcT-ZXaYWywT9EPp7UXiCYjtWMurOTIksptIrU'''
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 08-08-2025 12:44:32.210 | General Service|:: CompanyIndex:0 SpName: spADM_Login 
 6
 ,'cc0d383c-3cf9-4f06-b1e8-c057cde7f4ad'
 ,''
 ,''
 ,''
 ,''
 ,0
[System: 192.168.1.76] DEBUG | 08-08-2025 12:44:32.210 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzU0NjM0MjI2LCJleHAiOjE3NTQ2NjMwMjYsImlhdCI6MTc1NDYzNDIyNn0.Q8kJCmcT-ZXaYWywT9EPp7UXiCYjtWMurOTIksptIrU'''
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 08-08-2025 12:44:32.476 | General Service|:: CompanyIndex:7 SpName: sp_SetTokenHistory 
 0
 ,'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzU0NjM0MjI2LCJleHAiOjE3NTQ2NjMwMjYsImlhdCI6MTc1NDYzNDIyNn0.Q8kJCmcT-ZXaYWywT9EPp7UXiCYjtWMurOTIksptIrU'
 ,''
 ,NULL
 ,1
 ,1
 message=Saved Succesfully
[System: 192.168.1.76] DEBUG | 08-08-2025 12:44:32.476 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzU0NjM0MjI2LCJleHAiOjE3NTQ2NjMwMjYsImlhdCI6MTc1NDYzNDIyNn0.Q8kJCmcT-ZXaYWywT9EPp7UXiCYjtWMurOTIksptIrU'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 12:44:33.061 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 12:44:33.076 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 12:45:33.051 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 12:45:33.066 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 12:46:33.032 | General Service|:: CompanyIndex:53 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.99] DEBUG | 08-08-2025 12:46:33.032 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 12:46:33.095 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 12:46:33.095 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 12:47:33.067 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 12:47:33.067 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 12:48:33.052 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 12:48:33.052 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 12:49:33.064 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 12:49:33.064 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 12:50:33.052 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 12:50:33.052 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 12:51:33.029 | General Service|:: CompanyIndex:53 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.99] DEBUG | 08-08-2025 12:51:33.029 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 12:51:33.107 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 12:51:33.107 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 12:52:33.051 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 12:52:33.051 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 12:53:33.049 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 12:53:33.065 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 12:54:33.064 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 12:54:33.064 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 12:55:33.045 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 12:55:33.061 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 12:55:43.018 | General Service|:: CompanyIndex:0 SpName: spADM_Login 
 4
 ,''
 ,''
 ,''
 ,'declare @AllowSession bit,@GUID nvarchar(50)
set @AllowSession=0
set @GUID=''0487a41c-8997-4838-bb25-c25f47d7ca93''
if exists(select [GUID] from ADM_Login with(nolock) where [GUID]=@GUID)
begin
    update ADM_Login  set LastAccessTime=convert(float,getdate()) where [GUID]=@GUID
    set @AllowSession=1
end
select @AllowSession AllowSession
'
 ,''
 ,0
[System: 192.168.1.99] DEBUG | 08-08-2025 12:55:43.033 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 12:56:33.014 | General Service|:: CompanyIndex:53 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.99] DEBUG | 08-08-2025 12:56:33.029 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 12:56:33.076 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 12:56:33.076 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 12:57:33.066 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 12:57:33.066 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 12:58:33.040 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 12:58:33.055 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 12:59:33.052 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 12:59:33.052 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 13:00:33.053 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 13:00:33.053 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 13:01:33.009 | General Service|:: CompanyIndex:53 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.99] DEBUG | 08-08-2025 13:01:33.009 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 13:01:33.056 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 13:01:33.056 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 13:02:33.039 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 13:02:33.054 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 13:03:33.073 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 13:03:33.073 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 13:04:33.048 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 13:04:33.048 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 13:05:33.043 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 13:05:33.043 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 13:06:33.011 | General Service|:: CompanyIndex:53 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.99] DEBUG | 08-08-2025 13:06:33.011 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 13:06:33.089 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 13:06:33.105 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 13:07:33.043 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 13:07:33.043 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 13:08:33.032 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 13:08:33.048 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 13:09:33.041 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 13:09:33.041 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 13:10:33.038 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 13:10:33.038 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 13:11:33.007 | General Service|:: CompanyIndex:53 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.99] DEBUG | 08-08-2025 13:11:33.007 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 13:11:33.023 | General Service|:: CompanyIndex:0 SpName: spADM_Login 
 4
 ,''
 ,''
 ,''
 ,'declare @AllowSession bit,@GUID nvarchar(50)
set @AllowSession=0
set @GUID=''0487a41c-8997-4838-bb25-c25f47d7ca93''
if exists(select [GUID] from ADM_Login with(nolock) where [GUID]=@GUID)
begin
    update ADM_Login  set LastAccessTime=convert(float,getdate()) where [GUID]=@GUID
    set @AllowSession=1
end
select @AllowSession AllowSession
'
 ,''
 ,0
[System: 192.168.1.99] DEBUG | 08-08-2025 13:11:33.023 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 13:11:33.070 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 13:11:33.070 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 13:12:33.056 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 13:12:33.056 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 13:13:33.035 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 13:13:33.035 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 13:14:33.037 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 13:14:33.037 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 13:15:33.038 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 13:15:33.038 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 13:16:33.005 | General Service|:: CompanyIndex:53 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.99] DEBUG | 08-08-2025 13:16:33.005 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 13:16:33.052 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 13:16:33.067 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 13:17:33.044 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 13:17:33.044 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 13:18:33.021 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 13:18:33.036 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 13:19:33.028 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 13:19:33.044 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 13:20:33.024 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 13:20:33.024 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 13:21:32.995 | General Service|:: CompanyIndex:53 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.99] DEBUG | 08-08-2025 13:21:33.010 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 13:21:33.057 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 13:21:33.057 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 13:22:33.023 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 13:22:33.023 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 13:23:33.023 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 13:23:33.038 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 13:24:33.022 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 13:24:33.022 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 13:25:33.032 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 13:25:33.032 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 13:26:33.001 | General Service|:: CompanyIndex:53 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.99] DEBUG | 08-08-2025 13:26:33.001 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 13:26:33.001 | General Service|:: CompanyIndex:0 SpName: spADM_Login 
 4
 ,''
 ,''
 ,''
 ,'declare @AllowSession bit,@GUID nvarchar(50)
set @AllowSession=0
set @GUID=''0487a41c-8997-4838-bb25-c25f47d7ca93''
if exists(select [GUID] from ADM_Login with(nolock) where [GUID]=@GUID)
begin
    update ADM_Login  set LastAccessTime=convert(float,getdate()) where [GUID]=@GUID
    set @AllowSession=1
end
select @AllowSession AllowSession
'
 ,''
 ,0
[System: 192.168.1.99] DEBUG | 08-08-2025 13:26:33.001 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 13:26:33.048 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 13:26:33.048 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 13:27:33.016 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 13:27:33.016 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 13:28:33.017 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 13:28:33.032 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 13:29:33.018 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 13:29:33.018 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 13:30:33.032 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 13:30:33.032 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 13:31:32.989 | General Service|:: CompanyIndex:53 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.99] DEBUG | 08-08-2025 13:31:33.005 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 13:31:33.052 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 13:31:33.052 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-08-2025 13:31:44.784 | General Service|:: CompanyIndex:0 SpName: spADM_GetClientUserDetails2C 
 'admin'
 ,1
 ,0
[System: 192.168.1.77] DEBUG | 08-08-2025 13:31:44.893 | General Service|:: CompanyIndex:0 SpName: spADM_UserLoginCheck 
 2
 ,'admin'
 ,0
 ,'192.168.1.77'
 ,'192.168.1.77'
 ,''
 ,'Web'
 ,1
[System: 192.168.1.77] DEBUG | 08-08-2025 13:31:48.427 | General Service|:: CompanyIndex:0 SpName: spADM_GetClientUserDetails2C 
 'admin'
 ,1
 ,0
[System: 192.168.1.77] DEBUG | 08-08-2025 13:31:48.474 | General Service|:: CompanyIndex:0 SpName: spADM_UserLoginCheck 
 2
 ,'admin'
 ,0
 ,'192.168.1.77'
 ,'192.168.1.77'
 ,''
 ,'Web'
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 13:32:33.028 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 13:32:33.028 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 13:33:33.012 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 13:33:33.012 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 13:34:33.022 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 13:34:33.022 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 13:35:33.025 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 13:35:33.025 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 13:36:32.977 | General Service|:: CompanyIndex:53 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.99] DEBUG | 08-08-2025 13:36:32.977 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 13:36:33.039 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 13:36:33.039 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 13:37:33.014 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 13:37:33.030 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 13:38:33.014 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 13:38:33.014 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 13:39:33.022 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 13:39:33.022 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 13:40:33.024 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 13:40:33.024 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 13:41:32.987 | General Service|:: CompanyIndex:53 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.99] DEBUG | 08-08-2025 13:41:32.987 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 13:41:32.987 | General Service|:: CompanyIndex:0 SpName: spADM_Login 
 4
 ,''
 ,''
 ,''
 ,'declare @AllowSession bit,@GUID nvarchar(50)
set @AllowSession=0
set @GUID=''0487a41c-8997-4838-bb25-c25f47d7ca93''
if exists(select [GUID] from ADM_Login with(nolock) where [GUID]=@GUID)
begin
    update ADM_Login  set LastAccessTime=convert(float,getdate()) where [GUID]=@GUID
    set @AllowSession=1
end
select @AllowSession AllowSession
'
 ,''
 ,0
[System: 192.168.1.99] DEBUG | 08-08-2025 13:41:33.003 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 13:41:33.050 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 13:41:33.050 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 13:42:33.013 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 13:42:33.013 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 13:43:33.017 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 13:43:33.017 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 13:44:33.004 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 13:44:33.020 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 13:45:33.004 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 13:45:33.004 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 13:46:32.983 | General Service|:: CompanyIndex:53 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.99] DEBUG | 08-08-2025 13:46:32.983 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 13:46:33.030 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 13:46:33.046 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 13:47:33.010 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 13:47:33.010 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 13:48:33.010 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 13:48:33.025 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 13:49:32.999 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 13:49:32.999 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 13:50:33.006 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 13:50:33.021 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 13:51:32.970 | General Service|:: CompanyIndex:53 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.99] DEBUG | 08-08-2025 13:51:32.986 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 13:51:33.033 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 13:51:33.033 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 13:52:33.019 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 13:52:33.019 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 13:53:33.009 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 13:53:33.009 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 13:54:33.012 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 13:54:33.012 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 13:55:32.996 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 13:55:32.996 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 13:56:32.963 | General Service|:: CompanyIndex:53 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.99] DEBUG | 08-08-2025 13:56:32.978 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 13:56:32.978 | General Service|:: CompanyIndex:0 SpName: spADM_Login 
 4
 ,''
 ,''
 ,''
 ,'declare @AllowSession bit,@GUID nvarchar(50)
set @AllowSession=0
set @GUID=''0487a41c-8997-4838-bb25-c25f47d7ca93''
if exists(select [GUID] from ADM_Login with(nolock) where [GUID]=@GUID)
begin
    update ADM_Login  set LastAccessTime=convert(float,getdate()) where [GUID]=@GUID
    set @AllowSession=1
end
select @AllowSession AllowSession
'
 ,''
 ,0
[System: 192.168.1.99] DEBUG | 08-08-2025 13:56:32.978 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 13:56:33.025 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 13:56:33.025 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 13:57:32.989 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 13:57:33.005 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 13:58:32.994 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 13:58:33.009 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 13:59:32.994 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 13:59:32.994 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:00:32.993 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:00:32.993 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:01:32.961 | General Service|:: CompanyIndex:53 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.99] DEBUG | 08-08-2025 14:01:32.976 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:01:33.039 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:01:33.039 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:02:32.995 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:02:33.010 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:03:32.989 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:03:33.004 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:04:32.995 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:04:33.011 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:05:32.995 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:05:33.011 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:06:32.963 | General Service|:: CompanyIndex:53 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.99] DEBUG | 08-08-2025 14:06:32.963 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:06:33.026 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:06:33.026 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:07:32.991 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:07:32.991 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:08:32.989 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:08:32.989 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:09:32.980 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:09:32.980 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:10:32.988 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:10:32.988 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:11:32.964 | General Service|:: CompanyIndex:53 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.99] DEBUG | 08-08-2025 14:11:32.964 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:11:32.980 | General Service|:: CompanyIndex:0 SpName: spADM_Login 
 4
 ,''
 ,''
 ,''
 ,'declare @AllowSession bit,@GUID nvarchar(50)
set @AllowSession=0
set @GUID=''0487a41c-8997-4838-bb25-c25f47d7ca93''
if exists(select [GUID] from ADM_Login with(nolock) where [GUID]=@GUID)
begin
    update ADM_Login  set LastAccessTime=convert(float,getdate()) where [GUID]=@GUID
    set @AllowSession=1
end
select @AllowSession AllowSession
'
 ,''
 ,0
[System: 192.168.1.99] DEBUG | 08-08-2025 14:11:32.980 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:11:33.027 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:11:33.027 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:12:32.977 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:12:32.992 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:13:32.984 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:13:32.984 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:14:33.001 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:14:33.001 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:15:32.988 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:15:32.988 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:16:32.943 | General Service|:: CompanyIndex:53 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.99] DEBUG | 08-08-2025 14:16:32.943 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:16:32.990 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:16:32.990 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:17:32.992 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:17:32.992 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:18:32.964 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:18:32.980 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:19:32.968 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:19:32.983 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:20:32.990 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:20:32.990 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:21:32.939 | General Service|:: CompanyIndex:53 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.99] DEBUG | 08-08-2025 14:21:32.955 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:21:33.002 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:21:33.002 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:22:32.984 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:22:32.999 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:23:32.978 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:23:32.978 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:24:32.988 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:24:32.988 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:25:33.007 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:25:33.007 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:26:32.958 | General Service|:: CompanyIndex:53 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.99] DEBUG | 08-08-2025 14:26:32.958 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:26:32.958 | General Service|:: CompanyIndex:0 SpName: spADM_Login 
 4
 ,''
 ,''
 ,''
 ,'declare @AllowSession bit,@GUID nvarchar(50)
set @AllowSession=0
set @GUID=''0487a41c-8997-4838-bb25-c25f47d7ca93''
if exists(select [GUID] from ADM_Login with(nolock) where [GUID]=@GUID)
begin
    update ADM_Login  set LastAccessTime=convert(float,getdate()) where [GUID]=@GUID
    set @AllowSession=1
end
select @AllowSession AllowSession
'
 ,''
 ,0
[System: 192.168.1.99] DEBUG | 08-08-2025 14:26:32.974 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:26:33.036 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:26:33.036 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.86] DEBUG | 08-08-2025 14:26:43.995 | General Service|:: CompanyIndex:0 SpName: spADM_GetClientUserDetails2C 
 'admin'
 ,1
 ,0
[System: 192.168.1.86] DEBUG | 08-08-2025 14:26:44.026 | General Service|:: CompanyIndex:0 SpName: spADM_UserLoginCheck 
 2
 ,'admin'
 ,0
 ,'192.168.1.86'
 ,'192.168.1.86'
 ,''
 ,'Web'
 ,1
[System: 192.168.1.86] DEBUG | 08-08-2025 14:26:44.198 | General Service|:: CompanyIndex:193 SpName: spADM_GetClientUserDetails 
 'admin'
 ,1
 ,'26.2.9'
 ,0
[System: 192.168.1.86] DEBUG | 08-08-2025 14:26:44.245 | General Service|:: CompanyIndex:0 SpName: spADM_UserLoginCheck 
 2
 ,'admin'
 ,193
 ,'192.168.1.86'
 ,'192.168.1.86'
 ,''
 ,'Web'
 ,1
[System: 192.168.1.86] DEBUG | 08-08-2025 14:26:44.260 | General Service|:: CompanyIndex:0 SpName: spADM_Login 
 1
 ,''
 ,''
 ,''
 ,''
 ,''
 ,193
[System: 192.168.1.86] DEBUG | 08-08-2025 14:26:44.260 | General Service|:: CompanyIndex:193 SpName: spADM_GetDataSet 
 'select Value from ADM_GlobalPreferences with (nolock) where name =''EnableReLogin'''
 ,1
 ,1
[System: 192.168.1.86] DEBUG | 08-08-2025 14:26:44.260 | General Service|:: CompanyIndex:193 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTkzLDEiLCJuYmYiOjE3NTQ2NDM0MDQsImV4cCI6MTc1NDY3MjIwNCwiaWF0IjoxNzU0NjQzNDA0fQ.ujdInKP3iDCLFVXLxBLoIcCn_KYg-MBK9U5CEoUQNr4'''
 ,1
 ,1
[System: 192.168.1.86] DEBUG | 08-08-2025 14:26:44.292 | General Service|:: CompanyIndex:0 SpName: spADM_Login 
 4
 ,''
 ,''
 ,''
 ,'declare @Cnt int,@ExpiredGUID nvarchar(50),@AllowSession int,@GUID nvarchar(50),@CurrDate float,@UserID INT,@Instances INT,@InstancesExists INT,@LCDBIndex int
set @CurrDate= convert(float,dateadd(minute,-21,getdate()))
set @AllowSession=0
set @GUID=''f9c9bf30-9bf4-4340-bdac-e95e76f426b2''
set @LCDBIndex=0
select top 1 @UserID=UserID,@Instances=InstanceCount from ADM_Users with(nolock) where UserName=''admin''
if exists(select [GUID] from ADM_Login with(nolock) where [GUID]=@GUID)
begin
	update ADM_Login 
	set LastAccessTime=convert(float,getdate()),UserID=@UserID
	where [GUID]=@GUID
    set @AllowSession=1
end
else
begin
	select @Cnt=count(*) from ADM_Login with(nolock) where LCDBIndex=@LCDBIndex and [GUID]!=''ACCESSRIGHTS'' and AP =''WEB''
    if(@Cnt<100)
		set @AllowSession=1
	else
	begin
		select top 1 @ExpiredGUID=[GUID] from ADM_Login with(nolock)
		where [GUID]!=''ACCESSRIGHTS'' and LCDBIndex=@LCDBIndex and LastAccessTime<@CurrDate  and AP =''WEB''
        order by LastAccessTime asc
		if @ExpiredGUID is not null
		begin
			delete from ADM_Login where [GUID]=@ExpiredGUID
			set @AllowSession=1
		end
	end
	if @AllowSession=1
	begin
        select @InstancesExists=COUNT(*) from ADM_Login with(nolock)
		where [GUID]!=''ACCESSRIGHTS'' and LCDBIndex=@LCDBIndex and LastAccessTime>=@CurrDate and UserID=@UserID and AP =''WEB''
		if(@Instances!=0 and @Instances<=@InstancesExists)
			set @AllowSession=2
		else
		    INSERT INTO ADM_Login([GUID],[SysName],IPAddress,[Status],LoginTime,LastAccessTime,AccessRights,UserID,DBIndex,LCDBIndex,AP)
		    VALUES(@GUID,''WEB'',''192.168.1.86'',1,convert(float,getdate()),convert(float,getdate()),null,@UserID,193,@LCDBIndex, ''WEB'')
	end
end

select @AllowSession AllowSession,@Instances Instances,@InstancesExists InstancesExists
'
 ,''
 ,0
[System: 192.168.1.86] DEBUG | 08-08-2025 14:26:44.292 | General Service|:: CompanyIndex:193 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTkzLDEiLCJuYmYiOjE3NTQ2NDM0MDQsImV4cCI6MTc1NDY3MjIwNCwiaWF0IjoxNzU0NjQzNDA0fQ.ujdInKP3iDCLFVXLxBLoIcCn_KYg-MBK9U5CEoUQNr4'''
 ,1
 ,1
[System: 192.168.1.86] DEBUG | 08-08-2025 14:26:44.323 | General Service|:: CompanyIndex:193 SpName: spADM_GetDataSet 
 'SELECT (SELECT COUNT(*) FROM COM_Location L WITH(NOLOCK) JOIN COM_Status S WITH(NOLOCK) ON S.StatusID=L.StatusID WHERE L.IsGroup=0 AND S.[Status]=''Active'') ML
,(SELECT COUNT(*) FROM ADM_Features WITH(NOLOCK) WHERE ((FeatureID>50000 AND FeatureID<=50050) OR FeatureID>=51000) AND IsEnabled=1) MD
,(SELECT ISNULL(COUNT(*),0) FROM ADM_RevenUReports WITH(NOLOCK) WHERE IsGroup=0 AND ReportID>10000 AND StaticReportType IN (0,-1)) MR'
 ,1
 ,1
[System: 192.168.1.86] DEBUG | 08-08-2025 14:26:44.323 | General Service|:: CompanyIndex:193 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTkzLDEiLCJuYmYiOjE3NTQ2NDM0MDQsImV4cCI6MTc1NDY3MjIwNCwiaWF0IjoxNzU0NjQzNDA0fQ.ujdInKP3iDCLFVXLxBLoIcCn_KYg-MBK9U5CEoUQNr4'''
 ,1
 ,1
[System: 192.168.1.86] DEBUG | 08-08-2025 14:26:48.949 | General Service|:: CompanyIndex:193 SpName: spCOM_GetDivisions 
 0
 ,1
 ,1
 ,1
[System: 192.168.1.86] DEBUG | 08-08-2025 14:26:48.996 | General Service|:: CompanyIndex:193 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTkzLDEiLCJuYmYiOjE3NTQ2NDM0MDQsImV4cCI6MTc1NDY3MjIwNCwiaWF0IjoxNzU0NjQzNDA0fQ.ujdInKP3iDCLFVXLxBLoIcCn_KYg-MBK9U5CEoUQNr4'''
 ,1
 ,1
[System: 192.168.1.86] DEBUG | 08-08-2025 14:26:49.012 | General Service|:: CompanyIndex:193 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.86] DEBUG | 08-08-2025 14:26:49.027 | General Service|:: CompanyIndex:193 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTkzLDEiLCJuYmYiOjE3NTQ2NDM0MDQsImV4cCI6MTc1NDY3MjIwNCwiaWF0IjoxNzU0NjQzNDA0fQ.ujdInKP3iDCLFVXLxBLoIcCn_KYg-MBK9U5CEoUQNr4'''
 ,1
 ,1
[System: 192.168.1.86] DEBUG | 08-08-2025 14:26:51.956 | General Service|:: CompanyIndex:193 SpName: spADM_GetRibbonView 
 1
 ,1
 ,1
 ,1
 ,0
 ,''
[System: 192.168.1.86] DEBUG | 08-08-2025 14:26:51.956 | General Service|:: CompanyIndex:193 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTkzLDEiLCJuYmYiOjE3NTQ2NDM0MDQsImV4cCI6MTc1NDY3MjIwNCwiaWF0IjoxNzU0NjQzNDA0fQ.ujdInKP3iDCLFVXLxBLoIcCn_KYg-MBK9U5CEoUQNr4'''
 ,1
 ,1
[System: 192.168.1.86] DEBUG | 08-08-2025 14:26:52.144 | General Service|:: CompanyIndex:193 SpName: spADM_GetDashBoard 
 2
 ,0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.86] DEBUG | 08-08-2025 14:26:52.160 | General Service|:: CompanyIndex:193 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTkzLDEiLCJuYmYiOjE3NTQ2NDM0MDQsImV4cCI6MTc1NDY3MjIwNCwiaWF0IjoxNzU0NjQzNDA0fQ.ujdInKP3iDCLFVXLxBLoIcCn_KYg-MBK9U5CEoUQNr4'''
 ,1
 ,1
[System: 192.168.1.86] DEBUG | 08-08-2025 14:26:52.175 | General Service|:: CompanyIndex:193 SpName: spCOM_ConfigValues 
 1
 ,'LandingDocs'
 ,'1'
[System: 192.168.1.86] DEBUG | 08-08-2025 14:26:52.175 | General Service|:: CompanyIndex:193 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTkzLDEiLCJuYmYiOjE3NTQ2NDM0MDQsImV4cCI6MTc1NDY3MjIwNCwiaWF0IjoxNzU0NjQzNDA0fQ.ujdInKP3iDCLFVXLxBLoIcCn_KYg-MBK9U5CEoUQNr4'''
 ,1
 ,1
[System: 192.168.1.86] DEBUG | 08-08-2025 14:26:52.222 | General Service|:: CompanyIndex:193 SpName: spADM_GetAllListViewsDef 
 1
 ,1
[System: 192.168.1.86] DEBUG | 08-08-2025 14:26:52.222 | General Service|:: CompanyIndex:193 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTkzLDEiLCJuYmYiOjE3NTQ2NDM0MDQsImV4cCI6MTc1NDY3MjIwNCwiaWF0IjoxNzU0NjQzNDA0fQ.ujdInKP3iDCLFVXLxBLoIcCn_KYg-MBK9U5CEoUQNr4'''
 ,1
 ,1
[System: 192.168.1.86] DEBUG | 08-08-2025 14:26:52.316 | General Service|:: CompanyIndex:193 SpName: spADM_GetAllListViewsDef 
 1
 ,1
[System: 192.168.1.86] DEBUG | 08-08-2025 14:26:52.316 | General Service|:: CompanyIndex:193 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTkzLDEiLCJuYmYiOjE3NTQ2NDM0MDQsImV4cCI6MTc1NDY3MjIwNCwiaWF0IjoxNzU0NjQzNDA0fQ.ujdInKP3iDCLFVXLxBLoIcCn_KYg-MBK9U5CEoUQNr4'''
 ,1
 ,1
[System: 192.168.1.86] DEBUG | 08-08-2025 14:26:52.441 | General Service|:: CompanyIndex:193 SpName: spADM_GetDataSet 
 'Select CostCenterID,CostCenterColID,CostCenterName,SysTableName,UserColumnName,SysColumnName,ISNULL(UserDefaultValue,'''') UserDefaultValue
From AdM_CostCenterDef WITH(NOLOCK)
Where SysColumnName IN(''CreditAccount'',''DebitAccount'',''ProductID'') 
AND CostCenterID>40000 AND CostCenterID<50000 

SELECT * FROM ADM_Features WITH(NOLOCK) '
 ,1
 ,1
[System: 192.168.1.86] DEBUG | 08-08-2025 14:26:52.441 | General Service|:: CompanyIndex:193 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTkzLDEiLCJuYmYiOjE3NTQ2NDM0MDQsImV4cCI6MTc1NDY3MjIwNCwiaWF0IjoxNzU0NjQzNDA0fQ.ujdInKP3iDCLFVXLxBLoIcCn_KYg-MBK9U5CEoUQNr4'''
 ,1
 ,1
[System: 192.168.1.86] DEBUG | 08-08-2025 14:26:52.472 | General Service|:: CompanyIndex:193 SpName: spADM_GetDataSet 
 '  SELECT * FROM PAY_PayrollPreferences WITH(NOLOCK) '
 ,1
 ,1
[System: 192.168.1.86] DEBUG | 08-08-2025 14:26:52.472 | General Service|:: CompanyIndex:193 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTkzLDEiLCJuYmYiOjE3NTQ2NDM0MDQsImV4cCI6MTc1NDY3MjIwNCwiaWF0IjoxNzU0NjQzNDA0fQ.ujdInKP3iDCLFVXLxBLoIcCn_KYg-MBK9U5CEoUQNr4'''
 ,1
 ,1
[System: 192.168.1.86] DEBUG | 08-08-2025 14:26:52.503 | General Service|:: CompanyIndex:193 SpName: spADM_GetDataSet 
 '  --0
                                Select * FROM COM_CC50051 WITH(NOLOCK) WHERE IsGroup=0 AND LoginUserID=''admin''
                                --1                                
                                Select * FROM COM_CC50051 WITH(NOLOCK) WHERE RptManager IN (Select NodeID FROM COM_CC50051 WITH(NOLOCK) WHERE IsGroup=0 AND LoginUserID=''admin'')
                                UNION ALL
                                Select * FROM COM_CC50051 WITH(NOLOCK) WHERE RptManager IN 
                                (
	                                Select NodeID FROM COM_CC50051 WITH(NOLOCK) 
	                                WHERE IsGroup=0 AND LoginUserID IN
	                                (
	                                SELECT fe.LoginUserID
	                                FROM INV_DocDetails a WITH(NOLOCK) 
	                                JOIN COM_DocCCData b WITH(NOLOCK) ON b.InvDocDetailsID=a.InvDocDetailsID
	                                JOIN COM_DocNumData c WITH(NOLOCK) ON c.InvDocDetailsID=a.InvDocDetailsID
	                                JOIN COM_DocTextData d WITH(NOLOCK) ON d.InvDocDetailsID=a.InvDocDetailsID
	                                JOIN COM_CC50051 fe WITH(NOLOCK) on fe.NodeID=b.dcCCNID51
	                                JOIN COM_CC50051 te WITH(NOLOCK) on CONVERT(NVARCHAR,te.NodeID)=d.dcAlpha1
	                                WHERE a.CostCenterID=40098 and a.StatusID=369 AND d.dcAlpha3=''Temporary''
	                                AND te.LoginUserID=''admin'' 
	                                AND ISDATE(d.dcAlpha4)=1 AND ISDATE(d.dcAlpha5)=1 
	                                AND CONVERT(DATETIME,''08 Aug 2025'') BETWEEN CONVERT(DATETIME,d.dcAlpha4) AND CONVERT(DATETIME,d.dcAlpha5)
	                                )
                                )
                                --2
                                Select * FROM ADM_USERS WITH(NOLOCK) WHERE USERID=1
                                --3
                                Select * FROM COM_CostCenterCostCenterMap WITH(NOLOCK) WHERE ParentCostCenterID=7 AND ParentNodeID=1
                                --4                                
                                Select * FROM COM_CostCenterCostCenterMap WITH(NOLOCK) WHERE ParentCostCenterID=7 AND ParentNodeID=1
                                AND CostCenterID IN(Select ColumnCostCenterID From ADM_CostCenterDef Where CostCenterID=50051 AND IsColumnInUse=1 AND SysColumnName LIKE ''CCNID%'')
                                --5
                                Select * from COM_Files WITH(NOLOCK) WHERE FeatureID=50051 AND FeaturePK IN (Select NodeID FROM COM_CC50051 WITH(NOLOCK) WHERE IsGroup=0 AND LoginUserID=''admin'')                         
'
 ,1
 ,1
[System: 192.168.1.86] DEBUG | 08-08-2025 14:26:52.503 | General Service|:: CompanyIndex:193 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTkzLDEiLCJuYmYiOjE3NTQ2NDM0MDQsImV4cCI6MTc1NDY3MjIwNCwiaWF0IjoxNzU0NjQzNDA0fQ.ujdInKP3iDCLFVXLxBLoIcCn_KYg-MBK9U5CEoUQNr4'''
 ,1
 ,1
[System: 192.168.1.86] DEBUG | 08-08-2025 14:26:52.722 | General Service|:: CompanyIndex:193 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.86] DEBUG | 08-08-2025 14:26:52.722 | General Service|:: CompanyIndex:193 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTkzLDEiLCJuYmYiOjE3NTQ2NDM0MDQsImV4cCI6MTc1NDY3MjIwNCwiaWF0IjoxNzU0NjQzNDA0fQ.ujdInKP3iDCLFVXLxBLoIcCn_KYg-MBK9U5CEoUQNr4'''
 ,1
 ,1
[System: 192.168.1.86] DEBUG | 08-08-2025 14:26:55.145 | General Service|:: CompanyIndex:193 SpName: spCOM_GetFavorites 
 'GETLIST0'
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.86] DEBUG | 08-08-2025 14:26:55.145 | General Service|:: CompanyIndex:193 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTkzLDEiLCJuYmYiOjE3NTQ2NDM0MDQsImV4cCI6MTc1NDY3MjIwNCwiaWF0IjoxNzU0NjQzNDA0fQ.ujdInKP3iDCLFVXLxBLoIcCn_KYg-MBK9U5CEoUQNr4'''
 ,1
 ,1
[System: 192.168.1.86] DEBUG | 08-08-2025 14:26:55.629 | General Service|:: CompanyIndex:193 SpName: spCOM_GetFavorites 
 'VIEW'
 ,18817
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.86] DEBUG | 08-08-2025 14:26:55.629 | General Service|:: CompanyIndex:193 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTkzLDEiLCJuYmYiOjE3NTQ2NDM0MDQsImV4cCI6MTc1NDY3MjIwNCwiaWF0IjoxNzU0NjQzNDA0fQ.ujdInKP3iDCLFVXLxBLoIcCn_KYg-MBK9U5CEoUQNr4'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:27:32.977 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:27:32.977 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.86] DEBUG | 08-08-2025 14:27:42.250 | General Service|:: CompanyIndex:0 SpName: spADM_Login 
 6
 ,'f9c9bf30-9bf4-4340-bdac-e95e76f426b2'
 ,''
 ,''
 ,''
 ,''
 ,0
[System: 192.168.1.86] DEBUG | 08-08-2025 14:27:42.250 | General Service|:: CompanyIndex:193 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTkzLDEiLCJuYmYiOjE3NTQ2NDM0MDQsImV4cCI6MTc1NDY3MjIwNCwiaWF0IjoxNzU0NjQzNDA0fQ.ujdInKP3iDCLFVXLxBLoIcCn_KYg-MBK9U5CEoUQNr4'''
 ,1
 ,1
[System: 192.168.1.86] DEBUG | 08-08-2025 14:27:42.672 | General Service|:: CompanyIndex:193 SpName: sp_SetTokenHistory 
 0
 ,'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTkzLDEiLCJuYmYiOjE3NTQ2NDM0MDQsImV4cCI6MTc1NDY3MjIwNCwiaWF0IjoxNzU0NjQzNDA0fQ.ujdInKP3iDCLFVXLxBLoIcCn_KYg-MBK9U5CEoUQNr4'
 ,''
 ,NULL
 ,1
 ,1
 message=Saved Succesfully
[System: 192.168.1.86] DEBUG | 08-08-2025 14:27:42.688 | General Service|:: CompanyIndex:193 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTkzLDEiLCJuYmYiOjE3NTQ2NDM0MDQsImV4cCI6MTc1NDY3MjIwNCwiaWF0IjoxNzU0NjQzNDA0fQ.ujdInKP3iDCLFVXLxBLoIcCn_KYg-MBK9U5CEoUQNr4'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:28:32.974 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:28:32.989 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:29:32.993 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:29:32.993 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:30:32.972 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:30:32.972 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:31:32.940 | General Service|:: CompanyIndex:53 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.99] DEBUG | 08-08-2025 14:31:32.940 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:31:32.971 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:31:32.987 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:32:32.974 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:32:32.974 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:33:32.976 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:33:32.976 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:34:32.961 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:34:32.961 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:35:32.977 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:35:32.992 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:36:32.919 | General Service|:: CompanyIndex:53 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.99] DEBUG | 08-08-2025 14:36:32.935 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:36:32.997 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:36:32.997 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:37:32.983 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:37:32.983 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:38:32.963 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:38:32.963 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:39:32.974 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:39:32.974 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:40:32.964 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:40:32.979 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:41:32.928 | General Service|:: CompanyIndex:53 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.99] DEBUG | 08-08-2025 14:41:32.944 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:41:32.944 | General Service|:: CompanyIndex:0 SpName: spADM_Login 
 4
 ,''
 ,''
 ,''
 ,'declare @AllowSession bit,@GUID nvarchar(50)
set @AllowSession=0
set @GUID=''0487a41c-8997-4838-bb25-c25f47d7ca93''
if exists(select [GUID] from ADM_Login with(nolock) where [GUID]=@GUID)
begin
    update ADM_Login  set LastAccessTime=convert(float,getdate()) where [GUID]=@GUID
    set @AllowSession=1
end
select @AllowSession AllowSession
'
 ,''
 ,0
[System: 192.168.1.99] DEBUG | 08-08-2025 14:41:32.944 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:41:32.991 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:41:32.991 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:42:32.959 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:42:32.959 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:43:32.970 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:43:32.970 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:44:32.956 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:44:32.956 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:45:32.964 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:45:32.964 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:46:32.921 | General Service|:: CompanyIndex:53 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.99] DEBUG | 08-08-2025 14:46:32.921 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:46:32.983 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:46:32.983 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:47:32.953 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:47:32.969 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:48:32.988 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:48:33.003 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:49:07.841 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:49:07.841 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:49:37.512 | General Service|:: CompanyIndex:53 SpName: spADM_GetCostCenterGridViewList 
 2
 ,1
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:49:37.528 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:49:37.950 | General Service|:: CompanyIndex:53 SpName: spCom_GetCostCenterSummary 
 126
 ,-1
 ,1000
 ,''
 ,''
 ,''
 ,0
 ,'08-Aug-2025'
 ,NULL
 ,''
 ,1
 ,1
 ,0
 ,0
 ,False
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:49:37.950 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:49:44.054 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:49:44.054 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDYzNDM0MiwiZXhwIjoxNzU0NjYzMTQyLCJpYXQiOjE3NTQ2MzQzNDJ9.0z8w2XPiVlLryiYfElimexgPppYgb69-pLduNB_sRwc'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:06.704 | General Service|:: CompanyIndex:0 SpName: spADM_GetClientUserDetails2C 
 'admin'
 ,1
 ,0
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:06.751 | General Service|:: CompanyIndex:0 SpName: spADM_UserLoginCheck 
 2
 ,'admin'
 ,0
 ,'192.168.1.99'
 ,'192.168.1.99'
 ,''
 ,'Web'
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:11.383 | General Service|:: CompanyIndex:53 SpName: spADM_GetClientUserDetails 
 'admin'
 ,1
 ,'26.2.9'
 ,0
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:11.446 | General Service|:: CompanyIndex:0 SpName: spADM_UserLoginCheck 
 2
 ,'admin'
 ,53
 ,'192.168.1.99'
 ,'192.168.1.99'
 ,''
 ,'Web'
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:11.462 | General Service|:: CompanyIndex:0 SpName: spADM_Login 
 1
 ,''
 ,''
 ,''
 ,''
 ,''
 ,53
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:11.462 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select Value from ADM_GlobalPreferences with (nolock) where name =''EnableReLogin'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:11.462 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDgxMSwiZXhwIjoxNzU0NjczNjExLCJpYXQiOjE3NTQ2NDQ4MTF9.QPJkyh0zHoIMduP9lhMZG2WUas9aHHJuhKNro9CZEcw'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:11.493 | General Service|:: CompanyIndex:0 SpName: spADM_Login 
 4
 ,''
 ,''
 ,''
 ,'declare @Cnt int,@ExpiredGUID nvarchar(50),@AllowSession int,@GUID nvarchar(50),@CurrDate float,@UserID INT,@Instances INT,@InstancesExists INT,@LCDBIndex int
set @CurrDate= convert(float,dateadd(minute,-21,getdate()))
set @AllowSession=0
set @GUID=''3db1f914-120d-4dea-a5f0-762760868e8c''
set @LCDBIndex=0
select top 1 @UserID=UserID,@Instances=InstanceCount from ADM_Users with(nolock) where UserName=''admin''
if exists(select [GUID] from ADM_Login with(nolock) where [GUID]=@GUID)
begin
	update ADM_Login 
	set LastAccessTime=convert(float,getdate()),UserID=@UserID
	where [GUID]=@GUID
    set @AllowSession=1
end
else
begin
	select @Cnt=count(*) from ADM_Login with(nolock) where LCDBIndex=@LCDBIndex and [GUID]!=''ACCESSRIGHTS'' and AP =''WEB''
    if(@Cnt<100)
		set @AllowSession=1
	else
	begin
		select top 1 @ExpiredGUID=[GUID] from ADM_Login with(nolock)
		where [GUID]!=''ACCESSRIGHTS'' and LCDBIndex=@LCDBIndex and LastAccessTime<@CurrDate  and AP =''WEB''
        order by LastAccessTime asc
		if @ExpiredGUID is not null
		begin
			delete from ADM_Login where [GUID]=@ExpiredGUID
			set @AllowSession=1
		end
	end
	if @AllowSession=1
	begin
        select @InstancesExists=COUNT(*) from ADM_Login with(nolock)
		where [GUID]!=''ACCESSRIGHTS'' and LCDBIndex=@LCDBIndex and LastAccessTime>=@CurrDate and UserID=@UserID and AP =''WEB''
		if(@Instances!=0 and @Instances<=@InstancesExists)
			set @AllowSession=2
		else
		    INSERT INTO ADM_Login([GUID],[SysName],IPAddress,[Status],LoginTime,LastAccessTime,AccessRights,UserID,DBIndex,LCDBIndex,AP)
		    VALUES(@GUID,''WEB'',''192.168.1.99'',1,convert(float,getdate()),convert(float,getdate()),null,@UserID,53,@LCDBIndex, ''WEB'')
	end
end

select @AllowSession AllowSession,@Instances Instances,@InstancesExists InstancesExists
'
 ,''
 ,0
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:11.493 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDgxMSwiZXhwIjoxNzU0NjczNjExLCJpYXQiOjE3NTQ2NDQ4MTF9.QPJkyh0zHoIMduP9lhMZG2WUas9aHHJuhKNro9CZEcw'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:11.508 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT (SELECT COUNT(*) FROM COM_Location L WITH(NOLOCK) JOIN COM_Status S WITH(NOLOCK) ON S.StatusID=L.StatusID WHERE L.IsGroup=0 AND S.[Status]=''Active'') ML
,(SELECT COUNT(*) FROM ADM_Features WITH(NOLOCK) WHERE ((FeatureID>50000 AND FeatureID<=50050) OR FeatureID>=51000) AND IsEnabled=1) MD
,(SELECT ISNULL(COUNT(*),0) FROM ADM_RevenUReports WITH(NOLOCK) WHERE IsGroup=0 AND ReportID>10000 AND StaticReportType IN (0,-1)) MR'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:11.508 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDgxMSwiZXhwIjoxNzU0NjczNjExLCJpYXQiOjE3NTQ2NDQ4MTF9.QPJkyh0zHoIMduP9lhMZG2WUas9aHHJuhKNro9CZEcw'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:11.540 | General Service|:: CompanyIndex:53 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:11.540 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDgxMSwiZXhwIjoxNzU0NjczNjExLCJpYXQiOjE3NTQ2NDQ4MTF9.QPJkyh0zHoIMduP9lhMZG2WUas9aHHJuhKNro9CZEcw'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:11.868 | General Service|:: CompanyIndex:53 SpName: spADM_GetRibbonView 
 1
 ,1
 ,1
 ,1
 ,0
 ,''
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:11.868 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDgxMSwiZXhwIjoxNzU0NjczNjExLCJpYXQiOjE3NTQ2NDQ4MTF9.QPJkyh0zHoIMduP9lhMZG2WUas9aHHJuhKNro9CZEcw'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:12.086 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 2
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:12.086 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDgxMSwiZXhwIjoxNzU0NjczNjExLCJpYXQiOjE3NTQ2NDQ4MTF9.QPJkyh0zHoIMduP9lhMZG2WUas9aHHJuhKNro9CZEcw'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:12.118 | General Service|:: CompanyIndex:53 SpName: spADM_GetDashBoard 
 2
 ,0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:12.118 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDgxMSwiZXhwIjoxNzU0NjczNjExLCJpYXQiOjE3NTQ2NDQ4MTF9.QPJkyh0zHoIMduP9lhMZG2WUas9aHHJuhKNro9CZEcw'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:12.227 | General Service|:: CompanyIndex:53 SpName: spCOM_ConfigValues 
 1
 ,'LandingDocs'
 ,'1'
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:12.227 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDgxMSwiZXhwIjoxNzU0NjczNjExLCJpYXQiOjE3NTQ2NDQ4MTF9.QPJkyh0zHoIMduP9lhMZG2WUas9aHHJuhKNro9CZEcw'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:12.274 | General Service|:: CompanyIndex:53 SpName: spCOM_GetFavorites 
 'GETLIST0'
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:12.289 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDgxMSwiZXhwIjoxNzU0NjczNjExLCJpYXQiOjE3NTQ2NDQ4MTF9.QPJkyh0zHoIMduP9lhMZG2WUas9aHHJuhKNro9CZEcw'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:12.289 | General Service|:: CompanyIndex:53 SpName: spADM_GetAllListViewsDef 
 1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:12.289 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDgxMSwiZXhwIjoxNzU0NjczNjExLCJpYXQiOjE3NTQ2NDQ4MTF9.QPJkyh0zHoIMduP9lhMZG2WUas9aHHJuhKNro9CZEcw'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:12.399 | General Service|:: CompanyIndex:53 SpName: spADM_GetAllListViewsDef 
 1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:12.399 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDgxMSwiZXhwIjoxNzU0NjczNjExLCJpYXQiOjE3NTQ2NDQ4MTF9.QPJkyh0zHoIMduP9lhMZG2WUas9aHHJuhKNro9CZEcw'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:12.508 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'Select CostCenterID,CostCenterColID,CostCenterName,SysTableName,UserColumnName,SysColumnName,ISNULL(UserDefaultValue,'''') UserDefaultValue
From AdM_CostCenterDef WITH(NOLOCK)
Where SysColumnName IN(''CreditAccount'',''DebitAccount'',''ProductID'') 
AND CostCenterID>40000 AND CostCenterID<50000 

SELECT * FROM ADM_Features WITH(NOLOCK) '
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:12.508 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDgxMSwiZXhwIjoxNzU0NjczNjExLCJpYXQiOjE3NTQ2NDQ4MTF9.QPJkyh0zHoIMduP9lhMZG2WUas9aHHJuhKNro9CZEcw'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:12.539 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 '  SELECT * FROM PAY_PayrollPreferences WITH(NOLOCK) '
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:12.539 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDgxMSwiZXhwIjoxNzU0NjczNjExLCJpYXQiOjE3NTQ2NDQ4MTF9.QPJkyh0zHoIMduP9lhMZG2WUas9aHHJuhKNro9CZEcw'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:12.571 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 '  --0
                                Select * FROM COM_CC50051 WITH(NOLOCK) WHERE IsGroup=0 AND LoginUserID=''admin''
                                --1                                
                                Select * FROM COM_CC50051 WITH(NOLOCK) WHERE RptManager IN (Select NodeID FROM COM_CC50051 WITH(NOLOCK) WHERE IsGroup=0 AND LoginUserID=''admin'')
                                UNION ALL
                                Select * FROM COM_CC50051 WITH(NOLOCK) WHERE RptManager IN 
                                (
	                                Select NodeID FROM COM_CC50051 WITH(NOLOCK) 
	                                WHERE IsGroup=0 AND LoginUserID IN
	                                (
	                                SELECT fe.LoginUserID
	                                FROM INV_DocDetails a WITH(NOLOCK) 
	                                JOIN COM_DocCCData b WITH(NOLOCK) ON b.InvDocDetailsID=a.InvDocDetailsID
	                                JOIN COM_DocNumData c WITH(NOLOCK) ON c.InvDocDetailsID=a.InvDocDetailsID
	                                JOIN COM_DocTextData d WITH(NOLOCK) ON d.InvDocDetailsID=a.InvDocDetailsID
	                                JOIN COM_CC50051 fe WITH(NOLOCK) on fe.NodeID=b.dcCCNID51
	                                JOIN COM_CC50051 te WITH(NOLOCK) on CONVERT(NVARCHAR,te.NodeID)=d.dcAlpha1
	                                WHERE a.CostCenterID=40098 and a.StatusID=369 AND d.dcAlpha3=''Temporary''
	                                AND te.LoginUserID=''admin'' 
	                                AND ISDATE(d.dcAlpha4)=1 AND ISDATE(d.dcAlpha5)=1 
	                                AND CONVERT(DATETIME,''08 Aug 2025'') BETWEEN CONVERT(DATETIME,d.dcAlpha4) AND CONVERT(DATETIME,d.dcAlpha5)
	                                )
                                )
                                --2
                                Select * FROM ADM_USERS WITH(NOLOCK) WHERE USERID=1
                                --3
                                Select * FROM COM_CostCenterCostCenterMap WITH(NOLOCK) WHERE ParentCostCenterID=7 AND ParentNodeID=1
                                --4                                
                                Select * FROM COM_CostCenterCostCenterMap WITH(NOLOCK) WHERE ParentCostCenterID=7 AND ParentNodeID=1
                                AND CostCenterID IN(Select ColumnCostCenterID From ADM_CostCenterDef Where CostCenterID=50051 AND IsColumnInUse=1 AND SysColumnName LIKE ''CCNID%'')
                                --5
                                Select * from COM_Files WITH(NOLOCK) WHERE FeatureID=50051 AND FeaturePK IN (Select NodeID FROM COM_CC50051 WITH(NOLOCK) WHERE IsGroup=0 AND LoginUserID=''admin'')                         
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:12.571 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDgxMSwiZXhwIjoxNzU0NjczNjExLCJpYXQiOjE3NTQ2NDQ4MTF9.QPJkyh0zHoIMduP9lhMZG2WUas9aHHJuhKNro9CZEcw'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:12.961 | General Service|:: CompanyIndex:53 SpName: spADM_GetDashBoard 
 1
 ,41
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:12.961 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDgxMSwiZXhwIjoxNzU0NjczNjExLCJpYXQiOjE3NTQ2NDQ4MTF9.QPJkyh0zHoIMduP9lhMZG2WUas9aHHJuhKNro9CZEcw'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:12.992 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,60584
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:13.008 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,60585
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:13.008 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDgxMSwiZXhwIjoxNzU0NjczNjExLCJpYXQiOjE3NTQ2NDQ4MTF9.QPJkyh0zHoIMduP9lhMZG2WUas9aHHJuhKNro9CZEcw'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:13.008 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,60587
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:13.008 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDgxMSwiZXhwIjoxNzU0NjczNjExLCJpYXQiOjE3NTQ2NDQ4MTF9.QPJkyh0zHoIMduP9lhMZG2WUas9aHHJuhKNro9CZEcw'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:13.008 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDgxMSwiZXhwIjoxNzU0NjczNjExLCJpYXQiOjE3NTQ2NDQ4MTF9.QPJkyh0zHoIMduP9lhMZG2WUas9aHHJuhKNro9CZEcw'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:13.024 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,60583
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:13.024 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,60586
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:13.024 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDgxMSwiZXhwIjoxNzU0NjczNjExLCJpYXQiOjE3NTQ2NDQ4MTF9.QPJkyh0zHoIMduP9lhMZG2WUas9aHHJuhKNro9CZEcw'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:13.039 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDgxMSwiZXhwIjoxNzU0NjczNjExLCJpYXQiOjE3NTQ2NDQ4MTF9.QPJkyh0zHoIMduP9lhMZG2WUas9aHHJuhKNro9CZEcw'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:13.039 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,60588
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:13.039 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDgxMSwiZXhwIjoxNzU0NjczNjExLCJpYXQiOjE3NTQ2NDQ4MTF9.QPJkyh0zHoIMduP9lhMZG2WUas9aHHJuhKNro9CZEcw'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:13.039 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,60585
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:13.039 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDgxMSwiZXhwIjoxNzU0NjczNjExLCJpYXQiOjE3NTQ2NDQ4MTF9.QPJkyh0zHoIMduP9lhMZG2WUas9aHHJuhKNro9CZEcw'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:13.039 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:13.039 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDgxMSwiZXhwIjoxNzU0NjczNjExLCJpYXQiOjE3NTQ2NDQ4MTF9.QPJkyh0zHoIMduP9lhMZG2WUas9aHHJuhKNro9CZEcw'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:13.055 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,60584
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:13.055 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDgxMSwiZXhwIjoxNzU0NjczNjExLCJpYXQiOjE3NTQ2NDQ4MTF9.QPJkyh0zHoIMduP9lhMZG2WUas9aHHJuhKNro9CZEcw'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:13.055 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,60587
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:13.055 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDgxMSwiZXhwIjoxNzU0NjczNjExLCJpYXQiOjE3NTQ2NDQ4MTF9.QPJkyh0zHoIMduP9lhMZG2WUas9aHHJuhKNro9CZEcw'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:13.055 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,60583
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:13.055 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDgxMSwiZXhwIjoxNzU0NjczNjExLCJpYXQiOjE3NTQ2NDQ4MTF9.QPJkyh0zHoIMduP9lhMZG2WUas9aHHJuhKNro9CZEcw'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:13.055 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,60586
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:13.055 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDgxMSwiZXhwIjoxNzU0NjczNjExLCJpYXQiOjE3NTQ2NDQ4MTF9.QPJkyh0zHoIMduP9lhMZG2WUas9aHHJuhKNro9CZEcw'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:13.071 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,60588
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:13.071 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:13.071 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDgxMSwiZXhwIjoxNzU0NjczNjExLCJpYXQiOjE3NTQ2NDQ4MTF9.QPJkyh0zHoIMduP9lhMZG2WUas9aHHJuhKNro9CZEcw'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:13.071 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDgxMSwiZXhwIjoxNzU0NjczNjExLCJpYXQiOjE3NTQ2NDQ4MTF9.QPJkyh0zHoIMduP9lhMZG2WUas9aHHJuhKNro9CZEcw'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:13.086 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:13.086 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDgxMSwiZXhwIjoxNzU0NjczNjExLCJpYXQiOjE3NTQ2NDQ4MTF9.QPJkyh0zHoIMduP9lhMZG2WUas9aHHJuhKNro9CZEcw'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:13.102 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:13.102 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDgxMSwiZXhwIjoxNzU0NjczNjExLCJpYXQiOjE3NTQ2NDQ4MTF9.QPJkyh0zHoIMduP9lhMZG2WUas9aHHJuhKNro9CZEcw'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:13.118 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:13.118 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDgxMSwiZXhwIjoxNzU0NjczNjExLCJpYXQiOjE3NTQ2NDQ4MTF9.QPJkyh0zHoIMduP9lhMZG2WUas9aHHJuhKNro9CZEcw'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:13.118 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:13.118 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDgxMSwiZXhwIjoxNzU0NjczNjExLCJpYXQiOjE3NTQ2NDQ4MTF9.QPJkyh0zHoIMduP9lhMZG2WUas9aHHJuhKNro9CZEcw'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:13.133 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:13.133 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDgxMSwiZXhwIjoxNzU0NjczNjExLCJpYXQiOjE3NTQ2NDQ4MTF9.QPJkyh0zHoIMduP9lhMZG2WUas9aHHJuhKNro9CZEcw'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:13.149 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:13.149 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDgxMSwiZXhwIjoxNzU0NjczNjExLCJpYXQiOjE3NTQ2NDQ4MTF9.QPJkyh0zHoIMduP9lhMZG2WUas9aHHJuhKNro9CZEcw'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:13.149 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:13.149 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDgxMSwiZXhwIjoxNzU0NjczNjExLCJpYXQiOjE3NTQ2NDQ4MTF9.QPJkyh0zHoIMduP9lhMZG2WUas9aHHJuhKNro9CZEcw'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:13.164 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:13.164 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDgxMSwiZXhwIjoxNzU0NjczNjExLCJpYXQiOjE3NTQ2NDQ4MTF9.QPJkyh0zHoIMduP9lhMZG2WUas9aHHJuhKNro9CZEcw'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:13.164 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:13.180 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDgxMSwiZXhwIjoxNzU0NjczNjExLCJpYXQiOjE3NTQ2NDQ4MTF9.QPJkyh0zHoIMduP9lhMZG2WUas9aHHJuhKNro9CZEcw'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:13.180 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:13.180 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDgxMSwiZXhwIjoxNzU0NjczNjExLCJpYXQiOjE3NTQ2NDQ4MTF9.QPJkyh0zHoIMduP9lhMZG2WUas9aHHJuhKNro9CZEcw'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:13.274 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60583'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:13.274 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDgxMSwiZXhwIjoxNzU0NjczNjExLCJpYXQiOjE3NTQ2NDQ4MTF9.QPJkyh0zHoIMduP9lhMZG2WUas9aHHJuhKNro9CZEcw'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:13.289 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:13.305 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDgxMSwiZXhwIjoxNzU0NjczNjExLCJpYXQiOjE3NTQ2NDQ4MTF9.QPJkyh0zHoIMduP9lhMZG2WUas9aHHJuhKNro9CZEcw'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:13.695 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReportCategoryandField 
 -1
 ,0
 ,1
 ,0
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:13.695 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDgxMSwiZXhwIjoxNzU0NjczNjExLCJpYXQiOjE3NTQ2NDQ4MTF9.QPJkyh0zHoIMduP9lhMZG2WUas9aHHJuhKNro9CZEcw'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:13.742 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60584'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:13.742 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDgxMSwiZXhwIjoxNzU0NjczNjExLCJpYXQiOjE3NTQ2NDQ4MTF9.QPJkyh0zHoIMduP9lhMZG2WUas9aHHJuhKNro9CZEcw'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:13.758 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60585'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:13.758 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDgxMSwiZXhwIjoxNzU0NjczNjExLCJpYXQiOjE3NTQ2NDQ4MTF9.QPJkyh0zHoIMduP9lhMZG2WUas9aHHJuhKNro9CZEcw'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:13.773 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select * from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0  
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) a --where UStatus like ''%Hold%'' 
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:13.773 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDgxMSwiZXhwIjoxNzU0NjczNjExLCJpYXQiOjE3NTQ2NDQ4MTF9.QPJkyh0zHoIMduP9lhMZG2WUas9aHHJuhKNro9CZEcw'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:13.789 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60586'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:13.789 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select * from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0  
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) a where UnitStatus=''Vacant''
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:13.789 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select * from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0  
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) a where UnitStatus=''Occupied'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:13.789 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDgxMSwiZXhwIjoxNzU0NjczNjExLCJpYXQiOjE3NTQ2NDQ4MTF9.QPJkyh0zHoIMduP9lhMZG2WUas9aHHJuhKNro9CZEcw'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:13.789 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDgxMSwiZXhwIjoxNzU0NjczNjExLCJpYXQiOjE3NTQ2NDQ4MTF9.QPJkyh0zHoIMduP9lhMZG2WUas9aHHJuhKNro9CZEcw'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:13.789 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDgxMSwiZXhwIjoxNzU0NjczNjExLCJpYXQiOjE3NTQ2NDQ4MTF9.QPJkyh0zHoIMduP9lhMZG2WUas9aHHJuhKNro9CZEcw'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:13.805 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60587'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:13.805 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDgxMSwiZXhwIjoxNzU0NjczNjExLCJpYXQiOjE3NTQ2NDQ4MTF9.QPJkyh0zHoIMduP9lhMZG2WUas9aHHJuhKNro9CZEcw'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:13.805 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select * from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0  
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) a  where UnitStatus=''Expired'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:13.820 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDgxMSwiZXhwIjoxNzU0NjczNjExLCJpYXQiOjE3NTQ2NDQ4MTF9.QPJkyh0zHoIMduP9lhMZG2WUas9aHHJuhKNro9CZEcw'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:13.820 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60588'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:13.820 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDgxMSwiZXhwIjoxNzU0NjczNjExLCJpYXQiOjE3NTQ2NDQ4MTF9.QPJkyh0zHoIMduP9lhMZG2WUas9aHHJuhKNro9CZEcw'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:13.836 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select * from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0  
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) a where UStatus like ''%Case%'' 
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:13.836 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60583'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:13.836 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDgxMSwiZXhwIjoxNzU0NjczNjExLCJpYXQiOjE3NTQ2NDQ4MTF9.QPJkyh0zHoIMduP9lhMZG2WUas9aHHJuhKNro9CZEcw'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:13.836 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDgxMSwiZXhwIjoxNzU0NjczNjExLCJpYXQiOjE3NTQ2NDQ4MTF9.QPJkyh0zHoIMduP9lhMZG2WUas9aHHJuhKNro9CZEcw'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:13.852 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60584'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:13.852 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDgxMSwiZXhwIjoxNzU0NjczNjExLCJpYXQiOjE3NTQ2NDQ4MTF9.QPJkyh0zHoIMduP9lhMZG2WUas9aHHJuhKNro9CZEcw'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:13.867 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select * from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0  
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) a --where UStatus like ''%Hold%'' 
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:13.867 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDgxMSwiZXhwIjoxNzU0NjczNjExLCJpYXQiOjE3NTQ2NDQ4MTF9.QPJkyh0zHoIMduP9lhMZG2WUas9aHHJuhKNro9CZEcw'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:13.883 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 '/*
DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select * from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0  
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) a where UStatus like ''%Reserve%'' 
*/

DECLARE @FROM FLOAT
SET @FROM=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @UnitID BIGINT,@StatusID BIGINT,@TotalAmount FLOAT,@I INT,@COUNT INT,@ContractID BIGINT
DECLARE @NoofDays INT,@VacantSince DATETIME

DECLARE @TAB TABLE(ID INT IDENTITY(1,1) PRIMARY KEY,UnitID BIGINT,CurrentRent FLOAT,Status NVARCHAR(10),NoofDays INT,VacantSince DATETIME,ContractID BIGINT)

INSERT INTO @TAB (UnitID)
SELECT U.UnitID
FROM REN_Units U WITH(NOLOCK) 
LEFT JOIN REN_Property P WITH(NOLOCK) ON P.NodeID=U.PropertyID
LEFT JOIN COM_Lookup LK WITH(NOLOCK) ON U.UnitStatus=LK.NodeID
WHERE U.UnitID>1 AND P.Name <> U.Name AND U.IsGroup=0 AND U.Status=424 and U.UnitStatus=306 
-- AND P.NodeID IN (207)
SELECT @I=1,@COUNT=COUNT(*) FROM @TAB
WHILE(@I<=@COUNT)
BEGIN
	SET @StatusID=0
	SET @TotalAmount=0
	SET @ContractID=0
	SELECT @UnitID=UnitID FROM @TAB WHERE ID=@I

	SELECT TOP 1 @ContractID=(CASE WHEN RefContractID>0 THEN RefContractID ELSE ContractID END),@StatusID=StatusID
	,@VacantSince=(CASE WHEN StatusID = 450 THEN ( CASE WHEN RefundDate IS NOT NULL THEN CONVERT(DATETIME,RefundDate) ELSE CONVERT(DATETIME,VacancyDate) END ) 
			ELSE CONVERT(DATETIME,TerminationDate) END )
	,@NoofDays=(CASE WHEN StatusID = 450 THEN (CASE WHEN RefundDate IS NOT NULL THEN DATEDIFF(DAY, CONVERT(DATETIME,RefundDate),CONVERT(DATETIME,@FROM) ) 
			ELSE DATEDIFF(DAY, CONVERT(DATETIME,VacancyDate),CONVERT(DATETIME,@FROM) ) END )
			ELSE DATEDIFF(DAY, CONVERT(DATETIME,TerminationDate),CONVERT(DATETIME,@FROM) ) END )  
	FROM REN_Contract WITH(NOLOCK) WHERE StatusID<>451 AND StartDate<@FROM AND UNITID=@UnitID 
	ORDER BY StartDate DESC,StatusID
	
	SELECT @TotalAmount=ISNULL(SUM(RPD.Amount),MAX(RentAmount)/(CASE WHEN MAX(RC.NoOfUnits)=0 THEN 1 ELSE MAX(RC.NoOfUnits) END)) 
	FROM REN_Contract RC WITH(NOLOCK)
	JOIN REN_ContractParticulars RP WITH(NOLOCK) ON RP.ContractID=RC.ContractID AND RP.Sno=1
	LEFT JOIN REN_ContractParticularsDetail RPD WITH(NOLOCK) ON RPD.ParticularNodeID=RP.NodeID AND RPD.Unit=@UnitID 
	AND @FROM BETWEEN ISNULL(RPD.FromDate,@FROM) AND ISNULL(RPD.ToDate,@FROM)
	WHERE RC.ContractID=@ContractID
	
	IF @StatusID=427 OR @StatusID=426 OR @StatusID=466
	BEGIN
		UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Occupied'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
	END
	ELSE IF @StatusID=440
	BEGIN
		UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''UnAproved'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
	END
	ELSE IF @StatusID=428 OR @StatusID=450
	BEGIN 
		IF EXISTS (SELECT * FROM REN_Quotation WITH(NOLOCK) WHERE COSTCENTERID=129 AND UNITID=@UnitID AND CONVERT(DATETIME,@FROM) BETWEEN CONVERT(DATETIME,STARTDATE) AND CONVERT(DATETIME,ENDDATE) and statusid=467 )
			UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Reserved'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
		ELSE IF EXISTS (SELECT * FROM REN_Quotation WITH(NOLOCK) WHERE COSTCENTERID=103 AND UNITID=@UnitID AND CONVERT(DATETIME,@FROM) BETWEEN CONVERT(DATETIME,STARTDATE) AND CONVERT(DATETIME,ENDDATE) and statusid=426 )
			UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Quoted'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
		ELSE
			UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Vacant'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
	END
	ELSE
	BEGIN 
		IF EXISTS (SELECT * FROM REN_Quotation WITH(NOLOCK) WHERE COSTCENTERID=129 AND UNITID=@UnitID AND CONVERT(DATETIME,@FROM) BETWEEN CONVERT(DATETIME,STARTDATE) AND CONVERT(DATETIME,ENDDATE) and statusid=467 )
			UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Reserved'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
		ELSE IF EXISTS (SELECT * FROM REN_Quotation WITH(NOLOCK) WHERE COSTCENTERID=103 AND UNITID=@UnitID AND CONVERT(DATETIME,@FROM) BETWEEN CONVERT(DATETIME,STARTDATE) AND CONVERT(DATETIME,ENDDATE) and statusid=426 )
			UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Quoted'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
		ELSE
			UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Vacant'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
	END
	set @I=@I+1
END

select * from (
SELECT TEMP.*,RP.NodeID Building_ID,RP.NAME Property,TEMP.UnitID Unit_ID,RU.NAME Unit,C18.NAME UnitType,RU.UnitStatus,RU.RentableArea UnitArea,RU.RentPerSQFT UnitRate
,RU.AnnualRent 
,T.FirstName AS [C98c7d2679f99489e9f0e010026eeb563]
,RUL.Name LandLord , RUC.Name Location 
,1 Cnt
FROM @TAB TEMP
JOIN REN_Units RU WITH(NOLOCK) ON TEMP.UnitID=RU.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
LEFT JOIN COM_CC50018 C18 WITH(NOLOCK) ON C18.NodeID=RU.NodeID
LEFT JOIN REN_Contract C WITH(NOLOCK) ON TEMP.ContractID=C.ContractID
LEFT JOIN REN_Tenant T WITH(NOLOCK) ON T.TenantID=C.TenantID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID

 )a where a.Status =''Reserved''
 order by Property,VacantSince'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:13.883 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDgxMSwiZXhwIjoxNzU0NjczNjExLCJpYXQiOjE3NTQ2NDQ4MTF9.QPJkyh0zHoIMduP9lhMZG2WUas9aHHJuhKNro9CZEcw'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:13.883 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60585'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:13.898 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDgxMSwiZXhwIjoxNzU0NjczNjExLCJpYXQiOjE3NTQ2NDQ4MTF9.QPJkyh0zHoIMduP9lhMZG2WUas9aHHJuhKNro9CZEcw'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:13.898 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60586'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:13.898 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select * from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0  
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) a where UnitStatus=''Vacant''
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:13.914 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDgxMSwiZXhwIjoxNzU0NjczNjExLCJpYXQiOjE3NTQ2NDQ4MTF9.QPJkyh0zHoIMduP9lhMZG2WUas9aHHJuhKNro9CZEcw'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:13.914 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select * from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0  
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) a where UnitStatus=''Occupied'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:13.914 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDgxMSwiZXhwIjoxNzU0NjczNjExLCJpYXQiOjE3NTQ2NDQ4MTF9.QPJkyh0zHoIMduP9lhMZG2WUas9aHHJuhKNro9CZEcw'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:13.914 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDgxMSwiZXhwIjoxNzU0NjczNjExLCJpYXQiOjE3NTQ2NDQ4MTF9.QPJkyh0zHoIMduP9lhMZG2WUas9aHHJuhKNro9CZEcw'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:13.930 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60587'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:13.930 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDgxMSwiZXhwIjoxNzU0NjczNjExLCJpYXQiOjE3NTQ2NDQ4MTF9.QPJkyh0zHoIMduP9lhMZG2WUas9aHHJuhKNro9CZEcw'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:13.930 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select * from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0  
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) a  where UnitStatus=''Expired'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:13.930 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDgxMSwiZXhwIjoxNzU0NjczNjExLCJpYXQiOjE3NTQ2NDQ4MTF9.QPJkyh0zHoIMduP9lhMZG2WUas9aHHJuhKNro9CZEcw'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:13.945 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select * from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0  
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) a where UStatus like ''%Case%'' 
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:13.945 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDgxMSwiZXhwIjoxNzU0NjczNjExLCJpYXQiOjE3NTQ2NDQ4MTF9.QPJkyh0zHoIMduP9lhMZG2WUas9aHHJuhKNro9CZEcw'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:13.961 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60588'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:13.961 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDgxMSwiZXhwIjoxNzU0NjczNjExLCJpYXQiOjE3NTQ2NDQ4MTF9.QPJkyh0zHoIMduP9lhMZG2WUas9aHHJuhKNro9CZEcw'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:14.024 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 '/*
DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select * from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0  
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) a where UStatus like ''%Reserve%'' 
*/

DECLARE @FROM FLOAT
SET @FROM=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @UnitID BIGINT,@StatusID BIGINT,@TotalAmount FLOAT,@I INT,@COUNT INT,@ContractID BIGINT
DECLARE @NoofDays INT,@VacantSince DATETIME

DECLARE @TAB TABLE(ID INT IDENTITY(1,1) PRIMARY KEY,UnitID BIGINT,CurrentRent FLOAT,Status NVARCHAR(10),NoofDays INT,VacantSince DATETIME,ContractID BIGINT)

INSERT INTO @TAB (UnitID)
SELECT U.UnitID
FROM REN_Units U WITH(NOLOCK) 
LEFT JOIN REN_Property P WITH(NOLOCK) ON P.NodeID=U.PropertyID
LEFT JOIN COM_Lookup LK WITH(NOLOCK) ON U.UnitStatus=LK.NodeID
WHERE U.UnitID>1 AND P.Name <> U.Name AND U.IsGroup=0 AND U.Status=424 and U.UnitStatus=306 
-- AND P.NodeID IN (207)
SELECT @I=1,@COUNT=COUNT(*) FROM @TAB
WHILE(@I<=@COUNT)
BEGIN
	SET @StatusID=0
	SET @TotalAmount=0
	SET @ContractID=0
	SELECT @UnitID=UnitID FROM @TAB WHERE ID=@I

	SELECT TOP 1 @ContractID=(CASE WHEN RefContractID>0 THEN RefContractID ELSE ContractID END),@StatusID=StatusID
	,@VacantSince=(CASE WHEN StatusID = 450 THEN ( CASE WHEN RefundDate IS NOT NULL THEN CONVERT(DATETIME,RefundDate) ELSE CONVERT(DATETIME,VacancyDate) END ) 
			ELSE CONVERT(DATETIME,TerminationDate) END )
	,@NoofDays=(CASE WHEN StatusID = 450 THEN (CASE WHEN RefundDate IS NOT NULL THEN DATEDIFF(DAY, CONVERT(DATETIME,RefundDate),CONVERT(DATETIME,@FROM) ) 
			ELSE DATEDIFF(DAY, CONVERT(DATETIME,VacancyDate),CONVERT(DATETIME,@FROM) ) END )
			ELSE DATEDIFF(DAY, CONVERT(DATETIME,TerminationDate),CONVERT(DATETIME,@FROM) ) END )  
	FROM REN_Contract WITH(NOLOCK) WHERE StatusID<>451 AND StartDate<@FROM AND UNITID=@UnitID 
	ORDER BY StartDate DESC,StatusID
	
	SELECT @TotalAmount=ISNULL(SUM(RPD.Amount),MAX(RentAmount)/(CASE WHEN MAX(RC.NoOfUnits)=0 THEN 1 ELSE MAX(RC.NoOfUnits) END)) 
	FROM REN_Contract RC WITH(NOLOCK)
	JOIN REN_ContractParticulars RP WITH(NOLOCK) ON RP.ContractID=RC.ContractID AND RP.Sno=1
	LEFT JOIN REN_ContractParticularsDetail RPD WITH(NOLOCK) ON RPD.ParticularNodeID=RP.NodeID AND RPD.Unit=@UnitID 
	AND @FROM BETWEEN ISNULL(RPD.FromDate,@FROM) AND ISNULL(RPD.ToDate,@FROM)
	WHERE RC.ContractID=@ContractID
	
	IF @StatusID=427 OR @StatusID=426 OR @StatusID=466
	BEGIN
		UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Occupied'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
	END
	ELSE IF @StatusID=440
	BEGIN
		UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''UnAproved'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
	END
	ELSE IF @StatusID=428 OR @StatusID=450
	BEGIN 
		IF EXISTS (SELECT * FROM REN_Quotation WITH(NOLOCK) WHERE COSTCENTERID=129 AND UNITID=@UnitID AND CONVERT(DATETIME,@FROM) BETWEEN CONVERT(DATETIME,STARTDATE) AND CONVERT(DATETIME,ENDDATE) and statusid=467 )
			UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Reserved'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
		ELSE IF EXISTS (SELECT * FROM REN_Quotation WITH(NOLOCK) WHERE COSTCENTERID=103 AND UNITID=@UnitID AND CONVERT(DATETIME,@FROM) BETWEEN CONVERT(DATETIME,STARTDATE) AND CONVERT(DATETIME,ENDDATE) and statusid=426 )
			UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Quoted'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
		ELSE
			UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Vacant'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
	END
	ELSE
	BEGIN 
		IF EXISTS (SELECT * FROM REN_Quotation WITH(NOLOCK) WHERE COSTCENTERID=129 AND UNITID=@UnitID AND CONVERT(DATETIME,@FROM) BETWEEN CONVERT(DATETIME,STARTDATE) AND CONVERT(DATETIME,ENDDATE) and statusid=467 )
			UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Reserved'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
		ELSE IF EXISTS (SELECT * FROM REN_Quotation WITH(NOLOCK) WHERE COSTCENTERID=103 AND UNITID=@UnitID AND CONVERT(DATETIME,@FROM) BETWEEN CONVERT(DATETIME,STARTDATE) AND CONVERT(DATETIME,ENDDATE) and statusid=426 )
			UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Quoted'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
		ELSE
			UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Vacant'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
	END
	set @I=@I+1
END

select * from (
SELECT TEMP.*,RP.NodeID Building_ID,RP.NAME Property,TEMP.UnitID Unit_ID,RU.NAME Unit,C18.NAME UnitType,RU.UnitStatus,RU.RentableArea UnitArea,RU.RentPerSQFT UnitRate
,RU.AnnualRent 
,T.FirstName AS [C98c7d2679f99489e9f0e010026eeb563]
,RUL.Name LandLord , RUC.Name Location 
,1 Cnt
FROM @TAB TEMP
JOIN REN_Units RU WITH(NOLOCK) ON TEMP.UnitID=RU.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
LEFT JOIN COM_CC50018 C18 WITH(NOLOCK) ON C18.NodeID=RU.NodeID
LEFT JOIN REN_Contract C WITH(NOLOCK) ON TEMP.ContractID=C.ContractID
LEFT JOIN REN_Tenant T WITH(NOLOCK) ON T.TenantID=C.TenantID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID

 )a where a.Status =''Reserved''
 order by Property,VacantSince'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:14.024 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDgxMSwiZXhwIjoxNzU0NjczNjExLCJpYXQiOjE3NTQ2NDQ4MTF9.QPJkyh0zHoIMduP9lhMZG2WUas9aHHJuhKNro9CZEcw'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:15.133 | General Service|:: CompanyIndex:53 SpName: spADM_GetCostCenterGridViewList 
 2
 ,1
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:15.133 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDgxMSwiZXhwIjoxNzU0NjczNjExLCJpYXQiOjE3NTQ2NDQ4MTF9.QPJkyh0zHoIMduP9lhMZG2WUas9aHHJuhKNro9CZEcw'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:15.164 | General Service|:: CompanyIndex:53 SpName: spCom_GetCostCenterSummary 
 126
 ,-1
 ,1000
 ,''
 ,''
 ,''
 ,0
 ,'08-Aug-2025'
 ,NULL
 ,''
 ,1
 ,1
 ,0
 ,0
 ,False
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:15.179 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDgxMSwiZXhwIjoxNzU0NjczNjExLCJpYXQiOjE3NTQ2NDQ4MTF9.QPJkyh0zHoIMduP9lhMZG2WUas9aHHJuhKNro9CZEcw'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:36.383 | General Service|:: CompanyIndex:0 SpName: spADM_GetClientUserDetails2C 
 'admin'
 ,1
 ,0
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:36.430 | General Service|:: CompanyIndex:0 SpName: spADM_UserLoginCheck 
 2
 ,'admin'
 ,0
 ,'192.168.1.99'
 ,'192.168.1.99'
 ,''
 ,'Web'
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:43.542 | General Service|:: CompanyIndex:53 SpName: spADM_GetClientUserDetails 
 'admin'
 ,1
 ,'26.2.9'
 ,0
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:43.620 | General Service|:: CompanyIndex:0 SpName: spADM_UserLoginCheck 
 2
 ,'admin'
 ,53
 ,'192.168.1.99'
 ,'192.168.1.99'
 ,''
 ,'Web'
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:43.635 | General Service|:: CompanyIndex:0 SpName: spADM_Login 
 1
 ,''
 ,''
 ,''
 ,''
 ,''
 ,53
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:43.635 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select Value from ADM_GlobalPreferences with (nolock) where name =''EnableReLogin'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:43.651 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDg0MywiZXhwIjoxNzU0NjczNjQzLCJpYXQiOjE3NTQ2NDQ4NDN9.vBLGTnZk19LSXZzyVArtTPOcsZroJeY2D93k4slxSeQ'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:43.698 | General Service|:: CompanyIndex:0 SpName: spADM_Login 
 4
 ,''
 ,''
 ,''
 ,'declare @Cnt int,@ExpiredGUID nvarchar(50),@AllowSession int,@GUID nvarchar(50),@CurrDate float,@UserID INT,@Instances INT,@InstancesExists INT,@LCDBIndex int
set @CurrDate= convert(float,dateadd(minute,-21,getdate()))
set @AllowSession=0
set @GUID=''78485abe-c6a0-4902-817e-710c6460851e''
set @LCDBIndex=0
select top 1 @UserID=UserID,@Instances=InstanceCount from ADM_Users with(nolock) where UserName=''admin''
if exists(select [GUID] from ADM_Login with(nolock) where [GUID]=@GUID)
begin
	update ADM_Login 
	set LastAccessTime=convert(float,getdate()),UserID=@UserID
	where [GUID]=@GUID
    set @AllowSession=1
end
else
begin
	select @Cnt=count(*) from ADM_Login with(nolock) where LCDBIndex=@LCDBIndex and [GUID]!=''ACCESSRIGHTS'' and AP =''WEB''
    if(@Cnt<100)
		set @AllowSession=1
	else
	begin
		select top 1 @ExpiredGUID=[GUID] from ADM_Login with(nolock)
		where [GUID]!=''ACCESSRIGHTS'' and LCDBIndex=@LCDBIndex and LastAccessTime<@CurrDate  and AP =''WEB''
        order by LastAccessTime asc
		if @ExpiredGUID is not null
		begin
			delete from ADM_Login where [GUID]=@ExpiredGUID
			set @AllowSession=1
		end
	end
	if @AllowSession=1
	begin
        select @InstancesExists=COUNT(*) from ADM_Login with(nolock)
		where [GUID]!=''ACCESSRIGHTS'' and LCDBIndex=@LCDBIndex and LastAccessTime>=@CurrDate and UserID=@UserID and AP =''WEB''
		if(@Instances!=0 and @Instances<=@InstancesExists)
			set @AllowSession=2
		else
		    INSERT INTO ADM_Login([GUID],[SysName],IPAddress,[Status],LoginTime,LastAccessTime,AccessRights,UserID,DBIndex,LCDBIndex,AP)
		    VALUES(@GUID,''WEB'',''192.168.1.99'',1,convert(float,getdate()),convert(float,getdate()),null,@UserID,53,@LCDBIndex, ''WEB'')
	end
end

select @AllowSession AllowSession,@Instances Instances,@InstancesExists InstancesExists
'
 ,''
 ,0
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:43.698 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDg0MywiZXhwIjoxNzU0NjczNjQzLCJpYXQiOjE3NTQ2NDQ4NDN9.vBLGTnZk19LSXZzyVArtTPOcsZroJeY2D93k4slxSeQ'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:43.729 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT (SELECT COUNT(*) FROM COM_Location L WITH(NOLOCK) JOIN COM_Status S WITH(NOLOCK) ON S.StatusID=L.StatusID WHERE L.IsGroup=0 AND S.[Status]=''Active'') ML
,(SELECT COUNT(*) FROM ADM_Features WITH(NOLOCK) WHERE ((FeatureID>50000 AND FeatureID<=50050) OR FeatureID>=51000) AND IsEnabled=1) MD
,(SELECT ISNULL(COUNT(*),0) FROM ADM_RevenUReports WITH(NOLOCK) WHERE IsGroup=0 AND ReportID>10000 AND StaticReportType IN (0,-1)) MR'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:43.729 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDg0MywiZXhwIjoxNzU0NjczNjQzLCJpYXQiOjE3NTQ2NDQ4NDN9.vBLGTnZk19LSXZzyVArtTPOcsZroJeY2D93k4slxSeQ'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:43.761 | General Service|:: CompanyIndex:53 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:43.761 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDg0MywiZXhwIjoxNzU0NjczNjQzLCJpYXQiOjE3NTQ2NDQ4NDN9.vBLGTnZk19LSXZzyVArtTPOcsZroJeY2D93k4slxSeQ'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:43.995 | General Service|:: CompanyIndex:53 SpName: spADM_GetRibbonView 
 1
 ,1
 ,1
 ,1
 ,0
 ,''
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:43.995 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDg0MywiZXhwIjoxNzU0NjczNjQzLCJpYXQiOjE3NTQ2NDQ4NDN9.vBLGTnZk19LSXZzyVArtTPOcsZroJeY2D93k4slxSeQ'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:44.198 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 2
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:44.198 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDg0MywiZXhwIjoxNzU0NjczNjQzLCJpYXQiOjE3NTQ2NDQ4NDN9.vBLGTnZk19LSXZzyVArtTPOcsZroJeY2D93k4slxSeQ'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:44.213 | General Service|:: CompanyIndex:53 SpName: spADM_GetDashBoard 
 2
 ,0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:44.213 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDg0MywiZXhwIjoxNzU0NjczNjQzLCJpYXQiOjE3NTQ2NDQ4NDN9.vBLGTnZk19LSXZzyVArtTPOcsZroJeY2D93k4slxSeQ'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:44.229 | General Service|:: CompanyIndex:53 SpName: spCOM_ConfigValues 
 1
 ,'LandingDocs'
 ,'1'
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:44.229 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDg0MywiZXhwIjoxNzU0NjczNjQzLCJpYXQiOjE3NTQ2NDQ4NDN9.vBLGTnZk19LSXZzyVArtTPOcsZroJeY2D93k4slxSeQ'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:44.292 | General Service|:: CompanyIndex:53 SpName: spCOM_GetFavorites 
 'GETLIST0'
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:44.292 | General Service|:: CompanyIndex:53 SpName: spADM_GetAllListViewsDef 
 1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:44.292 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDg0MywiZXhwIjoxNzU0NjczNjQzLCJpYXQiOjE3NTQ2NDQ4NDN9.vBLGTnZk19LSXZzyVArtTPOcsZroJeY2D93k4slxSeQ'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:44.292 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDg0MywiZXhwIjoxNzU0NjczNjQzLCJpYXQiOjE3NTQ2NDQ4NDN9.vBLGTnZk19LSXZzyVArtTPOcsZroJeY2D93k4slxSeQ'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:44.401 | General Service|:: CompanyIndex:53 SpName: spADM_GetAllListViewsDef 
 1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:44.401 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDg0MywiZXhwIjoxNzU0NjczNjQzLCJpYXQiOjE3NTQ2NDQ4NDN9.vBLGTnZk19LSXZzyVArtTPOcsZroJeY2D93k4slxSeQ'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:44.526 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'Select CostCenterID,CostCenterColID,CostCenterName,SysTableName,UserColumnName,SysColumnName,ISNULL(UserDefaultValue,'''') UserDefaultValue
From AdM_CostCenterDef WITH(NOLOCK)
Where SysColumnName IN(''CreditAccount'',''DebitAccount'',''ProductID'') 
AND CostCenterID>40000 AND CostCenterID<50000 

SELECT * FROM ADM_Features WITH(NOLOCK) '
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:44.526 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDg0MywiZXhwIjoxNzU0NjczNjQzLCJpYXQiOjE3NTQ2NDQ4NDN9.vBLGTnZk19LSXZzyVArtTPOcsZroJeY2D93k4slxSeQ'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:44.573 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 '  SELECT * FROM PAY_PayrollPreferences WITH(NOLOCK) '
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:44.588 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDg0MywiZXhwIjoxNzU0NjczNjQzLCJpYXQiOjE3NTQ2NDQ4NDN9.vBLGTnZk19LSXZzyVArtTPOcsZroJeY2D93k4slxSeQ'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:44.620 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 '  --0
                                Select * FROM COM_CC50051 WITH(NOLOCK) WHERE IsGroup=0 AND LoginUserID=''admin''
                                --1                                
                                Select * FROM COM_CC50051 WITH(NOLOCK) WHERE RptManager IN (Select NodeID FROM COM_CC50051 WITH(NOLOCK) WHERE IsGroup=0 AND LoginUserID=''admin'')
                                UNION ALL
                                Select * FROM COM_CC50051 WITH(NOLOCK) WHERE RptManager IN 
                                (
	                                Select NodeID FROM COM_CC50051 WITH(NOLOCK) 
	                                WHERE IsGroup=0 AND LoginUserID IN
	                                (
	                                SELECT fe.LoginUserID
	                                FROM INV_DocDetails a WITH(NOLOCK) 
	                                JOIN COM_DocCCData b WITH(NOLOCK) ON b.InvDocDetailsID=a.InvDocDetailsID
	                                JOIN COM_DocNumData c WITH(NOLOCK) ON c.InvDocDetailsID=a.InvDocDetailsID
	                                JOIN COM_DocTextData d WITH(NOLOCK) ON d.InvDocDetailsID=a.InvDocDetailsID
	                                JOIN COM_CC50051 fe WITH(NOLOCK) on fe.NodeID=b.dcCCNID51
	                                JOIN COM_CC50051 te WITH(NOLOCK) on CONVERT(NVARCHAR,te.NodeID)=d.dcAlpha1
	                                WHERE a.CostCenterID=40098 and a.StatusID=369 AND d.dcAlpha3=''Temporary''
	                                AND te.LoginUserID=''admin'' 
	                                AND ISDATE(d.dcAlpha4)=1 AND ISDATE(d.dcAlpha5)=1 
	                                AND CONVERT(DATETIME,''08 Aug 2025'') BETWEEN CONVERT(DATETIME,d.dcAlpha4) AND CONVERT(DATETIME,d.dcAlpha5)
	                                )
                                )
                                --2
                                Select * FROM ADM_USERS WITH(NOLOCK) WHERE USERID=1
                                --3
                                Select * FROM COM_CostCenterCostCenterMap WITH(NOLOCK) WHERE ParentCostCenterID=7 AND ParentNodeID=1
                                --4                                
                                Select * FROM COM_CostCenterCostCenterMap WITH(NOLOCK) WHERE ParentCostCenterID=7 AND ParentNodeID=1
                                AND CostCenterID IN(Select ColumnCostCenterID From ADM_CostCenterDef Where CostCenterID=50051 AND IsColumnInUse=1 AND SysColumnName LIKE ''CCNID%'')
                                --5
                                Select * from COM_Files WITH(NOLOCK) WHERE FeatureID=50051 AND FeaturePK IN (Select NodeID FROM COM_CC50051 WITH(NOLOCK) WHERE IsGroup=0 AND LoginUserID=''admin'')                         
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:44.620 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDg0MywiZXhwIjoxNzU0NjczNjQzLCJpYXQiOjE3NTQ2NDQ4NDN9.vBLGTnZk19LSXZzyVArtTPOcsZroJeY2D93k4slxSeQ'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:44.682 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:44.682 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDg0MywiZXhwIjoxNzU0NjczNjQzLCJpYXQiOjE3NTQ2NDQ4NDN9.vBLGTnZk19LSXZzyVArtTPOcsZroJeY2D93k4slxSeQ'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:44.996 | General Service|:: CompanyIndex:53 SpName: spADM_GetDashBoard 
 1
 ,41
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:44.996 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDg0MywiZXhwIjoxNzU0NjczNjQzLCJpYXQiOjE3NTQ2NDQ4NDN9.vBLGTnZk19LSXZzyVArtTPOcsZroJeY2D93k4slxSeQ'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:45.027 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,60587
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:45.027 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,60583
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:45.027 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDg0MywiZXhwIjoxNzU0NjczNjQzLCJpYXQiOjE3NTQ2NDQ4NDN9.vBLGTnZk19LSXZzyVArtTPOcsZroJeY2D93k4slxSeQ'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:45.027 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,60585
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:45.027 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,60584
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:45.027 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDg0MywiZXhwIjoxNzU0NjczNjQzLCJpYXQiOjE3NTQ2NDQ4NDN9.vBLGTnZk19LSXZzyVArtTPOcsZroJeY2D93k4slxSeQ'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:45.042 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDg0MywiZXhwIjoxNzU0NjczNjQzLCJpYXQiOjE3NTQ2NDQ4NDN9.vBLGTnZk19LSXZzyVArtTPOcsZroJeY2D93k4slxSeQ'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:45.042 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDg0MywiZXhwIjoxNzU0NjczNjQzLCJpYXQiOjE3NTQ2NDQ4NDN9.vBLGTnZk19LSXZzyVArtTPOcsZroJeY2D93k4slxSeQ'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:45.042 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,60586
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:45.042 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,60588
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:45.042 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDg0MywiZXhwIjoxNzU0NjczNjQzLCJpYXQiOjE3NTQ2NDQ4NDN9.vBLGTnZk19LSXZzyVArtTPOcsZroJeY2D93k4slxSeQ'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:45.042 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDg0MywiZXhwIjoxNzU0NjczNjQzLCJpYXQiOjE3NTQ2NDQ4NDN9.vBLGTnZk19LSXZzyVArtTPOcsZroJeY2D93k4slxSeQ'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:45.058 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,60583
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:45.058 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:45.058 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDg0MywiZXhwIjoxNzU0NjczNjQzLCJpYXQiOjE3NTQ2NDQ4NDN9.vBLGTnZk19LSXZzyVArtTPOcsZroJeY2D93k4slxSeQ'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:45.058 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,60587
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:45.058 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDg0MywiZXhwIjoxNzU0NjczNjQzLCJpYXQiOjE3NTQ2NDQ4NDN9.vBLGTnZk19LSXZzyVArtTPOcsZroJeY2D93k4slxSeQ'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:45.058 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,60585
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:45.058 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDg0MywiZXhwIjoxNzU0NjczNjQzLCJpYXQiOjE3NTQ2NDQ4NDN9.vBLGTnZk19LSXZzyVArtTPOcsZroJeY2D93k4slxSeQ'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:45.058 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,60584
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:45.058 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDg0MywiZXhwIjoxNzU0NjczNjQzLCJpYXQiOjE3NTQ2NDQ4NDN9.vBLGTnZk19LSXZzyVArtTPOcsZroJeY2D93k4slxSeQ'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:45.074 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,60588
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:45.074 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,60586
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:45.074 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDg0MywiZXhwIjoxNzU0NjczNjQzLCJpYXQiOjE3NTQ2NDQ4NDN9.vBLGTnZk19LSXZzyVArtTPOcsZroJeY2D93k4slxSeQ'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:45.074 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:45.074 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDg0MywiZXhwIjoxNzU0NjczNjQzLCJpYXQiOjE3NTQ2NDQ4NDN9.vBLGTnZk19LSXZzyVArtTPOcsZroJeY2D93k4slxSeQ'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:45.074 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDg0MywiZXhwIjoxNzU0NjczNjQzLCJpYXQiOjE3NTQ2NDQ4NDN9.vBLGTnZk19LSXZzyVArtTPOcsZroJeY2D93k4slxSeQ'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:45.074 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDg0MywiZXhwIjoxNzU0NjczNjQzLCJpYXQiOjE3NTQ2NDQ4NDN9.vBLGTnZk19LSXZzyVArtTPOcsZroJeY2D93k4slxSeQ'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:45.089 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:45.089 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDg0MywiZXhwIjoxNzU0NjczNjQzLCJpYXQiOjE3NTQ2NDQ4NDN9.vBLGTnZk19LSXZzyVArtTPOcsZroJeY2D93k4slxSeQ'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:45.089 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:45.089 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDg0MywiZXhwIjoxNzU0NjczNjQzLCJpYXQiOjE3NTQ2NDQ4NDN9.vBLGTnZk19LSXZzyVArtTPOcsZroJeY2D93k4slxSeQ'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:45.105 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:45.105 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDg0MywiZXhwIjoxNzU0NjczNjQzLCJpYXQiOjE3NTQ2NDQ4NDN9.vBLGTnZk19LSXZzyVArtTPOcsZroJeY2D93k4slxSeQ'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:45.121 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:45.121 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDg0MywiZXhwIjoxNzU0NjczNjQzLCJpYXQiOjE3NTQ2NDQ4NDN9.vBLGTnZk19LSXZzyVArtTPOcsZroJeY2D93k4slxSeQ'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:45.121 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:45.121 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDg0MywiZXhwIjoxNzU0NjczNjQzLCJpYXQiOjE3NTQ2NDQ4NDN9.vBLGTnZk19LSXZzyVArtTPOcsZroJeY2D93k4slxSeQ'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:45.136 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:45.136 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDg0MywiZXhwIjoxNzU0NjczNjQzLCJpYXQiOjE3NTQ2NDQ4NDN9.vBLGTnZk19LSXZzyVArtTPOcsZroJeY2D93k4slxSeQ'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:45.152 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:45.152 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDg0MywiZXhwIjoxNzU0NjczNjQzLCJpYXQiOjE3NTQ2NDQ4NDN9.vBLGTnZk19LSXZzyVArtTPOcsZroJeY2D93k4slxSeQ'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:45.152 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:45.152 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDg0MywiZXhwIjoxNzU0NjczNjQzLCJpYXQiOjE3NTQ2NDQ4NDN9.vBLGTnZk19LSXZzyVArtTPOcsZroJeY2D93k4slxSeQ'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:45.167 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:45.167 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDg0MywiZXhwIjoxNzU0NjczNjQzLCJpYXQiOjE3NTQ2NDQ4NDN9.vBLGTnZk19LSXZzyVArtTPOcsZroJeY2D93k4slxSeQ'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:45.183 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:45.183 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDg0MywiZXhwIjoxNzU0NjczNjQzLCJpYXQiOjE3NTQ2NDQ4NDN9.vBLGTnZk19LSXZzyVArtTPOcsZroJeY2D93k4slxSeQ'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:45.277 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60583'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:45.277 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDg0MywiZXhwIjoxNzU0NjczNjQzLCJpYXQiOjE3NTQ2NDQ4NDN9.vBLGTnZk19LSXZzyVArtTPOcsZroJeY2D93k4slxSeQ'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:45.449 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReportCategoryandField 
 -1
 ,0
 ,1
 ,0
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:45.449 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDg0MywiZXhwIjoxNzU0NjczNjQzLCJpYXQiOjE3NTQ2NDQ4NDN9.vBLGTnZk19LSXZzyVArtTPOcsZroJeY2D93k4slxSeQ'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:45.496 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60584'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:45.496 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDg0MywiZXhwIjoxNzU0NjczNjQzLCJpYXQiOjE3NTQ2NDQ4NDN9.vBLGTnZk19LSXZzyVArtTPOcsZroJeY2D93k4slxSeQ'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:45.511 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select * from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0  
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) a --where UStatus like ''%Hold%'' 
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:45.527 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60585'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:45.527 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDg0MywiZXhwIjoxNzU0NjczNjQzLCJpYXQiOjE3NTQ2NDQ4NDN9.vBLGTnZk19LSXZzyVArtTPOcsZroJeY2D93k4slxSeQ'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:45.527 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDg0MywiZXhwIjoxNzU0NjczNjQzLCJpYXQiOjE3NTQ2NDQ4NDN9.vBLGTnZk19LSXZzyVArtTPOcsZroJeY2D93k4slxSeQ'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:45.542 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select * from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0  
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) a where UnitStatus=''Vacant''
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:45.542 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60586'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:45.542 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDg0MywiZXhwIjoxNzU0NjczNjQzLCJpYXQiOjE3NTQ2NDQ4NDN9.vBLGTnZk19LSXZzyVArtTPOcsZroJeY2D93k4slxSeQ'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:45.542 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select * from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0  
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) a where UnitStatus=''Occupied'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:45.542 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDg0MywiZXhwIjoxNzU0NjczNjQzLCJpYXQiOjE3NTQ2NDQ4NDN9.vBLGTnZk19LSXZzyVArtTPOcsZroJeY2D93k4slxSeQ'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:45.542 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDg0MywiZXhwIjoxNzU0NjczNjQzLCJpYXQiOjE3NTQ2NDQ4NDN9.vBLGTnZk19LSXZzyVArtTPOcsZroJeY2D93k4slxSeQ'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:45.558 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60587'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:45.558 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDg0MywiZXhwIjoxNzU0NjczNjQzLCJpYXQiOjE3NTQ2NDQ4NDN9.vBLGTnZk19LSXZzyVArtTPOcsZroJeY2D93k4slxSeQ'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:45.558 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select * from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0  
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) a  where UnitStatus=''Expired'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:45.574 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDg0MywiZXhwIjoxNzU0NjczNjQzLCJpYXQiOjE3NTQ2NDQ4NDN9.vBLGTnZk19LSXZzyVArtTPOcsZroJeY2D93k4slxSeQ'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:45.574 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60588'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:45.589 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDg0MywiZXhwIjoxNzU0NjczNjQzLCJpYXQiOjE3NTQ2NDQ4NDN9.vBLGTnZk19LSXZzyVArtTPOcsZroJeY2D93k4slxSeQ'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:45.589 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select * from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0  
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) a where UStatus like ''%Case%'' 
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:45.589 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDg0MywiZXhwIjoxNzU0NjczNjQzLCJpYXQiOjE3NTQ2NDQ4NDN9.vBLGTnZk19LSXZzyVArtTPOcsZroJeY2D93k4slxSeQ'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:45.636 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60583'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:45.652 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDg0MywiZXhwIjoxNzU0NjczNjQzLCJpYXQiOjE3NTQ2NDQ4NDN9.vBLGTnZk19LSXZzyVArtTPOcsZroJeY2D93k4slxSeQ'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:45.652 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 '/*
DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select * from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0  
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) a where UStatus like ''%Reserve%'' 
*/

DECLARE @FROM FLOAT
SET @FROM=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @UnitID BIGINT,@StatusID BIGINT,@TotalAmount FLOAT,@I INT,@COUNT INT,@ContractID BIGINT
DECLARE @NoofDays INT,@VacantSince DATETIME

DECLARE @TAB TABLE(ID INT IDENTITY(1,1) PRIMARY KEY,UnitID BIGINT,CurrentRent FLOAT,Status NVARCHAR(10),NoofDays INT,VacantSince DATETIME,ContractID BIGINT)

INSERT INTO @TAB (UnitID)
SELECT U.UnitID
FROM REN_Units U WITH(NOLOCK) 
LEFT JOIN REN_Property P WITH(NOLOCK) ON P.NodeID=U.PropertyID
LEFT JOIN COM_Lookup LK WITH(NOLOCK) ON U.UnitStatus=LK.NodeID
WHERE U.UnitID>1 AND P.Name <> U.Name AND U.IsGroup=0 AND U.Status=424 and U.UnitStatus=306 
-- AND P.NodeID IN (207)
SELECT @I=1,@COUNT=COUNT(*) FROM @TAB
WHILE(@I<=@COUNT)
BEGIN
	SET @StatusID=0
	SET @TotalAmount=0
	SET @ContractID=0
	SELECT @UnitID=UnitID FROM @TAB WHERE ID=@I

	SELECT TOP 1 @ContractID=(CASE WHEN RefContractID>0 THEN RefContractID ELSE ContractID END),@StatusID=StatusID
	,@VacantSince=(CASE WHEN StatusID = 450 THEN ( CASE WHEN RefundDate IS NOT NULL THEN CONVERT(DATETIME,RefundDate) ELSE CONVERT(DATETIME,VacancyDate) END ) 
			ELSE CONVERT(DATETIME,TerminationDate) END )
	,@NoofDays=(CASE WHEN StatusID = 450 THEN (CASE WHEN RefundDate IS NOT NULL THEN DATEDIFF(DAY, CONVERT(DATETIME,RefundDate),CONVERT(DATETIME,@FROM) ) 
			ELSE DATEDIFF(DAY, CONVERT(DATETIME,VacancyDate),CONVERT(DATETIME,@FROM) ) END )
			ELSE DATEDIFF(DAY, CONVERT(DATETIME,TerminationDate),CONVERT(DATETIME,@FROM) ) END )  
	FROM REN_Contract WITH(NOLOCK) WHERE StatusID<>451 AND StartDate<@FROM AND UNITID=@UnitID 
	ORDER BY StartDate DESC,StatusID
	
	SELECT @TotalAmount=ISNULL(SUM(RPD.Amount),MAX(RentAmount)/(CASE WHEN MAX(RC.NoOfUnits)=0 THEN 1 ELSE MAX(RC.NoOfUnits) END)) 
	FROM REN_Contract RC WITH(NOLOCK)
	JOIN REN_ContractParticulars RP WITH(NOLOCK) ON RP.ContractID=RC.ContractID AND RP.Sno=1
	LEFT JOIN REN_ContractParticularsDetail RPD WITH(NOLOCK) ON RPD.ParticularNodeID=RP.NodeID AND RPD.Unit=@UnitID 
	AND @FROM BETWEEN ISNULL(RPD.FromDate,@FROM) AND ISNULL(RPD.ToDate,@FROM)
	WHERE RC.ContractID=@ContractID
	
	IF @StatusID=427 OR @StatusID=426 OR @StatusID=466
	BEGIN
		UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Occupied'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
	END
	ELSE IF @StatusID=440
	BEGIN
		UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''UnAproved'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
	END
	ELSE IF @StatusID=428 OR @StatusID=450
	BEGIN 
		IF EXISTS (SELECT * FROM REN_Quotation WITH(NOLOCK) WHERE COSTCENTERID=129 AND UNITID=@UnitID AND CONVERT(DATETIME,@FROM) BETWEEN CONVERT(DATETIME,STARTDATE) AND CONVERT(DATETIME,ENDDATE) and statusid=467 )
			UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Reserved'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
		ELSE IF EXISTS (SELECT * FROM REN_Quotation WITH(NOLOCK) WHERE COSTCENTERID=103 AND UNITID=@UnitID AND CONVERT(DATETIME,@FROM) BETWEEN CONVERT(DATETIME,STARTDATE) AND CONVERT(DATETIME,ENDDATE) and statusid=426 )
			UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Quoted'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
		ELSE
			UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Vacant'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
	END
	ELSE
	BEGIN 
		IF EXISTS (SELECT * FROM REN_Quotation WITH(NOLOCK) WHERE COSTCENTERID=129 AND UNITID=@UnitID AND CONVERT(DATETIME,@FROM) BETWEEN CONVERT(DATETIME,STARTDATE) AND CONVERT(DATETIME,ENDDATE) and statusid=467 )
			UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Reserved'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
		ELSE IF EXISTS (SELECT * FROM REN_Quotation WITH(NOLOCK) WHERE COSTCENTERID=103 AND UNITID=@UnitID AND CONVERT(DATETIME,@FROM) BETWEEN CONVERT(DATETIME,STARTDATE) AND CONVERT(DATETIME,ENDDATE) and statusid=426 )
			UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Quoted'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
		ELSE
			UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Vacant'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
	END
	set @I=@I+1
END

select * from (
SELECT TEMP.*,RP.NodeID Building_ID,RP.NAME Property,TEMP.UnitID Unit_ID,RU.NAME Unit,C18.NAME UnitType,RU.UnitStatus,RU.RentableArea UnitArea,RU.RentPerSQFT UnitRate
,RU.AnnualRent 
,T.FirstName AS [C98c7d2679f99489e9f0e010026eeb563]
,RUL.Name LandLord , RUC.Name Location 
,1 Cnt
FROM @TAB TEMP
JOIN REN_Units RU WITH(NOLOCK) ON TEMP.UnitID=RU.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
LEFT JOIN COM_CC50018 C18 WITH(NOLOCK) ON C18.NodeID=RU.NodeID
LEFT JOIN REN_Contract C WITH(NOLOCK) ON TEMP.ContractID=C.ContractID
LEFT JOIN REN_Tenant T WITH(NOLOCK) ON T.TenantID=C.TenantID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID

 )a where a.Status =''Reserved''
 order by Property,VacantSince'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:45.667 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDg0MywiZXhwIjoxNzU0NjczNjQzLCJpYXQiOjE3NTQ2NDQ4NDN9.vBLGTnZk19LSXZzyVArtTPOcsZroJeY2D93k4slxSeQ'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:45.667 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60584'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:45.667 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDg0MywiZXhwIjoxNzU0NjczNjQzLCJpYXQiOjE3NTQ2NDQ4NDN9.vBLGTnZk19LSXZzyVArtTPOcsZroJeY2D93k4slxSeQ'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:45.683 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select * from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0  
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) a --where UStatus like ''%Hold%'' 
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:45.683 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDg0MywiZXhwIjoxNzU0NjczNjQzLCJpYXQiOjE3NTQ2NDQ4NDN9.vBLGTnZk19LSXZzyVArtTPOcsZroJeY2D93k4slxSeQ'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:45.699 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60585'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:45.699 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDg0MywiZXhwIjoxNzU0NjczNjQzLCJpYXQiOjE3NTQ2NDQ4NDN9.vBLGTnZk19LSXZzyVArtTPOcsZroJeY2D93k4slxSeQ'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:45.699 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select * from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0  
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) a where UnitStatus=''Vacant''
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:45.699 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDg0MywiZXhwIjoxNzU0NjczNjQzLCJpYXQiOjE3NTQ2NDQ4NDN9.vBLGTnZk19LSXZzyVArtTPOcsZroJeY2D93k4slxSeQ'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:45.714 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select * from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0  
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) a where UnitStatus=''Occupied'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:45.730 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDg0MywiZXhwIjoxNzU0NjczNjQzLCJpYXQiOjE3NTQ2NDQ4NDN9.vBLGTnZk19LSXZzyVArtTPOcsZroJeY2D93k4slxSeQ'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:45.730 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60586'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:45.730 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDg0MywiZXhwIjoxNzU0NjczNjQzLCJpYXQiOjE3NTQ2NDQ4NDN9.vBLGTnZk19LSXZzyVArtTPOcsZroJeY2D93k4slxSeQ'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:45.745 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select * from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0  
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) a  where UnitStatus=''Expired'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:45.761 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDg0MywiZXhwIjoxNzU0NjczNjQzLCJpYXQiOjE3NTQ2NDQ4NDN9.vBLGTnZk19LSXZzyVArtTPOcsZroJeY2D93k4slxSeQ'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:45.761 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60587'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:45.761 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDg0MywiZXhwIjoxNzU0NjczNjQzLCJpYXQiOjE3NTQ2NDQ4NDN9.vBLGTnZk19LSXZzyVArtTPOcsZroJeY2D93k4slxSeQ'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:45.808 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select * from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0  
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) a where UStatus like ''%Case%'' 
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:45.808 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDg0MywiZXhwIjoxNzU0NjczNjQzLCJpYXQiOjE3NTQ2NDQ4NDN9.vBLGTnZk19LSXZzyVArtTPOcsZroJeY2D93k4slxSeQ'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:46.027 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60588'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:46.042 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDg0MywiZXhwIjoxNzU0NjczNjQzLCJpYXQiOjE3NTQ2NDQ4NDN9.vBLGTnZk19LSXZzyVArtTPOcsZroJeY2D93k4slxSeQ'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:46.120 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 '/*
DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select * from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0  
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) a where UStatus like ''%Reserve%'' 
*/

DECLARE @FROM FLOAT
SET @FROM=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @UnitID BIGINT,@StatusID BIGINT,@TotalAmount FLOAT,@I INT,@COUNT INT,@ContractID BIGINT
DECLARE @NoofDays INT,@VacantSince DATETIME

DECLARE @TAB TABLE(ID INT IDENTITY(1,1) PRIMARY KEY,UnitID BIGINT,CurrentRent FLOAT,Status NVARCHAR(10),NoofDays INT,VacantSince DATETIME,ContractID BIGINT)

INSERT INTO @TAB (UnitID)
SELECT U.UnitID
FROM REN_Units U WITH(NOLOCK) 
LEFT JOIN REN_Property P WITH(NOLOCK) ON P.NodeID=U.PropertyID
LEFT JOIN COM_Lookup LK WITH(NOLOCK) ON U.UnitStatus=LK.NodeID
WHERE U.UnitID>1 AND P.Name <> U.Name AND U.IsGroup=0 AND U.Status=424 and U.UnitStatus=306 
-- AND P.NodeID IN (207)
SELECT @I=1,@COUNT=COUNT(*) FROM @TAB
WHILE(@I<=@COUNT)
BEGIN
	SET @StatusID=0
	SET @TotalAmount=0
	SET @ContractID=0
	SELECT @UnitID=UnitID FROM @TAB WHERE ID=@I

	SELECT TOP 1 @ContractID=(CASE WHEN RefContractID>0 THEN RefContractID ELSE ContractID END),@StatusID=StatusID
	,@VacantSince=(CASE WHEN StatusID = 450 THEN ( CASE WHEN RefundDate IS NOT NULL THEN CONVERT(DATETIME,RefundDate) ELSE CONVERT(DATETIME,VacancyDate) END ) 
			ELSE CONVERT(DATETIME,TerminationDate) END )
	,@NoofDays=(CASE WHEN StatusID = 450 THEN (CASE WHEN RefundDate IS NOT NULL THEN DATEDIFF(DAY, CONVERT(DATETIME,RefundDate),CONVERT(DATETIME,@FROM) ) 
			ELSE DATEDIFF(DAY, CONVERT(DATETIME,VacancyDate),CONVERT(DATETIME,@FROM) ) END )
			ELSE DATEDIFF(DAY, CONVERT(DATETIME,TerminationDate),CONVERT(DATETIME,@FROM) ) END )  
	FROM REN_Contract WITH(NOLOCK) WHERE StatusID<>451 AND StartDate<@FROM AND UNITID=@UnitID 
	ORDER BY StartDate DESC,StatusID
	
	SELECT @TotalAmount=ISNULL(SUM(RPD.Amount),MAX(RentAmount)/(CASE WHEN MAX(RC.NoOfUnits)=0 THEN 1 ELSE MAX(RC.NoOfUnits) END)) 
	FROM REN_Contract RC WITH(NOLOCK)
	JOIN REN_ContractParticulars RP WITH(NOLOCK) ON RP.ContractID=RC.ContractID AND RP.Sno=1
	LEFT JOIN REN_ContractParticularsDetail RPD WITH(NOLOCK) ON RPD.ParticularNodeID=RP.NodeID AND RPD.Unit=@UnitID 
	AND @FROM BETWEEN ISNULL(RPD.FromDate,@FROM) AND ISNULL(RPD.ToDate,@FROM)
	WHERE RC.ContractID=@ContractID
	
	IF @StatusID=427 OR @StatusID=426 OR @StatusID=466
	BEGIN
		UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Occupied'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
	END
	ELSE IF @StatusID=440
	BEGIN
		UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''UnAproved'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
	END
	ELSE IF @StatusID=428 OR @StatusID=450
	BEGIN 
		IF EXISTS (SELECT * FROM REN_Quotation WITH(NOLOCK) WHERE COSTCENTERID=129 AND UNITID=@UnitID AND CONVERT(DATETIME,@FROM) BETWEEN CONVERT(DATETIME,STARTDATE) AND CONVERT(DATETIME,ENDDATE) and statusid=467 )
			UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Reserved'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
		ELSE IF EXISTS (SELECT * FROM REN_Quotation WITH(NOLOCK) WHERE COSTCENTERID=103 AND UNITID=@UnitID AND CONVERT(DATETIME,@FROM) BETWEEN CONVERT(DATETIME,STARTDATE) AND CONVERT(DATETIME,ENDDATE) and statusid=426 )
			UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Quoted'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
		ELSE
			UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Vacant'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
	END
	ELSE
	BEGIN 
		IF EXISTS (SELECT * FROM REN_Quotation WITH(NOLOCK) WHERE COSTCENTERID=129 AND UNITID=@UnitID AND CONVERT(DATETIME,@FROM) BETWEEN CONVERT(DATETIME,STARTDATE) AND CONVERT(DATETIME,ENDDATE) and statusid=467 )
			UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Reserved'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
		ELSE IF EXISTS (SELECT * FROM REN_Quotation WITH(NOLOCK) WHERE COSTCENTERID=103 AND UNITID=@UnitID AND CONVERT(DATETIME,@FROM) BETWEEN CONVERT(DATETIME,STARTDATE) AND CONVERT(DATETIME,ENDDATE) and statusid=426 )
			UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Quoted'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
		ELSE
			UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Vacant'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
	END
	set @I=@I+1
END

select * from (
SELECT TEMP.*,RP.NodeID Building_ID,RP.NAME Property,TEMP.UnitID Unit_ID,RU.NAME Unit,C18.NAME UnitType,RU.UnitStatus,RU.RentableArea UnitArea,RU.RentPerSQFT UnitRate
,RU.AnnualRent 
,T.FirstName AS [C98c7d2679f99489e9f0e010026eeb563]
,RUL.Name LandLord , RUC.Name Location 
,1 Cnt
FROM @TAB TEMP
JOIN REN_Units RU WITH(NOLOCK) ON TEMP.UnitID=RU.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
LEFT JOIN COM_CC50018 C18 WITH(NOLOCK) ON C18.NodeID=RU.NodeID
LEFT JOIN REN_Contract C WITH(NOLOCK) ON TEMP.ContractID=C.ContractID
LEFT JOIN REN_Tenant T WITH(NOLOCK) ON T.TenantID=C.TenantID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID

 )a where a.Status =''Reserved''
 order by Property,VacantSince'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:46.120 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDg0MywiZXhwIjoxNzU0NjczNjQzLCJpYXQiOjE3NTQ2NDQ4NDN9.vBLGTnZk19LSXZzyVArtTPOcsZroJeY2D93k4slxSeQ'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:46.917 | General Service|:: CompanyIndex:53 SpName: spADM_GetCostCenterGridViewList 
 2
 ,1
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:46.917 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDg0MywiZXhwIjoxNzU0NjczNjQzLCJpYXQiOjE3NTQ2NDQ4NDN9.vBLGTnZk19LSXZzyVArtTPOcsZroJeY2D93k4slxSeQ'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:46.964 | General Service|:: CompanyIndex:53 SpName: spCom_GetCostCenterSummary 
 126
 ,-1
 ,1000
 ,''
 ,''
 ,''
 ,0
 ,'08-Aug-2025'
 ,NULL
 ,''
 ,1
 ,1
 ,0
 ,0
 ,False
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:50:46.964 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDg0MywiZXhwIjoxNzU0NjczNjQzLCJpYXQiOjE3NTQ2NDQ4NDN9.vBLGTnZk19LSXZzyVArtTPOcsZroJeY2D93k4slxSeQ'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:11.293 | General Service|:: CompanyIndex:0 SpName: spADM_GetClientUserDetails2C 
 'admin'
 ,1
 ,0
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:11.340 | General Service|:: CompanyIndex:0 SpName: spADM_UserLoginCheck 
 2
 ,'admin'
 ,0
 ,'192.168.1.99'
 ,'192.168.1.99'
 ,''
 ,'Web'
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:19.606 | General Service|:: CompanyIndex:53 SpName: spADM_GetClientUserDetails 
 'admin'
 ,1
 ,'26.2.9'
 ,0
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:19.684 | General Service|:: CompanyIndex:0 SpName: spADM_UserLoginCheck 
 2
 ,'admin'
 ,53
 ,'192.168.1.99'
 ,'192.168.1.99'
 ,''
 ,'Web'
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:19.684 | General Service|:: CompanyIndex:0 SpName: spADM_Login 
 1
 ,''
 ,''
 ,''
 ,''
 ,''
 ,53
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:19.684 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select Value from ADM_GlobalPreferences with (nolock) where name =''EnableReLogin'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:19.700 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDg3OSwiZXhwIjoxNzU0NjczNjc5LCJpYXQiOjE3NTQ2NDQ4Nzl9.tBXfNrjkjBFaQiqrfRuM0q6v4f2hXHLA1bXzn3oXtZo'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:19.715 | General Service|:: CompanyIndex:0 SpName: spADM_Login 
 4
 ,''
 ,''
 ,''
 ,'declare @Cnt int,@ExpiredGUID nvarchar(50),@AllowSession int,@GUID nvarchar(50),@CurrDate float,@UserID INT,@Instances INT,@InstancesExists INT,@LCDBIndex int
set @CurrDate= convert(float,dateadd(minute,-21,getdate()))
set @AllowSession=0
set @GUID=''4c6e8818-70eb-4b67-83d8-588a7d76a320''
set @LCDBIndex=0
select top 1 @UserID=UserID,@Instances=InstanceCount from ADM_Users with(nolock) where UserName=''admin''
if exists(select [GUID] from ADM_Login with(nolock) where [GUID]=@GUID)
begin
	update ADM_Login 
	set LastAccessTime=convert(float,getdate()),UserID=@UserID
	where [GUID]=@GUID
    set @AllowSession=1
end
else
begin
	select @Cnt=count(*) from ADM_Login with(nolock) where LCDBIndex=@LCDBIndex and [GUID]!=''ACCESSRIGHTS'' and AP =''WEB''
    if(@Cnt<100)
		set @AllowSession=1
	else
	begin
		select top 1 @ExpiredGUID=[GUID] from ADM_Login with(nolock)
		where [GUID]!=''ACCESSRIGHTS'' and LCDBIndex=@LCDBIndex and LastAccessTime<@CurrDate  and AP =''WEB''
        order by LastAccessTime asc
		if @ExpiredGUID is not null
		begin
			delete from ADM_Login where [GUID]=@ExpiredGUID
			set @AllowSession=1
		end
	end
	if @AllowSession=1
	begin
        select @InstancesExists=COUNT(*) from ADM_Login with(nolock)
		where [GUID]!=''ACCESSRIGHTS'' and LCDBIndex=@LCDBIndex and LastAccessTime>=@CurrDate and UserID=@UserID and AP =''WEB''
		if(@Instances!=0 and @Instances<=@InstancesExists)
			set @AllowSession=2
		else
		    INSERT INTO ADM_Login([GUID],[SysName],IPAddress,[Status],LoginTime,LastAccessTime,AccessRights,UserID,DBIndex,LCDBIndex,AP)
		    VALUES(@GUID,''WEB'',''192.168.1.99'',1,convert(float,getdate()),convert(float,getdate()),null,@UserID,53,@LCDBIndex, ''WEB'')
	end
end

select @AllowSession AllowSession,@Instances Instances,@InstancesExists InstancesExists
'
 ,''
 ,0
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:19.731 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDg3OSwiZXhwIjoxNzU0NjczNjc5LCJpYXQiOjE3NTQ2NDQ4Nzl9.tBXfNrjkjBFaQiqrfRuM0q6v4f2hXHLA1bXzn3oXtZo'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:19.731 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT (SELECT COUNT(*) FROM COM_Location L WITH(NOLOCK) JOIN COM_Status S WITH(NOLOCK) ON S.StatusID=L.StatusID WHERE L.IsGroup=0 AND S.[Status]=''Active'') ML
,(SELECT COUNT(*) FROM ADM_Features WITH(NOLOCK) WHERE ((FeatureID>50000 AND FeatureID<=50050) OR FeatureID>=51000) AND IsEnabled=1) MD
,(SELECT ISNULL(COUNT(*),0) FROM ADM_RevenUReports WITH(NOLOCK) WHERE IsGroup=0 AND ReportID>10000 AND StaticReportType IN (0,-1)) MR'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:19.746 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDg3OSwiZXhwIjoxNzU0NjczNjc5LCJpYXQiOjE3NTQ2NDQ4Nzl9.tBXfNrjkjBFaQiqrfRuM0q6v4f2hXHLA1bXzn3oXtZo'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:19.746 | General Service|:: CompanyIndex:53 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:19.762 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDg3OSwiZXhwIjoxNzU0NjczNjc5LCJpYXQiOjE3NTQ2NDQ4Nzl9.tBXfNrjkjBFaQiqrfRuM0q6v4f2hXHLA1bXzn3oXtZo'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:19.950 | General Service|:: CompanyIndex:53 SpName: spADM_GetRibbonView 
 1
 ,1
 ,1
 ,1
 ,0
 ,''
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:19.965 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDg3OSwiZXhwIjoxNzU0NjczNjc5LCJpYXQiOjE3NTQ2NDQ4Nzl9.tBXfNrjkjBFaQiqrfRuM0q6v4f2hXHLA1bXzn3oXtZo'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:20.200 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 2
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:20.200 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDg3OSwiZXhwIjoxNzU0NjczNjc5LCJpYXQiOjE3NTQ2NDQ4Nzl9.tBXfNrjkjBFaQiqrfRuM0q6v4f2hXHLA1bXzn3oXtZo'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:20.215 | General Service|:: CompanyIndex:53 SpName: spADM_GetDashBoard 
 2
 ,0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:20.215 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDg3OSwiZXhwIjoxNzU0NjczNjc5LCJpYXQiOjE3NTQ2NDQ4Nzl9.tBXfNrjkjBFaQiqrfRuM0q6v4f2hXHLA1bXzn3oXtZo'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:20.231 | General Service|:: CompanyIndex:53 SpName: spCOM_ConfigValues 
 1
 ,'LandingDocs'
 ,'1'
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:20.231 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDg3OSwiZXhwIjoxNzU0NjczNjc5LCJpYXQiOjE3NTQ2NDQ4Nzl9.tBXfNrjkjBFaQiqrfRuM0q6v4f2hXHLA1bXzn3oXtZo'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:20.293 | General Service|:: CompanyIndex:53 SpName: spCOM_GetFavorites 
 'GETLIST0'
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:20.293 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDg3OSwiZXhwIjoxNzU0NjczNjc5LCJpYXQiOjE3NTQ2NDQ4Nzl9.tBXfNrjkjBFaQiqrfRuM0q6v4f2hXHLA1bXzn3oXtZo'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:20.309 | General Service|:: CompanyIndex:53 SpName: spADM_GetAllListViewsDef 
 1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:20.309 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDg3OSwiZXhwIjoxNzU0NjczNjc5LCJpYXQiOjE3NTQ2NDQ4Nzl9.tBXfNrjkjBFaQiqrfRuM0q6v4f2hXHLA1bXzn3oXtZo'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:20.418 | General Service|:: CompanyIndex:53 SpName: spADM_GetAllListViewsDef 
 1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:20.418 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDg3OSwiZXhwIjoxNzU0NjczNjc5LCJpYXQiOjE3NTQ2NDQ4Nzl9.tBXfNrjkjBFaQiqrfRuM0q6v4f2hXHLA1bXzn3oXtZo'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:20.559 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'Select CostCenterID,CostCenterColID,CostCenterName,SysTableName,UserColumnName,SysColumnName,ISNULL(UserDefaultValue,'''') UserDefaultValue
From AdM_CostCenterDef WITH(NOLOCK)
Where SysColumnName IN(''CreditAccount'',''DebitAccount'',''ProductID'') 
AND CostCenterID>40000 AND CostCenterID<50000 

SELECT * FROM ADM_Features WITH(NOLOCK) '
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:20.559 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDg3OSwiZXhwIjoxNzU0NjczNjc5LCJpYXQiOjE3NTQ2NDQ4Nzl9.tBXfNrjkjBFaQiqrfRuM0q6v4f2hXHLA1bXzn3oXtZo'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:20.606 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 '  SELECT * FROM PAY_PayrollPreferences WITH(NOLOCK) '
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:20.606 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDg3OSwiZXhwIjoxNzU0NjczNjc5LCJpYXQiOjE3NTQ2NDQ4Nzl9.tBXfNrjkjBFaQiqrfRuM0q6v4f2hXHLA1bXzn3oXtZo'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:20.637 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 '  --0
                                Select * FROM COM_CC50051 WITH(NOLOCK) WHERE IsGroup=0 AND LoginUserID=''admin''
                                --1                                
                                Select * FROM COM_CC50051 WITH(NOLOCK) WHERE RptManager IN (Select NodeID FROM COM_CC50051 WITH(NOLOCK) WHERE IsGroup=0 AND LoginUserID=''admin'')
                                UNION ALL
                                Select * FROM COM_CC50051 WITH(NOLOCK) WHERE RptManager IN 
                                (
	                                Select NodeID FROM COM_CC50051 WITH(NOLOCK) 
	                                WHERE IsGroup=0 AND LoginUserID IN
	                                (
	                                SELECT fe.LoginUserID
	                                FROM INV_DocDetails a WITH(NOLOCK) 
	                                JOIN COM_DocCCData b WITH(NOLOCK) ON b.InvDocDetailsID=a.InvDocDetailsID
	                                JOIN COM_DocNumData c WITH(NOLOCK) ON c.InvDocDetailsID=a.InvDocDetailsID
	                                JOIN COM_DocTextData d WITH(NOLOCK) ON d.InvDocDetailsID=a.InvDocDetailsID
	                                JOIN COM_CC50051 fe WITH(NOLOCK) on fe.NodeID=b.dcCCNID51
	                                JOIN COM_CC50051 te WITH(NOLOCK) on CONVERT(NVARCHAR,te.NodeID)=d.dcAlpha1
	                                WHERE a.CostCenterID=40098 and a.StatusID=369 AND d.dcAlpha3=''Temporary''
	                                AND te.LoginUserID=''admin'' 
	                                AND ISDATE(d.dcAlpha4)=1 AND ISDATE(d.dcAlpha5)=1 
	                                AND CONVERT(DATETIME,''08 Aug 2025'') BETWEEN CONVERT(DATETIME,d.dcAlpha4) AND CONVERT(DATETIME,d.dcAlpha5)
	                                )
                                )
                                --2
                                Select * FROM ADM_USERS WITH(NOLOCK) WHERE USERID=1
                                --3
                                Select * FROM COM_CostCenterCostCenterMap WITH(NOLOCK) WHERE ParentCostCenterID=7 AND ParentNodeID=1
                                --4                                
                                Select * FROM COM_CostCenterCostCenterMap WITH(NOLOCK) WHERE ParentCostCenterID=7 AND ParentNodeID=1
                                AND CostCenterID IN(Select ColumnCostCenterID From ADM_CostCenterDef Where CostCenterID=50051 AND IsColumnInUse=1 AND SysColumnName LIKE ''CCNID%'')
                                --5
                                Select * from COM_Files WITH(NOLOCK) WHERE FeatureID=50051 AND FeaturePK IN (Select NodeID FROM COM_CC50051 WITH(NOLOCK) WHERE IsGroup=0 AND LoginUserID=''admin'')                         
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:20.637 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDg3OSwiZXhwIjoxNzU0NjczNjc5LCJpYXQiOjE3NTQ2NDQ4Nzl9.tBXfNrjkjBFaQiqrfRuM0q6v4f2hXHLA1bXzn3oXtZo'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:20.840 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:20.840 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDg3OSwiZXhwIjoxNzU0NjczNjc5LCJpYXQiOjE3NTQ2NDQ4Nzl9.tBXfNrjkjBFaQiqrfRuM0q6v4f2hXHLA1bXzn3oXtZo'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:21.137 | General Service|:: CompanyIndex:53 SpName: spADM_GetDashBoard 
 1
 ,41
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:21.152 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDg3OSwiZXhwIjoxNzU0NjczNjc5LCJpYXQiOjE3NTQ2NDQ4Nzl9.tBXfNrjkjBFaQiqrfRuM0q6v4f2hXHLA1bXzn3oXtZo'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:21.168 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,60584
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:21.168 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,60583
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:21.168 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDg3OSwiZXhwIjoxNzU0NjczNjc5LCJpYXQiOjE3NTQ2NDQ4Nzl9.tBXfNrjkjBFaQiqrfRuM0q6v4f2hXHLA1bXzn3oXtZo'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:21.168 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,60585
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:21.184 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDg3OSwiZXhwIjoxNzU0NjczNjc5LCJpYXQiOjE3NTQ2NDQ4Nzl9.tBXfNrjkjBFaQiqrfRuM0q6v4f2hXHLA1bXzn3oXtZo'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:21.184 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDg3OSwiZXhwIjoxNzU0NjczNjc5LCJpYXQiOjE3NTQ2NDQ4Nzl9.tBXfNrjkjBFaQiqrfRuM0q6v4f2hXHLA1bXzn3oXtZo'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:21.184 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,60586
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:21.184 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDg3OSwiZXhwIjoxNzU0NjczNjc5LCJpYXQiOjE3NTQ2NDQ4Nzl9.tBXfNrjkjBFaQiqrfRuM0q6v4f2hXHLA1bXzn3oXtZo'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:21.199 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,60584
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:21.199 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,60588
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:21.199 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDg3OSwiZXhwIjoxNzU0NjczNjc5LCJpYXQiOjE3NTQ2NDQ4Nzl9.tBXfNrjkjBFaQiqrfRuM0q6v4f2hXHLA1bXzn3oXtZo'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:21.199 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDg3OSwiZXhwIjoxNzU0NjczNjc5LCJpYXQiOjE3NTQ2NDQ4Nzl9.tBXfNrjkjBFaQiqrfRuM0q6v4f2hXHLA1bXzn3oXtZo'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:21.199 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,60587
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:21.199 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDg3OSwiZXhwIjoxNzU0NjczNjc5LCJpYXQiOjE3NTQ2NDQ4Nzl9.tBXfNrjkjBFaQiqrfRuM0q6v4f2hXHLA1bXzn3oXtZo'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:21.199 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:21.199 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDg3OSwiZXhwIjoxNzU0NjczNjc5LCJpYXQiOjE3NTQ2NDQ4Nzl9.tBXfNrjkjBFaQiqrfRuM0q6v4f2hXHLA1bXzn3oXtZo'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:21.215 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,60585
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:21.215 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,60583
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:21.215 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDg3OSwiZXhwIjoxNzU0NjczNjc5LCJpYXQiOjE3NTQ2NDQ4Nzl9.tBXfNrjkjBFaQiqrfRuM0q6v4f2hXHLA1bXzn3oXtZo'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:21.215 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDg3OSwiZXhwIjoxNzU0NjczNjc5LCJpYXQiOjE3NTQ2NDQ4Nzl9.tBXfNrjkjBFaQiqrfRuM0q6v4f2hXHLA1bXzn3oXtZo'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:21.215 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,60586
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:21.215 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,60588
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:21.215 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDg3OSwiZXhwIjoxNzU0NjczNjc5LCJpYXQiOjE3NTQ2NDQ4Nzl9.tBXfNrjkjBFaQiqrfRuM0q6v4f2hXHLA1bXzn3oXtZo'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:21.215 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDg3OSwiZXhwIjoxNzU0NjczNjc5LCJpYXQiOjE3NTQ2NDQ4Nzl9.tBXfNrjkjBFaQiqrfRuM0q6v4f2hXHLA1bXzn3oXtZo'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:21.215 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:21.215 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,60587
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:21.215 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDg3OSwiZXhwIjoxNzU0NjczNjc5LCJpYXQiOjE3NTQ2NDQ4Nzl9.tBXfNrjkjBFaQiqrfRuM0q6v4f2hXHLA1bXzn3oXtZo'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:21.215 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDg3OSwiZXhwIjoxNzU0NjczNjc5LCJpYXQiOjE3NTQ2NDQ4Nzl9.tBXfNrjkjBFaQiqrfRuM0q6v4f2hXHLA1bXzn3oXtZo'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:21.231 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:21.231 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDg3OSwiZXhwIjoxNzU0NjczNjc5LCJpYXQiOjE3NTQ2NDQ4Nzl9.tBXfNrjkjBFaQiqrfRuM0q6v4f2hXHLA1bXzn3oXtZo'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:21.231 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:21.246 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDg3OSwiZXhwIjoxNzU0NjczNjc5LCJpYXQiOjE3NTQ2NDQ4Nzl9.tBXfNrjkjBFaQiqrfRuM0q6v4f2hXHLA1bXzn3oXtZo'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:21.246 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:21.246 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDg3OSwiZXhwIjoxNzU0NjczNjc5LCJpYXQiOjE3NTQ2NDQ4Nzl9.tBXfNrjkjBFaQiqrfRuM0q6v4f2hXHLA1bXzn3oXtZo'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:21.262 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:21.262 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDg3OSwiZXhwIjoxNzU0NjczNjc5LCJpYXQiOjE3NTQ2NDQ4Nzl9.tBXfNrjkjBFaQiqrfRuM0q6v4f2hXHLA1bXzn3oXtZo'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:21.262 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:21.262 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDg3OSwiZXhwIjoxNzU0NjczNjc5LCJpYXQiOjE3NTQ2NDQ4Nzl9.tBXfNrjkjBFaQiqrfRuM0q6v4f2hXHLA1bXzn3oXtZo'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:21.278 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:21.278 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDg3OSwiZXhwIjoxNzU0NjczNjc5LCJpYXQiOjE3NTQ2NDQ4Nzl9.tBXfNrjkjBFaQiqrfRuM0q6v4f2hXHLA1bXzn3oXtZo'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:21.293 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:21.293 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDg3OSwiZXhwIjoxNzU0NjczNjc5LCJpYXQiOjE3NTQ2NDQ4Nzl9.tBXfNrjkjBFaQiqrfRuM0q6v4f2hXHLA1bXzn3oXtZo'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:21.293 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:21.309 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDg3OSwiZXhwIjoxNzU0NjczNjc5LCJpYXQiOjE3NTQ2NDQ4Nzl9.tBXfNrjkjBFaQiqrfRuM0q6v4f2hXHLA1bXzn3oXtZo'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:21.309 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:21.309 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDg3OSwiZXhwIjoxNzU0NjczNjc5LCJpYXQiOjE3NTQ2NDQ4Nzl9.tBXfNrjkjBFaQiqrfRuM0q6v4f2hXHLA1bXzn3oXtZo'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:21.324 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:21.324 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDg3OSwiZXhwIjoxNzU0NjczNjc5LCJpYXQiOjE3NTQ2NDQ4Nzl9.tBXfNrjkjBFaQiqrfRuM0q6v4f2hXHLA1bXzn3oXtZo'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:21.434 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60583'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:21.434 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDg3OSwiZXhwIjoxNzU0NjczNjc5LCJpYXQiOjE3NTQ2NDQ4Nzl9.tBXfNrjkjBFaQiqrfRuM0q6v4f2hXHLA1bXzn3oXtZo'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:21.824 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReportCategoryandField 
 -1
 ,0
 ,1
 ,0
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:21.824 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDg3OSwiZXhwIjoxNzU0NjczNjc5LCJpYXQiOjE3NTQ2NDQ4Nzl9.tBXfNrjkjBFaQiqrfRuM0q6v4f2hXHLA1bXzn3oXtZo'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:21.871 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60584'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:21.871 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDg3OSwiZXhwIjoxNzU0NjczNjc5LCJpYXQiOjE3NTQ2NDQ4Nzl9.tBXfNrjkjBFaQiqrfRuM0q6v4f2hXHLA1bXzn3oXtZo'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:21.918 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select * from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0  
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) a --where UStatus like ''%Hold%'' 
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:21.918 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDg3OSwiZXhwIjoxNzU0NjczNjc5LCJpYXQiOjE3NTQ2NDQ4Nzl9.tBXfNrjkjBFaQiqrfRuM0q6v4f2hXHLA1bXzn3oXtZo'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:21.949 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60585'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:21.949 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDg3OSwiZXhwIjoxNzU0NjczNjc5LCJpYXQiOjE3NTQ2NDQ4Nzl9.tBXfNrjkjBFaQiqrfRuM0q6v4f2hXHLA1bXzn3oXtZo'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:21.980 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60586'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:21.980 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDg3OSwiZXhwIjoxNzU0NjczNjc5LCJpYXQiOjE3NTQ2NDQ4Nzl9.tBXfNrjkjBFaQiqrfRuM0q6v4f2hXHLA1bXzn3oXtZo'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:21.996 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select * from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0  
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) a where UnitStatus=''Occupied'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:21.996 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDg3OSwiZXhwIjoxNzU0NjczNjc5LCJpYXQiOjE3NTQ2NDQ4Nzl9.tBXfNrjkjBFaQiqrfRuM0q6v4f2hXHLA1bXzn3oXtZo'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:21.996 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select * from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0  
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) a where UnitStatus=''Vacant''
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:21.996 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDg3OSwiZXhwIjoxNzU0NjczNjc5LCJpYXQiOjE3NTQ2NDQ4Nzl9.tBXfNrjkjBFaQiqrfRuM0q6v4f2hXHLA1bXzn3oXtZo'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:22.012 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60587'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:22.012 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDg3OSwiZXhwIjoxNzU0NjczNjc5LCJpYXQiOjE3NTQ2NDQ4Nzl9.tBXfNrjkjBFaQiqrfRuM0q6v4f2hXHLA1bXzn3oXtZo'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:22.012 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select * from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0  
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) a  where UnitStatus=''Expired'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:22.027 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDg3OSwiZXhwIjoxNzU0NjczNjc5LCJpYXQiOjE3NTQ2NDQ4Nzl9.tBXfNrjkjBFaQiqrfRuM0q6v4f2hXHLA1bXzn3oXtZo'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:22.027 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60588'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:22.027 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDg3OSwiZXhwIjoxNzU0NjczNjc5LCJpYXQiOjE3NTQ2NDQ4Nzl9.tBXfNrjkjBFaQiqrfRuM0q6v4f2hXHLA1bXzn3oXtZo'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:22.043 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60583'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:22.043 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDg3OSwiZXhwIjoxNzU0NjczNjc5LCJpYXQiOjE3NTQ2NDQ4Nzl9.tBXfNrjkjBFaQiqrfRuM0q6v4f2hXHLA1bXzn3oXtZo'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:22.059 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select * from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0  
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) a where UStatus like ''%Case%'' 
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:22.059 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDg3OSwiZXhwIjoxNzU0NjczNjc5LCJpYXQiOjE3NTQ2NDQ4Nzl9.tBXfNrjkjBFaQiqrfRuM0q6v4f2hXHLA1bXzn3oXtZo'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:22.059 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60584'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:22.090 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDg3OSwiZXhwIjoxNzU0NjczNjc5LCJpYXQiOjE3NTQ2NDQ4Nzl9.tBXfNrjkjBFaQiqrfRuM0q6v4f2hXHLA1bXzn3oXtZo'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:22.106 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select * from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0  
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) a --where UStatus like ''%Hold%'' 
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:22.121 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 '/*
DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select * from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0  
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) a where UStatus like ''%Reserve%'' 
*/

DECLARE @FROM FLOAT
SET @FROM=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @UnitID BIGINT,@StatusID BIGINT,@TotalAmount FLOAT,@I INT,@COUNT INT,@ContractID BIGINT
DECLARE @NoofDays INT,@VacantSince DATETIME

DECLARE @TAB TABLE(ID INT IDENTITY(1,1) PRIMARY KEY,UnitID BIGINT,CurrentRent FLOAT,Status NVARCHAR(10),NoofDays INT,VacantSince DATETIME,ContractID BIGINT)

INSERT INTO @TAB (UnitID)
SELECT U.UnitID
FROM REN_Units U WITH(NOLOCK) 
LEFT JOIN REN_Property P WITH(NOLOCK) ON P.NodeID=U.PropertyID
LEFT JOIN COM_Lookup LK WITH(NOLOCK) ON U.UnitStatus=LK.NodeID
WHERE U.UnitID>1 AND P.Name <> U.Name AND U.IsGroup=0 AND U.Status=424 and U.UnitStatus=306 
-- AND P.NodeID IN (207)
SELECT @I=1,@COUNT=COUNT(*) FROM @TAB
WHILE(@I<=@COUNT)
BEGIN
	SET @StatusID=0
	SET @TotalAmount=0
	SET @ContractID=0
	SELECT @UnitID=UnitID FROM @TAB WHERE ID=@I

	SELECT TOP 1 @ContractID=(CASE WHEN RefContractID>0 THEN RefContractID ELSE ContractID END),@StatusID=StatusID
	,@VacantSince=(CASE WHEN StatusID = 450 THEN ( CASE WHEN RefundDate IS NOT NULL THEN CONVERT(DATETIME,RefundDate) ELSE CONVERT(DATETIME,VacancyDate) END ) 
			ELSE CONVERT(DATETIME,TerminationDate) END )
	,@NoofDays=(CASE WHEN StatusID = 450 THEN (CASE WHEN RefundDate IS NOT NULL THEN DATEDIFF(DAY, CONVERT(DATETIME,RefundDate),CONVERT(DATETIME,@FROM) ) 
			ELSE DATEDIFF(DAY, CONVERT(DATETIME,VacancyDate),CONVERT(DATETIME,@FROM) ) END )
			ELSE DATEDIFF(DAY, CONVERT(DATETIME,TerminationDate),CONVERT(DATETIME,@FROM) ) END )  
	FROM REN_Contract WITH(NOLOCK) WHERE StatusID<>451 AND StartDate<@FROM AND UNITID=@UnitID 
	ORDER BY StartDate DESC,StatusID
	
	SELECT @TotalAmount=ISNULL(SUM(RPD.Amount),MAX(RentAmount)/(CASE WHEN MAX(RC.NoOfUnits)=0 THEN 1 ELSE MAX(RC.NoOfUnits) END)) 
	FROM REN_Contract RC WITH(NOLOCK)
	JOIN REN_ContractParticulars RP WITH(NOLOCK) ON RP.ContractID=RC.ContractID AND RP.Sno=1
	LEFT JOIN REN_ContractParticularsDetail RPD WITH(NOLOCK) ON RPD.ParticularNodeID=RP.NodeID AND RPD.Unit=@UnitID 
	AND @FROM BETWEEN ISNULL(RPD.FromDate,@FROM) AND ISNULL(RPD.ToDate,@FROM)
	WHERE RC.ContractID=@ContractID
	
	IF @StatusID=427 OR @StatusID=426 OR @StatusID=466
	BEGIN
		UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Occupied'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
	END
	ELSE IF @StatusID=440
	BEGIN
		UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''UnAproved'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
	END
	ELSE IF @StatusID=428 OR @StatusID=450
	BEGIN 
		IF EXISTS (SELECT * FROM REN_Quotation WITH(NOLOCK) WHERE COSTCENTERID=129 AND UNITID=@UnitID AND CONVERT(DATETIME,@FROM) BETWEEN CONVERT(DATETIME,STARTDATE) AND CONVERT(DATETIME,ENDDATE) and statusid=467 )
			UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Reserved'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
		ELSE IF EXISTS (SELECT * FROM REN_Quotation WITH(NOLOCK) WHERE COSTCENTERID=103 AND UNITID=@UnitID AND CONVERT(DATETIME,@FROM) BETWEEN CONVERT(DATETIME,STARTDATE) AND CONVERT(DATETIME,ENDDATE) and statusid=426 )
			UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Quoted'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
		ELSE
			UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Vacant'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
	END
	ELSE
	BEGIN 
		IF EXISTS (SELECT * FROM REN_Quotation WITH(NOLOCK) WHERE COSTCENTERID=129 AND UNITID=@UnitID AND CONVERT(DATETIME,@FROM) BETWEEN CONVERT(DATETIME,STARTDATE) AND CONVERT(DATETIME,ENDDATE) and statusid=467 )
			UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Reserved'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
		ELSE IF EXISTS (SELECT * FROM REN_Quotation WITH(NOLOCK) WHERE COSTCENTERID=103 AND UNITID=@UnitID AND CONVERT(DATETIME,@FROM) BETWEEN CONVERT(DATETIME,STARTDATE) AND CONVERT(DATETIME,ENDDATE) and statusid=426 )
			UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Quoted'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
		ELSE
			UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Vacant'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
	END
	set @I=@I+1
END

select * from (
SELECT TEMP.*,RP.NodeID Building_ID,RP.NAME Property,TEMP.UnitID Unit_ID,RU.NAME Unit,C18.NAME UnitType,RU.UnitStatus,RU.RentableArea UnitArea,RU.RentPerSQFT UnitRate
,RU.AnnualRent 
,T.FirstName AS [C98c7d2679f99489e9f0e010026eeb563]
,RUL.Name LandLord , RUC.Name Location 
,1 Cnt
FROM @TAB TEMP
JOIN REN_Units RU WITH(NOLOCK) ON TEMP.UnitID=RU.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
LEFT JOIN COM_CC50018 C18 WITH(NOLOCK) ON C18.NodeID=RU.NodeID
LEFT JOIN REN_Contract C WITH(NOLOCK) ON TEMP.ContractID=C.ContractID
LEFT JOIN REN_Tenant T WITH(NOLOCK) ON T.TenantID=C.TenantID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID

 )a where a.Status =''Reserved''
 order by Property,VacantSince'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:22.121 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDg3OSwiZXhwIjoxNzU0NjczNjc5LCJpYXQiOjE3NTQ2NDQ4Nzl9.tBXfNrjkjBFaQiqrfRuM0q6v4f2hXHLA1bXzn3oXtZo'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:22.121 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDg3OSwiZXhwIjoxNzU0NjczNjc5LCJpYXQiOjE3NTQ2NDQ4Nzl9.tBXfNrjkjBFaQiqrfRuM0q6v4f2hXHLA1bXzn3oXtZo'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:22.121 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60585'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:22.137 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDg3OSwiZXhwIjoxNzU0NjczNjc5LCJpYXQiOjE3NTQ2NDQ4Nzl9.tBXfNrjkjBFaQiqrfRuM0q6v4f2hXHLA1bXzn3oXtZo'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:22.137 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select * from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0  
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) a where UnitStatus=''Vacant''
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:22.152 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDg3OSwiZXhwIjoxNzU0NjczNjc5LCJpYXQiOjE3NTQ2NDQ4Nzl9.tBXfNrjkjBFaQiqrfRuM0q6v4f2hXHLA1bXzn3oXtZo'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:22.168 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select * from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0  
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) a where UnitStatus=''Occupied'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:22.184 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDg3OSwiZXhwIjoxNzU0NjczNjc5LCJpYXQiOjE3NTQ2NDQ4Nzl9.tBXfNrjkjBFaQiqrfRuM0q6v4f2hXHLA1bXzn3oXtZo'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:22.215 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60586'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:22.215 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDg3OSwiZXhwIjoxNzU0NjczNjc5LCJpYXQiOjE3NTQ2NDQ4Nzl9.tBXfNrjkjBFaQiqrfRuM0q6v4f2hXHLA1bXzn3oXtZo'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:22.230 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select * from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0  
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) a  where UnitStatus=''Expired'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:22.246 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDg3OSwiZXhwIjoxNzU0NjczNjc5LCJpYXQiOjE3NTQ2NDQ4Nzl9.tBXfNrjkjBFaQiqrfRuM0q6v4f2hXHLA1bXzn3oXtZo'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:22.246 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60587'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:22.246 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDg3OSwiZXhwIjoxNzU0NjczNjc5LCJpYXQiOjE3NTQ2NDQ4Nzl9.tBXfNrjkjBFaQiqrfRuM0q6v4f2hXHLA1bXzn3oXtZo'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:22.262 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60588'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:22.262 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDg3OSwiZXhwIjoxNzU0NjczNjc5LCJpYXQiOjE3NTQ2NDQ4Nzl9.tBXfNrjkjBFaQiqrfRuM0q6v4f2hXHLA1bXzn3oXtZo'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:22.277 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select * from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0  
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) a where UStatus like ''%Case%'' 
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:22.277 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDg3OSwiZXhwIjoxNzU0NjczNjc5LCJpYXQiOjE3NTQ2NDQ4Nzl9.tBXfNrjkjBFaQiqrfRuM0q6v4f2hXHLA1bXzn3oXtZo'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:22.356 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 '/*
DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select * from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0  
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) a where UStatus like ''%Reserve%'' 
*/

DECLARE @FROM FLOAT
SET @FROM=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @UnitID BIGINT,@StatusID BIGINT,@TotalAmount FLOAT,@I INT,@COUNT INT,@ContractID BIGINT
DECLARE @NoofDays INT,@VacantSince DATETIME

DECLARE @TAB TABLE(ID INT IDENTITY(1,1) PRIMARY KEY,UnitID BIGINT,CurrentRent FLOAT,Status NVARCHAR(10),NoofDays INT,VacantSince DATETIME,ContractID BIGINT)

INSERT INTO @TAB (UnitID)
SELECT U.UnitID
FROM REN_Units U WITH(NOLOCK) 
LEFT JOIN REN_Property P WITH(NOLOCK) ON P.NodeID=U.PropertyID
LEFT JOIN COM_Lookup LK WITH(NOLOCK) ON U.UnitStatus=LK.NodeID
WHERE U.UnitID>1 AND P.Name <> U.Name AND U.IsGroup=0 AND U.Status=424 and U.UnitStatus=306 
-- AND P.NodeID IN (207)
SELECT @I=1,@COUNT=COUNT(*) FROM @TAB
WHILE(@I<=@COUNT)
BEGIN
	SET @StatusID=0
	SET @TotalAmount=0
	SET @ContractID=0
	SELECT @UnitID=UnitID FROM @TAB WHERE ID=@I

	SELECT TOP 1 @ContractID=(CASE WHEN RefContractID>0 THEN RefContractID ELSE ContractID END),@StatusID=StatusID
	,@VacantSince=(CASE WHEN StatusID = 450 THEN ( CASE WHEN RefundDate IS NOT NULL THEN CONVERT(DATETIME,RefundDate) ELSE CONVERT(DATETIME,VacancyDate) END ) 
			ELSE CONVERT(DATETIME,TerminationDate) END )
	,@NoofDays=(CASE WHEN StatusID = 450 THEN (CASE WHEN RefundDate IS NOT NULL THEN DATEDIFF(DAY, CONVERT(DATETIME,RefundDate),CONVERT(DATETIME,@FROM) ) 
			ELSE DATEDIFF(DAY, CONVERT(DATETIME,VacancyDate),CONVERT(DATETIME,@FROM) ) END )
			ELSE DATEDIFF(DAY, CONVERT(DATETIME,TerminationDate),CONVERT(DATETIME,@FROM) ) END )  
	FROM REN_Contract WITH(NOLOCK) WHERE StatusID<>451 AND StartDate<@FROM AND UNITID=@UnitID 
	ORDER BY StartDate DESC,StatusID
	
	SELECT @TotalAmount=ISNULL(SUM(RPD.Amount),MAX(RentAmount)/(CASE WHEN MAX(RC.NoOfUnits)=0 THEN 1 ELSE MAX(RC.NoOfUnits) END)) 
	FROM REN_Contract RC WITH(NOLOCK)
	JOIN REN_ContractParticulars RP WITH(NOLOCK) ON RP.ContractID=RC.ContractID AND RP.Sno=1
	LEFT JOIN REN_ContractParticularsDetail RPD WITH(NOLOCK) ON RPD.ParticularNodeID=RP.NodeID AND RPD.Unit=@UnitID 
	AND @FROM BETWEEN ISNULL(RPD.FromDate,@FROM) AND ISNULL(RPD.ToDate,@FROM)
	WHERE RC.ContractID=@ContractID
	
	IF @StatusID=427 OR @StatusID=426 OR @StatusID=466
	BEGIN
		UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Occupied'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
	END
	ELSE IF @StatusID=440
	BEGIN
		UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''UnAproved'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
	END
	ELSE IF @StatusID=428 OR @StatusID=450
	BEGIN 
		IF EXISTS (SELECT * FROM REN_Quotation WITH(NOLOCK) WHERE COSTCENTERID=129 AND UNITID=@UnitID AND CONVERT(DATETIME,@FROM) BETWEEN CONVERT(DATETIME,STARTDATE) AND CONVERT(DATETIME,ENDDATE) and statusid=467 )
			UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Reserved'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
		ELSE IF EXISTS (SELECT * FROM REN_Quotation WITH(NOLOCK) WHERE COSTCENTERID=103 AND UNITID=@UnitID AND CONVERT(DATETIME,@FROM) BETWEEN CONVERT(DATETIME,STARTDATE) AND CONVERT(DATETIME,ENDDATE) and statusid=426 )
			UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Quoted'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
		ELSE
			UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Vacant'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
	END
	ELSE
	BEGIN 
		IF EXISTS (SELECT * FROM REN_Quotation WITH(NOLOCK) WHERE COSTCENTERID=129 AND UNITID=@UnitID AND CONVERT(DATETIME,@FROM) BETWEEN CONVERT(DATETIME,STARTDATE) AND CONVERT(DATETIME,ENDDATE) and statusid=467 )
			UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Reserved'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
		ELSE IF EXISTS (SELECT * FROM REN_Quotation WITH(NOLOCK) WHERE COSTCENTERID=103 AND UNITID=@UnitID AND CONVERT(DATETIME,@FROM) BETWEEN CONVERT(DATETIME,STARTDATE) AND CONVERT(DATETIME,ENDDATE) and statusid=426 )
			UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Quoted'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
		ELSE
			UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Vacant'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
	END
	set @I=@I+1
END

select * from (
SELECT TEMP.*,RP.NodeID Building_ID,RP.NAME Property,TEMP.UnitID Unit_ID,RU.NAME Unit,C18.NAME UnitType,RU.UnitStatus,RU.RentableArea UnitArea,RU.RentPerSQFT UnitRate
,RU.AnnualRent 
,T.FirstName AS [C98c7d2679f99489e9f0e010026eeb563]
,RUL.Name LandLord , RUC.Name Location 
,1 Cnt
FROM @TAB TEMP
JOIN REN_Units RU WITH(NOLOCK) ON TEMP.UnitID=RU.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
LEFT JOIN COM_CC50018 C18 WITH(NOLOCK) ON C18.NodeID=RU.NodeID
LEFT JOIN REN_Contract C WITH(NOLOCK) ON TEMP.ContractID=C.ContractID
LEFT JOIN REN_Tenant T WITH(NOLOCK) ON T.TenantID=C.TenantID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID

 )a where a.Status =''Reserved''
 order by Property,VacantSince'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:22.356 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDg3OSwiZXhwIjoxNzU0NjczNjc5LCJpYXQiOjE3NTQ2NDQ4Nzl9.tBXfNrjkjBFaQiqrfRuM0q6v4f2hXHLA1bXzn3oXtZo'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:24.339 | General Service|:: CompanyIndex:53 SpName: spADM_GetCostCenterGridViewList 
 2
 ,1
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:24.339 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDg3OSwiZXhwIjoxNzU0NjczNjc5LCJpYXQiOjE3NTQ2NDQ4Nzl9.tBXfNrjkjBFaQiqrfRuM0q6v4f2hXHLA1bXzn3oXtZo'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:24.386 | General Service|:: CompanyIndex:53 SpName: spCom_GetCostCenterSummary 
 126
 ,-1
 ,1000
 ,''
 ,''
 ,''
 ,0
 ,'08-Aug-2025'
 ,NULL
 ,''
 ,1
 ,1
 ,0
 ,0
 ,False
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:24.386 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDg3OSwiZXhwIjoxNzU0NjczNjc5LCJpYXQiOjE3NTQ2NDQ4Nzl9.tBXfNrjkjBFaQiqrfRuM0q6v4f2hXHLA1bXzn3oXtZo'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:40.800 | General Service|:: CompanyIndex:53 SpName: spADM_GetDashBoard 
 1
 ,41
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:40.800 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDg3OSwiZXhwIjoxNzU0NjczNjc5LCJpYXQiOjE3NTQ2NDQ4Nzl9.tBXfNrjkjBFaQiqrfRuM0q6v4f2hXHLA1bXzn3oXtZo'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:40.831 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,60583
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:40.831 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,60584
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:40.831 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,60585
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:40.831 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,60588
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:40.831 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDg3OSwiZXhwIjoxNzU0NjczNjc5LCJpYXQiOjE3NTQ2NDQ4Nzl9.tBXfNrjkjBFaQiqrfRuM0q6v4f2hXHLA1bXzn3oXtZo'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:40.831 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDg3OSwiZXhwIjoxNzU0NjczNjc5LCJpYXQiOjE3NTQ2NDQ4Nzl9.tBXfNrjkjBFaQiqrfRuM0q6v4f2hXHLA1bXzn3oXtZo'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:40.831 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDg3OSwiZXhwIjoxNzU0NjczNjc5LCJpYXQiOjE3NTQ2NDQ4Nzl9.tBXfNrjkjBFaQiqrfRuM0q6v4f2hXHLA1bXzn3oXtZo'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:40.831 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDg3OSwiZXhwIjoxNzU0NjczNjc5LCJpYXQiOjE3NTQ2NDQ4Nzl9.tBXfNrjkjBFaQiqrfRuM0q6v4f2hXHLA1bXzn3oXtZo'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:40.847 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,60587
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:40.847 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,60586
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:40.847 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDg3OSwiZXhwIjoxNzU0NjczNjc5LCJpYXQiOjE3NTQ2NDQ4Nzl9.tBXfNrjkjBFaQiqrfRuM0q6v4f2hXHLA1bXzn3oXtZo'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:40.847 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:40.847 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,60583
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:40.847 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,60585
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:40.847 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,60584
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:40.847 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDg3OSwiZXhwIjoxNzU0NjczNjc5LCJpYXQiOjE3NTQ2NDQ4Nzl9.tBXfNrjkjBFaQiqrfRuM0q6v4f2hXHLA1bXzn3oXtZo'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:40.847 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDg3OSwiZXhwIjoxNzU0NjczNjc5LCJpYXQiOjE3NTQ2NDQ4Nzl9.tBXfNrjkjBFaQiqrfRuM0q6v4f2hXHLA1bXzn3oXtZo'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:40.847 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDg3OSwiZXhwIjoxNzU0NjczNjc5LCJpYXQiOjE3NTQ2NDQ4Nzl9.tBXfNrjkjBFaQiqrfRuM0q6v4f2hXHLA1bXzn3oXtZo'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:40.847 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDg3OSwiZXhwIjoxNzU0NjczNjc5LCJpYXQiOjE3NTQ2NDQ4Nzl9.tBXfNrjkjBFaQiqrfRuM0q6v4f2hXHLA1bXzn3oXtZo'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:40.847 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDg3OSwiZXhwIjoxNzU0NjczNjc5LCJpYXQiOjE3NTQ2NDQ4Nzl9.tBXfNrjkjBFaQiqrfRuM0q6v4f2hXHLA1bXzn3oXtZo'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:40.862 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,60588
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:40.862 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:40.862 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDg3OSwiZXhwIjoxNzU0NjczNjc5LCJpYXQiOjE3NTQ2NDQ4Nzl9.tBXfNrjkjBFaQiqrfRuM0q6v4f2hXHLA1bXzn3oXtZo'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:40.862 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDg3OSwiZXhwIjoxNzU0NjczNjc5LCJpYXQiOjE3NTQ2NDQ4Nzl9.tBXfNrjkjBFaQiqrfRuM0q6v4f2hXHLA1bXzn3oXtZo'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:40.862 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,60587
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:40.862 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,60586
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:40.862 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDg3OSwiZXhwIjoxNzU0NjczNjc5LCJpYXQiOjE3NTQ2NDQ4Nzl9.tBXfNrjkjBFaQiqrfRuM0q6v4f2hXHLA1bXzn3oXtZo'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:40.862 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDg3OSwiZXhwIjoxNzU0NjczNjc5LCJpYXQiOjE3NTQ2NDQ4Nzl9.tBXfNrjkjBFaQiqrfRuM0q6v4f2hXHLA1bXzn3oXtZo'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:40.878 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:40.878 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDg3OSwiZXhwIjoxNzU0NjczNjc5LCJpYXQiOjE3NTQ2NDQ4Nzl9.tBXfNrjkjBFaQiqrfRuM0q6v4f2hXHLA1bXzn3oXtZo'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:40.878 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:40.894 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDg3OSwiZXhwIjoxNzU0NjczNjc5LCJpYXQiOjE3NTQ2NDQ4Nzl9.tBXfNrjkjBFaQiqrfRuM0q6v4f2hXHLA1bXzn3oXtZo'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:40.894 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:40.894 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDg3OSwiZXhwIjoxNzU0NjczNjc5LCJpYXQiOjE3NTQ2NDQ4Nzl9.tBXfNrjkjBFaQiqrfRuM0q6v4f2hXHLA1bXzn3oXtZo'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:40.909 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:40.909 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDg3OSwiZXhwIjoxNzU0NjczNjc5LCJpYXQiOjE3NTQ2NDQ4Nzl9.tBXfNrjkjBFaQiqrfRuM0q6v4f2hXHLA1bXzn3oXtZo'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:40.909 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:40.909 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDg3OSwiZXhwIjoxNzU0NjczNjc5LCJpYXQiOjE3NTQ2NDQ4Nzl9.tBXfNrjkjBFaQiqrfRuM0q6v4f2hXHLA1bXzn3oXtZo'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:40.925 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:40.925 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDg3OSwiZXhwIjoxNzU0NjczNjc5LCJpYXQiOjE3NTQ2NDQ4Nzl9.tBXfNrjkjBFaQiqrfRuM0q6v4f2hXHLA1bXzn3oXtZo'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:40.925 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:40.925 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDg3OSwiZXhwIjoxNzU0NjczNjc5LCJpYXQiOjE3NTQ2NDQ4Nzl9.tBXfNrjkjBFaQiqrfRuM0q6v4f2hXHLA1bXzn3oXtZo'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:40.940 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:40.940 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDg3OSwiZXhwIjoxNzU0NjczNjc5LCJpYXQiOjE3NTQ2NDQ4Nzl9.tBXfNrjkjBFaQiqrfRuM0q6v4f2hXHLA1bXzn3oXtZo'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:40.956 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:40.956 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDg3OSwiZXhwIjoxNzU0NjczNjc5LCJpYXQiOjE3NTQ2NDQ4Nzl9.tBXfNrjkjBFaQiqrfRuM0q6v4f2hXHLA1bXzn3oXtZo'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:40.956 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:40.956 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDg3OSwiZXhwIjoxNzU0NjczNjc5LCJpYXQiOjE3NTQ2NDQ4Nzl9.tBXfNrjkjBFaQiqrfRuM0q6v4f2hXHLA1bXzn3oXtZo'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:41.065 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60583'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:41.065 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDg3OSwiZXhwIjoxNzU0NjczNjc5LCJpYXQiOjE3NTQ2NDQ4Nzl9.tBXfNrjkjBFaQiqrfRuM0q6v4f2hXHLA1bXzn3oXtZo'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:41.097 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60584'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:41.097 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDg3OSwiZXhwIjoxNzU0NjczNjc5LCJpYXQiOjE3NTQ2NDQ4Nzl9.tBXfNrjkjBFaQiqrfRuM0q6v4f2hXHLA1bXzn3oXtZo'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:41.143 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select * from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0  
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) a --where UStatus like ''%Hold%'' 
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:41.143 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDg3OSwiZXhwIjoxNzU0NjczNjc5LCJpYXQiOjE3NTQ2NDQ4Nzl9.tBXfNrjkjBFaQiqrfRuM0q6v4f2hXHLA1bXzn3oXtZo'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:41.143 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60585'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:41.143 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select * from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0  
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) a where UnitStatus=''Vacant''
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:41.143 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDg3OSwiZXhwIjoxNzU0NjczNjc5LCJpYXQiOjE3NTQ2NDQ4Nzl9.tBXfNrjkjBFaQiqrfRuM0q6v4f2hXHLA1bXzn3oXtZo'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:41.159 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDg3OSwiZXhwIjoxNzU0NjczNjc5LCJpYXQiOjE3NTQ2NDQ4Nzl9.tBXfNrjkjBFaQiqrfRuM0q6v4f2hXHLA1bXzn3oXtZo'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:41.190 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select * from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0  
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) a where UnitStatus=''Occupied'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:41.190 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDg3OSwiZXhwIjoxNzU0NjczNjc5LCJpYXQiOjE3NTQ2NDQ4Nzl9.tBXfNrjkjBFaQiqrfRuM0q6v4f2hXHLA1bXzn3oXtZo'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:41.190 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60586'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:41.190 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDg3OSwiZXhwIjoxNzU0NjczNjc5LCJpYXQiOjE3NTQ2NDQ4Nzl9.tBXfNrjkjBFaQiqrfRuM0q6v4f2hXHLA1bXzn3oXtZo'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:41.206 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select * from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0  
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) a  where UnitStatus=''Expired'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:41.222 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDg3OSwiZXhwIjoxNzU0NjczNjc5LCJpYXQiOjE3NTQ2NDQ4Nzl9.tBXfNrjkjBFaQiqrfRuM0q6v4f2hXHLA1bXzn3oXtZo'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:41.237 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60587'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:41.253 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDg3OSwiZXhwIjoxNzU0NjczNjc5LCJpYXQiOjE3NTQ2NDQ4Nzl9.tBXfNrjkjBFaQiqrfRuM0q6v4f2hXHLA1bXzn3oXtZo'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:41.300 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select * from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0  
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) a where UStatus like ''%Case%'' 
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:41.300 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60588'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:41.300 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDg3OSwiZXhwIjoxNzU0NjczNjc5LCJpYXQiOjE3NTQ2NDQ4Nzl9.tBXfNrjkjBFaQiqrfRuM0q6v4f2hXHLA1bXzn3oXtZo'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:41.300 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDg3OSwiZXhwIjoxNzU0NjczNjc5LCJpYXQiOjE3NTQ2NDQ4Nzl9.tBXfNrjkjBFaQiqrfRuM0q6v4f2hXHLA1bXzn3oXtZo'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:41.347 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60583'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:41.347 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDg3OSwiZXhwIjoxNzU0NjczNjc5LCJpYXQiOjE3NTQ2NDQ4Nzl9.tBXfNrjkjBFaQiqrfRuM0q6v4f2hXHLA1bXzn3oXtZo'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:41.378 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 '/*
DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select * from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0  
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) a where UStatus like ''%Reserve%'' 
*/

DECLARE @FROM FLOAT
SET @FROM=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @UnitID BIGINT,@StatusID BIGINT,@TotalAmount FLOAT,@I INT,@COUNT INT,@ContractID BIGINT
DECLARE @NoofDays INT,@VacantSince DATETIME

DECLARE @TAB TABLE(ID INT IDENTITY(1,1) PRIMARY KEY,UnitID BIGINT,CurrentRent FLOAT,Status NVARCHAR(10),NoofDays INT,VacantSince DATETIME,ContractID BIGINT)

INSERT INTO @TAB (UnitID)
SELECT U.UnitID
FROM REN_Units U WITH(NOLOCK) 
LEFT JOIN REN_Property P WITH(NOLOCK) ON P.NodeID=U.PropertyID
LEFT JOIN COM_Lookup LK WITH(NOLOCK) ON U.UnitStatus=LK.NodeID
WHERE U.UnitID>1 AND P.Name <> U.Name AND U.IsGroup=0 AND U.Status=424 and U.UnitStatus=306 
-- AND P.NodeID IN (207)
SELECT @I=1,@COUNT=COUNT(*) FROM @TAB
WHILE(@I<=@COUNT)
BEGIN
	SET @StatusID=0
	SET @TotalAmount=0
	SET @ContractID=0
	SELECT @UnitID=UnitID FROM @TAB WHERE ID=@I

	SELECT TOP 1 @ContractID=(CASE WHEN RefContractID>0 THEN RefContractID ELSE ContractID END),@StatusID=StatusID
	,@VacantSince=(CASE WHEN StatusID = 450 THEN ( CASE WHEN RefundDate IS NOT NULL THEN CONVERT(DATETIME,RefundDate) ELSE CONVERT(DATETIME,VacancyDate) END ) 
			ELSE CONVERT(DATETIME,TerminationDate) END )
	,@NoofDays=(CASE WHEN StatusID = 450 THEN (CASE WHEN RefundDate IS NOT NULL THEN DATEDIFF(DAY, CONVERT(DATETIME,RefundDate),CONVERT(DATETIME,@FROM) ) 
			ELSE DATEDIFF(DAY, CONVERT(DATETIME,VacancyDate),CONVERT(DATETIME,@FROM) ) END )
			ELSE DATEDIFF(DAY, CONVERT(DATETIME,TerminationDate),CONVERT(DATETIME,@FROM) ) END )  
	FROM REN_Contract WITH(NOLOCK) WHERE StatusID<>451 AND StartDate<@FROM AND UNITID=@UnitID 
	ORDER BY StartDate DESC,StatusID
	
	SELECT @TotalAmount=ISNULL(SUM(RPD.Amount),MAX(RentAmount)/(CASE WHEN MAX(RC.NoOfUnits)=0 THEN 1 ELSE MAX(RC.NoOfUnits) END)) 
	FROM REN_Contract RC WITH(NOLOCK)
	JOIN REN_ContractParticulars RP WITH(NOLOCK) ON RP.ContractID=RC.ContractID AND RP.Sno=1
	LEFT JOIN REN_ContractParticularsDetail RPD WITH(NOLOCK) ON RPD.ParticularNodeID=RP.NodeID AND RPD.Unit=@UnitID 
	AND @FROM BETWEEN ISNULL(RPD.FromDate,@FROM) AND ISNULL(RPD.ToDate,@FROM)
	WHERE RC.ContractID=@ContractID
	
	IF @StatusID=427 OR @StatusID=426 OR @StatusID=466
	BEGIN
		UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Occupied'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
	END
	ELSE IF @StatusID=440
	BEGIN
		UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''UnAproved'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
	END
	ELSE IF @StatusID=428 OR @StatusID=450
	BEGIN 
		IF EXISTS (SELECT * FROM REN_Quotation WITH(NOLOCK) WHERE COSTCENTERID=129 AND UNITID=@UnitID AND CONVERT(DATETIME,@FROM) BETWEEN CONVERT(DATETIME,STARTDATE) AND CONVERT(DATETIME,ENDDATE) and statusid=467 )
			UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Reserved'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
		ELSE IF EXISTS (SELECT * FROM REN_Quotation WITH(NOLOCK) WHERE COSTCENTERID=103 AND UNITID=@UnitID AND CONVERT(DATETIME,@FROM) BETWEEN CONVERT(DATETIME,STARTDATE) AND CONVERT(DATETIME,ENDDATE) and statusid=426 )
			UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Quoted'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
		ELSE
			UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Vacant'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
	END
	ELSE
	BEGIN 
		IF EXISTS (SELECT * FROM REN_Quotation WITH(NOLOCK) WHERE COSTCENTERID=129 AND UNITID=@UnitID AND CONVERT(DATETIME,@FROM) BETWEEN CONVERT(DATETIME,STARTDATE) AND CONVERT(DATETIME,ENDDATE) and statusid=467 )
			UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Reserved'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
		ELSE IF EXISTS (SELECT * FROM REN_Quotation WITH(NOLOCK) WHERE COSTCENTERID=103 AND UNITID=@UnitID AND CONVERT(DATETIME,@FROM) BETWEEN CONVERT(DATETIME,STARTDATE) AND CONVERT(DATETIME,ENDDATE) and statusid=426 )
			UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Quoted'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
		ELSE
			UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Vacant'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
	END
	set @I=@I+1
END

select * from (
SELECT TEMP.*,RP.NodeID Building_ID,RP.NAME Property,TEMP.UnitID Unit_ID,RU.NAME Unit,C18.NAME UnitType,RU.UnitStatus,RU.RentableArea UnitArea,RU.RentPerSQFT UnitRate
,RU.AnnualRent 
,T.FirstName AS [C98c7d2679f99489e9f0e010026eeb563]
,RUL.Name LandLord , RUC.Name Location 
,1 Cnt
FROM @TAB TEMP
JOIN REN_Units RU WITH(NOLOCK) ON TEMP.UnitID=RU.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
LEFT JOIN COM_CC50018 C18 WITH(NOLOCK) ON C18.NodeID=RU.NodeID
LEFT JOIN REN_Contract C WITH(NOLOCK) ON TEMP.ContractID=C.ContractID
LEFT JOIN REN_Tenant T WITH(NOLOCK) ON T.TenantID=C.TenantID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID

 )a where a.Status =''Reserved''
 order by Property,VacantSince'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:41.393 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDg3OSwiZXhwIjoxNzU0NjczNjc5LCJpYXQiOjE3NTQ2NDQ4Nzl9.tBXfNrjkjBFaQiqrfRuM0q6v4f2hXHLA1bXzn3oXtZo'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:41.393 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select * from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0  
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) a --where UStatus like ''%Hold%'' 
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:41.393 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDg3OSwiZXhwIjoxNzU0NjczNjc5LCJpYXQiOjE3NTQ2NDQ4Nzl9.tBXfNrjkjBFaQiqrfRuM0q6v4f2hXHLA1bXzn3oXtZo'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:41.409 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60584'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:41.409 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDg3OSwiZXhwIjoxNzU0NjczNjc5LCJpYXQiOjE3NTQ2NDQ4Nzl9.tBXfNrjkjBFaQiqrfRuM0q6v4f2hXHLA1bXzn3oXtZo'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:41.440 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select * from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0  
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) a where UnitStatus=''Vacant''
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:41.440 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60585'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:41.440 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDg3OSwiZXhwIjoxNzU0NjczNjc5LCJpYXQiOjE3NTQ2NDQ4Nzl9.tBXfNrjkjBFaQiqrfRuM0q6v4f2hXHLA1bXzn3oXtZo'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:41.440 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDg3OSwiZXhwIjoxNzU0NjczNjc5LCJpYXQiOjE3NTQ2NDQ4Nzl9.tBXfNrjkjBFaQiqrfRuM0q6v4f2hXHLA1bXzn3oXtZo'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:41.456 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select * from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0  
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) a where UnitStatus=''Occupied'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:41.456 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDg3OSwiZXhwIjoxNzU0NjczNjc5LCJpYXQiOjE3NTQ2NDQ4Nzl9.tBXfNrjkjBFaQiqrfRuM0q6v4f2hXHLA1bXzn3oXtZo'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:41.550 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60586'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:41.550 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDg3OSwiZXhwIjoxNzU0NjczNjc5LCJpYXQiOjE3NTQ2NDQ4Nzl9.tBXfNrjkjBFaQiqrfRuM0q6v4f2hXHLA1bXzn3oXtZo'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:41.581 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select * from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0  
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) a  where UnitStatus=''Expired'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:41.581 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDg3OSwiZXhwIjoxNzU0NjczNjc5LCJpYXQiOjE3NTQ2NDQ4Nzl9.tBXfNrjkjBFaQiqrfRuM0q6v4f2hXHLA1bXzn3oXtZo'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:41.596 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60587'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:41.612 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDg3OSwiZXhwIjoxNzU0NjczNjc5LCJpYXQiOjE3NTQ2NDQ4Nzl9.tBXfNrjkjBFaQiqrfRuM0q6v4f2hXHLA1bXzn3oXtZo'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:41.659 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select * from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0  
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) a where UStatus like ''%Case%'' 
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:41.659 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDg3OSwiZXhwIjoxNzU0NjczNjc5LCJpYXQiOjE3NTQ2NDQ4Nzl9.tBXfNrjkjBFaQiqrfRuM0q6v4f2hXHLA1bXzn3oXtZo'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:41.784 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60588'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:41.784 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDg3OSwiZXhwIjoxNzU0NjczNjc5LCJpYXQiOjE3NTQ2NDQ4Nzl9.tBXfNrjkjBFaQiqrfRuM0q6v4f2hXHLA1bXzn3oXtZo'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:41.862 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 '/*
DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select * from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0  
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) a where UStatus like ''%Reserve%'' 
*/

DECLARE @FROM FLOAT
SET @FROM=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @UnitID BIGINT,@StatusID BIGINT,@TotalAmount FLOAT,@I INT,@COUNT INT,@ContractID BIGINT
DECLARE @NoofDays INT,@VacantSince DATETIME

DECLARE @TAB TABLE(ID INT IDENTITY(1,1) PRIMARY KEY,UnitID BIGINT,CurrentRent FLOAT,Status NVARCHAR(10),NoofDays INT,VacantSince DATETIME,ContractID BIGINT)

INSERT INTO @TAB (UnitID)
SELECT U.UnitID
FROM REN_Units U WITH(NOLOCK) 
LEFT JOIN REN_Property P WITH(NOLOCK) ON P.NodeID=U.PropertyID
LEFT JOIN COM_Lookup LK WITH(NOLOCK) ON U.UnitStatus=LK.NodeID
WHERE U.UnitID>1 AND P.Name <> U.Name AND U.IsGroup=0 AND U.Status=424 and U.UnitStatus=306 
-- AND P.NodeID IN (207)
SELECT @I=1,@COUNT=COUNT(*) FROM @TAB
WHILE(@I<=@COUNT)
BEGIN
	SET @StatusID=0
	SET @TotalAmount=0
	SET @ContractID=0
	SELECT @UnitID=UnitID FROM @TAB WHERE ID=@I

	SELECT TOP 1 @ContractID=(CASE WHEN RefContractID>0 THEN RefContractID ELSE ContractID END),@StatusID=StatusID
	,@VacantSince=(CASE WHEN StatusID = 450 THEN ( CASE WHEN RefundDate IS NOT NULL THEN CONVERT(DATETIME,RefundDate) ELSE CONVERT(DATETIME,VacancyDate) END ) 
			ELSE CONVERT(DATETIME,TerminationDate) END )
	,@NoofDays=(CASE WHEN StatusID = 450 THEN (CASE WHEN RefundDate IS NOT NULL THEN DATEDIFF(DAY, CONVERT(DATETIME,RefundDate),CONVERT(DATETIME,@FROM) ) 
			ELSE DATEDIFF(DAY, CONVERT(DATETIME,VacancyDate),CONVERT(DATETIME,@FROM) ) END )
			ELSE DATEDIFF(DAY, CONVERT(DATETIME,TerminationDate),CONVERT(DATETIME,@FROM) ) END )  
	FROM REN_Contract WITH(NOLOCK) WHERE StatusID<>451 AND StartDate<@FROM AND UNITID=@UnitID 
	ORDER BY StartDate DESC,StatusID
	
	SELECT @TotalAmount=ISNULL(SUM(RPD.Amount),MAX(RentAmount)/(CASE WHEN MAX(RC.NoOfUnits)=0 THEN 1 ELSE MAX(RC.NoOfUnits) END)) 
	FROM REN_Contract RC WITH(NOLOCK)
	JOIN REN_ContractParticulars RP WITH(NOLOCK) ON RP.ContractID=RC.ContractID AND RP.Sno=1
	LEFT JOIN REN_ContractParticularsDetail RPD WITH(NOLOCK) ON RPD.ParticularNodeID=RP.NodeID AND RPD.Unit=@UnitID 
	AND @FROM BETWEEN ISNULL(RPD.FromDate,@FROM) AND ISNULL(RPD.ToDate,@FROM)
	WHERE RC.ContractID=@ContractID
	
	IF @StatusID=427 OR @StatusID=426 OR @StatusID=466
	BEGIN
		UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Occupied'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
	END
	ELSE IF @StatusID=440
	BEGIN
		UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''UnAproved'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
	END
	ELSE IF @StatusID=428 OR @StatusID=450
	BEGIN 
		IF EXISTS (SELECT * FROM REN_Quotation WITH(NOLOCK) WHERE COSTCENTERID=129 AND UNITID=@UnitID AND CONVERT(DATETIME,@FROM) BETWEEN CONVERT(DATETIME,STARTDATE) AND CONVERT(DATETIME,ENDDATE) and statusid=467 )
			UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Reserved'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
		ELSE IF EXISTS (SELECT * FROM REN_Quotation WITH(NOLOCK) WHERE COSTCENTERID=103 AND UNITID=@UnitID AND CONVERT(DATETIME,@FROM) BETWEEN CONVERT(DATETIME,STARTDATE) AND CONVERT(DATETIME,ENDDATE) and statusid=426 )
			UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Quoted'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
		ELSE
			UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Vacant'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
	END
	ELSE
	BEGIN 
		IF EXISTS (SELECT * FROM REN_Quotation WITH(NOLOCK) WHERE COSTCENTERID=129 AND UNITID=@UnitID AND CONVERT(DATETIME,@FROM) BETWEEN CONVERT(DATETIME,STARTDATE) AND CONVERT(DATETIME,ENDDATE) and statusid=467 )
			UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Reserved'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
		ELSE IF EXISTS (SELECT * FROM REN_Quotation WITH(NOLOCK) WHERE COSTCENTERID=103 AND UNITID=@UnitID AND CONVERT(DATETIME,@FROM) BETWEEN CONVERT(DATETIME,STARTDATE) AND CONVERT(DATETIME,ENDDATE) and statusid=426 )
			UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Quoted'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
		ELSE
			UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Vacant'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
	END
	set @I=@I+1
END

select * from (
SELECT TEMP.*,RP.NodeID Building_ID,RP.NAME Property,TEMP.UnitID Unit_ID,RU.NAME Unit,C18.NAME UnitType,RU.UnitStatus,RU.RentableArea UnitArea,RU.RentPerSQFT UnitRate
,RU.AnnualRent 
,T.FirstName AS [C98c7d2679f99489e9f0e010026eeb563]
,RUL.Name LandLord , RUC.Name Location 
,1 Cnt
FROM @TAB TEMP
JOIN REN_Units RU WITH(NOLOCK) ON TEMP.UnitID=RU.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
LEFT JOIN COM_CC50018 C18 WITH(NOLOCK) ON C18.NodeID=RU.NodeID
LEFT JOIN REN_Contract C WITH(NOLOCK) ON TEMP.ContractID=C.ContractID
LEFT JOIN REN_Tenant T WITH(NOLOCK) ON T.TenantID=C.TenantID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID

 )a where a.Status =''Reserved''
 order by Property,VacantSince'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:41.862 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDg3OSwiZXhwIjoxNzU0NjczNjc5LCJpYXQiOjE3NTQ2NDQ4Nzl9.tBXfNrjkjBFaQiqrfRuM0q6v4f2hXHLA1bXzn3oXtZo'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:44.956 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:44.956 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDg0MywiZXhwIjoxNzU0NjczNjQzLCJpYXQiOjE3NTQ2NDQ4NDN9.vBLGTnZk19LSXZzyVArtTPOcsZroJeY2D93k4slxSeQ'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:56.531 | General Service|:: CompanyIndex:0 SpName: spADM_GetClientUserDetails2C 
 'admin'
 ,1
 ,0
[System: 192.168.1.99] DEBUG | 08-08-2025 14:51:56.578 | General Service|:: CompanyIndex:0 SpName: spADM_UserLoginCheck 
 2
 ,'admin'
 ,0
 ,'192.168.1.99'
 ,'192.168.1.99'
 ,''
 ,'Web'
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:52:07.921 | General Service|:: CompanyIndex:56 SpName: spADM_GetClientUserDetails 
 'admin'
 ,1
 ,'26.2.9'
 ,0
[System: 192.168.1.99] DEBUG | 08-08-2025 14:52:07.999 | General Service|:: CompanyIndex:0 SpName: spADM_UserLoginCheck 
 2
 ,'admin'
 ,56
 ,'192.168.1.99'
 ,'192.168.1.99'
 ,''
 ,'Web'
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:52:08.014 | General Service|:: CompanyIndex:0 SpName: spADM_Login 
 1
 ,''
 ,''
 ,''
 ,''
 ,''
 ,56
[System: 192.168.1.99] DEBUG | 08-08-2025 14:52:08.045 | General Service|:: CompanyIndex:56 SpName: spADM_GetDataSet 
 'select Value from ADM_GlobalPreferences with (nolock) where name =''EnableReLogin'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:52:08.077 | General Service|:: CompanyIndex:56 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTYsMSIsIm5iZiI6MTc1NDY0NDkyNywiZXhwIjoxNzU0NjczNzI3LCJpYXQiOjE3NTQ2NDQ5Mjd9.bNdfdz3G_OZj72D5nhUdFzQ9s_6BY9rKdZrvQyOxuFA'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:52:08.108 | General Service|:: CompanyIndex:0 SpName: spADM_Login 
 4
 ,''
 ,''
 ,''
 ,'declare @Cnt int,@ExpiredGUID nvarchar(50),@AllowSession int,@GUID nvarchar(50),@CurrDate float,@UserID INT,@Instances INT,@InstancesExists INT,@LCDBIndex int
set @CurrDate= convert(float,dateadd(minute,-21,getdate()))
set @AllowSession=0
set @GUID=''82bc4e60-b71c-46b9-ab4f-a39aa290a1ce''
set @LCDBIndex=0
select top 1 @UserID=UserID,@Instances=InstanceCount from ADM_Users with(nolock) where UserName=''admin''
if exists(select [GUID] from ADM_Login with(nolock) where [GUID]=@GUID)
begin
	update ADM_Login 
	set LastAccessTime=convert(float,getdate()),UserID=@UserID
	where [GUID]=@GUID
    set @AllowSession=1
end
else
begin
	select @Cnt=count(*) from ADM_Login with(nolock) where LCDBIndex=@LCDBIndex and [GUID]!=''ACCESSRIGHTS'' and AP =''WEB''
    if(@Cnt<100)
		set @AllowSession=1
	else
	begin
		select top 1 @ExpiredGUID=[GUID] from ADM_Login with(nolock)
		where [GUID]!=''ACCESSRIGHTS'' and LCDBIndex=@LCDBIndex and LastAccessTime<@CurrDate  and AP =''WEB''
        order by LastAccessTime asc
		if @ExpiredGUID is not null
		begin
			delete from ADM_Login where [GUID]=@ExpiredGUID
			set @AllowSession=1
		end
	end
	if @AllowSession=1
	begin
        select @InstancesExists=COUNT(*) from ADM_Login with(nolock)
		where [GUID]!=''ACCESSRIGHTS'' and LCDBIndex=@LCDBIndex and LastAccessTime>=@CurrDate and UserID=@UserID and AP =''WEB''
		if(@Instances!=0 and @Instances<=@InstancesExists)
			set @AllowSession=2
		else
		    INSERT INTO ADM_Login([GUID],[SysName],IPAddress,[Status],LoginTime,LastAccessTime,AccessRights,UserID,DBIndex,LCDBIndex,AP)
		    VALUES(@GUID,''WEB'',''192.168.1.99'',1,convert(float,getdate()),convert(float,getdate()),null,@UserID,56,@LCDBIndex, ''WEB'')
	end
end

select @AllowSession AllowSession,@Instances Instances,@InstancesExists InstancesExists
'
 ,''
 ,0
[System: 192.168.1.99] DEBUG | 08-08-2025 14:52:08.124 | General Service|:: CompanyIndex:56 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTYsMSIsIm5iZiI6MTc1NDY0NDkyNywiZXhwIjoxNzU0NjczNzI3LCJpYXQiOjE3NTQ2NDQ5Mjd9.bNdfdz3G_OZj72D5nhUdFzQ9s_6BY9rKdZrvQyOxuFA'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:52:08.421 | General Service|:: CompanyIndex:56 SpName: spADM_GetDataSet 
 'SELECT (SELECT COUNT(*) FROM COM_Location L WITH(NOLOCK) JOIN COM_Status S WITH(NOLOCK) ON S.StatusID=L.StatusID WHERE L.IsGroup=0 AND S.[Status]=''Active'') ML
,(SELECT COUNT(*) FROM ADM_Features WITH(NOLOCK) WHERE ((FeatureID>50000 AND FeatureID<=50050) OR FeatureID>=51000) AND IsEnabled=1) MD
,(SELECT ISNULL(COUNT(*),0) FROM ADM_RevenUReports WITH(NOLOCK) WHERE IsGroup=0 AND ReportID>10000 AND StaticReportType IN (0,-1)) MR'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:52:08.421 | General Service|:: CompanyIndex:56 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTYsMSIsIm5iZiI6MTc1NDY0NDkyNywiZXhwIjoxNzU0NjczNzI3LCJpYXQiOjE3NTQ2NDQ5Mjd9.bNdfdz3G_OZj72D5nhUdFzQ9s_6BY9rKdZrvQyOxuFA'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:52:29.828 | General Service|:: CompanyIndex:0 SpName: spADM_GetClientUserDetails2C 
 'admin'
 ,1
 ,0
[System: 192.168.1.99] DEBUG | 08-08-2025 14:52:29.891 | General Service|:: CompanyIndex:0 SpName: spADM_UserLoginCheck 
 2
 ,'admin'
 ,0
 ,'192.168.1.99'
 ,'192.168.1.99'
 ,''
 ,'Web'
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:52:37.719 | General Service|:: CompanyIndex:53 SpName: spADM_GetClientUserDetails 
 'admin'
 ,1
 ,'26.2.9'
 ,0
[System: 192.168.1.99] DEBUG | 08-08-2025 14:52:37.797 | General Service|:: CompanyIndex:0 SpName: spADM_UserLoginCheck 
 2
 ,'admin'
 ,53
 ,'192.168.1.99'
 ,'192.168.1.99'
 ,''
 ,'Web'
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:52:37.797 | General Service|:: CompanyIndex:0 SpName: spADM_Login 
 1
 ,''
 ,''
 ,''
 ,''
 ,''
 ,53
[System: 192.168.1.99] DEBUG | 08-08-2025 14:52:37.812 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select Value from ADM_GlobalPreferences with (nolock) where name =''EnableReLogin'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:52:37.812 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDk1NywiZXhwIjoxNzU0NjczNzU3LCJpYXQiOjE3NTQ2NDQ5NTd9.9ovanv-yfIAieNHkTJLeuWQ1yPRQFDRyurQAal6EGcU'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:52:37.844 | General Service|:: CompanyIndex:0 SpName: spADM_Login 
 4
 ,''
 ,''
 ,''
 ,'declare @Cnt int,@ExpiredGUID nvarchar(50),@AllowSession int,@GUID nvarchar(50),@CurrDate float,@UserID INT,@Instances INT,@InstancesExists INT,@LCDBIndex int
set @CurrDate= convert(float,dateadd(minute,-21,getdate()))
set @AllowSession=0
set @GUID=''6ce5a22f-7d83-48a8-91da-b150652a3de2''
set @LCDBIndex=0
select top 1 @UserID=UserID,@Instances=InstanceCount from ADM_Users with(nolock) where UserName=''admin''
if exists(select [GUID] from ADM_Login with(nolock) where [GUID]=@GUID)
begin
	update ADM_Login 
	set LastAccessTime=convert(float,getdate()),UserID=@UserID
	where [GUID]=@GUID
    set @AllowSession=1
end
else
begin
	select @Cnt=count(*) from ADM_Login with(nolock) where LCDBIndex=@LCDBIndex and [GUID]!=''ACCESSRIGHTS'' and AP =''WEB''
    if(@Cnt<100)
		set @AllowSession=1
	else
	begin
		select top 1 @ExpiredGUID=[GUID] from ADM_Login with(nolock)
		where [GUID]!=''ACCESSRIGHTS'' and LCDBIndex=@LCDBIndex and LastAccessTime<@CurrDate  and AP =''WEB''
        order by LastAccessTime asc
		if @ExpiredGUID is not null
		begin
			delete from ADM_Login where [GUID]=@ExpiredGUID
			set @AllowSession=1
		end
	end
	if @AllowSession=1
	begin
        select @InstancesExists=COUNT(*) from ADM_Login with(nolock)
		where [GUID]!=''ACCESSRIGHTS'' and LCDBIndex=@LCDBIndex and LastAccessTime>=@CurrDate and UserID=@UserID and AP =''WEB''
		if(@Instances!=0 and @Instances<=@InstancesExists)
			set @AllowSession=2
		else
		    INSERT INTO ADM_Login([GUID],[SysName],IPAddress,[Status],LoginTime,LastAccessTime,AccessRights,UserID,DBIndex,LCDBIndex,AP)
		    VALUES(@GUID,''WEB'',''192.168.1.99'',1,convert(float,getdate()),convert(float,getdate()),null,@UserID,53,@LCDBIndex, ''WEB'')
	end
end

select @AllowSession AllowSession,@Instances Instances,@InstancesExists InstancesExists
'
 ,''
 ,0
[System: 192.168.1.99] DEBUG | 08-08-2025 14:52:37.844 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDk1NywiZXhwIjoxNzU0NjczNzU3LCJpYXQiOjE3NTQ2NDQ5NTd9.9ovanv-yfIAieNHkTJLeuWQ1yPRQFDRyurQAal6EGcU'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:52:37.859 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT (SELECT COUNT(*) FROM COM_Location L WITH(NOLOCK) JOIN COM_Status S WITH(NOLOCK) ON S.StatusID=L.StatusID WHERE L.IsGroup=0 AND S.[Status]=''Active'') ML
,(SELECT COUNT(*) FROM ADM_Features WITH(NOLOCK) WHERE ((FeatureID>50000 AND FeatureID<=50050) OR FeatureID>=51000) AND IsEnabled=1) MD
,(SELECT ISNULL(COUNT(*),0) FROM ADM_RevenUReports WITH(NOLOCK) WHERE IsGroup=0 AND ReportID>10000 AND StaticReportType IN (0,-1)) MR'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:52:37.859 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDk1NywiZXhwIjoxNzU0NjczNzU3LCJpYXQiOjE3NTQ2NDQ5NTd9.9ovanv-yfIAieNHkTJLeuWQ1yPRQFDRyurQAal6EGcU'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:52:37.890 | General Service|:: CompanyIndex:53 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.99] DEBUG | 08-08-2025 14:52:37.890 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDk1NywiZXhwIjoxNzU0NjczNzU3LCJpYXQiOjE3NTQ2NDQ5NTd9.9ovanv-yfIAieNHkTJLeuWQ1yPRQFDRyurQAal6EGcU'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:52:38.109 | General Service|:: CompanyIndex:53 SpName: spADM_GetRibbonView 
 1
 ,1
 ,1
 ,1
 ,0
 ,''
[System: 192.168.1.99] DEBUG | 08-08-2025 14:52:38.109 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDk1NywiZXhwIjoxNzU0NjczNzU3LCJpYXQiOjE3NTQ2NDQ5NTd9.9ovanv-yfIAieNHkTJLeuWQ1yPRQFDRyurQAal6EGcU'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:52:38.313 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 2
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:52:38.313 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDk1NywiZXhwIjoxNzU0NjczNzU3LCJpYXQiOjE3NTQ2NDQ5NTd9.9ovanv-yfIAieNHkTJLeuWQ1yPRQFDRyurQAal6EGcU'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:52:38.328 | General Service|:: CompanyIndex:53 SpName: spADM_GetDashBoard 
 2
 ,0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:52:38.328 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDk1NywiZXhwIjoxNzU0NjczNzU3LCJpYXQiOjE3NTQ2NDQ5NTd9.9ovanv-yfIAieNHkTJLeuWQ1yPRQFDRyurQAal6EGcU'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:52:38.344 | General Service|:: CompanyIndex:53 SpName: spCOM_ConfigValues 
 1
 ,'LandingDocs'
 ,'1'
[System: 192.168.1.99] DEBUG | 08-08-2025 14:52:38.359 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDk1NywiZXhwIjoxNzU0NjczNzU3LCJpYXQiOjE3NTQ2NDQ5NTd9.9ovanv-yfIAieNHkTJLeuWQ1yPRQFDRyurQAal6EGcU'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:52:38.406 | General Service|:: CompanyIndex:53 SpName: spCOM_GetFavorites 
 'GETLIST0'
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:52:38.406 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDk1NywiZXhwIjoxNzU0NjczNzU3LCJpYXQiOjE3NTQ2NDQ5NTd9.9ovanv-yfIAieNHkTJLeuWQ1yPRQFDRyurQAal6EGcU'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:52:38.406 | General Service|:: CompanyIndex:53 SpName: spADM_GetAllListViewsDef 
 1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:52:38.422 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDk1NywiZXhwIjoxNzU0NjczNzU3LCJpYXQiOjE3NTQ2NDQ5NTd9.9ovanv-yfIAieNHkTJLeuWQ1yPRQFDRyurQAal6EGcU'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:52:38.531 | General Service|:: CompanyIndex:53 SpName: spADM_GetAllListViewsDef 
 1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:52:38.531 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDk1NywiZXhwIjoxNzU0NjczNzU3LCJpYXQiOjE3NTQ2NDQ5NTd9.9ovanv-yfIAieNHkTJLeuWQ1yPRQFDRyurQAal6EGcU'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:52:38.656 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'Select CostCenterID,CostCenterColID,CostCenterName,SysTableName,UserColumnName,SysColumnName,ISNULL(UserDefaultValue,'''') UserDefaultValue
From AdM_CostCenterDef WITH(NOLOCK)
Where SysColumnName IN(''CreditAccount'',''DebitAccount'',''ProductID'') 
AND CostCenterID>40000 AND CostCenterID<50000 

SELECT * FROM ADM_Features WITH(NOLOCK) '
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:52:38.656 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDk1NywiZXhwIjoxNzU0NjczNzU3LCJpYXQiOjE3NTQ2NDQ5NTd9.9ovanv-yfIAieNHkTJLeuWQ1yPRQFDRyurQAal6EGcU'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:52:38.719 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 '  SELECT * FROM PAY_PayrollPreferences WITH(NOLOCK) '
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:52:38.719 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDk1NywiZXhwIjoxNzU0NjczNzU3LCJpYXQiOjE3NTQ2NDQ5NTd9.9ovanv-yfIAieNHkTJLeuWQ1yPRQFDRyurQAal6EGcU'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:52:38.734 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 '  --0
                                Select * FROM COM_CC50051 WITH(NOLOCK) WHERE IsGroup=0 AND LoginUserID=''admin''
                                --1                                
                                Select * FROM COM_CC50051 WITH(NOLOCK) WHERE RptManager IN (Select NodeID FROM COM_CC50051 WITH(NOLOCK) WHERE IsGroup=0 AND LoginUserID=''admin'')
                                UNION ALL
                                Select * FROM COM_CC50051 WITH(NOLOCK) WHERE RptManager IN 
                                (
	                                Select NodeID FROM COM_CC50051 WITH(NOLOCK) 
	                                WHERE IsGroup=0 AND LoginUserID IN
	                                (
	                                SELECT fe.LoginUserID
	                                FROM INV_DocDetails a WITH(NOLOCK) 
	                                JOIN COM_DocCCData b WITH(NOLOCK) ON b.InvDocDetailsID=a.InvDocDetailsID
	                                JOIN COM_DocNumData c WITH(NOLOCK) ON c.InvDocDetailsID=a.InvDocDetailsID
	                                JOIN COM_DocTextData d WITH(NOLOCK) ON d.InvDocDetailsID=a.InvDocDetailsID
	                                JOIN COM_CC50051 fe WITH(NOLOCK) on fe.NodeID=b.dcCCNID51
	                                JOIN COM_CC50051 te WITH(NOLOCK) on CONVERT(NVARCHAR,te.NodeID)=d.dcAlpha1
	                                WHERE a.CostCenterID=40098 and a.StatusID=369 AND d.dcAlpha3=''Temporary''
	                                AND te.LoginUserID=''admin'' 
	                                AND ISDATE(d.dcAlpha4)=1 AND ISDATE(d.dcAlpha5)=1 
	                                AND CONVERT(DATETIME,''08 Aug 2025'') BETWEEN CONVERT(DATETIME,d.dcAlpha4) AND CONVERT(DATETIME,d.dcAlpha5)
	                                )
                                )
                                --2
                                Select * FROM ADM_USERS WITH(NOLOCK) WHERE USERID=1
                                --3
                                Select * FROM COM_CostCenterCostCenterMap WITH(NOLOCK) WHERE ParentCostCenterID=7 AND ParentNodeID=1
                                --4                                
                                Select * FROM COM_CostCenterCostCenterMap WITH(NOLOCK) WHERE ParentCostCenterID=7 AND ParentNodeID=1
                                AND CostCenterID IN(Select ColumnCostCenterID From ADM_CostCenterDef Where CostCenterID=50051 AND IsColumnInUse=1 AND SysColumnName LIKE ''CCNID%'')
                                --5
                                Select * from COM_Files WITH(NOLOCK) WHERE FeatureID=50051 AND FeaturePK IN (Select NodeID FROM COM_CC50051 WITH(NOLOCK) WHERE IsGroup=0 AND LoginUserID=''admin'')                         
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:52:38.734 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDk1NywiZXhwIjoxNzU0NjczNzU3LCJpYXQiOjE3NTQ2NDQ5NTd9.9ovanv-yfIAieNHkTJLeuWQ1yPRQFDRyurQAal6EGcU'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:52:38.781 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:52:38.797 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDk1NywiZXhwIjoxNzU0NjczNzU3LCJpYXQiOjE3NTQ2NDQ5NTd9.9ovanv-yfIAieNHkTJLeuWQ1yPRQFDRyurQAal6EGcU'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:52:39.125 | General Service|:: CompanyIndex:53 SpName: spADM_GetDashBoard 
 1
 ,41
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:52:39.125 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDk1NywiZXhwIjoxNzU0NjczNzU3LCJpYXQiOjE3NTQ2NDQ5NTd9.9ovanv-yfIAieNHkTJLeuWQ1yPRQFDRyurQAal6EGcU'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:52:39.156 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,60586
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:52:39.156 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,60585
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:52:39.156 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,60587
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:52:39.156 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDk1NywiZXhwIjoxNzU0NjczNzU3LCJpYXQiOjE3NTQ2NDQ5NTd9.9ovanv-yfIAieNHkTJLeuWQ1yPRQFDRyurQAal6EGcU'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:52:39.172 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,60584
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:52:39.172 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,60583
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:52:39.172 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDk1NywiZXhwIjoxNzU0NjczNzU3LCJpYXQiOjE3NTQ2NDQ5NTd9.9ovanv-yfIAieNHkTJLeuWQ1yPRQFDRyurQAal6EGcU'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:52:39.172 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDk1NywiZXhwIjoxNzU0NjczNzU3LCJpYXQiOjE3NTQ2NDQ5NTd9.9ovanv-yfIAieNHkTJLeuWQ1yPRQFDRyurQAal6EGcU'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:52:39.172 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDk1NywiZXhwIjoxNzU0NjczNzU3LCJpYXQiOjE3NTQ2NDQ5NTd9.9ovanv-yfIAieNHkTJLeuWQ1yPRQFDRyurQAal6EGcU'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:52:39.172 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDk1NywiZXhwIjoxNzU0NjczNzU3LCJpYXQiOjE3NTQ2NDQ5NTd9.9ovanv-yfIAieNHkTJLeuWQ1yPRQFDRyurQAal6EGcU'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:52:39.172 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,60588
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:52:39.187 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDk1NywiZXhwIjoxNzU0NjczNzU3LCJpYXQiOjE3NTQ2NDQ5NTd9.9ovanv-yfIAieNHkTJLeuWQ1yPRQFDRyurQAal6EGcU'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:52:39.187 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,60586
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:52:39.187 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:52:39.187 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDk1NywiZXhwIjoxNzU0NjczNzU3LCJpYXQiOjE3NTQ2NDQ5NTd9.9ovanv-yfIAieNHkTJLeuWQ1yPRQFDRyurQAal6EGcU'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:52:39.187 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,60585
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:52:39.187 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDk1NywiZXhwIjoxNzU0NjczNzU3LCJpYXQiOjE3NTQ2NDQ5NTd9.9ovanv-yfIAieNHkTJLeuWQ1yPRQFDRyurQAal6EGcU'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:52:39.187 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDk1NywiZXhwIjoxNzU0NjczNzU3LCJpYXQiOjE3NTQ2NDQ5NTd9.9ovanv-yfIAieNHkTJLeuWQ1yPRQFDRyurQAal6EGcU'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:52:39.203 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,60584
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:52:39.203 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,60583
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:52:39.203 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,60587
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:52:39.203 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDk1NywiZXhwIjoxNzU0NjczNzU3LCJpYXQiOjE3NTQ2NDQ5NTd9.9ovanv-yfIAieNHkTJLeuWQ1yPRQFDRyurQAal6EGcU'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:52:39.203 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,60588
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:52:39.203 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDk1NywiZXhwIjoxNzU0NjczNzU3LCJpYXQiOjE3NTQ2NDQ5NTd9.9ovanv-yfIAieNHkTJLeuWQ1yPRQFDRyurQAal6EGcU'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:52:39.203 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDk1NywiZXhwIjoxNzU0NjczNzU3LCJpYXQiOjE3NTQ2NDQ5NTd9.9ovanv-yfIAieNHkTJLeuWQ1yPRQFDRyurQAal6EGcU'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:52:39.203 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDk1NywiZXhwIjoxNzU0NjczNzU3LCJpYXQiOjE3NTQ2NDQ5NTd9.9ovanv-yfIAieNHkTJLeuWQ1yPRQFDRyurQAal6EGcU'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:52:39.219 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:52:39.219 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDk1NywiZXhwIjoxNzU0NjczNzU3LCJpYXQiOjE3NTQ2NDQ5NTd9.9ovanv-yfIAieNHkTJLeuWQ1yPRQFDRyurQAal6EGcU'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:52:39.219 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:52:39.219 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDk1NywiZXhwIjoxNzU0NjczNzU3LCJpYXQiOjE3NTQ2NDQ5NTd9.9ovanv-yfIAieNHkTJLeuWQ1yPRQFDRyurQAal6EGcU'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:52:39.234 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:52:39.234 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDk1NywiZXhwIjoxNzU0NjczNzU3LCJpYXQiOjE3NTQ2NDQ5NTd9.9ovanv-yfIAieNHkTJLeuWQ1yPRQFDRyurQAal6EGcU'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:52:39.250 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:52:39.250 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDk1NywiZXhwIjoxNzU0NjczNzU3LCJpYXQiOjE3NTQ2NDQ5NTd9.9ovanv-yfIAieNHkTJLeuWQ1yPRQFDRyurQAal6EGcU'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:52:39.266 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:52:39.266 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDk1NywiZXhwIjoxNzU0NjczNzU3LCJpYXQiOjE3NTQ2NDQ5NTd9.9ovanv-yfIAieNHkTJLeuWQ1yPRQFDRyurQAal6EGcU'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:52:39.266 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:52:39.266 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDk1NywiZXhwIjoxNzU0NjczNzU3LCJpYXQiOjE3NTQ2NDQ5NTd9.9ovanv-yfIAieNHkTJLeuWQ1yPRQFDRyurQAal6EGcU'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:52:39.281 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:52:39.281 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDk1NywiZXhwIjoxNzU0NjczNzU3LCJpYXQiOjE3NTQ2NDQ5NTd9.9ovanv-yfIAieNHkTJLeuWQ1yPRQFDRyurQAal6EGcU'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:52:39.297 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:52:39.297 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDk1NywiZXhwIjoxNzU0NjczNzU3LCJpYXQiOjE3NTQ2NDQ5NTd9.9ovanv-yfIAieNHkTJLeuWQ1yPRQFDRyurQAal6EGcU'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:52:39.297 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:52:39.312 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDk1NywiZXhwIjoxNzU0NjczNzU3LCJpYXQiOjE3NTQ2NDQ5NTd9.9ovanv-yfIAieNHkTJLeuWQ1yPRQFDRyurQAal6EGcU'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:52:39.312 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:52:39.312 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDk1NywiZXhwIjoxNzU0NjczNzU3LCJpYXQiOjE3NTQ2NDQ5NTd9.9ovanv-yfIAieNHkTJLeuWQ1yPRQFDRyurQAal6EGcU'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:52:39.328 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:52:39.328 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDk1NywiZXhwIjoxNzU0NjczNzU3LCJpYXQiOjE3NTQ2NDQ5NTd9.9ovanv-yfIAieNHkTJLeuWQ1yPRQFDRyurQAal6EGcU'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:52:39.437 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60583'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:52:39.437 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDk1NywiZXhwIjoxNzU0NjczNzU3LCJpYXQiOjE3NTQ2NDQ5NTd9.9ovanv-yfIAieNHkTJLeuWQ1yPRQFDRyurQAal6EGcU'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:52:39.581 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReportCategoryandField 
 -1
 ,0
 ,1
 ,0
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:52:39.597 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDk1NywiZXhwIjoxNzU0NjczNzU3LCJpYXQiOjE3NTQ2NDQ5NTd9.9ovanv-yfIAieNHkTJLeuWQ1yPRQFDRyurQAal6EGcU'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:52:39.628 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60584'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:52:39.644 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDk1NywiZXhwIjoxNzU0NjczNzU3LCJpYXQiOjE3NTQ2NDQ5NTd9.9ovanv-yfIAieNHkTJLeuWQ1yPRQFDRyurQAal6EGcU'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:52:39.659 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60585'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:52:39.659 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDk1NywiZXhwIjoxNzU0NjczNzU3LCJpYXQiOjE3NTQ2NDQ5NTd9.9ovanv-yfIAieNHkTJLeuWQ1yPRQFDRyurQAal6EGcU'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:52:39.675 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select * from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0  
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) a --where UStatus like ''%Hold%'' 
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:52:39.675 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDk1NywiZXhwIjoxNzU0NjczNzU3LCJpYXQiOjE3NTQ2NDQ5NTd9.9ovanv-yfIAieNHkTJLeuWQ1yPRQFDRyurQAal6EGcU'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:52:39.675 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select * from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0  
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) a where UnitStatus=''Vacant''
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:52:39.690 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60586'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:52:39.690 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDk1NywiZXhwIjoxNzU0NjczNzU3LCJpYXQiOjE3NTQ2NDQ5NTd9.9ovanv-yfIAieNHkTJLeuWQ1yPRQFDRyurQAal6EGcU'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:52:39.690 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDk1NywiZXhwIjoxNzU0NjczNzU3LCJpYXQiOjE3NTQ2NDQ5NTd9.9ovanv-yfIAieNHkTJLeuWQ1yPRQFDRyurQAal6EGcU'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:52:39.690 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select * from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0  
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) a where UnitStatus=''Occupied'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:52:39.706 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDk1NywiZXhwIjoxNzU0NjczNzU3LCJpYXQiOjE3NTQ2NDQ5NTd9.9ovanv-yfIAieNHkTJLeuWQ1yPRQFDRyurQAal6EGcU'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:52:39.706 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60587'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:52:39.706 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDk1NywiZXhwIjoxNzU0NjczNzU3LCJpYXQiOjE3NTQ2NDQ5NTd9.9ovanv-yfIAieNHkTJLeuWQ1yPRQFDRyurQAal6EGcU'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:52:39.706 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select * from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0  
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) a  where UnitStatus=''Expired'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:52:39.706 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDk1NywiZXhwIjoxNzU0NjczNzU3LCJpYXQiOjE3NTQ2NDQ5NTd9.9ovanv-yfIAieNHkTJLeuWQ1yPRQFDRyurQAal6EGcU'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:52:39.722 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60588'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:52:39.722 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDk1NywiZXhwIjoxNzU0NjczNzU3LCJpYXQiOjE3NTQ2NDQ5NTd9.9ovanv-yfIAieNHkTJLeuWQ1yPRQFDRyurQAal6EGcU'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:52:39.737 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select * from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0  
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) a where UStatus like ''%Case%'' 
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:52:39.737 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDk1NywiZXhwIjoxNzU0NjczNzU3LCJpYXQiOjE3NTQ2NDQ5NTd9.9ovanv-yfIAieNHkTJLeuWQ1yPRQFDRyurQAal6EGcU'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:52:39.753 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60583'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:52:39.753 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDk1NywiZXhwIjoxNzU0NjczNzU3LCJpYXQiOjE3NTQ2NDQ5NTd9.9ovanv-yfIAieNHkTJLeuWQ1yPRQFDRyurQAal6EGcU'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:52:39.784 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 '/*
DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select * from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0  
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) a where UStatus like ''%Reserve%'' 
*/

DECLARE @FROM FLOAT
SET @FROM=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @UnitID BIGINT,@StatusID BIGINT,@TotalAmount FLOAT,@I INT,@COUNT INT,@ContractID BIGINT
DECLARE @NoofDays INT,@VacantSince DATETIME

DECLARE @TAB TABLE(ID INT IDENTITY(1,1) PRIMARY KEY,UnitID BIGINT,CurrentRent FLOAT,Status NVARCHAR(10),NoofDays INT,VacantSince DATETIME,ContractID BIGINT)

INSERT INTO @TAB (UnitID)
SELECT U.UnitID
FROM REN_Units U WITH(NOLOCK) 
LEFT JOIN REN_Property P WITH(NOLOCK) ON P.NodeID=U.PropertyID
LEFT JOIN COM_Lookup LK WITH(NOLOCK) ON U.UnitStatus=LK.NodeID
WHERE U.UnitID>1 AND P.Name <> U.Name AND U.IsGroup=0 AND U.Status=424 and U.UnitStatus=306 
-- AND P.NodeID IN (207)
SELECT @I=1,@COUNT=COUNT(*) FROM @TAB
WHILE(@I<=@COUNT)
BEGIN
	SET @StatusID=0
	SET @TotalAmount=0
	SET @ContractID=0
	SELECT @UnitID=UnitID FROM @TAB WHERE ID=@I

	SELECT TOP 1 @ContractID=(CASE WHEN RefContractID>0 THEN RefContractID ELSE ContractID END),@StatusID=StatusID
	,@VacantSince=(CASE WHEN StatusID = 450 THEN ( CASE WHEN RefundDate IS NOT NULL THEN CONVERT(DATETIME,RefundDate) ELSE CONVERT(DATETIME,VacancyDate) END ) 
			ELSE CONVERT(DATETIME,TerminationDate) END )
	,@NoofDays=(CASE WHEN StatusID = 450 THEN (CASE WHEN RefundDate IS NOT NULL THEN DATEDIFF(DAY, CONVERT(DATETIME,RefundDate),CONVERT(DATETIME,@FROM) ) 
			ELSE DATEDIFF(DAY, CONVERT(DATETIME,VacancyDate),CONVERT(DATETIME,@FROM) ) END )
			ELSE DATEDIFF(DAY, CONVERT(DATETIME,TerminationDate),CONVERT(DATETIME,@FROM) ) END )  
	FROM REN_Contract WITH(NOLOCK) WHERE StatusID<>451 AND StartDate<@FROM AND UNITID=@UnitID 
	ORDER BY StartDate DESC,StatusID
	
	SELECT @TotalAmount=ISNULL(SUM(RPD.Amount),MAX(RentAmount)/(CASE WHEN MAX(RC.NoOfUnits)=0 THEN 1 ELSE MAX(RC.NoOfUnits) END)) 
	FROM REN_Contract RC WITH(NOLOCK)
	JOIN REN_ContractParticulars RP WITH(NOLOCK) ON RP.ContractID=RC.ContractID AND RP.Sno=1
	LEFT JOIN REN_ContractParticularsDetail RPD WITH(NOLOCK) ON RPD.ParticularNodeID=RP.NodeID AND RPD.Unit=@UnitID 
	AND @FROM BETWEEN ISNULL(RPD.FromDate,@FROM) AND ISNULL(RPD.ToDate,@FROM)
	WHERE RC.ContractID=@ContractID
	
	IF @StatusID=427 OR @StatusID=426 OR @StatusID=466
	BEGIN
		UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Occupied'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
	END
	ELSE IF @StatusID=440
	BEGIN
		UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''UnAproved'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
	END
	ELSE IF @StatusID=428 OR @StatusID=450
	BEGIN 
		IF EXISTS (SELECT * FROM REN_Quotation WITH(NOLOCK) WHERE COSTCENTERID=129 AND UNITID=@UnitID AND CONVERT(DATETIME,@FROM) BETWEEN CONVERT(DATETIME,STARTDATE) AND CONVERT(DATETIME,ENDDATE) and statusid=467 )
			UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Reserved'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
		ELSE IF EXISTS (SELECT * FROM REN_Quotation WITH(NOLOCK) WHERE COSTCENTERID=103 AND UNITID=@UnitID AND CONVERT(DATETIME,@FROM) BETWEEN CONVERT(DATETIME,STARTDATE) AND CONVERT(DATETIME,ENDDATE) and statusid=426 )
			UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Quoted'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
		ELSE
			UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Vacant'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
	END
	ELSE
	BEGIN 
		IF EXISTS (SELECT * FROM REN_Quotation WITH(NOLOCK) WHERE COSTCENTERID=129 AND UNITID=@UnitID AND CONVERT(DATETIME,@FROM) BETWEEN CONVERT(DATETIME,STARTDATE) AND CONVERT(DATETIME,ENDDATE) and statusid=467 )
			UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Reserved'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
		ELSE IF EXISTS (SELECT * FROM REN_Quotation WITH(NOLOCK) WHERE COSTCENTERID=103 AND UNITID=@UnitID AND CONVERT(DATETIME,@FROM) BETWEEN CONVERT(DATETIME,STARTDATE) AND CONVERT(DATETIME,ENDDATE) and statusid=426 )
			UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Quoted'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
		ELSE
			UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Vacant'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
	END
	set @I=@I+1
END

select * from (
SELECT TEMP.*,RP.NodeID Building_ID,RP.NAME Property,TEMP.UnitID Unit_ID,RU.NAME Unit,C18.NAME UnitType,RU.UnitStatus,RU.RentableArea UnitArea,RU.RentPerSQFT UnitRate
,RU.AnnualRent 
,T.FirstName AS [C98c7d2679f99489e9f0e010026eeb563]
,RUL.Name LandLord , RUC.Name Location 
,1 Cnt
FROM @TAB TEMP
JOIN REN_Units RU WITH(NOLOCK) ON TEMP.UnitID=RU.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
LEFT JOIN COM_CC50018 C18 WITH(NOLOCK) ON C18.NodeID=RU.NodeID
LEFT JOIN REN_Contract C WITH(NOLOCK) ON TEMP.ContractID=C.ContractID
LEFT JOIN REN_Tenant T WITH(NOLOCK) ON T.TenantID=C.TenantID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID

 )a where a.Status =''Reserved''
 order by Property,VacantSince'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:52:39.784 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDk1NywiZXhwIjoxNzU0NjczNzU3LCJpYXQiOjE3NTQ2NDQ5NTd9.9ovanv-yfIAieNHkTJLeuWQ1yPRQFDRyurQAal6EGcU'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:52:39.784 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60584'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:52:39.784 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDk1NywiZXhwIjoxNzU0NjczNzU3LCJpYXQiOjE3NTQ2NDQ5NTd9.9ovanv-yfIAieNHkTJLeuWQ1yPRQFDRyurQAal6EGcU'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:52:39.800 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select * from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0  
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) a --where UStatus like ''%Hold%'' 
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:52:39.800 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDk1NywiZXhwIjoxNzU0NjczNzU3LCJpYXQiOjE3NTQ2NDQ5NTd9.9ovanv-yfIAieNHkTJLeuWQ1yPRQFDRyurQAal6EGcU'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:52:39.815 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select * from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0  
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) a where UnitStatus=''Vacant''
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:52:39.815 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDk1NywiZXhwIjoxNzU0NjczNzU3LCJpYXQiOjE3NTQ2NDQ5NTd9.9ovanv-yfIAieNHkTJLeuWQ1yPRQFDRyurQAal6EGcU'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:52:39.831 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60585'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:52:39.831 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDk1NywiZXhwIjoxNzU0NjczNzU3LCJpYXQiOjE3NTQ2NDQ5NTd9.9ovanv-yfIAieNHkTJLeuWQ1yPRQFDRyurQAal6EGcU'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:52:39.847 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select * from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0  
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) a where UnitStatus=''Occupied'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:52:39.847 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDk1NywiZXhwIjoxNzU0NjczNzU3LCJpYXQiOjE3NTQ2NDQ5NTd9.9ovanv-yfIAieNHkTJLeuWQ1yPRQFDRyurQAal6EGcU'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:52:39.862 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60586'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:52:39.862 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDk1NywiZXhwIjoxNzU0NjczNzU3LCJpYXQiOjE3NTQ2NDQ5NTd9.9ovanv-yfIAieNHkTJLeuWQ1yPRQFDRyurQAal6EGcU'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:52:39.878 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select * from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0  
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) a  where UnitStatus=''Expired'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:52:39.878 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDk1NywiZXhwIjoxNzU0NjczNzU3LCJpYXQiOjE3NTQ2NDQ5NTd9.9ovanv-yfIAieNHkTJLeuWQ1yPRQFDRyurQAal6EGcU'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:52:40.065 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60587'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:52:40.065 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDk1NywiZXhwIjoxNzU0NjczNzU3LCJpYXQiOjE3NTQ2NDQ5NTd9.9ovanv-yfIAieNHkTJLeuWQ1yPRQFDRyurQAal6EGcU'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:52:40.112 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select * from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0  
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) a where UStatus like ''%Case%'' 
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:52:40.112 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDk1NywiZXhwIjoxNzU0NjczNzU3LCJpYXQiOjE3NTQ2NDQ5NTd9.9ovanv-yfIAieNHkTJLeuWQ1yPRQFDRyurQAal6EGcU'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:52:40.284 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60588'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:52:40.284 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDk1NywiZXhwIjoxNzU0NjczNzU3LCJpYXQiOjE3NTQ2NDQ5NTd9.9ovanv-yfIAieNHkTJLeuWQ1yPRQFDRyurQAal6EGcU'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:52:40.362 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 '/*
DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select * from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0  
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) a where UStatus like ''%Reserve%'' 
*/

DECLARE @FROM FLOAT
SET @FROM=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @UnitID BIGINT,@StatusID BIGINT,@TotalAmount FLOAT,@I INT,@COUNT INT,@ContractID BIGINT
DECLARE @NoofDays INT,@VacantSince DATETIME

DECLARE @TAB TABLE(ID INT IDENTITY(1,1) PRIMARY KEY,UnitID BIGINT,CurrentRent FLOAT,Status NVARCHAR(10),NoofDays INT,VacantSince DATETIME,ContractID BIGINT)

INSERT INTO @TAB (UnitID)
SELECT U.UnitID
FROM REN_Units U WITH(NOLOCK) 
LEFT JOIN REN_Property P WITH(NOLOCK) ON P.NodeID=U.PropertyID
LEFT JOIN COM_Lookup LK WITH(NOLOCK) ON U.UnitStatus=LK.NodeID
WHERE U.UnitID>1 AND P.Name <> U.Name AND U.IsGroup=0 AND U.Status=424 and U.UnitStatus=306 
-- AND P.NodeID IN (207)
SELECT @I=1,@COUNT=COUNT(*) FROM @TAB
WHILE(@I<=@COUNT)
BEGIN
	SET @StatusID=0
	SET @TotalAmount=0
	SET @ContractID=0
	SELECT @UnitID=UnitID FROM @TAB WHERE ID=@I

	SELECT TOP 1 @ContractID=(CASE WHEN RefContractID>0 THEN RefContractID ELSE ContractID END),@StatusID=StatusID
	,@VacantSince=(CASE WHEN StatusID = 450 THEN ( CASE WHEN RefundDate IS NOT NULL THEN CONVERT(DATETIME,RefundDate) ELSE CONVERT(DATETIME,VacancyDate) END ) 
			ELSE CONVERT(DATETIME,TerminationDate) END )
	,@NoofDays=(CASE WHEN StatusID = 450 THEN (CASE WHEN RefundDate IS NOT NULL THEN DATEDIFF(DAY, CONVERT(DATETIME,RefundDate),CONVERT(DATETIME,@FROM) ) 
			ELSE DATEDIFF(DAY, CONVERT(DATETIME,VacancyDate),CONVERT(DATETIME,@FROM) ) END )
			ELSE DATEDIFF(DAY, CONVERT(DATETIME,TerminationDate),CONVERT(DATETIME,@FROM) ) END )  
	FROM REN_Contract WITH(NOLOCK) WHERE StatusID<>451 AND StartDate<@FROM AND UNITID=@UnitID 
	ORDER BY StartDate DESC,StatusID
	
	SELECT @TotalAmount=ISNULL(SUM(RPD.Amount),MAX(RentAmount)/(CASE WHEN MAX(RC.NoOfUnits)=0 THEN 1 ELSE MAX(RC.NoOfUnits) END)) 
	FROM REN_Contract RC WITH(NOLOCK)
	JOIN REN_ContractParticulars RP WITH(NOLOCK) ON RP.ContractID=RC.ContractID AND RP.Sno=1
	LEFT JOIN REN_ContractParticularsDetail RPD WITH(NOLOCK) ON RPD.ParticularNodeID=RP.NodeID AND RPD.Unit=@UnitID 
	AND @FROM BETWEEN ISNULL(RPD.FromDate,@FROM) AND ISNULL(RPD.ToDate,@FROM)
	WHERE RC.ContractID=@ContractID
	
	IF @StatusID=427 OR @StatusID=426 OR @StatusID=466
	BEGIN
		UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Occupied'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
	END
	ELSE IF @StatusID=440
	BEGIN
		UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''UnAproved'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
	END
	ELSE IF @StatusID=428 OR @StatusID=450
	BEGIN 
		IF EXISTS (SELECT * FROM REN_Quotation WITH(NOLOCK) WHERE COSTCENTERID=129 AND UNITID=@UnitID AND CONVERT(DATETIME,@FROM) BETWEEN CONVERT(DATETIME,STARTDATE) AND CONVERT(DATETIME,ENDDATE) and statusid=467 )
			UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Reserved'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
		ELSE IF EXISTS (SELECT * FROM REN_Quotation WITH(NOLOCK) WHERE COSTCENTERID=103 AND UNITID=@UnitID AND CONVERT(DATETIME,@FROM) BETWEEN CONVERT(DATETIME,STARTDATE) AND CONVERT(DATETIME,ENDDATE) and statusid=426 )
			UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Quoted'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
		ELSE
			UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Vacant'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
	END
	ELSE
	BEGIN 
		IF EXISTS (SELECT * FROM REN_Quotation WITH(NOLOCK) WHERE COSTCENTERID=129 AND UNITID=@UnitID AND CONVERT(DATETIME,@FROM) BETWEEN CONVERT(DATETIME,STARTDATE) AND CONVERT(DATETIME,ENDDATE) and statusid=467 )
			UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Reserved'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
		ELSE IF EXISTS (SELECT * FROM REN_Quotation WITH(NOLOCK) WHERE COSTCENTERID=103 AND UNITID=@UnitID AND CONVERT(DATETIME,@FROM) BETWEEN CONVERT(DATETIME,STARTDATE) AND CONVERT(DATETIME,ENDDATE) and statusid=426 )
			UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Quoted'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
		ELSE
			UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Vacant'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
	END
	set @I=@I+1
END

select * from (
SELECT TEMP.*,RP.NodeID Building_ID,RP.NAME Property,TEMP.UnitID Unit_ID,RU.NAME Unit,C18.NAME UnitType,RU.UnitStatus,RU.RentableArea UnitArea,RU.RentPerSQFT UnitRate
,RU.AnnualRent 
,T.FirstName AS [C98c7d2679f99489e9f0e010026eeb563]
,RUL.Name LandLord , RUC.Name Location 
,1 Cnt
FROM @TAB TEMP
JOIN REN_Units RU WITH(NOLOCK) ON TEMP.UnitID=RU.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
LEFT JOIN COM_CC50018 C18 WITH(NOLOCK) ON C18.NodeID=RU.NodeID
LEFT JOIN REN_Contract C WITH(NOLOCK) ON TEMP.ContractID=C.ContractID
LEFT JOIN REN_Tenant T WITH(NOLOCK) ON T.TenantID=C.TenantID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID

 )a where a.Status =''Reserved''
 order by Property,VacantSince'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:52:40.362 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDk1NywiZXhwIjoxNzU0NjczNzU3LCJpYXQiOjE3NTQ2NDQ5NTd9.9ovanv-yfIAieNHkTJLeuWQ1yPRQFDRyurQAal6EGcU'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:52:42.284 | General Service|:: CompanyIndex:53 SpName: spADM_GetCostCenterGridViewList 
 2
 ,1
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:52:42.284 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDk1NywiZXhwIjoxNzU0NjczNzU3LCJpYXQiOjE3NTQ2NDQ5NTd9.9ovanv-yfIAieNHkTJLeuWQ1yPRQFDRyurQAal6EGcU'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:52:42.331 | General Service|:: CompanyIndex:53 SpName: spCom_GetCostCenterSummary 
 126
 ,-1
 ,1000
 ,''
 ,''
 ,''
 ,0
 ,'08-Aug-2025'
 ,NULL
 ,''
 ,1
 ,1
 ,0
 ,0
 ,False
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:52:42.331 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NDk1NywiZXhwIjoxNzU0NjczNzU3LCJpYXQiOjE3NTQ2NDQ5NTd9.9ovanv-yfIAieNHkTJLeuWQ1yPRQFDRyurQAal6EGcU'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:53:01.993 | General Service|:: CompanyIndex:0 SpName: spADM_GetClientUserDetails2C 
 'admin'
 ,1
 ,0
[System: 192.168.1.99] DEBUG | 08-08-2025 14:53:02.056 | General Service|:: CompanyIndex:0 SpName: spADM_UserLoginCheck 
 2
 ,'admin'
 ,0
 ,'192.168.1.99'
 ,'192.168.1.99'
 ,''
 ,'Web'
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:53:37.007 | General Service|:: CompanyIndex:111 SpName: spADM_GetClientUserDetails 
 'admin'
 ,1
 ,'26.2.9'
 ,0
[System: 192.168.1.99] DEBUG | 08-08-2025 14:53:37.100 | General Service|:: CompanyIndex:0 SpName: spADM_UserLoginCheck 
 2
 ,'admin'
 ,111
 ,'192.168.1.99'
 ,'192.168.1.99'
 ,''
 ,'Web'
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:53:37.100 | General Service|:: CompanyIndex:0 SpName: spADM_Login 
 1
 ,''
 ,''
 ,''
 ,''
 ,''
 ,111
[System: 192.168.1.99] DEBUG | 08-08-2025 14:53:37.163 | General Service|:: CompanyIndex:111 SpName: spADM_GetDataSet 
 'select Value from ADM_GlobalPreferences with (nolock) where name =''EnableReLogin'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:53:37.179 | General Service|:: CompanyIndex:111 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTExLDEiLCJuYmYiOjE3NTQ2NDUwMTcsImV4cCI6MTc1NDY3MzgxNywiaWF0IjoxNzU0NjQ1MDE3fQ.RvpPkR9adXJeEiOlh5ZFXjmuEdQcVlKOhcBG9V3sCxk'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:53:37.210 | General Service|:: CompanyIndex:0 SpName: spADM_Login 
 4
 ,''
 ,''
 ,''
 ,'declare @Cnt int,@ExpiredGUID nvarchar(50),@AllowSession int,@GUID nvarchar(50),@CurrDate float,@UserID INT,@Instances INT,@InstancesExists INT,@LCDBIndex int
set @CurrDate= convert(float,dateadd(minute,-21,getdate()))
set @AllowSession=0
set @GUID=''6f26f8fb-a27a-47f6-aa36-8b51e048b7bd''
set @LCDBIndex=0
select top 1 @UserID=UserID,@Instances=InstanceCount from ADM_Users with(nolock) where UserName=''admin''
if exists(select [GUID] from ADM_Login with(nolock) where [GUID]=@GUID)
begin
	update ADM_Login 
	set LastAccessTime=convert(float,getdate()),UserID=@UserID
	where [GUID]=@GUID
    set @AllowSession=1
end
else
begin
	select @Cnt=count(*) from ADM_Login with(nolock) where LCDBIndex=@LCDBIndex and [GUID]!=''ACCESSRIGHTS'' and AP =''WEB''
    if(@Cnt<100)
		set @AllowSession=1
	else
	begin
		select top 1 @ExpiredGUID=[GUID] from ADM_Login with(nolock)
		where [GUID]!=''ACCESSRIGHTS'' and LCDBIndex=@LCDBIndex and LastAccessTime<@CurrDate  and AP =''WEB''
        order by LastAccessTime asc
		if @ExpiredGUID is not null
		begin
			delete from ADM_Login where [GUID]=@ExpiredGUID
			set @AllowSession=1
		end
	end
	if @AllowSession=1
	begin
        select @InstancesExists=COUNT(*) from ADM_Login with(nolock)
		where [GUID]!=''ACCESSRIGHTS'' and LCDBIndex=@LCDBIndex and LastAccessTime>=@CurrDate and UserID=@UserID and AP =''WEB''
		if(@Instances!=0 and @Instances<=@InstancesExists)
			set @AllowSession=2
		else
		    INSERT INTO ADM_Login([GUID],[SysName],IPAddress,[Status],LoginTime,LastAccessTime,AccessRights,UserID,DBIndex,LCDBIndex,AP)
		    VALUES(@GUID,''WEB'',''192.168.1.99'',1,convert(float,getdate()),convert(float,getdate()),null,@UserID,111,@LCDBIndex, ''WEB'')
	end
end

select @AllowSession AllowSession,@Instances Instances,@InstancesExists InstancesExists
'
 ,''
 ,0
[System: 192.168.1.99] DEBUG | 08-08-2025 14:53:37.225 | General Service|:: CompanyIndex:111 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTExLDEiLCJuYmYiOjE3NTQ2NDUwMTcsImV4cCI6MTc1NDY3MzgxNywiaWF0IjoxNzU0NjQ1MDE3fQ.RvpPkR9adXJeEiOlh5ZFXjmuEdQcVlKOhcBG9V3sCxk'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:53:37.429 | General Service|:: CompanyIndex:111 SpName: spADM_GetDataSet 
 'SELECT (SELECT COUNT(*) FROM COM_Location L WITH(NOLOCK) JOIN COM_Status S WITH(NOLOCK) ON S.StatusID=L.StatusID WHERE L.IsGroup=0 AND S.[Status]=''Active'') ML
,(SELECT COUNT(*) FROM ADM_Features WITH(NOLOCK) WHERE ((FeatureID>50000 AND FeatureID<=50050) OR FeatureID>=51000) AND IsEnabled=1) MD
,(SELECT ISNULL(COUNT(*),0) FROM ADM_RevenUReports WITH(NOLOCK) WHERE IsGroup=0 AND ReportID>10000 AND StaticReportType IN (0,-1)) MR'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:53:37.429 | General Service|:: CompanyIndex:111 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTExLDEiLCJuYmYiOjE3NTQ2NDUwMTcsImV4cCI6MTc1NDY3MzgxNywiaWF0IjoxNzU0NjQ1MDE3fQ.RvpPkR9adXJeEiOlh5ZFXjmuEdQcVlKOhcBG9V3sCxk'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:53:37.538 | General Service|:: CompanyIndex:111 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.99] DEBUG | 08-08-2025 14:53:37.553 | General Service|:: CompanyIndex:111 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTExLDEiLCJuYmYiOjE3NTQ2NDUwMTcsImV4cCI6MTc1NDY3MzgxNywiaWF0IjoxNzU0NjQ1MDE3fQ.RvpPkR9adXJeEiOlh5ZFXjmuEdQcVlKOhcBG9V3sCxk'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:53:40.850 | General Service|:: CompanyIndex:111 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:53:40.850 | General Service|:: CompanyIndex:111 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTExLDEiLCJuYmYiOjE3NTQ2NDUwMTcsImV4cCI6MTc1NDY3MzgxNywiaWF0IjoxNzU0NjQ1MDE3fQ.RvpPkR9adXJeEiOlh5ZFXjmuEdQcVlKOhcBG9V3sCxk'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-08-2025 14:53:50.630 | General Service|:: CompanyIndex:111 SpName: spADM_GetRibbonView 
 1
 ,1
 ,1
 ,1
 ,0
 ,''
[System: 192.168.1.99] DEBUG | 08-08-2025 14:53:50.630 | General Service|:: CompanyIndex:111 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTExLDEiLCJuYmYiOjE3NTQ2NDUwMTcsImV4cCI6MTc1NDY3MzgxNywiaWF0IjoxNzU0NjQ1MDE3fQ.RvpPkR9adXJeEiOlh5ZFXjmuEdQcVlKOhcBG9V3sCxk'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:54:32.504 | General Service|:: CompanyIndex:0 SpName: spADM_GetClientUserDetails2C 
 'admin'
 ,1
 ,0
[System: 192.168.1.73] DEBUG | 08-08-2025 14:54:32.566 | General Service|:: CompanyIndex:0 SpName: spADM_UserLoginCheck 
 2
 ,'admin'
 ,0
 ,'192.168.1.73'
 ,'192.168.1.73'
 ,''
 ,'Web'
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:54:48.521 | General Service|:: CompanyIndex:0 SpName: spADM_GetClientUserDetails2C 
 'admin'
 ,1
 ,0
[System: 192.168.1.73] DEBUG | 08-08-2025 14:54:48.568 | General Service|:: CompanyIndex:0 SpName: spADM_UserLoginCheck 
 2
 ,'admin'
 ,0
 ,'192.168.1.73'
 ,'192.168.1.73'
 ,''
 ,'Web'
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:54:53.152 | General Service|:: CompanyIndex:53 SpName: spADM_GetClientUserDetails 
 'admin'
 ,1
 ,'26.2.9'
 ,0
[System: 192.168.1.73] DEBUG | 08-08-2025 14:54:53.230 | General Service|:: CompanyIndex:0 SpName: spADM_UserLoginCheck 
 2
 ,'admin'
 ,53
 ,'192.168.1.73'
 ,'192.168.1.73'
 ,''
 ,'Web'
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:54:53.246 | General Service|:: CompanyIndex:0 SpName: spADM_Login 
 1
 ,''
 ,''
 ,''
 ,''
 ,''
 ,53
[System: 192.168.1.73] DEBUG | 08-08-2025 14:54:53.246 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select Value from ADM_GlobalPreferences with (nolock) where name =''EnableReLogin'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:54:53.246 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTA5MywiZXhwIjoxNzU0NjczODkzLCJpYXQiOjE3NTQ2NDUwOTN9.w-Kvhm1ZfZVdcW_wGEABzUDnDPLfNw3ZXp10OoRLjdc'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:54:53.277 | General Service|:: CompanyIndex:0 SpName: spADM_Login 
 4
 ,''
 ,''
 ,''
 ,'declare @Cnt int,@ExpiredGUID nvarchar(50),@AllowSession int,@GUID nvarchar(50),@CurrDate float,@UserID INT,@Instances INT,@InstancesExists INT,@LCDBIndex int
set @CurrDate= convert(float,dateadd(minute,-21,getdate()))
set @AllowSession=0
set @GUID=''97b9ec5a-09a6-44cb-bd07-8cd0ab4bd2dc''
set @LCDBIndex=0
select top 1 @UserID=UserID,@Instances=InstanceCount from ADM_Users with(nolock) where UserName=''admin''
if exists(select [GUID] from ADM_Login with(nolock) where [GUID]=@GUID)
begin
	update ADM_Login 
	set LastAccessTime=convert(float,getdate()),UserID=@UserID
	where [GUID]=@GUID
    set @AllowSession=1
end
else
begin
	select @Cnt=count(*) from ADM_Login with(nolock) where LCDBIndex=@LCDBIndex and [GUID]!=''ACCESSRIGHTS'' and AP =''WEB''
    if(@Cnt<100)
		set @AllowSession=1
	else
	begin
		select top 1 @ExpiredGUID=[GUID] from ADM_Login with(nolock)
		where [GUID]!=''ACCESSRIGHTS'' and LCDBIndex=@LCDBIndex and LastAccessTime<@CurrDate  and AP =''WEB''
        order by LastAccessTime asc
		if @ExpiredGUID is not null
		begin
			delete from ADM_Login where [GUID]=@ExpiredGUID
			set @AllowSession=1
		end
	end
	if @AllowSession=1
	begin
        select @InstancesExists=COUNT(*) from ADM_Login with(nolock)
		where [GUID]!=''ACCESSRIGHTS'' and LCDBIndex=@LCDBIndex and LastAccessTime>=@CurrDate and UserID=@UserID and AP =''WEB''
		if(@Instances!=0 and @Instances<=@InstancesExists)
			set @AllowSession=2
		else
		    INSERT INTO ADM_Login([GUID],[SysName],IPAddress,[Status],LoginTime,LastAccessTime,AccessRights,UserID,DBIndex,LCDBIndex,AP)
		    VALUES(@GUID,''WEB'',''192.168.1.73'',1,convert(float,getdate()),convert(float,getdate()),null,@UserID,53,@LCDBIndex, ''WEB'')
	end
end

select @AllowSession AllowSession,@Instances Instances,@InstancesExists InstancesExists
'
 ,''
 ,0
[System: 192.168.1.73] DEBUG | 08-08-2025 14:54:53.293 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTA5MywiZXhwIjoxNzU0NjczODkzLCJpYXQiOjE3NTQ2NDUwOTN9.w-Kvhm1ZfZVdcW_wGEABzUDnDPLfNw3ZXp10OoRLjdc'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:54:53.293 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT (SELECT COUNT(*) FROM COM_Location L WITH(NOLOCK) JOIN COM_Status S WITH(NOLOCK) ON S.StatusID=L.StatusID WHERE L.IsGroup=0 AND S.[Status]=''Active'') ML
,(SELECT COUNT(*) FROM ADM_Features WITH(NOLOCK) WHERE ((FeatureID>50000 AND FeatureID<=50050) OR FeatureID>=51000) AND IsEnabled=1) MD
,(SELECT ISNULL(COUNT(*),0) FROM ADM_RevenUReports WITH(NOLOCK) WHERE IsGroup=0 AND ReportID>10000 AND StaticReportType IN (0,-1)) MR'
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:54:53.293 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTA5MywiZXhwIjoxNzU0NjczODkzLCJpYXQiOjE3NTQ2NDUwOTN9.w-Kvhm1ZfZVdcW_wGEABzUDnDPLfNw3ZXp10OoRLjdc'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:54:53.308 | General Service|:: CompanyIndex:53 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.73] DEBUG | 08-08-2025 14:54:53.308 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTA5MywiZXhwIjoxNzU0NjczODkzLCJpYXQiOjE3NTQ2NDUwOTN9.w-Kvhm1ZfZVdcW_wGEABzUDnDPLfNw3ZXp10OoRLjdc'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:54:53.527 | General Service|:: CompanyIndex:53 SpName: spADM_GetRibbonView 
 1
 ,1
 ,1
 ,1
 ,0
 ,''
[System: 192.168.1.73] DEBUG | 08-08-2025 14:54:53.527 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTA5MywiZXhwIjoxNzU0NjczODkzLCJpYXQiOjE3NTQ2NDUwOTN9.w-Kvhm1ZfZVdcW_wGEABzUDnDPLfNw3ZXp10OoRLjdc'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:54:53.766 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 2
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:54:53.766 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTA5MywiZXhwIjoxNzU0NjczODkzLCJpYXQiOjE3NTQ2NDUwOTN9.w-Kvhm1ZfZVdcW_wGEABzUDnDPLfNw3ZXp10OoRLjdc'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:54:53.781 | General Service|:: CompanyIndex:53 SpName: spADM_GetDashBoard 
 2
 ,0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:54:53.781 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTA5MywiZXhwIjoxNzU0NjczODkzLCJpYXQiOjE3NTQ2NDUwOTN9.w-Kvhm1ZfZVdcW_wGEABzUDnDPLfNw3ZXp10OoRLjdc'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:54:53.797 | General Service|:: CompanyIndex:53 SpName: spCOM_ConfigValues 
 1
 ,'LandingDocs'
 ,'1'
[System: 192.168.1.73] DEBUG | 08-08-2025 14:54:53.812 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTA5MywiZXhwIjoxNzU0NjczODkzLCJpYXQiOjE3NTQ2NDUwOTN9.w-Kvhm1ZfZVdcW_wGEABzUDnDPLfNw3ZXp10OoRLjdc'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:54:53.843 | General Service|:: CompanyIndex:53 SpName: spCOM_GetFavorites 
 'GETLIST0'
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:54:53.859 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTA5MywiZXhwIjoxNzU0NjczODkzLCJpYXQiOjE3NTQ2NDUwOTN9.w-Kvhm1ZfZVdcW_wGEABzUDnDPLfNw3ZXp10OoRLjdc'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:54:53.859 | General Service|:: CompanyIndex:53 SpName: spADM_GetAllListViewsDef 
 1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:54:53.859 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTA5MywiZXhwIjoxNzU0NjczODkzLCJpYXQiOjE3NTQ2NDUwOTN9.w-Kvhm1ZfZVdcW_wGEABzUDnDPLfNw3ZXp10OoRLjdc'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:54:53.968 | General Service|:: CompanyIndex:53 SpName: spADM_GetAllListViewsDef 
 1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:54:53.984 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTA5MywiZXhwIjoxNzU0NjczODkzLCJpYXQiOjE3NTQ2NDUwOTN9.w-Kvhm1ZfZVdcW_wGEABzUDnDPLfNw3ZXp10OoRLjdc'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:54:54.109 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'Select CostCenterID,CostCenterColID,CostCenterName,SysTableName,UserColumnName,SysColumnName,ISNULL(UserDefaultValue,'''') UserDefaultValue
From AdM_CostCenterDef WITH(NOLOCK)
Where SysColumnName IN(''CreditAccount'',''DebitAccount'',''ProductID'') 
AND CostCenterID>40000 AND CostCenterID<50000 

SELECT * FROM ADM_Features WITH(NOLOCK) '
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:54:54.109 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTA5MywiZXhwIjoxNzU0NjczODkzLCJpYXQiOjE3NTQ2NDUwOTN9.w-Kvhm1ZfZVdcW_wGEABzUDnDPLfNw3ZXp10OoRLjdc'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:54:54.156 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 '  SELECT * FROM PAY_PayrollPreferences WITH(NOLOCK) '
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:54:54.156 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTA5MywiZXhwIjoxNzU0NjczODkzLCJpYXQiOjE3NTQ2NDUwOTN9.w-Kvhm1ZfZVdcW_wGEABzUDnDPLfNw3ZXp10OoRLjdc'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:54:54.187 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 '  --0
                                Select * FROM COM_CC50051 WITH(NOLOCK) WHERE IsGroup=0 AND LoginUserID=''admin''
                                --1                                
                                Select * FROM COM_CC50051 WITH(NOLOCK) WHERE RptManager IN (Select NodeID FROM COM_CC50051 WITH(NOLOCK) WHERE IsGroup=0 AND LoginUserID=''admin'')
                                UNION ALL
                                Select * FROM COM_CC50051 WITH(NOLOCK) WHERE RptManager IN 
                                (
	                                Select NodeID FROM COM_CC50051 WITH(NOLOCK) 
	                                WHERE IsGroup=0 AND LoginUserID IN
	                                (
	                                SELECT fe.LoginUserID
	                                FROM INV_DocDetails a WITH(NOLOCK) 
	                                JOIN COM_DocCCData b WITH(NOLOCK) ON b.InvDocDetailsID=a.InvDocDetailsID
	                                JOIN COM_DocNumData c WITH(NOLOCK) ON c.InvDocDetailsID=a.InvDocDetailsID
	                                JOIN COM_DocTextData d WITH(NOLOCK) ON d.InvDocDetailsID=a.InvDocDetailsID
	                                JOIN COM_CC50051 fe WITH(NOLOCK) on fe.NodeID=b.dcCCNID51
	                                JOIN COM_CC50051 te WITH(NOLOCK) on CONVERT(NVARCHAR,te.NodeID)=d.dcAlpha1
	                                WHERE a.CostCenterID=40098 and a.StatusID=369 AND d.dcAlpha3=''Temporary''
	                                AND te.LoginUserID=''admin'' 
	                                AND ISDATE(d.dcAlpha4)=1 AND ISDATE(d.dcAlpha5)=1 
	                                AND CONVERT(DATETIME,''08 Aug 2025'') BETWEEN CONVERT(DATETIME,d.dcAlpha4) AND CONVERT(DATETIME,d.dcAlpha5)
	                                )
                                )
                                --2
                                Select * FROM ADM_USERS WITH(NOLOCK) WHERE USERID=1
                                --3
                                Select * FROM COM_CostCenterCostCenterMap WITH(NOLOCK) WHERE ParentCostCenterID=7 AND ParentNodeID=1
                                --4                                
                                Select * FROM COM_CostCenterCostCenterMap WITH(NOLOCK) WHERE ParentCostCenterID=7 AND ParentNodeID=1
                                AND CostCenterID IN(Select ColumnCostCenterID From ADM_CostCenterDef Where CostCenterID=50051 AND IsColumnInUse=1 AND SysColumnName LIKE ''CCNID%'')
                                --5
                                Select * from COM_Files WITH(NOLOCK) WHERE FeatureID=50051 AND FeaturePK IN (Select NodeID FROM COM_CC50051 WITH(NOLOCK) WHERE IsGroup=0 AND LoginUserID=''admin'')                         
'
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:54:54.187 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTA5MywiZXhwIjoxNzU0NjczODkzLCJpYXQiOjE3NTQ2NDUwOTN9.w-Kvhm1ZfZVdcW_wGEABzUDnDPLfNw3ZXp10OoRLjdc'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:54:54.390 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:54:54.390 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTA5MywiZXhwIjoxNzU0NjczODkzLCJpYXQiOjE3NTQ2NDUwOTN9.w-Kvhm1ZfZVdcW_wGEABzUDnDPLfNw3ZXp10OoRLjdc'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:54:54.687 | General Service|:: CompanyIndex:53 SpName: spADM_GetDashBoard 
 1
 ,41
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:54:54.687 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTA5MywiZXhwIjoxNzU0NjczODkzLCJpYXQiOjE3NTQ2NDUwOTN9.w-Kvhm1ZfZVdcW_wGEABzUDnDPLfNw3ZXp10OoRLjdc'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:54:54.703 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,60583
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:54:54.703 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,60585
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:54:54.718 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,60586
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:54:54.718 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTA5MywiZXhwIjoxNzU0NjczODkzLCJpYXQiOjE3NTQ2NDUwOTN9.w-Kvhm1ZfZVdcW_wGEABzUDnDPLfNw3ZXp10OoRLjdc'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:54:54.718 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,60584
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:54:54.718 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,60588
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:54:54.718 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTA5MywiZXhwIjoxNzU0NjczODkzLCJpYXQiOjE3NTQ2NDUwOTN9.w-Kvhm1ZfZVdcW_wGEABzUDnDPLfNw3ZXp10OoRLjdc'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:54:54.718 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,60587
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:54:54.718 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTA5MywiZXhwIjoxNzU0NjczODkzLCJpYXQiOjE3NTQ2NDUwOTN9.w-Kvhm1ZfZVdcW_wGEABzUDnDPLfNw3ZXp10OoRLjdc'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:54:54.718 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTA5MywiZXhwIjoxNzU0NjczODkzLCJpYXQiOjE3NTQ2NDUwOTN9.w-Kvhm1ZfZVdcW_wGEABzUDnDPLfNw3ZXp10OoRLjdc'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:54:54.734 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTA5MywiZXhwIjoxNzU0NjczODkzLCJpYXQiOjE3NTQ2NDUwOTN9.w-Kvhm1ZfZVdcW_wGEABzUDnDPLfNw3ZXp10OoRLjdc'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:54:54.734 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTA5MywiZXhwIjoxNzU0NjczODkzLCJpYXQiOjE3NTQ2NDUwOTN9.w-Kvhm1ZfZVdcW_wGEABzUDnDPLfNw3ZXp10OoRLjdc'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:54:54.734 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:54:54.734 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,60585
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:54:54.734 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTA5MywiZXhwIjoxNzU0NjczODkzLCJpYXQiOjE3NTQ2NDUwOTN9.w-Kvhm1ZfZVdcW_wGEABzUDnDPLfNw3ZXp10OoRLjdc'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:54:54.734 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,60584
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:54:54.734 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTA5MywiZXhwIjoxNzU0NjczODkzLCJpYXQiOjE3NTQ2NDUwOTN9.w-Kvhm1ZfZVdcW_wGEABzUDnDPLfNw3ZXp10OoRLjdc'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:54:54.734 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTA5MywiZXhwIjoxNzU0NjczODkzLCJpYXQiOjE3NTQ2NDUwOTN9.w-Kvhm1ZfZVdcW_wGEABzUDnDPLfNw3ZXp10OoRLjdc'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:54:54.734 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,60588
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:54:54.750 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,60583
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:54:54.750 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,60587
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:54:54.750 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTA5MywiZXhwIjoxNzU0NjczODkzLCJpYXQiOjE3NTQ2NDUwOTN9.w-Kvhm1ZfZVdcW_wGEABzUDnDPLfNw3ZXp10OoRLjdc'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:54:54.750 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTA5MywiZXhwIjoxNzU0NjczODkzLCJpYXQiOjE3NTQ2NDUwOTN9.w-Kvhm1ZfZVdcW_wGEABzUDnDPLfNw3ZXp10OoRLjdc'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:54:54.750 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:54:54.750 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,60586
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:54:54.750 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTA5MywiZXhwIjoxNzU0NjczODkzLCJpYXQiOjE3NTQ2NDUwOTN9.w-Kvhm1ZfZVdcW_wGEABzUDnDPLfNw3ZXp10OoRLjdc'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:54:54.750 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTA5MywiZXhwIjoxNzU0NjczODkzLCJpYXQiOjE3NTQ2NDUwOTN9.w-Kvhm1ZfZVdcW_wGEABzUDnDPLfNw3ZXp10OoRLjdc'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:54:54.750 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTA5MywiZXhwIjoxNzU0NjczODkzLCJpYXQiOjE3NTQ2NDUwOTN9.w-Kvhm1ZfZVdcW_wGEABzUDnDPLfNw3ZXp10OoRLjdc'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:54:54.765 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:54:54.765 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTA5MywiZXhwIjoxNzU0NjczODkzLCJpYXQiOjE3NTQ2NDUwOTN9.w-Kvhm1ZfZVdcW_wGEABzUDnDPLfNw3ZXp10OoRLjdc'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:54:54.765 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:54:54.765 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTA5MywiZXhwIjoxNzU0NjczODkzLCJpYXQiOjE3NTQ2NDUwOTN9.w-Kvhm1ZfZVdcW_wGEABzUDnDPLfNw3ZXp10OoRLjdc'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:54:54.781 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:54:54.781 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTA5MywiZXhwIjoxNzU0NjczODkzLCJpYXQiOjE3NTQ2NDUwOTN9.w-Kvhm1ZfZVdcW_wGEABzUDnDPLfNw3ZXp10OoRLjdc'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:54:54.781 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:54:54.796 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTA5MywiZXhwIjoxNzU0NjczODkzLCJpYXQiOjE3NTQ2NDUwOTN9.w-Kvhm1ZfZVdcW_wGEABzUDnDPLfNw3ZXp10OoRLjdc'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:54:54.796 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:54:54.796 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTA5MywiZXhwIjoxNzU0NjczODkzLCJpYXQiOjE3NTQ2NDUwOTN9.w-Kvhm1ZfZVdcW_wGEABzUDnDPLfNw3ZXp10OoRLjdc'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:54:54.812 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:54:54.812 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTA5MywiZXhwIjoxNzU0NjczODkzLCJpYXQiOjE3NTQ2NDUwOTN9.w-Kvhm1ZfZVdcW_wGEABzUDnDPLfNw3ZXp10OoRLjdc'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:54:54.812 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:54:54.812 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTA5MywiZXhwIjoxNzU0NjczODkzLCJpYXQiOjE3NTQ2NDUwOTN9.w-Kvhm1ZfZVdcW_wGEABzUDnDPLfNw3ZXp10OoRLjdc'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:54:54.828 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:54:54.828 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTA5MywiZXhwIjoxNzU0NjczODkzLCJpYXQiOjE3NTQ2NDUwOTN9.w-Kvhm1ZfZVdcW_wGEABzUDnDPLfNw3ZXp10OoRLjdc'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:54:54.828 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:54:54.828 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTA5MywiZXhwIjoxNzU0NjczODkzLCJpYXQiOjE3NTQ2NDUwOTN9.w-Kvhm1ZfZVdcW_wGEABzUDnDPLfNw3ZXp10OoRLjdc'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:54:54.843 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:54:54.843 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTA5MywiZXhwIjoxNzU0NjczODkzLCJpYXQiOjE3NTQ2NDUwOTN9.w-Kvhm1ZfZVdcW_wGEABzUDnDPLfNw3ZXp10OoRLjdc'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:54:54.921 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60583'
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:54:54.921 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTA5MywiZXhwIjoxNzU0NjczODkzLCJpYXQiOjE3NTQ2NDUwOTN9.w-Kvhm1ZfZVdcW_wGEABzUDnDPLfNw3ZXp10OoRLjdc'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:54:55.078 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReportCategoryandField 
 -1
 ,0
 ,1
 ,0
 ,'1'
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:54:55.078 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTA5MywiZXhwIjoxNzU0NjczODkzLCJpYXQiOjE3NTQ2NDUwOTN9.w-Kvhm1ZfZVdcW_wGEABzUDnDPLfNw3ZXp10OoRLjdc'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:54:55.124 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60584'
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:54:55.124 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTA5MywiZXhwIjoxNzU0NjczODkzLCJpYXQiOjE3NTQ2NDUwOTN9.w-Kvhm1ZfZVdcW_wGEABzUDnDPLfNw3ZXp10OoRLjdc'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:54:55.156 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60585'
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:54:55.156 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTA5MywiZXhwIjoxNzU0NjczODkzLCJpYXQiOjE3NTQ2NDUwOTN9.w-Kvhm1ZfZVdcW_wGEABzUDnDPLfNw3ZXp10OoRLjdc'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:54:55.156 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select * from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0  
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) a --where UStatus like ''%Hold%'' 
'
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:54:55.156 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTA5MywiZXhwIjoxNzU0NjczODkzLCJpYXQiOjE3NTQ2NDUwOTN9.w-Kvhm1ZfZVdcW_wGEABzUDnDPLfNw3ZXp10OoRLjdc'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:54:55.171 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select * from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0  
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) a where UnitStatus=''Vacant''
'
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:54:55.171 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select * from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0  
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) a where UnitStatus=''Occupied'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:54:55.187 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60586'
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:54:55.187 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTA5MywiZXhwIjoxNzU0NjczODkzLCJpYXQiOjE3NTQ2NDUwOTN9.w-Kvhm1ZfZVdcW_wGEABzUDnDPLfNw3ZXp10OoRLjdc'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:54:55.187 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTA5MywiZXhwIjoxNzU0NjczODkzLCJpYXQiOjE3NTQ2NDUwOTN9.w-Kvhm1ZfZVdcW_wGEABzUDnDPLfNw3ZXp10OoRLjdc'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:54:55.187 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTA5MywiZXhwIjoxNzU0NjczODkzLCJpYXQiOjE3NTQ2NDUwOTN9.w-Kvhm1ZfZVdcW_wGEABzUDnDPLfNw3ZXp10OoRLjdc'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:54:55.203 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60587'
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:54:55.203 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTA5MywiZXhwIjoxNzU0NjczODkzLCJpYXQiOjE3NTQ2NDUwOTN9.w-Kvhm1ZfZVdcW_wGEABzUDnDPLfNw3ZXp10OoRLjdc'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:54:55.203 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select * from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0  
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) a  where UnitStatus=''Expired'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:54:55.203 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTA5MywiZXhwIjoxNzU0NjczODkzLCJpYXQiOjE3NTQ2NDUwOTN9.w-Kvhm1ZfZVdcW_wGEABzUDnDPLfNw3ZXp10OoRLjdc'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:54:55.218 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60588'
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:54:55.218 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTA5MywiZXhwIjoxNzU0NjczODkzLCJpYXQiOjE3NTQ2NDUwOTN9.w-Kvhm1ZfZVdcW_wGEABzUDnDPLfNw3ZXp10OoRLjdc'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:54:55.218 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select * from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0  
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) a where UStatus like ''%Case%'' 
'
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:54:55.234 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTA5MywiZXhwIjoxNzU0NjczODkzLCJpYXQiOjE3NTQ2NDUwOTN9.w-Kvhm1ZfZVdcW_wGEABzUDnDPLfNw3ZXp10OoRLjdc'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:54:55.265 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60583'
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:54:55.265 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTA5MywiZXhwIjoxNzU0NjczODkzLCJpYXQiOjE3NTQ2NDUwOTN9.w-Kvhm1ZfZVdcW_wGEABzUDnDPLfNw3ZXp10OoRLjdc'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:54:55.281 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 '/*
DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select * from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0  
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) a where UStatus like ''%Reserve%'' 
*/

DECLARE @FROM FLOAT
SET @FROM=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @UnitID BIGINT,@StatusID BIGINT,@TotalAmount FLOAT,@I INT,@COUNT INT,@ContractID BIGINT
DECLARE @NoofDays INT,@VacantSince DATETIME

DECLARE @TAB TABLE(ID INT IDENTITY(1,1) PRIMARY KEY,UnitID BIGINT,CurrentRent FLOAT,Status NVARCHAR(10),NoofDays INT,VacantSince DATETIME,ContractID BIGINT)

INSERT INTO @TAB (UnitID)
SELECT U.UnitID
FROM REN_Units U WITH(NOLOCK) 
LEFT JOIN REN_Property P WITH(NOLOCK) ON P.NodeID=U.PropertyID
LEFT JOIN COM_Lookup LK WITH(NOLOCK) ON U.UnitStatus=LK.NodeID
WHERE U.UnitID>1 AND P.Name <> U.Name AND U.IsGroup=0 AND U.Status=424 and U.UnitStatus=306 
-- AND P.NodeID IN (207)
SELECT @I=1,@COUNT=COUNT(*) FROM @TAB
WHILE(@I<=@COUNT)
BEGIN
	SET @StatusID=0
	SET @TotalAmount=0
	SET @ContractID=0
	SELECT @UnitID=UnitID FROM @TAB WHERE ID=@I

	SELECT TOP 1 @ContractID=(CASE WHEN RefContractID>0 THEN RefContractID ELSE ContractID END),@StatusID=StatusID
	,@VacantSince=(CASE WHEN StatusID = 450 THEN ( CASE WHEN RefundDate IS NOT NULL THEN CONVERT(DATETIME,RefundDate) ELSE CONVERT(DATETIME,VacancyDate) END ) 
			ELSE CONVERT(DATETIME,TerminationDate) END )
	,@NoofDays=(CASE WHEN StatusID = 450 THEN (CASE WHEN RefundDate IS NOT NULL THEN DATEDIFF(DAY, CONVERT(DATETIME,RefundDate),CONVERT(DATETIME,@FROM) ) 
			ELSE DATEDIFF(DAY, CONVERT(DATETIME,VacancyDate),CONVERT(DATETIME,@FROM) ) END )
			ELSE DATEDIFF(DAY, CONVERT(DATETIME,TerminationDate),CONVERT(DATETIME,@FROM) ) END )  
	FROM REN_Contract WITH(NOLOCK) WHERE StatusID<>451 AND StartDate<@FROM AND UNITID=@UnitID 
	ORDER BY StartDate DESC,StatusID
	
	SELECT @TotalAmount=ISNULL(SUM(RPD.Amount),MAX(RentAmount)/(CASE WHEN MAX(RC.NoOfUnits)=0 THEN 1 ELSE MAX(RC.NoOfUnits) END)) 
	FROM REN_Contract RC WITH(NOLOCK)
	JOIN REN_ContractParticulars RP WITH(NOLOCK) ON RP.ContractID=RC.ContractID AND RP.Sno=1
	LEFT JOIN REN_ContractParticularsDetail RPD WITH(NOLOCK) ON RPD.ParticularNodeID=RP.NodeID AND RPD.Unit=@UnitID 
	AND @FROM BETWEEN ISNULL(RPD.FromDate,@FROM) AND ISNULL(RPD.ToDate,@FROM)
	WHERE RC.ContractID=@ContractID
	
	IF @StatusID=427 OR @StatusID=426 OR @StatusID=466
	BEGIN
		UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Occupied'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
	END
	ELSE IF @StatusID=440
	BEGIN
		UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''UnAproved'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
	END
	ELSE IF @StatusID=428 OR @StatusID=450
	BEGIN 
		IF EXISTS (SELECT * FROM REN_Quotation WITH(NOLOCK) WHERE COSTCENTERID=129 AND UNITID=@UnitID AND CONVERT(DATETIME,@FROM) BETWEEN CONVERT(DATETIME,STARTDATE) AND CONVERT(DATETIME,ENDDATE) and statusid=467 )
			UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Reserved'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
		ELSE IF EXISTS (SELECT * FROM REN_Quotation WITH(NOLOCK) WHERE COSTCENTERID=103 AND UNITID=@UnitID AND CONVERT(DATETIME,@FROM) BETWEEN CONVERT(DATETIME,STARTDATE) AND CONVERT(DATETIME,ENDDATE) and statusid=426 )
			UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Quoted'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
		ELSE
			UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Vacant'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
	END
	ELSE
	BEGIN 
		IF EXISTS (SELECT * FROM REN_Quotation WITH(NOLOCK) WHERE COSTCENTERID=129 AND UNITID=@UnitID AND CONVERT(DATETIME,@FROM) BETWEEN CONVERT(DATETIME,STARTDATE) AND CONVERT(DATETIME,ENDDATE) and statusid=467 )
			UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Reserved'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
		ELSE IF EXISTS (SELECT * FROM REN_Quotation WITH(NOLOCK) WHERE COSTCENTERID=103 AND UNITID=@UnitID AND CONVERT(DATETIME,@FROM) BETWEEN CONVERT(DATETIME,STARTDATE) AND CONVERT(DATETIME,ENDDATE) and statusid=426 )
			UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Quoted'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
		ELSE
			UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Vacant'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
	END
	set @I=@I+1
END

select * from (
SELECT TEMP.*,RP.NodeID Building_ID,RP.NAME Property,TEMP.UnitID Unit_ID,RU.NAME Unit,C18.NAME UnitType,RU.UnitStatus,RU.RentableArea UnitArea,RU.RentPerSQFT UnitRate
,RU.AnnualRent 
,T.FirstName AS [C98c7d2679f99489e9f0e010026eeb563]
,RUL.Name LandLord , RUC.Name Location 
,1 Cnt
FROM @TAB TEMP
JOIN REN_Units RU WITH(NOLOCK) ON TEMP.UnitID=RU.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
LEFT JOIN COM_CC50018 C18 WITH(NOLOCK) ON C18.NodeID=RU.NodeID
LEFT JOIN REN_Contract C WITH(NOLOCK) ON TEMP.ContractID=C.ContractID
LEFT JOIN REN_Tenant T WITH(NOLOCK) ON T.TenantID=C.TenantID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID

 )a where a.Status =''Reserved''
 order by Property,VacantSince'
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:54:55.281 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTA5MywiZXhwIjoxNzU0NjczODkzLCJpYXQiOjE3NTQ2NDUwOTN9.w-Kvhm1ZfZVdcW_wGEABzUDnDPLfNw3ZXp10OoRLjdc'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:54:55.312 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60584'
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:54:55.312 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTA5MywiZXhwIjoxNzU0NjczODkzLCJpYXQiOjE3NTQ2NDUwOTN9.w-Kvhm1ZfZVdcW_wGEABzUDnDPLfNw3ZXp10OoRLjdc'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:54:55.328 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select * from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0  
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) a --where UStatus like ''%Hold%'' 
'
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:54:55.328 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTA5MywiZXhwIjoxNzU0NjczODkzLCJpYXQiOjE3NTQ2NDUwOTN9.w-Kvhm1ZfZVdcW_wGEABzUDnDPLfNw3ZXp10OoRLjdc'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:54:55.343 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60585'
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:54:55.343 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTA5MywiZXhwIjoxNzU0NjczODkzLCJpYXQiOjE3NTQ2NDUwOTN9.w-Kvhm1ZfZVdcW_wGEABzUDnDPLfNw3ZXp10OoRLjdc'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:54:55.374 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select * from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0  
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) a where UnitStatus=''Occupied'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:54:55.374 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select * from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0  
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) a where UnitStatus=''Vacant''
'
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:54:55.374 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTA5MywiZXhwIjoxNzU0NjczODkzLCJpYXQiOjE3NTQ2NDUwOTN9.w-Kvhm1ZfZVdcW_wGEABzUDnDPLfNw3ZXp10OoRLjdc'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:54:55.374 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTA5MywiZXhwIjoxNzU0NjczODkzLCJpYXQiOjE3NTQ2NDUwOTN9.w-Kvhm1ZfZVdcW_wGEABzUDnDPLfNw3ZXp10OoRLjdc'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:54:55.390 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60586'
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:54:55.390 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTA5MywiZXhwIjoxNzU0NjczODkzLCJpYXQiOjE3NTQ2NDUwOTN9.w-Kvhm1ZfZVdcW_wGEABzUDnDPLfNw3ZXp10OoRLjdc'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:54:55.421 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select * from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0  
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) a  where UnitStatus=''Expired'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:54:55.421 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTA5MywiZXhwIjoxNzU0NjczODkzLCJpYXQiOjE3NTQ2NDUwOTN9.w-Kvhm1ZfZVdcW_wGEABzUDnDPLfNw3ZXp10OoRLjdc'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:54:55.437 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60587'
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:54:55.437 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTA5MywiZXhwIjoxNzU0NjczODkzLCJpYXQiOjE3NTQ2NDUwOTN9.w-Kvhm1ZfZVdcW_wGEABzUDnDPLfNw3ZXp10OoRLjdc'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:54:55.484 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60588'
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:54:55.484 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTA5MywiZXhwIjoxNzU0NjczODkzLCJpYXQiOjE3NTQ2NDUwOTN9.w-Kvhm1ZfZVdcW_wGEABzUDnDPLfNw3ZXp10OoRLjdc'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:54:55.484 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select * from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0  
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) a where UStatus like ''%Case%'' 
'
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:54:55.499 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTA5MywiZXhwIjoxNzU0NjczODkzLCJpYXQiOjE3NTQ2NDUwOTN9.w-Kvhm1ZfZVdcW_wGEABzUDnDPLfNw3ZXp10OoRLjdc'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:54:55.562 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 '/*
DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select * from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0  
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) a where UStatus like ''%Reserve%'' 
*/

DECLARE @FROM FLOAT
SET @FROM=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @UnitID BIGINT,@StatusID BIGINT,@TotalAmount FLOAT,@I INT,@COUNT INT,@ContractID BIGINT
DECLARE @NoofDays INT,@VacantSince DATETIME

DECLARE @TAB TABLE(ID INT IDENTITY(1,1) PRIMARY KEY,UnitID BIGINT,CurrentRent FLOAT,Status NVARCHAR(10),NoofDays INT,VacantSince DATETIME,ContractID BIGINT)

INSERT INTO @TAB (UnitID)
SELECT U.UnitID
FROM REN_Units U WITH(NOLOCK) 
LEFT JOIN REN_Property P WITH(NOLOCK) ON P.NodeID=U.PropertyID
LEFT JOIN COM_Lookup LK WITH(NOLOCK) ON U.UnitStatus=LK.NodeID
WHERE U.UnitID>1 AND P.Name <> U.Name AND U.IsGroup=0 AND U.Status=424 and U.UnitStatus=306 
-- AND P.NodeID IN (207)
SELECT @I=1,@COUNT=COUNT(*) FROM @TAB
WHILE(@I<=@COUNT)
BEGIN
	SET @StatusID=0
	SET @TotalAmount=0
	SET @ContractID=0
	SELECT @UnitID=UnitID FROM @TAB WHERE ID=@I

	SELECT TOP 1 @ContractID=(CASE WHEN RefContractID>0 THEN RefContractID ELSE ContractID END),@StatusID=StatusID
	,@VacantSince=(CASE WHEN StatusID = 450 THEN ( CASE WHEN RefundDate IS NOT NULL THEN CONVERT(DATETIME,RefundDate) ELSE CONVERT(DATETIME,VacancyDate) END ) 
			ELSE CONVERT(DATETIME,TerminationDate) END )
	,@NoofDays=(CASE WHEN StatusID = 450 THEN (CASE WHEN RefundDate IS NOT NULL THEN DATEDIFF(DAY, CONVERT(DATETIME,RefundDate),CONVERT(DATETIME,@FROM) ) 
			ELSE DATEDIFF(DAY, CONVERT(DATETIME,VacancyDate),CONVERT(DATETIME,@FROM) ) END )
			ELSE DATEDIFF(DAY, CONVERT(DATETIME,TerminationDate),CONVERT(DATETIME,@FROM) ) END )  
	FROM REN_Contract WITH(NOLOCK) WHERE StatusID<>451 AND StartDate<@FROM AND UNITID=@UnitID 
	ORDER BY StartDate DESC,StatusID
	
	SELECT @TotalAmount=ISNULL(SUM(RPD.Amount),MAX(RentAmount)/(CASE WHEN MAX(RC.NoOfUnits)=0 THEN 1 ELSE MAX(RC.NoOfUnits) END)) 
	FROM REN_Contract RC WITH(NOLOCK)
	JOIN REN_ContractParticulars RP WITH(NOLOCK) ON RP.ContractID=RC.ContractID AND RP.Sno=1
	LEFT JOIN REN_ContractParticularsDetail RPD WITH(NOLOCK) ON RPD.ParticularNodeID=RP.NodeID AND RPD.Unit=@UnitID 
	AND @FROM BETWEEN ISNULL(RPD.FromDate,@FROM) AND ISNULL(RPD.ToDate,@FROM)
	WHERE RC.ContractID=@ContractID
	
	IF @StatusID=427 OR @StatusID=426 OR @StatusID=466
	BEGIN
		UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Occupied'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
	END
	ELSE IF @StatusID=440
	BEGIN
		UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''UnAproved'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
	END
	ELSE IF @StatusID=428 OR @StatusID=450
	BEGIN 
		IF EXISTS (SELECT * FROM REN_Quotation WITH(NOLOCK) WHERE COSTCENTERID=129 AND UNITID=@UnitID AND CONVERT(DATETIME,@FROM) BETWEEN CONVERT(DATETIME,STARTDATE) AND CONVERT(DATETIME,ENDDATE) and statusid=467 )
			UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Reserved'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
		ELSE IF EXISTS (SELECT * FROM REN_Quotation WITH(NOLOCK) WHERE COSTCENTERID=103 AND UNITID=@UnitID AND CONVERT(DATETIME,@FROM) BETWEEN CONVERT(DATETIME,STARTDATE) AND CONVERT(DATETIME,ENDDATE) and statusid=426 )
			UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Quoted'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
		ELSE
			UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Vacant'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
	END
	ELSE
	BEGIN 
		IF EXISTS (SELECT * FROM REN_Quotation WITH(NOLOCK) WHERE COSTCENTERID=129 AND UNITID=@UnitID AND CONVERT(DATETIME,@FROM) BETWEEN CONVERT(DATETIME,STARTDATE) AND CONVERT(DATETIME,ENDDATE) and statusid=467 )
			UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Reserved'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
		ELSE IF EXISTS (SELECT * FROM REN_Quotation WITH(NOLOCK) WHERE COSTCENTERID=103 AND UNITID=@UnitID AND CONVERT(DATETIME,@FROM) BETWEEN CONVERT(DATETIME,STARTDATE) AND CONVERT(DATETIME,ENDDATE) and statusid=426 )
			UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Quoted'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
		ELSE
			UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Vacant'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
	END
	set @I=@I+1
END

select * from (
SELECT TEMP.*,RP.NodeID Building_ID,RP.NAME Property,TEMP.UnitID Unit_ID,RU.NAME Unit,C18.NAME UnitType,RU.UnitStatus,RU.RentableArea UnitArea,RU.RentPerSQFT UnitRate
,RU.AnnualRent 
,T.FirstName AS [C98c7d2679f99489e9f0e010026eeb563]
,RUL.Name LandLord , RUC.Name Location 
,1 Cnt
FROM @TAB TEMP
JOIN REN_Units RU WITH(NOLOCK) ON TEMP.UnitID=RU.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
LEFT JOIN COM_CC50018 C18 WITH(NOLOCK) ON C18.NodeID=RU.NodeID
LEFT JOIN REN_Contract C WITH(NOLOCK) ON TEMP.ContractID=C.ContractID
LEFT JOIN REN_Tenant T WITH(NOLOCK) ON T.TenantID=C.TenantID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID

 )a where a.Status =''Reserved''
 order by Property,VacantSince'
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:54:55.562 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTA5MywiZXhwIjoxNzU0NjczODkzLCJpYXQiOjE3NTQ2NDUwOTN9.w-Kvhm1ZfZVdcW_wGEABzUDnDPLfNw3ZXp10OoRLjdc'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:54:56.468 | General Service|:: CompanyIndex:53 SpName: spADM_GetCostCenterGridViewList 
 2
 ,1
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:54:56.468 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTA5MywiZXhwIjoxNzU0NjczODkzLCJpYXQiOjE3NTQ2NDUwOTN9.w-Kvhm1ZfZVdcW_wGEABzUDnDPLfNw3ZXp10OoRLjdc'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:54:56.499 | General Service|:: CompanyIndex:53 SpName: spCom_GetCostCenterSummary 
 126
 ,-1
 ,1000
 ,''
 ,''
 ,''
 ,0
 ,'08-Aug-2025'
 ,NULL
 ,''
 ,1
 ,1
 ,0
 ,0
 ,False
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:54:56.515 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTA5MywiZXhwIjoxNzU0NjczODkzLCJpYXQiOjE3NTQ2NDUwOTN9.w-Kvhm1ZfZVdcW_wGEABzUDnDPLfNw3ZXp10OoRLjdc'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:55:54.281 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:55:54.281 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTA5MywiZXhwIjoxNzU0NjczODkzLCJpYXQiOjE3NTQ2NDUwOTN9.w-Kvhm1ZfZVdcW_wGEABzUDnDPLfNw3ZXp10OoRLjdc'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:56:54.243 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:56:54.243 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTA5MywiZXhwIjoxNzU0NjczODkzLCJpYXQiOjE3NTQ2NDUwOTN9.w-Kvhm1ZfZVdcW_wGEABzUDnDPLfNw3ZXp10OoRLjdc'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:57:54.251 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:57:54.251 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTA5MywiZXhwIjoxNzU0NjczODkzLCJpYXQiOjE3NTQ2NDUwOTN9.w-Kvhm1ZfZVdcW_wGEABzUDnDPLfNw3ZXp10OoRLjdc'''
 ,1
 ,1
[System: 192.168.1.76] DEBUG | 08-08-2025 14:58:08.319 | General Service|:: CompanyIndex:0 SpName: spADM_GetClientUserDetails2C 
 'admin'
 ,1
 ,0
[System: 192.168.1.76] DEBUG | 08-08-2025 14:58:08.382 | General Service|:: CompanyIndex:0 SpName: spADM_UserLoginCheck 
 2
 ,'admin'
 ,0
 ,'192.168.1.76'
 ,'192.168.1.76'
 ,''
 ,'Web'
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:58:54.233 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:58:54.248 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTA5MywiZXhwIjoxNzU0NjczODkzLCJpYXQiOjE3NTQ2NDUwOTN9.w-Kvhm1ZfZVdcW_wGEABzUDnDPLfNw3ZXp10OoRLjdc'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:59:34.760 | General Service|:: CompanyIndex:0 SpName: spADM_GetClientUserDetails2C 
 'admin'
 ,1
 ,0
[System: 192.168.1.73] DEBUG | 08-08-2025 14:59:34.838 | General Service|:: CompanyIndex:0 SpName: spADM_UserLoginCheck 
 2
 ,'admin'
 ,0
 ,'192.168.1.73'
 ,'192.168.1.73'
 ,''
 ,'Web'
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:59:39.353 | General Service|:: CompanyIndex:53 SpName: spADM_GetClientUserDetails 
 'admin'
 ,1
 ,'26.2.9'
 ,0
[System: 192.168.1.73] DEBUG | 08-08-2025 14:59:39.415 | General Service|:: CompanyIndex:0 SpName: spADM_UserLoginCheck 
 2
 ,'admin'
 ,53
 ,'192.168.1.73'
 ,'192.168.1.73'
 ,''
 ,'Web'
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:59:39.431 | General Service|:: CompanyIndex:0 SpName: spADM_Login 
 1
 ,''
 ,''
 ,''
 ,''
 ,''
 ,53
[System: 192.168.1.73] DEBUG | 08-08-2025 14:59:39.446 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select Value from ADM_GlobalPreferences with (nolock) where name =''EnableReLogin'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:59:39.446 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTM3OSwiZXhwIjoxNzU0Njc0MTc5LCJpYXQiOjE3NTQ2NDUzNzl9.g2xkwaskoaQf9D1KtdWbI8AB4PdXmoDh0PQE7Ov_cPI'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:59:39.462 | General Service|:: CompanyIndex:0 SpName: spADM_Login 
 4
 ,''
 ,''
 ,''
 ,'declare @Cnt int,@ExpiredGUID nvarchar(50),@AllowSession int,@GUID nvarchar(50),@CurrDate float,@UserID INT,@Instances INT,@InstancesExists INT,@LCDBIndex int
set @CurrDate= convert(float,dateadd(minute,-21,getdate()))
set @AllowSession=0
set @GUID=''39d911aa-9564-4bef-a8d7-2926e404b842''
set @LCDBIndex=0
select top 1 @UserID=UserID,@Instances=InstanceCount from ADM_Users with(nolock) where UserName=''admin''
if exists(select [GUID] from ADM_Login with(nolock) where [GUID]=@GUID)
begin
	update ADM_Login 
	set LastAccessTime=convert(float,getdate()),UserID=@UserID
	where [GUID]=@GUID
    set @AllowSession=1
end
else
begin
	select @Cnt=count(*) from ADM_Login with(nolock) where LCDBIndex=@LCDBIndex and [GUID]!=''ACCESSRIGHTS'' and AP =''WEB''
    if(@Cnt<100)
		set @AllowSession=1
	else
	begin
		select top 1 @ExpiredGUID=[GUID] from ADM_Login with(nolock)
		where [GUID]!=''ACCESSRIGHTS'' and LCDBIndex=@LCDBIndex and LastAccessTime<@CurrDate  and AP =''WEB''
        order by LastAccessTime asc
		if @ExpiredGUID is not null
		begin
			delete from ADM_Login where [GUID]=@ExpiredGUID
			set @AllowSession=1
		end
	end
	if @AllowSession=1
	begin
        select @InstancesExists=COUNT(*) from ADM_Login with(nolock)
		where [GUID]!=''ACCESSRIGHTS'' and LCDBIndex=@LCDBIndex and LastAccessTime>=@CurrDate and UserID=@UserID and AP =''WEB''
		if(@Instances!=0 and @Instances<=@InstancesExists)
			set @AllowSession=2
		else
		    INSERT INTO ADM_Login([GUID],[SysName],IPAddress,[Status],LoginTime,LastAccessTime,AccessRights,UserID,DBIndex,LCDBIndex,AP)
		    VALUES(@GUID,''WEB'',''192.168.1.73'',1,convert(float,getdate()),convert(float,getdate()),null,@UserID,53,@LCDBIndex, ''WEB'')
	end
end

select @AllowSession AllowSession,@Instances Instances,@InstancesExists InstancesExists
'
 ,''
 ,0
[System: 192.168.1.73] DEBUG | 08-08-2025 14:59:39.478 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTM3OSwiZXhwIjoxNzU0Njc0MTc5LCJpYXQiOjE3NTQ2NDUzNzl9.g2xkwaskoaQf9D1KtdWbI8AB4PdXmoDh0PQE7Ov_cPI'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:59:39.478 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT (SELECT COUNT(*) FROM COM_Location L WITH(NOLOCK) JOIN COM_Status S WITH(NOLOCK) ON S.StatusID=L.StatusID WHERE L.IsGroup=0 AND S.[Status]=''Active'') ML
,(SELECT COUNT(*) FROM ADM_Features WITH(NOLOCK) WHERE ((FeatureID>50000 AND FeatureID<=50050) OR FeatureID>=51000) AND IsEnabled=1) MD
,(SELECT ISNULL(COUNT(*),0) FROM ADM_RevenUReports WITH(NOLOCK) WHERE IsGroup=0 AND ReportID>10000 AND StaticReportType IN (0,-1)) MR'
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:59:39.493 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTM3OSwiZXhwIjoxNzU0Njc0MTc5LCJpYXQiOjE3NTQ2NDUzNzl9.g2xkwaskoaQf9D1KtdWbI8AB4PdXmoDh0PQE7Ov_cPI'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:59:39.493 | General Service|:: CompanyIndex:53 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.73] DEBUG | 08-08-2025 14:59:39.509 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTM3OSwiZXhwIjoxNzU0Njc0MTc5LCJpYXQiOjE3NTQ2NDUzNzl9.g2xkwaskoaQf9D1KtdWbI8AB4PdXmoDh0PQE7Ov_cPI'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:59:39.712 | General Service|:: CompanyIndex:53 SpName: spADM_GetRibbonView 
 1
 ,1
 ,1
 ,1
 ,0
 ,''
[System: 192.168.1.73] DEBUG | 08-08-2025 14:59:39.712 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTM3OSwiZXhwIjoxNzU0Njc0MTc5LCJpYXQiOjE3NTQ2NDUzNzl9.g2xkwaskoaQf9D1KtdWbI8AB4PdXmoDh0PQE7Ov_cPI'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:59:39.915 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 2
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:59:39.931 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTM3OSwiZXhwIjoxNzU0Njc0MTc5LCJpYXQiOjE3NTQ2NDUzNzl9.g2xkwaskoaQf9D1KtdWbI8AB4PdXmoDh0PQE7Ov_cPI'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:59:39.946 | General Service|:: CompanyIndex:53 SpName: spADM_GetDashBoard 
 2
 ,0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:59:39.946 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTM3OSwiZXhwIjoxNzU0Njc0MTc5LCJpYXQiOjE3NTQ2NDUzNzl9.g2xkwaskoaQf9D1KtdWbI8AB4PdXmoDh0PQE7Ov_cPI'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:59:39.978 | General Service|:: CompanyIndex:53 SpName: spCOM_ConfigValues 
 1
 ,'LandingDocs'
 ,'1'
[System: 192.168.1.73] DEBUG | 08-08-2025 14:59:39.978 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTM3OSwiZXhwIjoxNzU0Njc0MTc5LCJpYXQiOjE3NTQ2NDUzNzl9.g2xkwaskoaQf9D1KtdWbI8AB4PdXmoDh0PQE7Ov_cPI'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:59:40.024 | General Service|:: CompanyIndex:53 SpName: spCOM_GetFavorites 
 'GETLIST0'
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:59:40.024 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTM3OSwiZXhwIjoxNzU0Njc0MTc5LCJpYXQiOjE3NTQ2NDUzNzl9.g2xkwaskoaQf9D1KtdWbI8AB4PdXmoDh0PQE7Ov_cPI'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:59:40.040 | General Service|:: CompanyIndex:53 SpName: spADM_GetAllListViewsDef 
 1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:59:40.040 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTM3OSwiZXhwIjoxNzU0Njc0MTc5LCJpYXQiOjE3NTQ2NDUzNzl9.g2xkwaskoaQf9D1KtdWbI8AB4PdXmoDh0PQE7Ov_cPI'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:59:40.149 | General Service|:: CompanyIndex:53 SpName: spADM_GetAllListViewsDef 
 1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:59:40.149 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTM3OSwiZXhwIjoxNzU0Njc0MTc5LCJpYXQiOjE3NTQ2NDUzNzl9.g2xkwaskoaQf9D1KtdWbI8AB4PdXmoDh0PQE7Ov_cPI'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:59:40.290 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'Select CostCenterID,CostCenterColID,CostCenterName,SysTableName,UserColumnName,SysColumnName,ISNULL(UserDefaultValue,'''') UserDefaultValue
From AdM_CostCenterDef WITH(NOLOCK)
Where SysColumnName IN(''CreditAccount'',''DebitAccount'',''ProductID'') 
AND CostCenterID>40000 AND CostCenterID<50000 

SELECT * FROM ADM_Features WITH(NOLOCK) '
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:59:40.290 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTM3OSwiZXhwIjoxNzU0Njc0MTc5LCJpYXQiOjE3NTQ2NDUzNzl9.g2xkwaskoaQf9D1KtdWbI8AB4PdXmoDh0PQE7Ov_cPI'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:59:40.337 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 '  SELECT * FROM PAY_PayrollPreferences WITH(NOLOCK) '
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:59:40.352 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTM3OSwiZXhwIjoxNzU0Njc0MTc5LCJpYXQiOjE3NTQ2NDUzNzl9.g2xkwaskoaQf9D1KtdWbI8AB4PdXmoDh0PQE7Ov_cPI'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:59:40.384 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 '  --0
                                Select * FROM COM_CC50051 WITH(NOLOCK) WHERE IsGroup=0 AND LoginUserID=''admin''
                                --1                                
                                Select * FROM COM_CC50051 WITH(NOLOCK) WHERE RptManager IN (Select NodeID FROM COM_CC50051 WITH(NOLOCK) WHERE IsGroup=0 AND LoginUserID=''admin'')
                                UNION ALL
                                Select * FROM COM_CC50051 WITH(NOLOCK) WHERE RptManager IN 
                                (
	                                Select NodeID FROM COM_CC50051 WITH(NOLOCK) 
	                                WHERE IsGroup=0 AND LoginUserID IN
	                                (
	                                SELECT fe.LoginUserID
	                                FROM INV_DocDetails a WITH(NOLOCK) 
	                                JOIN COM_DocCCData b WITH(NOLOCK) ON b.InvDocDetailsID=a.InvDocDetailsID
	                                JOIN COM_DocNumData c WITH(NOLOCK) ON c.InvDocDetailsID=a.InvDocDetailsID
	                                JOIN COM_DocTextData d WITH(NOLOCK) ON d.InvDocDetailsID=a.InvDocDetailsID
	                                JOIN COM_CC50051 fe WITH(NOLOCK) on fe.NodeID=b.dcCCNID51
	                                JOIN COM_CC50051 te WITH(NOLOCK) on CONVERT(NVARCHAR,te.NodeID)=d.dcAlpha1
	                                WHERE a.CostCenterID=40098 and a.StatusID=369 AND d.dcAlpha3=''Temporary''
	                                AND te.LoginUserID=''admin'' 
	                                AND ISDATE(d.dcAlpha4)=1 AND ISDATE(d.dcAlpha5)=1 
	                                AND CONVERT(DATETIME,''08 Aug 2025'') BETWEEN CONVERT(DATETIME,d.dcAlpha4) AND CONVERT(DATETIME,d.dcAlpha5)
	                                )
                                )
                                --2
                                Select * FROM ADM_USERS WITH(NOLOCK) WHERE USERID=1
                                --3
                                Select * FROM COM_CostCenterCostCenterMap WITH(NOLOCK) WHERE ParentCostCenterID=7 AND ParentNodeID=1
                                --4                                
                                Select * FROM COM_CostCenterCostCenterMap WITH(NOLOCK) WHERE ParentCostCenterID=7 AND ParentNodeID=1
                                AND CostCenterID IN(Select ColumnCostCenterID From ADM_CostCenterDef Where CostCenterID=50051 AND IsColumnInUse=1 AND SysColumnName LIKE ''CCNID%'')
                                --5
                                Select * from COM_Files WITH(NOLOCK) WHERE FeatureID=50051 AND FeaturePK IN (Select NodeID FROM COM_CC50051 WITH(NOLOCK) WHERE IsGroup=0 AND LoginUserID=''admin'')                         
'
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:59:40.399 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTM3OSwiZXhwIjoxNzU0Njc0MTc5LCJpYXQiOjE3NTQ2NDUzNzl9.g2xkwaskoaQf9D1KtdWbI8AB4PdXmoDh0PQE7Ov_cPI'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:59:40.462 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:59:40.462 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTM3OSwiZXhwIjoxNzU0Njc0MTc5LCJpYXQiOjE3NTQ2NDUzNzl9.g2xkwaskoaQf9D1KtdWbI8AB4PdXmoDh0PQE7Ov_cPI'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:59:40.774 | General Service|:: CompanyIndex:53 SpName: spADM_GetDashBoard 
 1
 ,41
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:59:40.774 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTM3OSwiZXhwIjoxNzU0Njc0MTc5LCJpYXQiOjE3NTQ2NDUzNzl9.g2xkwaskoaQf9D1KtdWbI8AB4PdXmoDh0PQE7Ov_cPI'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:59:40.805 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,60585
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:59:40.805 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,60583
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:59:40.805 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,60586
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:59:40.805 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,60584
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:59:40.821 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTM3OSwiZXhwIjoxNzU0Njc0MTc5LCJpYXQiOjE3NTQ2NDUzNzl9.g2xkwaskoaQf9D1KtdWbI8AB4PdXmoDh0PQE7Ov_cPI'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:59:40.821 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTM3OSwiZXhwIjoxNzU0Njc0MTc5LCJpYXQiOjE3NTQ2NDUzNzl9.g2xkwaskoaQf9D1KtdWbI8AB4PdXmoDh0PQE7Ov_cPI'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:59:40.821 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTM3OSwiZXhwIjoxNzU0Njc0MTc5LCJpYXQiOjE3NTQ2NDUzNzl9.g2xkwaskoaQf9D1KtdWbI8AB4PdXmoDh0PQE7Ov_cPI'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:59:40.821 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTM3OSwiZXhwIjoxNzU0Njc0MTc5LCJpYXQiOjE3NTQ2NDUzNzl9.g2xkwaskoaQf9D1KtdWbI8AB4PdXmoDh0PQE7Ov_cPI'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:59:40.821 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,60587
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:59:40.821 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,60584
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:59:40.837 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTM3OSwiZXhwIjoxNzU0Njc0MTc5LCJpYXQiOjE3NTQ2NDUzNzl9.g2xkwaskoaQf9D1KtdWbI8AB4PdXmoDh0PQE7Ov_cPI'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:59:40.837 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,60588
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:59:40.837 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:59:40.837 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTM3OSwiZXhwIjoxNzU0Njc0MTc5LCJpYXQiOjE3NTQ2NDUzNzl9.g2xkwaskoaQf9D1KtdWbI8AB4PdXmoDh0PQE7Ov_cPI'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:59:40.837 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTM3OSwiZXhwIjoxNzU0Njc0MTc5LCJpYXQiOjE3NTQ2NDUzNzl9.g2xkwaskoaQf9D1KtdWbI8AB4PdXmoDh0PQE7Ov_cPI'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:59:40.837 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTM3OSwiZXhwIjoxNzU0Njc0MTc5LCJpYXQiOjE3NTQ2NDUzNzl9.g2xkwaskoaQf9D1KtdWbI8AB4PdXmoDh0PQE7Ov_cPI'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:59:40.837 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,60586
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:59:40.837 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTM3OSwiZXhwIjoxNzU0Njc0MTc5LCJpYXQiOjE3NTQ2NDUzNzl9.g2xkwaskoaQf9D1KtdWbI8AB4PdXmoDh0PQE7Ov_cPI'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:59:40.837 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,60583
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:59:40.852 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTM3OSwiZXhwIjoxNzU0Njc0MTc5LCJpYXQiOjE3NTQ2NDUzNzl9.g2xkwaskoaQf9D1KtdWbI8AB4PdXmoDh0PQE7Ov_cPI'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:59:40.852 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,60585
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:59:40.852 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTM3OSwiZXhwIjoxNzU0Njc0MTc5LCJpYXQiOjE3NTQ2NDUzNzl9.g2xkwaskoaQf9D1KtdWbI8AB4PdXmoDh0PQE7Ov_cPI'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:59:40.852 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,60587
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:59:40.852 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,60588
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:59:40.852 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:59:40.852 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTM3OSwiZXhwIjoxNzU0Njc0MTc5LCJpYXQiOjE3NTQ2NDUzNzl9.g2xkwaskoaQf9D1KtdWbI8AB4PdXmoDh0PQE7Ov_cPI'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:59:40.852 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTM3OSwiZXhwIjoxNzU0Njc0MTc5LCJpYXQiOjE3NTQ2NDUzNzl9.g2xkwaskoaQf9D1KtdWbI8AB4PdXmoDh0PQE7Ov_cPI'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:59:40.852 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTM3OSwiZXhwIjoxNzU0Njc0MTc5LCJpYXQiOjE3NTQ2NDUzNzl9.g2xkwaskoaQf9D1KtdWbI8AB4PdXmoDh0PQE7Ov_cPI'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:59:40.868 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:59:40.868 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTM3OSwiZXhwIjoxNzU0Njc0MTc5LCJpYXQiOjE3NTQ2NDUzNzl9.g2xkwaskoaQf9D1KtdWbI8AB4PdXmoDh0PQE7Ov_cPI'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:59:40.868 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:59:40.868 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTM3OSwiZXhwIjoxNzU0Njc0MTc5LCJpYXQiOjE3NTQ2NDUzNzl9.g2xkwaskoaQf9D1KtdWbI8AB4PdXmoDh0PQE7Ov_cPI'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:59:40.884 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:59:40.884 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTM3OSwiZXhwIjoxNzU0Njc0MTc5LCJpYXQiOjE3NTQ2NDUzNzl9.g2xkwaskoaQf9D1KtdWbI8AB4PdXmoDh0PQE7Ov_cPI'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:59:40.884 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:59:40.899 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTM3OSwiZXhwIjoxNzU0Njc0MTc5LCJpYXQiOjE3NTQ2NDUzNzl9.g2xkwaskoaQf9D1KtdWbI8AB4PdXmoDh0PQE7Ov_cPI'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:59:40.899 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:59:40.899 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTM3OSwiZXhwIjoxNzU0Njc0MTc5LCJpYXQiOjE3NTQ2NDUzNzl9.g2xkwaskoaQf9D1KtdWbI8AB4PdXmoDh0PQE7Ov_cPI'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:59:40.899 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:59:40.915 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTM3OSwiZXhwIjoxNzU0Njc0MTc5LCJpYXQiOjE3NTQ2NDUzNzl9.g2xkwaskoaQf9D1KtdWbI8AB4PdXmoDh0PQE7Ov_cPI'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:59:40.915 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:59:40.915 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTM3OSwiZXhwIjoxNzU0Njc0MTc5LCJpYXQiOjE3NTQ2NDUzNzl9.g2xkwaskoaQf9D1KtdWbI8AB4PdXmoDh0PQE7Ov_cPI'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:59:40.930 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:59:40.930 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTM3OSwiZXhwIjoxNzU0Njc0MTc5LCJpYXQiOjE3NTQ2NDUzNzl9.g2xkwaskoaQf9D1KtdWbI8AB4PdXmoDh0PQE7Ov_cPI'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:59:40.930 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:59:40.930 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTM3OSwiZXhwIjoxNzU0Njc0MTc5LCJpYXQiOjE3NTQ2NDUzNzl9.g2xkwaskoaQf9D1KtdWbI8AB4PdXmoDh0PQE7Ov_cPI'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:59:40.946 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:59:40.946 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTM3OSwiZXhwIjoxNzU0Njc0MTc5LCJpYXQiOjE3NTQ2NDUzNzl9.g2xkwaskoaQf9D1KtdWbI8AB4PdXmoDh0PQE7Ov_cPI'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:59:41.024 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60583'
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:59:41.024 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTM3OSwiZXhwIjoxNzU0Njc0MTc5LCJpYXQiOjE3NTQ2NDUzNzl9.g2xkwaskoaQf9D1KtdWbI8AB4PdXmoDh0PQE7Ov_cPI'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:59:41.305 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReportCategoryandField 
 -1
 ,0
 ,1
 ,0
 ,'1'
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:59:41.305 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTM3OSwiZXhwIjoxNzU0Njc0MTc5LCJpYXQiOjE3NTQ2NDUzNzl9.g2xkwaskoaQf9D1KtdWbI8AB4PdXmoDh0PQE7Ov_cPI'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:59:41.352 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60584'
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:59:41.368 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTM3OSwiZXhwIjoxNzU0Njc0MTc5LCJpYXQiOjE3NTQ2NDUzNzl9.g2xkwaskoaQf9D1KtdWbI8AB4PdXmoDh0PQE7Ov_cPI'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:59:41.383 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60585'
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:59:41.383 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTM3OSwiZXhwIjoxNzU0Njc0MTc5LCJpYXQiOjE3NTQ2NDUzNzl9.g2xkwaskoaQf9D1KtdWbI8AB4PdXmoDh0PQE7Ov_cPI'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:59:41.383 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select * from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0  
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) a --where UStatus like ''%Hold%'' 
'
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:59:41.399 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTM3OSwiZXhwIjoxNzU0Njc0MTc5LCJpYXQiOjE3NTQ2NDUzNzl9.g2xkwaskoaQf9D1KtdWbI8AB4PdXmoDh0PQE7Ov_cPI'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:59:41.399 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select * from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0  
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) a where UnitStatus=''Vacant''
'
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:59:41.415 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTM3OSwiZXhwIjoxNzU0Njc0MTc5LCJpYXQiOjE3NTQ2NDUzNzl9.g2xkwaskoaQf9D1KtdWbI8AB4PdXmoDh0PQE7Ov_cPI'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:59:41.415 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60586'
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:59:41.415 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select * from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0  
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) a where UnitStatus=''Occupied'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:59:41.415 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTM3OSwiZXhwIjoxNzU0Njc0MTc5LCJpYXQiOjE3NTQ2NDUzNzl9.g2xkwaskoaQf9D1KtdWbI8AB4PdXmoDh0PQE7Ov_cPI'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:59:41.415 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTM3OSwiZXhwIjoxNzU0Njc0MTc5LCJpYXQiOjE3NTQ2NDUzNzl9.g2xkwaskoaQf9D1KtdWbI8AB4PdXmoDh0PQE7Ov_cPI'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:59:41.430 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60587'
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:59:41.430 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTM3OSwiZXhwIjoxNzU0Njc0MTc5LCJpYXQiOjE3NTQ2NDUzNzl9.g2xkwaskoaQf9D1KtdWbI8AB4PdXmoDh0PQE7Ov_cPI'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:59:41.446 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select * from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0  
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) a  where UnitStatus=''Expired'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:59:41.446 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTM3OSwiZXhwIjoxNzU0Njc0MTc5LCJpYXQiOjE3NTQ2NDUzNzl9.g2xkwaskoaQf9D1KtdWbI8AB4PdXmoDh0PQE7Ov_cPI'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:59:41.446 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60588'
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:59:41.446 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTM3OSwiZXhwIjoxNzU0Njc0MTc5LCJpYXQiOjE3NTQ2NDUzNzl9.g2xkwaskoaQf9D1KtdWbI8AB4PdXmoDh0PQE7Ov_cPI'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:59:41.462 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select * from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0  
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) a where UStatus like ''%Case%'' 
'
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:59:41.462 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60583'
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:59:41.462 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTM3OSwiZXhwIjoxNzU0Njc0MTc5LCJpYXQiOjE3NTQ2NDUzNzl9.g2xkwaskoaQf9D1KtdWbI8AB4PdXmoDh0PQE7Ov_cPI'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:59:41.462 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTM3OSwiZXhwIjoxNzU0Njc0MTc5LCJpYXQiOjE3NTQ2NDUzNzl9.g2xkwaskoaQf9D1KtdWbI8AB4PdXmoDh0PQE7Ov_cPI'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:59:41.477 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60584'
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:59:41.493 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTM3OSwiZXhwIjoxNzU0Njc0MTc5LCJpYXQiOjE3NTQ2NDUzNzl9.g2xkwaskoaQf9D1KtdWbI8AB4PdXmoDh0PQE7Ov_cPI'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:59:41.508 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select * from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0  
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) a --where UStatus like ''%Hold%'' 
'
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:59:41.508 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTM3OSwiZXhwIjoxNzU0Njc0MTc5LCJpYXQiOjE3NTQ2NDUzNzl9.g2xkwaskoaQf9D1KtdWbI8AB4PdXmoDh0PQE7Ov_cPI'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:59:41.524 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60585'
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:59:41.524 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTM3OSwiZXhwIjoxNzU0Njc0MTc5LCJpYXQiOjE3NTQ2NDUzNzl9.g2xkwaskoaQf9D1KtdWbI8AB4PdXmoDh0PQE7Ov_cPI'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:59:41.540 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 '/*
DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select * from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0  
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) a where UStatus like ''%Reserve%'' 
*/

DECLARE @FROM FLOAT
SET @FROM=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @UnitID BIGINT,@StatusID BIGINT,@TotalAmount FLOAT,@I INT,@COUNT INT,@ContractID BIGINT
DECLARE @NoofDays INT,@VacantSince DATETIME

DECLARE @TAB TABLE(ID INT IDENTITY(1,1) PRIMARY KEY,UnitID BIGINT,CurrentRent FLOAT,Status NVARCHAR(10),NoofDays INT,VacantSince DATETIME,ContractID BIGINT)

INSERT INTO @TAB (UnitID)
SELECT U.UnitID
FROM REN_Units U WITH(NOLOCK) 
LEFT JOIN REN_Property P WITH(NOLOCK) ON P.NodeID=U.PropertyID
LEFT JOIN COM_Lookup LK WITH(NOLOCK) ON U.UnitStatus=LK.NodeID
WHERE U.UnitID>1 AND P.Name <> U.Name AND U.IsGroup=0 AND U.Status=424 and U.UnitStatus=306 
-- AND P.NodeID IN (207)
SELECT @I=1,@COUNT=COUNT(*) FROM @TAB
WHILE(@I<=@COUNT)
BEGIN
	SET @StatusID=0
	SET @TotalAmount=0
	SET @ContractID=0
	SELECT @UnitID=UnitID FROM @TAB WHERE ID=@I

	SELECT TOP 1 @ContractID=(CASE WHEN RefContractID>0 THEN RefContractID ELSE ContractID END),@StatusID=StatusID
	,@VacantSince=(CASE WHEN StatusID = 450 THEN ( CASE WHEN RefundDate IS NOT NULL THEN CONVERT(DATETIME,RefundDate) ELSE CONVERT(DATETIME,VacancyDate) END ) 
			ELSE CONVERT(DATETIME,TerminationDate) END )
	,@NoofDays=(CASE WHEN StatusID = 450 THEN (CASE WHEN RefundDate IS NOT NULL THEN DATEDIFF(DAY, CONVERT(DATETIME,RefundDate),CONVERT(DATETIME,@FROM) ) 
			ELSE DATEDIFF(DAY, CONVERT(DATETIME,VacancyDate),CONVERT(DATETIME,@FROM) ) END )
			ELSE DATEDIFF(DAY, CONVERT(DATETIME,TerminationDate),CONVERT(DATETIME,@FROM) ) END )  
	FROM REN_Contract WITH(NOLOCK) WHERE StatusID<>451 AND StartDate<@FROM AND UNITID=@UnitID 
	ORDER BY StartDate DESC,StatusID
	
	SELECT @TotalAmount=ISNULL(SUM(RPD.Amount),MAX(RentAmount)/(CASE WHEN MAX(RC.NoOfUnits)=0 THEN 1 ELSE MAX(RC.NoOfUnits) END)) 
	FROM REN_Contract RC WITH(NOLOCK)
	JOIN REN_ContractParticulars RP WITH(NOLOCK) ON RP.ContractID=RC.ContractID AND RP.Sno=1
	LEFT JOIN REN_ContractParticularsDetail RPD WITH(NOLOCK) ON RPD.ParticularNodeID=RP.NodeID AND RPD.Unit=@UnitID 
	AND @FROM BETWEEN ISNULL(RPD.FromDate,@FROM) AND ISNULL(RPD.ToDate,@FROM)
	WHERE RC.ContractID=@ContractID
	
	IF @StatusID=427 OR @StatusID=426 OR @StatusID=466
	BEGIN
		UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Occupied'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
	END
	ELSE IF @StatusID=440
	BEGIN
		UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''UnAproved'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
	END
	ELSE IF @StatusID=428 OR @StatusID=450
	BEGIN 
		IF EXISTS (SELECT * FROM REN_Quotation WITH(NOLOCK) WHERE COSTCENTERID=129 AND UNITID=@UnitID AND CONVERT(DATETIME,@FROM) BETWEEN CONVERT(DATETIME,STARTDATE) AND CONVERT(DATETIME,ENDDATE) and statusid=467 )
			UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Reserved'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
		ELSE IF EXISTS (SELECT * FROM REN_Quotation WITH(NOLOCK) WHERE COSTCENTERID=103 AND UNITID=@UnitID AND CONVERT(DATETIME,@FROM) BETWEEN CONVERT(DATETIME,STARTDATE) AND CONVERT(DATETIME,ENDDATE) and statusid=426 )
			UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Quoted'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
		ELSE
			UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Vacant'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
	END
	ELSE
	BEGIN 
		IF EXISTS (SELECT * FROM REN_Quotation WITH(NOLOCK) WHERE COSTCENTERID=129 AND UNITID=@UnitID AND CONVERT(DATETIME,@FROM) BETWEEN CONVERT(DATETIME,STARTDATE) AND CONVERT(DATETIME,ENDDATE) and statusid=467 )
			UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Reserved'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
		ELSE IF EXISTS (SELECT * FROM REN_Quotation WITH(NOLOCK) WHERE COSTCENTERID=103 AND UNITID=@UnitID AND CONVERT(DATETIME,@FROM) BETWEEN CONVERT(DATETIME,STARTDATE) AND CONVERT(DATETIME,ENDDATE) and statusid=426 )
			UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Quoted'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
		ELSE
			UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Vacant'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
	END
	set @I=@I+1
END

select * from (
SELECT TEMP.*,RP.NodeID Building_ID,RP.NAME Property,TEMP.UnitID Unit_ID,RU.NAME Unit,C18.NAME UnitType,RU.UnitStatus,RU.RentableArea UnitArea,RU.RentPerSQFT UnitRate
,RU.AnnualRent 
,T.FirstName AS [C98c7d2679f99489e9f0e010026eeb563]
,RUL.Name LandLord , RUC.Name Location 
,1 Cnt
FROM @TAB TEMP
JOIN REN_Units RU WITH(NOLOCK) ON TEMP.UnitID=RU.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
LEFT JOIN COM_CC50018 C18 WITH(NOLOCK) ON C18.NodeID=RU.NodeID
LEFT JOIN REN_Contract C WITH(NOLOCK) ON TEMP.ContractID=C.ContractID
LEFT JOIN REN_Tenant T WITH(NOLOCK) ON T.TenantID=C.TenantID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID

 )a where a.Status =''Reserved''
 order by Property,VacantSince'
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:59:41.540 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select * from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0  
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) a where UnitStatus=''Vacant''
'
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:59:41.540 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTM3OSwiZXhwIjoxNzU0Njc0MTc5LCJpYXQiOjE3NTQ2NDUzNzl9.g2xkwaskoaQf9D1KtdWbI8AB4PdXmoDh0PQE7Ov_cPI'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:59:41.540 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTM3OSwiZXhwIjoxNzU0Njc0MTc5LCJpYXQiOjE3NTQ2NDUzNzl9.g2xkwaskoaQf9D1KtdWbI8AB4PdXmoDh0PQE7Ov_cPI'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:59:41.540 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60586'
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:59:41.540 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select * from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0  
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) a where UnitStatus=''Occupied'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:59:41.540 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTM3OSwiZXhwIjoxNzU0Njc0MTc5LCJpYXQiOjE3NTQ2NDUzNzl9.g2xkwaskoaQf9D1KtdWbI8AB4PdXmoDh0PQE7Ov_cPI'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:59:41.540 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTM3OSwiZXhwIjoxNzU0Njc0MTc5LCJpYXQiOjE3NTQ2NDUzNzl9.g2xkwaskoaQf9D1KtdWbI8AB4PdXmoDh0PQE7Ov_cPI'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:59:41.571 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60587'
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:59:41.571 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select * from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0  
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) a  where UnitStatus=''Expired'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:59:41.571 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTM3OSwiZXhwIjoxNzU0Njc0MTc5LCJpYXQiOjE3NTQ2NDUzNzl9.g2xkwaskoaQf9D1KtdWbI8AB4PdXmoDh0PQE7Ov_cPI'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:59:41.571 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTM3OSwiZXhwIjoxNzU0Njc0MTc5LCJpYXQiOjE3NTQ2NDUzNzl9.g2xkwaskoaQf9D1KtdWbI8AB4PdXmoDh0PQE7Ov_cPI'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:59:41.602 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select * from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0  
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) a where UStatus like ''%Case%'' 
'
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:59:41.602 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTM3OSwiZXhwIjoxNzU0Njc0MTc5LCJpYXQiOjE3NTQ2NDUzNzl9.g2xkwaskoaQf9D1KtdWbI8AB4PdXmoDh0PQE7Ov_cPI'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:59:41.618 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60588'
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:59:41.618 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTM3OSwiZXhwIjoxNzU0Njc0MTc5LCJpYXQiOjE3NTQ2NDUzNzl9.g2xkwaskoaQf9D1KtdWbI8AB4PdXmoDh0PQE7Ov_cPI'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:59:41.680 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 '/*
DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select * from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0  
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) a where UStatus like ''%Reserve%'' 
*/

DECLARE @FROM FLOAT
SET @FROM=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @UnitID BIGINT,@StatusID BIGINT,@TotalAmount FLOAT,@I INT,@COUNT INT,@ContractID BIGINT
DECLARE @NoofDays INT,@VacantSince DATETIME

DECLARE @TAB TABLE(ID INT IDENTITY(1,1) PRIMARY KEY,UnitID BIGINT,CurrentRent FLOAT,Status NVARCHAR(10),NoofDays INT,VacantSince DATETIME,ContractID BIGINT)

INSERT INTO @TAB (UnitID)
SELECT U.UnitID
FROM REN_Units U WITH(NOLOCK) 
LEFT JOIN REN_Property P WITH(NOLOCK) ON P.NodeID=U.PropertyID
LEFT JOIN COM_Lookup LK WITH(NOLOCK) ON U.UnitStatus=LK.NodeID
WHERE U.UnitID>1 AND P.Name <> U.Name AND U.IsGroup=0 AND U.Status=424 and U.UnitStatus=306 
-- AND P.NodeID IN (207)
SELECT @I=1,@COUNT=COUNT(*) FROM @TAB
WHILE(@I<=@COUNT)
BEGIN
	SET @StatusID=0
	SET @TotalAmount=0
	SET @ContractID=0
	SELECT @UnitID=UnitID FROM @TAB WHERE ID=@I

	SELECT TOP 1 @ContractID=(CASE WHEN RefContractID>0 THEN RefContractID ELSE ContractID END),@StatusID=StatusID
	,@VacantSince=(CASE WHEN StatusID = 450 THEN ( CASE WHEN RefundDate IS NOT NULL THEN CONVERT(DATETIME,RefundDate) ELSE CONVERT(DATETIME,VacancyDate) END ) 
			ELSE CONVERT(DATETIME,TerminationDate) END )
	,@NoofDays=(CASE WHEN StatusID = 450 THEN (CASE WHEN RefundDate IS NOT NULL THEN DATEDIFF(DAY, CONVERT(DATETIME,RefundDate),CONVERT(DATETIME,@FROM) ) 
			ELSE DATEDIFF(DAY, CONVERT(DATETIME,VacancyDate),CONVERT(DATETIME,@FROM) ) END )
			ELSE DATEDIFF(DAY, CONVERT(DATETIME,TerminationDate),CONVERT(DATETIME,@FROM) ) END )  
	FROM REN_Contract WITH(NOLOCK) WHERE StatusID<>451 AND StartDate<@FROM AND UNITID=@UnitID 
	ORDER BY StartDate DESC,StatusID
	
	SELECT @TotalAmount=ISNULL(SUM(RPD.Amount),MAX(RentAmount)/(CASE WHEN MAX(RC.NoOfUnits)=0 THEN 1 ELSE MAX(RC.NoOfUnits) END)) 
	FROM REN_Contract RC WITH(NOLOCK)
	JOIN REN_ContractParticulars RP WITH(NOLOCK) ON RP.ContractID=RC.ContractID AND RP.Sno=1
	LEFT JOIN REN_ContractParticularsDetail RPD WITH(NOLOCK) ON RPD.ParticularNodeID=RP.NodeID AND RPD.Unit=@UnitID 
	AND @FROM BETWEEN ISNULL(RPD.FromDate,@FROM) AND ISNULL(RPD.ToDate,@FROM)
	WHERE RC.ContractID=@ContractID
	
	IF @StatusID=427 OR @StatusID=426 OR @StatusID=466
	BEGIN
		UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Occupied'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
	END
	ELSE IF @StatusID=440
	BEGIN
		UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''UnAproved'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
	END
	ELSE IF @StatusID=428 OR @StatusID=450
	BEGIN 
		IF EXISTS (SELECT * FROM REN_Quotation WITH(NOLOCK) WHERE COSTCENTERID=129 AND UNITID=@UnitID AND CONVERT(DATETIME,@FROM) BETWEEN CONVERT(DATETIME,STARTDATE) AND CONVERT(DATETIME,ENDDATE) and statusid=467 )
			UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Reserved'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
		ELSE IF EXISTS (SELECT * FROM REN_Quotation WITH(NOLOCK) WHERE COSTCENTERID=103 AND UNITID=@UnitID AND CONVERT(DATETIME,@FROM) BETWEEN CONVERT(DATETIME,STARTDATE) AND CONVERT(DATETIME,ENDDATE) and statusid=426 )
			UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Quoted'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
		ELSE
			UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Vacant'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
	END
	ELSE
	BEGIN 
		IF EXISTS (SELECT * FROM REN_Quotation WITH(NOLOCK) WHERE COSTCENTERID=129 AND UNITID=@UnitID AND CONVERT(DATETIME,@FROM) BETWEEN CONVERT(DATETIME,STARTDATE) AND CONVERT(DATETIME,ENDDATE) and statusid=467 )
			UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Reserved'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
		ELSE IF EXISTS (SELECT * FROM REN_Quotation WITH(NOLOCK) WHERE COSTCENTERID=103 AND UNITID=@UnitID AND CONVERT(DATETIME,@FROM) BETWEEN CONVERT(DATETIME,STARTDATE) AND CONVERT(DATETIME,ENDDATE) and statusid=426 )
			UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Quoted'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
		ELSE
			UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Vacant'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
	END
	set @I=@I+1
END

select * from (
SELECT TEMP.*,RP.NodeID Building_ID,RP.NAME Property,TEMP.UnitID Unit_ID,RU.NAME Unit,C18.NAME UnitType,RU.UnitStatus,RU.RentableArea UnitArea,RU.RentPerSQFT UnitRate
,RU.AnnualRent 
,T.FirstName AS [C98c7d2679f99489e9f0e010026eeb563]
,RUL.Name LandLord , RUC.Name Location 
,1 Cnt
FROM @TAB TEMP
JOIN REN_Units RU WITH(NOLOCK) ON TEMP.UnitID=RU.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
LEFT JOIN COM_CC50018 C18 WITH(NOLOCK) ON C18.NodeID=RU.NodeID
LEFT JOIN REN_Contract C WITH(NOLOCK) ON TEMP.ContractID=C.ContractID
LEFT JOIN REN_Tenant T WITH(NOLOCK) ON T.TenantID=C.TenantID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID

 )a where a.Status =''Reserved''
 order by Property,VacantSince'
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:59:41.680 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTM3OSwiZXhwIjoxNzU0Njc0MTc5LCJpYXQiOjE3NTQ2NDUzNzl9.g2xkwaskoaQf9D1KtdWbI8AB4PdXmoDh0PQE7Ov_cPI'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:59:42.696 | General Service|:: CompanyIndex:53 SpName: spADM_GetCostCenterGridViewList 
 2
 ,1
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:59:42.696 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTM3OSwiZXhwIjoxNzU0Njc0MTc5LCJpYXQiOjE3NTQ2NDUzNzl9.g2xkwaskoaQf9D1KtdWbI8AB4PdXmoDh0PQE7Ov_cPI'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:59:42.727 | General Service|:: CompanyIndex:53 SpName: spCom_GetCostCenterSummary 
 126
 ,-1
 ,1000
 ,''
 ,''
 ,''
 ,0
 ,'08-Aug-2025'
 ,NULL
 ,''
 ,1
 ,1
 ,0
 ,0
 ,False
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:59:42.743 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTM3OSwiZXhwIjoxNzU0Njc0MTc5LCJpYXQiOjE3NTQ2NDUzNzl9.g2xkwaskoaQf9D1KtdWbI8AB4PdXmoDh0PQE7Ov_cPI'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:59:45.914 | General Service|:: CompanyIndex:53 SpName: spADM_GetCostCenterGridViewList 
 2
 ,1
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:59:45.914 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTM3OSwiZXhwIjoxNzU0Njc0MTc5LCJpYXQiOjE3NTQ2NDUzNzl9.g2xkwaskoaQf9D1KtdWbI8AB4PdXmoDh0PQE7Ov_cPI'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:59:45.961 | General Service|:: CompanyIndex:53 SpName: spCom_GetCostCenterSummary 
 126
 ,-1
 ,1000
 ,''
 ,''
 ,''
 ,0
 ,'08-Aug-2025'
 ,NULL
 ,''
 ,1
 ,1
 ,0
 ,0
 ,False
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:59:45.961 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTM3OSwiZXhwIjoxNzU0Njc0MTc5LCJpYXQiOjE3NTQ2NDUzNzl9.g2xkwaskoaQf9D1KtdWbI8AB4PdXmoDh0PQE7Ov_cPI'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:59:49.717 | General Service|:: CompanyIndex:53 SpName: spADM_GetCostCenterGridViewList 
 2
 ,1
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:59:49.717 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTM3OSwiZXhwIjoxNzU0Njc0MTc5LCJpYXQiOjE3NTQ2NDUzNzl9.g2xkwaskoaQf9D1KtdWbI8AB4PdXmoDh0PQE7Ov_cPI'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:59:49.811 | General Service|:: CompanyIndex:53 SpName: spCom_GetCostCenterSummary 
 126
 ,-1
 ,1000
 ,''
 ,''
 ,''
 ,0
 ,'08-Aug-2025'
 ,NULL
 ,''
 ,1
 ,1
 ,0
 ,0
 ,False
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 14:59:49.811 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTM3OSwiZXhwIjoxNzU0Njc0MTc5LCJpYXQiOjE3NTQ2NDUzNzl9.g2xkwaskoaQf9D1KtdWbI8AB4PdXmoDh0PQE7Ov_cPI'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 15:00:40.469 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 15:00:40.469 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTM3OSwiZXhwIjoxNzU0Njc0MTc5LCJpYXQiOjE3NTQ2NDUzNzl9.g2xkwaskoaQf9D1KtdWbI8AB4PdXmoDh0PQE7Ov_cPI'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 15:01:40.445 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 15:01:40.445 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTM3OSwiZXhwIjoxNzU0Njc0MTc5LCJpYXQiOjE3NTQ2NDUzNzl9.g2xkwaskoaQf9D1KtdWbI8AB4PdXmoDh0PQE7Ov_cPI'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-08-2025 15:02:28.491 | General Service|:: CompanyIndex:0 SpName: spADM_GetClientUserDetails2C 
 'admin'
 ,1
 ,0
[System: 192.168.1.77] DEBUG | 08-08-2025 15:02:28.678 | General Service|:: CompanyIndex:0 SpName: spADM_UserLoginCheck 
 2
 ,'admin'
 ,0
 ,'192.168.1.77'
 ,'192.168.1.77'
 ,''
 ,'Web'
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 15:02:40.457 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 15:02:40.457 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTM3OSwiZXhwIjoxNzU0Njc0MTc5LCJpYXQiOjE3NTQ2NDUzNzl9.g2xkwaskoaQf9D1KtdWbI8AB4PdXmoDh0PQE7Ov_cPI'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-08-2025 15:02:52.473 | General Service|:: CompanyIndex:53 SpName: spADM_GetClientUserDetails 
 'admin'
 ,1
 ,'26.2.9'
 ,0
[System: 192.168.1.77] DEBUG | 08-08-2025 15:02:52.598 | General Service|:: CompanyIndex:0 SpName: spADM_UserLoginCheck 
 2
 ,'admin'
 ,53
 ,'192.168.1.77'
 ,'192.168.1.77'
 ,''
 ,'Web'
 ,1
[System: 192.168.1.77] DEBUG | 08-08-2025 15:02:52.614 | General Service|:: CompanyIndex:0 SpName: spADM_Login 
 1
 ,''
 ,''
 ,''
 ,''
 ,''
 ,53
[System: 192.168.1.77] DEBUG | 08-08-2025 15:02:52.630 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select Value from ADM_GlobalPreferences with (nolock) where name =''EnableReLogin'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-08-2025 15:02:52.630 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTU3MiwiZXhwIjoxNzU0Njc0MzcyLCJpYXQiOjE3NTQ2NDU1NzJ9.dWQSKvWvNOCDHdN0as-Ifeffeam7nzOFLKbpJhu5Ocw'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-08-2025 15:02:52.677 | General Service|:: CompanyIndex:0 SpName: spADM_Login 
 4
 ,''
 ,''
 ,''
 ,'declare @Cnt int,@ExpiredGUID nvarchar(50),@AllowSession int,@GUID nvarchar(50),@CurrDate float,@UserID INT,@Instances INT,@InstancesExists INT,@LCDBIndex int
set @CurrDate= convert(float,dateadd(minute,-21,getdate()))
set @AllowSession=0
set @GUID=''9c62d1c4-6a96-4ea5-9de0-4093d8a85b1d''
set @LCDBIndex=0
select top 1 @UserID=UserID,@Instances=InstanceCount from ADM_Users with(nolock) where UserName=''admin''
if exists(select [GUID] from ADM_Login with(nolock) where [GUID]=@GUID)
begin
	update ADM_Login 
	set LastAccessTime=convert(float,getdate()),UserID=@UserID
	where [GUID]=@GUID
    set @AllowSession=1
end
else
begin
	select @Cnt=count(*) from ADM_Login with(nolock) where LCDBIndex=@LCDBIndex and [GUID]!=''ACCESSRIGHTS'' and AP =''WEB''
    if(@Cnt<100)
		set @AllowSession=1
	else
	begin
		select top 1 @ExpiredGUID=[GUID] from ADM_Login with(nolock)
		where [GUID]!=''ACCESSRIGHTS'' and LCDBIndex=@LCDBIndex and LastAccessTime<@CurrDate  and AP =''WEB''
        order by LastAccessTime asc
		if @ExpiredGUID is not null
		begin
			delete from ADM_Login where [GUID]=@ExpiredGUID
			set @AllowSession=1
		end
	end
	if @AllowSession=1
	begin
        select @InstancesExists=COUNT(*) from ADM_Login with(nolock)
		where [GUID]!=''ACCESSRIGHTS'' and LCDBIndex=@LCDBIndex and LastAccessTime>=@CurrDate and UserID=@UserID and AP =''WEB''
		if(@Instances!=0 and @Instances<=@InstancesExists)
			set @AllowSession=2
		else
		    INSERT INTO ADM_Login([GUID],[SysName],IPAddress,[Status],LoginTime,LastAccessTime,AccessRights,UserID,DBIndex,LCDBIndex,AP)
		    VALUES(@GUID,''WEB'',''192.168.1.77'',1,convert(float,getdate()),convert(float,getdate()),null,@UserID,53,@LCDBIndex, ''WEB'')
	end
end

select @AllowSession AllowSession,@Instances Instances,@InstancesExists InstancesExists
'
 ,''
 ,0
[System: 192.168.1.77] DEBUG | 08-08-2025 15:02:52.692 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTU3MiwiZXhwIjoxNzU0Njc0MzcyLCJpYXQiOjE3NTQ2NDU1NzJ9.dWQSKvWvNOCDHdN0as-Ifeffeam7nzOFLKbpJhu5Ocw'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-08-2025 15:02:52.708 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT (SELECT COUNT(*) FROM COM_Location L WITH(NOLOCK) JOIN COM_Status S WITH(NOLOCK) ON S.StatusID=L.StatusID WHERE L.IsGroup=0 AND S.[Status]=''Active'') ML
,(SELECT COUNT(*) FROM ADM_Features WITH(NOLOCK) WHERE ((FeatureID>50000 AND FeatureID<=50050) OR FeatureID>=51000) AND IsEnabled=1) MD
,(SELECT ISNULL(COUNT(*),0) FROM ADM_RevenUReports WITH(NOLOCK) WHERE IsGroup=0 AND ReportID>10000 AND StaticReportType IN (0,-1)) MR'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-08-2025 15:02:52.708 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTU3MiwiZXhwIjoxNzU0Njc0MzcyLCJpYXQiOjE3NTQ2NDU1NzJ9.dWQSKvWvNOCDHdN0as-Ifeffeam7nzOFLKbpJhu5Ocw'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-08-2025 15:02:52.739 | General Service|:: CompanyIndex:53 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.77] DEBUG | 08-08-2025 15:02:52.754 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTU3MiwiZXhwIjoxNzU0Njc0MzcyLCJpYXQiOjE3NTQ2NDU1NzJ9.dWQSKvWvNOCDHdN0as-Ifeffeam7nzOFLKbpJhu5Ocw'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-08-2025 15:02:52.958 | General Service|:: CompanyIndex:53 SpName: spADM_GetRibbonView 
 1
 ,1
 ,1
 ,1
 ,0
 ,''
[System: 192.168.1.77] DEBUG | 08-08-2025 15:02:52.958 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTU3MiwiZXhwIjoxNzU0Njc0MzcyLCJpYXQiOjE3NTQ2NDU1NzJ9.dWQSKvWvNOCDHdN0as-Ifeffeam7nzOFLKbpJhu5Ocw'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-08-2025 15:02:53.239 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 2
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.77] DEBUG | 08-08-2025 15:02:53.254 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTU3MiwiZXhwIjoxNzU0Njc0MzcyLCJpYXQiOjE3NTQ2NDU1NzJ9.dWQSKvWvNOCDHdN0as-Ifeffeam7nzOFLKbpJhu5Ocw'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-08-2025 15:02:53.270 | General Service|:: CompanyIndex:53 SpName: spADM_GetDashBoard 
 2
 ,0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.77] DEBUG | 08-08-2025 15:02:53.270 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTU3MiwiZXhwIjoxNzU0Njc0MzcyLCJpYXQiOjE3NTQ2NDU1NzJ9.dWQSKvWvNOCDHdN0as-Ifeffeam7nzOFLKbpJhu5Ocw'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-08-2025 15:02:53.301 | General Service|:: CompanyIndex:53 SpName: spCOM_ConfigValues 
 1
 ,'LandingDocs'
 ,'1'
[System: 192.168.1.77] DEBUG | 08-08-2025 15:02:53.301 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTU3MiwiZXhwIjoxNzU0Njc0MzcyLCJpYXQiOjE3NTQ2NDU1NzJ9.dWQSKvWvNOCDHdN0as-Ifeffeam7nzOFLKbpJhu5Ocw'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-08-2025 15:02:53.348 | General Service|:: CompanyIndex:53 SpName: spCOM_GetFavorites 
 'GETLIST0'
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.77] DEBUG | 08-08-2025 15:02:53.364 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTU3MiwiZXhwIjoxNzU0Njc0MzcyLCJpYXQiOjE3NTQ2NDU1NzJ9.dWQSKvWvNOCDHdN0as-Ifeffeam7nzOFLKbpJhu5Ocw'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-08-2025 15:02:53.364 | General Service|:: CompanyIndex:53 SpName: spADM_GetAllListViewsDef 
 1
 ,1
[System: 192.168.1.77] DEBUG | 08-08-2025 15:02:53.379 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTU3MiwiZXhwIjoxNzU0Njc0MzcyLCJpYXQiOjE3NTQ2NDU1NzJ9.dWQSKvWvNOCDHdN0as-Ifeffeam7nzOFLKbpJhu5Ocw'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-08-2025 15:02:53.504 | General Service|:: CompanyIndex:53 SpName: spADM_GetAllListViewsDef 
 1
 ,1
[System: 192.168.1.77] DEBUG | 08-08-2025 15:02:53.520 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTU3MiwiZXhwIjoxNzU0Njc0MzcyLCJpYXQiOjE3NTQ2NDU1NzJ9.dWQSKvWvNOCDHdN0as-Ifeffeam7nzOFLKbpJhu5Ocw'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-08-2025 15:02:53.723 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'Select CostCenterID,CostCenterColID,CostCenterName,SysTableName,UserColumnName,SysColumnName,ISNULL(UserDefaultValue,'''') UserDefaultValue
From AdM_CostCenterDef WITH(NOLOCK)
Where SysColumnName IN(''CreditAccount'',''DebitAccount'',''ProductID'') 
AND CostCenterID>40000 AND CostCenterID<50000 

SELECT * FROM ADM_Features WITH(NOLOCK) '
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-08-2025 15:02:53.723 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTU3MiwiZXhwIjoxNzU0Njc0MzcyLCJpYXQiOjE3NTQ2NDU1NzJ9.dWQSKvWvNOCDHdN0as-Ifeffeam7nzOFLKbpJhu5Ocw'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-08-2025 15:02:53.786 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 '  SELECT * FROM PAY_PayrollPreferences WITH(NOLOCK) '
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-08-2025 15:02:53.801 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTU3MiwiZXhwIjoxNzU0Njc0MzcyLCJpYXQiOjE3NTQ2NDU1NzJ9.dWQSKvWvNOCDHdN0as-Ifeffeam7nzOFLKbpJhu5Ocw'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-08-2025 15:02:53.832 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 '  --0
                                Select * FROM COM_CC50051 WITH(NOLOCK) WHERE IsGroup=0 AND LoginUserID=''admin''
                                --1                                
                                Select * FROM COM_CC50051 WITH(NOLOCK) WHERE RptManager IN (Select NodeID FROM COM_CC50051 WITH(NOLOCK) WHERE IsGroup=0 AND LoginUserID=''admin'')
                                UNION ALL
                                Select * FROM COM_CC50051 WITH(NOLOCK) WHERE RptManager IN 
                                (
	                                Select NodeID FROM COM_CC50051 WITH(NOLOCK) 
	                                WHERE IsGroup=0 AND LoginUserID IN
	                                (
	                                SELECT fe.LoginUserID
	                                FROM INV_DocDetails a WITH(NOLOCK) 
	                                JOIN COM_DocCCData b WITH(NOLOCK) ON b.InvDocDetailsID=a.InvDocDetailsID
	                                JOIN COM_DocNumData c WITH(NOLOCK) ON c.InvDocDetailsID=a.InvDocDetailsID
	                                JOIN COM_DocTextData d WITH(NOLOCK) ON d.InvDocDetailsID=a.InvDocDetailsID
	                                JOIN COM_CC50051 fe WITH(NOLOCK) on fe.NodeID=b.dcCCNID51
	                                JOIN COM_CC50051 te WITH(NOLOCK) on CONVERT(NVARCHAR,te.NodeID)=d.dcAlpha1
	                                WHERE a.CostCenterID=40098 and a.StatusID=369 AND d.dcAlpha3=''Temporary''
	                                AND te.LoginUserID=''admin'' 
	                                AND ISDATE(d.dcAlpha4)=1 AND ISDATE(d.dcAlpha5)=1 
	                                AND CONVERT(DATETIME,''08 Aug 2025'') BETWEEN CONVERT(DATETIME,d.dcAlpha4) AND CONVERT(DATETIME,d.dcAlpha5)
	                                )
                                )
                                --2
                                Select * FROM ADM_USERS WITH(NOLOCK) WHERE USERID=1
                                --3
                                Select * FROM COM_CostCenterCostCenterMap WITH(NOLOCK) WHERE ParentCostCenterID=7 AND ParentNodeID=1
                                --4                                
                                Select * FROM COM_CostCenterCostCenterMap WITH(NOLOCK) WHERE ParentCostCenterID=7 AND ParentNodeID=1
                                AND CostCenterID IN(Select ColumnCostCenterID From ADM_CostCenterDef Where CostCenterID=50051 AND IsColumnInUse=1 AND SysColumnName LIKE ''CCNID%'')
                                --5
                                Select * from COM_Files WITH(NOLOCK) WHERE FeatureID=50051 AND FeaturePK IN (Select NodeID FROM COM_CC50051 WITH(NOLOCK) WHERE IsGroup=0 AND LoginUserID=''admin'')                         
'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-08-2025 15:02:53.848 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTU3MiwiZXhwIjoxNzU0Njc0MzcyLCJpYXQiOjE3NTQ2NDU1NzJ9.dWQSKvWvNOCDHdN0as-Ifeffeam7nzOFLKbpJhu5Ocw'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-08-2025 15:02:54.051 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-08-2025 15:02:54.067 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTU3MiwiZXhwIjoxNzU0Njc0MzcyLCJpYXQiOjE3NTQ2NDU1NzJ9.dWQSKvWvNOCDHdN0as-Ifeffeam7nzOFLKbpJhu5Ocw'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-08-2025 15:02:54.676 | General Service|:: CompanyIndex:53 SpName: spADM_GetDashBoard 
 1
 ,41
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.77] DEBUG | 08-08-2025 15:02:54.707 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTU3MiwiZXhwIjoxNzU0Njc0MzcyLCJpYXQiOjE3NTQ2NDU1NzJ9.dWQSKvWvNOCDHdN0as-Ifeffeam7nzOFLKbpJhu5Ocw'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-08-2025 15:02:54.738 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,60584
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.77] DEBUG | 08-08-2025 15:02:54.738 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,60583
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.77] DEBUG | 08-08-2025 15:02:54.754 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,60585
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.77] DEBUG | 08-08-2025 15:02:54.754 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,60587
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.77] DEBUG | 08-08-2025 15:02:54.754 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTU3MiwiZXhwIjoxNzU0Njc0MzcyLCJpYXQiOjE3NTQ2NDU1NzJ9.dWQSKvWvNOCDHdN0as-Ifeffeam7nzOFLKbpJhu5Ocw'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-08-2025 15:02:54.754 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTU3MiwiZXhwIjoxNzU0Njc0MzcyLCJpYXQiOjE3NTQ2NDU1NzJ9.dWQSKvWvNOCDHdN0as-Ifeffeam7nzOFLKbpJhu5Ocw'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-08-2025 15:02:54.754 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,60586
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.77] DEBUG | 08-08-2025 15:02:54.754 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTU3MiwiZXhwIjoxNzU0Njc0MzcyLCJpYXQiOjE3NTQ2NDU1NzJ9.dWQSKvWvNOCDHdN0as-Ifeffeam7nzOFLKbpJhu5Ocw'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-08-2025 15:02:54.754 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTU3MiwiZXhwIjoxNzU0Njc0MzcyLCJpYXQiOjE3NTQ2NDU1NzJ9.dWQSKvWvNOCDHdN0as-Ifeffeam7nzOFLKbpJhu5Ocw'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-08-2025 15:02:54.754 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTU3MiwiZXhwIjoxNzU0Njc0MzcyLCJpYXQiOjE3NTQ2NDU1NzJ9.dWQSKvWvNOCDHdN0as-Ifeffeam7nzOFLKbpJhu5Ocw'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-08-2025 15:02:54.770 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,60588
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.77] DEBUG | 08-08-2025 15:02:54.770 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTU3MiwiZXhwIjoxNzU0Njc0MzcyLCJpYXQiOjE3NTQ2NDU1NzJ9.dWQSKvWvNOCDHdN0as-Ifeffeam7nzOFLKbpJhu5Ocw'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-08-2025 15:02:54.770 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,60584
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.77] DEBUG | 08-08-2025 15:02:54.770 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.77] DEBUG | 08-08-2025 15:02:54.770 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,60585
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.77] DEBUG | 08-08-2025 15:02:54.770 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,60587
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.77] DEBUG | 08-08-2025 15:02:54.770 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTU3MiwiZXhwIjoxNzU0Njc0MzcyLCJpYXQiOjE3NTQ2NDU1NzJ9.dWQSKvWvNOCDHdN0as-Ifeffeam7nzOFLKbpJhu5Ocw'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-08-2025 15:02:54.770 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTU3MiwiZXhwIjoxNzU0Njc0MzcyLCJpYXQiOjE3NTQ2NDU1NzJ9.dWQSKvWvNOCDHdN0as-Ifeffeam7nzOFLKbpJhu5Ocw'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-08-2025 15:02:54.770 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTU3MiwiZXhwIjoxNzU0Njc0MzcyLCJpYXQiOjE3NTQ2NDU1NzJ9.dWQSKvWvNOCDHdN0as-Ifeffeam7nzOFLKbpJhu5Ocw'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-08-2025 15:02:54.785 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,60583
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.77] DEBUG | 08-08-2025 15:02:54.785 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTU3MiwiZXhwIjoxNzU0Njc0MzcyLCJpYXQiOjE3NTQ2NDU1NzJ9.dWQSKvWvNOCDHdN0as-Ifeffeam7nzOFLKbpJhu5Ocw'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-08-2025 15:02:54.785 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTU3MiwiZXhwIjoxNzU0Njc0MzcyLCJpYXQiOjE3NTQ2NDU1NzJ9.dWQSKvWvNOCDHdN0as-Ifeffeam7nzOFLKbpJhu5Ocw'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-08-2025 15:02:54.785 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,60586
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.77] DEBUG | 08-08-2025 15:02:54.785 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,60588
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.77] DEBUG | 08-08-2025 15:02:54.785 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.77] DEBUG | 08-08-2025 15:02:54.785 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTU3MiwiZXhwIjoxNzU0Njc0MzcyLCJpYXQiOjE3NTQ2NDU1NzJ9.dWQSKvWvNOCDHdN0as-Ifeffeam7nzOFLKbpJhu5Ocw'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-08-2025 15:02:54.785 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTU3MiwiZXhwIjoxNzU0Njc0MzcyLCJpYXQiOjE3NTQ2NDU1NzJ9.dWQSKvWvNOCDHdN0as-Ifeffeam7nzOFLKbpJhu5Ocw'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-08-2025 15:02:54.785 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTU3MiwiZXhwIjoxNzU0Njc0MzcyLCJpYXQiOjE3NTQ2NDU1NzJ9.dWQSKvWvNOCDHdN0as-Ifeffeam7nzOFLKbpJhu5Ocw'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-08-2025 15:02:54.801 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.77] DEBUG | 08-08-2025 15:02:54.801 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTU3MiwiZXhwIjoxNzU0Njc0MzcyLCJpYXQiOjE3NTQ2NDU1NzJ9.dWQSKvWvNOCDHdN0as-Ifeffeam7nzOFLKbpJhu5Ocw'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-08-2025 15:02:54.817 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.77] DEBUG | 08-08-2025 15:02:54.817 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTU3MiwiZXhwIjoxNzU0Njc0MzcyLCJpYXQiOjE3NTQ2NDU1NzJ9.dWQSKvWvNOCDHdN0as-Ifeffeam7nzOFLKbpJhu5Ocw'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-08-2025 15:02:54.817 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.77] DEBUG | 08-08-2025 15:02:54.832 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTU3MiwiZXhwIjoxNzU0Njc0MzcyLCJpYXQiOjE3NTQ2NDU1NzJ9.dWQSKvWvNOCDHdN0as-Ifeffeam7nzOFLKbpJhu5Ocw'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-08-2025 15:02:54.832 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.77] DEBUG | 08-08-2025 15:02:54.832 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTU3MiwiZXhwIjoxNzU0Njc0MzcyLCJpYXQiOjE3NTQ2NDU1NzJ9.dWQSKvWvNOCDHdN0as-Ifeffeam7nzOFLKbpJhu5Ocw'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-08-2025 15:02:54.848 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.77] DEBUG | 08-08-2025 15:02:54.848 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTU3MiwiZXhwIjoxNzU0Njc0MzcyLCJpYXQiOjE3NTQ2NDU1NzJ9.dWQSKvWvNOCDHdN0as-Ifeffeam7nzOFLKbpJhu5Ocw'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-08-2025 15:02:54.848 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.77] DEBUG | 08-08-2025 15:02:54.863 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTU3MiwiZXhwIjoxNzU0Njc0MzcyLCJpYXQiOjE3NTQ2NDU1NzJ9.dWQSKvWvNOCDHdN0as-Ifeffeam7nzOFLKbpJhu5Ocw'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-08-2025 15:02:54.863 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.77] DEBUG | 08-08-2025 15:02:54.863 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTU3MiwiZXhwIjoxNzU0Njc0MzcyLCJpYXQiOjE3NTQ2NDU1NzJ9.dWQSKvWvNOCDHdN0as-Ifeffeam7nzOFLKbpJhu5Ocw'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-08-2025 15:02:54.879 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.77] DEBUG | 08-08-2025 15:02:54.879 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTU3MiwiZXhwIjoxNzU0Njc0MzcyLCJpYXQiOjE3NTQ2NDU1NzJ9.dWQSKvWvNOCDHdN0as-Ifeffeam7nzOFLKbpJhu5Ocw'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-08-2025 15:02:54.879 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.77] DEBUG | 08-08-2025 15:02:54.879 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTU3MiwiZXhwIjoxNzU0Njc0MzcyLCJpYXQiOjE3NTQ2NDU1NzJ9.dWQSKvWvNOCDHdN0as-Ifeffeam7nzOFLKbpJhu5Ocw'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-08-2025 15:02:54.895 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.77] DEBUG | 08-08-2025 15:02:54.895 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTU3MiwiZXhwIjoxNzU0Njc0MzcyLCJpYXQiOjE3NTQ2NDU1NzJ9.dWQSKvWvNOCDHdN0as-Ifeffeam7nzOFLKbpJhu5Ocw'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-08-2025 15:02:54.989 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60583'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-08-2025 15:02:55.004 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTU3MiwiZXhwIjoxNzU0Njc0MzcyLCJpYXQiOjE3NTQ2NDU1NzJ9.dWQSKvWvNOCDHdN0as-Ifeffeam7nzOFLKbpJhu5Ocw'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-08-2025 15:02:55.160 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReportCategoryandField 
 -1
 ,0
 ,1
 ,0
 ,'1'
 ,1
[System: 192.168.1.77] DEBUG | 08-08-2025 15:02:55.160 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTU3MiwiZXhwIjoxNzU0Njc0MzcyLCJpYXQiOjE3NTQ2NDU1NzJ9.dWQSKvWvNOCDHdN0as-Ifeffeam7nzOFLKbpJhu5Ocw'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-08-2025 15:02:55.254 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60584'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-08-2025 15:02:55.254 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTU3MiwiZXhwIjoxNzU0Njc0MzcyLCJpYXQiOjE3NTQ2NDU1NzJ9.dWQSKvWvNOCDHdN0as-Ifeffeam7nzOFLKbpJhu5Ocw'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-08-2025 15:02:55.270 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60585'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-08-2025 15:02:55.285 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTU3MiwiZXhwIjoxNzU0Njc0MzcyLCJpYXQiOjE3NTQ2NDU1NzJ9.dWQSKvWvNOCDHdN0as-Ifeffeam7nzOFLKbpJhu5Ocw'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-08-2025 15:02:55.301 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select * from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0  
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) a --where UStatus like ''%Hold%'' 
'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-08-2025 15:02:55.301 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTU3MiwiZXhwIjoxNzU0Njc0MzcyLCJpYXQiOjE3NTQ2NDU1NzJ9.dWQSKvWvNOCDHdN0as-Ifeffeam7nzOFLKbpJhu5Ocw'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-08-2025 15:02:55.301 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select * from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0  
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) a where UnitStatus=''Vacant''
'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-08-2025 15:02:55.301 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60586'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-08-2025 15:02:55.301 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select * from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0  
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) a where UnitStatus=''Occupied'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-08-2025 15:02:55.316 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTU3MiwiZXhwIjoxNzU0Njc0MzcyLCJpYXQiOjE3NTQ2NDU1NzJ9.dWQSKvWvNOCDHdN0as-Ifeffeam7nzOFLKbpJhu5Ocw'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-08-2025 15:02:55.316 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTU3MiwiZXhwIjoxNzU0Njc0MzcyLCJpYXQiOjE3NTQ2NDU1NzJ9.dWQSKvWvNOCDHdN0as-Ifeffeam7nzOFLKbpJhu5Ocw'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-08-2025 15:02:55.316 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTU3MiwiZXhwIjoxNzU0Njc0MzcyLCJpYXQiOjE3NTQ2NDU1NzJ9.dWQSKvWvNOCDHdN0as-Ifeffeam7nzOFLKbpJhu5Ocw'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-08-2025 15:02:55.348 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60587'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-08-2025 15:02:55.348 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select * from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0  
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) a  where UnitStatus=''Expired'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-08-2025 15:02:55.348 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTU3MiwiZXhwIjoxNzU0Njc0MzcyLCJpYXQiOjE3NTQ2NDU1NzJ9.dWQSKvWvNOCDHdN0as-Ifeffeam7nzOFLKbpJhu5Ocw'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-08-2025 15:02:55.348 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTU3MiwiZXhwIjoxNzU0Njc0MzcyLCJpYXQiOjE3NTQ2NDU1NzJ9.dWQSKvWvNOCDHdN0as-Ifeffeam7nzOFLKbpJhu5Ocw'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-08-2025 15:02:55.363 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60588'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-08-2025 15:02:55.379 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTU3MiwiZXhwIjoxNzU0Njc0MzcyLCJpYXQiOjE3NTQ2NDU1NzJ9.dWQSKvWvNOCDHdN0as-Ifeffeam7nzOFLKbpJhu5Ocw'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-08-2025 15:02:55.379 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select * from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0  
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) a where UStatus like ''%Case%'' 
'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-08-2025 15:02:55.379 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTU3MiwiZXhwIjoxNzU0Njc0MzcyLCJpYXQiOjE3NTQ2NDU1NzJ9.dWQSKvWvNOCDHdN0as-Ifeffeam7nzOFLKbpJhu5Ocw'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-08-2025 15:02:55.394 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60583'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-08-2025 15:02:55.394 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTU3MiwiZXhwIjoxNzU0Njc0MzcyLCJpYXQiOjE3NTQ2NDU1NzJ9.dWQSKvWvNOCDHdN0as-Ifeffeam7nzOFLKbpJhu5Ocw'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-08-2025 15:02:55.442 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60584'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-08-2025 15:02:55.457 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTU3MiwiZXhwIjoxNzU0Njc0MzcyLCJpYXQiOjE3NTQ2NDU1NzJ9.dWQSKvWvNOCDHdN0as-Ifeffeam7nzOFLKbpJhu5Ocw'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-08-2025 15:02:55.457 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 '/*
DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select * from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0  
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) a where UStatus like ''%Reserve%'' 
*/

DECLARE @FROM FLOAT
SET @FROM=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @UnitID BIGINT,@StatusID BIGINT,@TotalAmount FLOAT,@I INT,@COUNT INT,@ContractID BIGINT
DECLARE @NoofDays INT,@VacantSince DATETIME

DECLARE @TAB TABLE(ID INT IDENTITY(1,1) PRIMARY KEY,UnitID BIGINT,CurrentRent FLOAT,Status NVARCHAR(10),NoofDays INT,VacantSince DATETIME,ContractID BIGINT)

INSERT INTO @TAB (UnitID)
SELECT U.UnitID
FROM REN_Units U WITH(NOLOCK) 
LEFT JOIN REN_Property P WITH(NOLOCK) ON P.NodeID=U.PropertyID
LEFT JOIN COM_Lookup LK WITH(NOLOCK) ON U.UnitStatus=LK.NodeID
WHERE U.UnitID>1 AND P.Name <> U.Name AND U.IsGroup=0 AND U.Status=424 and U.UnitStatus=306 
-- AND P.NodeID IN (207)
SELECT @I=1,@COUNT=COUNT(*) FROM @TAB
WHILE(@I<=@COUNT)
BEGIN
	SET @StatusID=0
	SET @TotalAmount=0
	SET @ContractID=0
	SELECT @UnitID=UnitID FROM @TAB WHERE ID=@I

	SELECT TOP 1 @ContractID=(CASE WHEN RefContractID>0 THEN RefContractID ELSE ContractID END),@StatusID=StatusID
	,@VacantSince=(CASE WHEN StatusID = 450 THEN ( CASE WHEN RefundDate IS NOT NULL THEN CONVERT(DATETIME,RefundDate) ELSE CONVERT(DATETIME,VacancyDate) END ) 
			ELSE CONVERT(DATETIME,TerminationDate) END )
	,@NoofDays=(CASE WHEN StatusID = 450 THEN (CASE WHEN RefundDate IS NOT NULL THEN DATEDIFF(DAY, CONVERT(DATETIME,RefundDate),CONVERT(DATETIME,@FROM) ) 
			ELSE DATEDIFF(DAY, CONVERT(DATETIME,VacancyDate),CONVERT(DATETIME,@FROM) ) END )
			ELSE DATEDIFF(DAY, CONVERT(DATETIME,TerminationDate),CONVERT(DATETIME,@FROM) ) END )  
	FROM REN_Contract WITH(NOLOCK) WHERE StatusID<>451 AND StartDate<@FROM AND UNITID=@UnitID 
	ORDER BY StartDate DESC,StatusID
	
	SELECT @TotalAmount=ISNULL(SUM(RPD.Amount),MAX(RentAmount)/(CASE WHEN MAX(RC.NoOfUnits)=0 THEN 1 ELSE MAX(RC.NoOfUnits) END)) 
	FROM REN_Contract RC WITH(NOLOCK)
	JOIN REN_ContractParticulars RP WITH(NOLOCK) ON RP.ContractID=RC.ContractID AND RP.Sno=1
	LEFT JOIN REN_ContractParticularsDetail RPD WITH(NOLOCK) ON RPD.ParticularNodeID=RP.NodeID AND RPD.Unit=@UnitID 
	AND @FROM BETWEEN ISNULL(RPD.FromDate,@FROM) AND ISNULL(RPD.ToDate,@FROM)
	WHERE RC.ContractID=@ContractID
	
	IF @StatusID=427 OR @StatusID=426 OR @StatusID=466
	BEGIN
		UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Occupied'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
	END
	ELSE IF @StatusID=440
	BEGIN
		UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''UnAproved'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
	END
	ELSE IF @StatusID=428 OR @StatusID=450
	BEGIN 
		IF EXISTS (SELECT * FROM REN_Quotation WITH(NOLOCK) WHERE COSTCENTERID=129 AND UNITID=@UnitID AND CONVERT(DATETIME,@FROM) BETWEEN CONVERT(DATETIME,STARTDATE) AND CONVERT(DATETIME,ENDDATE) and statusid=467 )
			UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Reserved'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
		ELSE IF EXISTS (SELECT * FROM REN_Quotation WITH(NOLOCK) WHERE COSTCENTERID=103 AND UNITID=@UnitID AND CONVERT(DATETIME,@FROM) BETWEEN CONVERT(DATETIME,STARTDATE) AND CONVERT(DATETIME,ENDDATE) and statusid=426 )
			UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Quoted'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
		ELSE
			UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Vacant'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
	END
	ELSE
	BEGIN 
		IF EXISTS (SELECT * FROM REN_Quotation WITH(NOLOCK) WHERE COSTCENTERID=129 AND UNITID=@UnitID AND CONVERT(DATETIME,@FROM) BETWEEN CONVERT(DATETIME,STARTDATE) AND CONVERT(DATETIME,ENDDATE) and statusid=467 )
			UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Reserved'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
		ELSE IF EXISTS (SELECT * FROM REN_Quotation WITH(NOLOCK) WHERE COSTCENTERID=103 AND UNITID=@UnitID AND CONVERT(DATETIME,@FROM) BETWEEN CONVERT(DATETIME,STARTDATE) AND CONVERT(DATETIME,ENDDATE) and statusid=426 )
			UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Quoted'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
		ELSE
			UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Vacant'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
	END
	set @I=@I+1
END

select * from (
SELECT TEMP.*,RP.NodeID Building_ID,RP.NAME Property,TEMP.UnitID Unit_ID,RU.NAME Unit,C18.NAME UnitType,RU.UnitStatus,RU.RentableArea UnitArea,RU.RentPerSQFT UnitRate
,RU.AnnualRent 
,T.FirstName AS [C98c7d2679f99489e9f0e010026eeb563]
,RUL.Name LandLord , RUC.Name Location 
,1 Cnt
FROM @TAB TEMP
JOIN REN_Units RU WITH(NOLOCK) ON TEMP.UnitID=RU.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
LEFT JOIN COM_CC50018 C18 WITH(NOLOCK) ON C18.NodeID=RU.NodeID
LEFT JOIN REN_Contract C WITH(NOLOCK) ON TEMP.ContractID=C.ContractID
LEFT JOIN REN_Tenant T WITH(NOLOCK) ON T.TenantID=C.TenantID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID

 )a where a.Status =''Reserved''
 order by Property,VacantSince'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-08-2025 15:02:55.457 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select * from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0  
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) a --where UStatus like ''%Hold%'' 
'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-08-2025 15:02:55.457 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTU3MiwiZXhwIjoxNzU0Njc0MzcyLCJpYXQiOjE3NTQ2NDU1NzJ9.dWQSKvWvNOCDHdN0as-Ifeffeam7nzOFLKbpJhu5Ocw'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-08-2025 15:02:55.473 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTU3MiwiZXhwIjoxNzU0Njc0MzcyLCJpYXQiOjE3NTQ2NDU1NzJ9.dWQSKvWvNOCDHdN0as-Ifeffeam7nzOFLKbpJhu5Ocw'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-08-2025 15:02:55.473 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60585'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-08-2025 15:02:55.488 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTU3MiwiZXhwIjoxNzU0Njc0MzcyLCJpYXQiOjE3NTQ2NDU1NzJ9.dWQSKvWvNOCDHdN0as-Ifeffeam7nzOFLKbpJhu5Ocw'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-08-2025 15:02:55.488 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select * from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0  
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) a where UnitStatus=''Vacant''
'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-08-2025 15:02:55.488 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTU3MiwiZXhwIjoxNzU0Njc0MzcyLCJpYXQiOjE3NTQ2NDU1NzJ9.dWQSKvWvNOCDHdN0as-Ifeffeam7nzOFLKbpJhu5Ocw'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-08-2025 15:02:55.504 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select * from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0  
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) a where UnitStatus=''Occupied'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-08-2025 15:02:55.519 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTU3MiwiZXhwIjoxNzU0Njc0MzcyLCJpYXQiOjE3NTQ2NDU1NzJ9.dWQSKvWvNOCDHdN0as-Ifeffeam7nzOFLKbpJhu5Ocw'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-08-2025 15:02:55.519 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60586'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-08-2025 15:02:55.519 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTU3MiwiZXhwIjoxNzU0Njc0MzcyLCJpYXQiOjE3NTQ2NDU1NzJ9.dWQSKvWvNOCDHdN0as-Ifeffeam7nzOFLKbpJhu5Ocw'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-08-2025 15:02:55.535 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60587'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-08-2025 15:02:55.551 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select * from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0  
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) a  where UnitStatus=''Expired'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-08-2025 15:02:55.551 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTU3MiwiZXhwIjoxNzU0Njc0MzcyLCJpYXQiOjE3NTQ2NDU1NzJ9.dWQSKvWvNOCDHdN0as-Ifeffeam7nzOFLKbpJhu5Ocw'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-08-2025 15:02:55.551 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTU3MiwiZXhwIjoxNzU0Njc0MzcyLCJpYXQiOjE3NTQ2NDU1NzJ9.dWQSKvWvNOCDHdN0as-Ifeffeam7nzOFLKbpJhu5Ocw'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-08-2025 15:02:55.566 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select * from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0  
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) a where UStatus like ''%Case%'' 
'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-08-2025 15:02:55.582 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTU3MiwiZXhwIjoxNzU0Njc0MzcyLCJpYXQiOjE3NTQ2NDU1NzJ9.dWQSKvWvNOCDHdN0as-Ifeffeam7nzOFLKbpJhu5Ocw'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-08-2025 15:02:55.754 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60588'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-08-2025 15:02:55.754 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTU3MiwiZXhwIjoxNzU0Njc0MzcyLCJpYXQiOjE3NTQ2NDU1NzJ9.dWQSKvWvNOCDHdN0as-Ifeffeam7nzOFLKbpJhu5Ocw'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-08-2025 15:02:55.848 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 '/*
DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select * from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0  
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) a where UStatus like ''%Reserve%'' 
*/

DECLARE @FROM FLOAT
SET @FROM=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @UnitID BIGINT,@StatusID BIGINT,@TotalAmount FLOAT,@I INT,@COUNT INT,@ContractID BIGINT
DECLARE @NoofDays INT,@VacantSince DATETIME

DECLARE @TAB TABLE(ID INT IDENTITY(1,1) PRIMARY KEY,UnitID BIGINT,CurrentRent FLOAT,Status NVARCHAR(10),NoofDays INT,VacantSince DATETIME,ContractID BIGINT)

INSERT INTO @TAB (UnitID)
SELECT U.UnitID
FROM REN_Units U WITH(NOLOCK) 
LEFT JOIN REN_Property P WITH(NOLOCK) ON P.NodeID=U.PropertyID
LEFT JOIN COM_Lookup LK WITH(NOLOCK) ON U.UnitStatus=LK.NodeID
WHERE U.UnitID>1 AND P.Name <> U.Name AND U.IsGroup=0 AND U.Status=424 and U.UnitStatus=306 
-- AND P.NodeID IN (207)
SELECT @I=1,@COUNT=COUNT(*) FROM @TAB
WHILE(@I<=@COUNT)
BEGIN
	SET @StatusID=0
	SET @TotalAmount=0
	SET @ContractID=0
	SELECT @UnitID=UnitID FROM @TAB WHERE ID=@I

	SELECT TOP 1 @ContractID=(CASE WHEN RefContractID>0 THEN RefContractID ELSE ContractID END),@StatusID=StatusID
	,@VacantSince=(CASE WHEN StatusID = 450 THEN ( CASE WHEN RefundDate IS NOT NULL THEN CONVERT(DATETIME,RefundDate) ELSE CONVERT(DATETIME,VacancyDate) END ) 
			ELSE CONVERT(DATETIME,TerminationDate) END )
	,@NoofDays=(CASE WHEN StatusID = 450 THEN (CASE WHEN RefundDate IS NOT NULL THEN DATEDIFF(DAY, CONVERT(DATETIME,RefundDate),CONVERT(DATETIME,@FROM) ) 
			ELSE DATEDIFF(DAY, CONVERT(DATETIME,VacancyDate),CONVERT(DATETIME,@FROM) ) END )
			ELSE DATEDIFF(DAY, CONVERT(DATETIME,TerminationDate),CONVERT(DATETIME,@FROM) ) END )  
	FROM REN_Contract WITH(NOLOCK) WHERE StatusID<>451 AND StartDate<@FROM AND UNITID=@UnitID 
	ORDER BY StartDate DESC,StatusID
	
	SELECT @TotalAmount=ISNULL(SUM(RPD.Amount),MAX(RentAmount)/(CASE WHEN MAX(RC.NoOfUnits)=0 THEN 1 ELSE MAX(RC.NoOfUnits) END)) 
	FROM REN_Contract RC WITH(NOLOCK)
	JOIN REN_ContractParticulars RP WITH(NOLOCK) ON RP.ContractID=RC.ContractID AND RP.Sno=1
	LEFT JOIN REN_ContractParticularsDetail RPD WITH(NOLOCK) ON RPD.ParticularNodeID=RP.NodeID AND RPD.Unit=@UnitID 
	AND @FROM BETWEEN ISNULL(RPD.FromDate,@FROM) AND ISNULL(RPD.ToDate,@FROM)
	WHERE RC.ContractID=@ContractID
	
	IF @StatusID=427 OR @StatusID=426 OR @StatusID=466
	BEGIN
		UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Occupied'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
	END
	ELSE IF @StatusID=440
	BEGIN
		UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''UnAproved'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
	END
	ELSE IF @StatusID=428 OR @StatusID=450
	BEGIN 
		IF EXISTS (SELECT * FROM REN_Quotation WITH(NOLOCK) WHERE COSTCENTERID=129 AND UNITID=@UnitID AND CONVERT(DATETIME,@FROM) BETWEEN CONVERT(DATETIME,STARTDATE) AND CONVERT(DATETIME,ENDDATE) and statusid=467 )
			UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Reserved'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
		ELSE IF EXISTS (SELECT * FROM REN_Quotation WITH(NOLOCK) WHERE COSTCENTERID=103 AND UNITID=@UnitID AND CONVERT(DATETIME,@FROM) BETWEEN CONVERT(DATETIME,STARTDATE) AND CONVERT(DATETIME,ENDDATE) and statusid=426 )
			UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Quoted'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
		ELSE
			UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Vacant'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
	END
	ELSE
	BEGIN 
		IF EXISTS (SELECT * FROM REN_Quotation WITH(NOLOCK) WHERE COSTCENTERID=129 AND UNITID=@UnitID AND CONVERT(DATETIME,@FROM) BETWEEN CONVERT(DATETIME,STARTDATE) AND CONVERT(DATETIME,ENDDATE) and statusid=467 )
			UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Reserved'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
		ELSE IF EXISTS (SELECT * FROM REN_Quotation WITH(NOLOCK) WHERE COSTCENTERID=103 AND UNITID=@UnitID AND CONVERT(DATETIME,@FROM) BETWEEN CONVERT(DATETIME,STARTDATE) AND CONVERT(DATETIME,ENDDATE) and statusid=426 )
			UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Quoted'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
		ELSE
			UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Vacant'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
	END
	set @I=@I+1
END

select * from (
SELECT TEMP.*,RP.NodeID Building_ID,RP.NAME Property,TEMP.UnitID Unit_ID,RU.NAME Unit,C18.NAME UnitType,RU.UnitStatus,RU.RentableArea UnitArea,RU.RentPerSQFT UnitRate
,RU.AnnualRent 
,T.FirstName AS [C98c7d2679f99489e9f0e010026eeb563]
,RUL.Name LandLord , RUC.Name Location 
,1 Cnt
FROM @TAB TEMP
JOIN REN_Units RU WITH(NOLOCK) ON TEMP.UnitID=RU.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
LEFT JOIN COM_CC50018 C18 WITH(NOLOCK) ON C18.NodeID=RU.NodeID
LEFT JOIN REN_Contract C WITH(NOLOCK) ON TEMP.ContractID=C.ContractID
LEFT JOIN REN_Tenant T WITH(NOLOCK) ON T.TenantID=C.TenantID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID

 )a where a.Status =''Reserved''
 order by Property,VacantSince'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-08-2025 15:02:55.848 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTU3MiwiZXhwIjoxNzU0Njc0MzcyLCJpYXQiOjE3NTQ2NDU1NzJ9.dWQSKvWvNOCDHdN0as-Ifeffeam7nzOFLKbpJhu5Ocw'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-08-2025 15:02:57.238 | General Service|:: CompanyIndex:53 SpName: spADM_GetCostCenterGridViewList 
 2
 ,1
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-08-2025 15:02:57.238 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTU3MiwiZXhwIjoxNzU0Njc0MzcyLCJpYXQiOjE3NTQ2NDU1NzJ9.dWQSKvWvNOCDHdN0as-Ifeffeam7nzOFLKbpJhu5Ocw'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-08-2025 15:02:57.285 | General Service|:: CompanyIndex:53 SpName: spCom_GetCostCenterSummary 
 126
 ,-1
 ,1000
 ,''
 ,''
 ,''
 ,0
 ,'08-Aug-2025'
 ,NULL
 ,''
 ,1
 ,1
 ,0
 ,0
 ,False
 ,1
[System: 192.168.1.77] DEBUG | 08-08-2025 15:02:57.300 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTU3MiwiZXhwIjoxNzU0Njc0MzcyLCJpYXQiOjE3NTQ2NDU1NzJ9.dWQSKvWvNOCDHdN0as-Ifeffeam7nzOFLKbpJhu5Ocw'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 15:03:40.470 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 15:03:40.470 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTM3OSwiZXhwIjoxNzU0Njc0MTc5LCJpYXQiOjE3NTQ2NDUzNzl9.g2xkwaskoaQf9D1KtdWbI8AB4PdXmoDh0PQE7Ov_cPI'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-08-2025 15:03:53.928 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-08-2025 15:03:53.928 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTU3MiwiZXhwIjoxNzU0Njc0MzcyLCJpYXQiOjE3NTQ2NDU1NzJ9.dWQSKvWvNOCDHdN0as-Ifeffeam7nzOFLKbpJhu5Ocw'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 15:04:39.518 | General Service|:: CompanyIndex:53 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.73] DEBUG | 08-08-2025 15:04:39.534 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTM3OSwiZXhwIjoxNzU0Njc0MTc5LCJpYXQiOjE3NTQ2NDUzNzl9.g2xkwaskoaQf9D1KtdWbI8AB4PdXmoDh0PQE7Ov_cPI'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 15:04:40.455 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 15:04:40.455 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTM3OSwiZXhwIjoxNzU0Njc0MTc5LCJpYXQiOjE3NTQ2NDUzNzl9.g2xkwaskoaQf9D1KtdWbI8AB4PdXmoDh0PQE7Ov_cPI'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-08-2025 15:04:54.438 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-08-2025 15:04:54.453 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTU3MiwiZXhwIjoxNzU0Njc0MzcyLCJpYXQiOjE3NTQ2NDU1NzJ9.dWQSKvWvNOCDHdN0as-Ifeffeam7nzOFLKbpJhu5Ocw'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 15:05:40.453 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 15:05:40.453 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTM3OSwiZXhwIjoxNzU0Njc0MTc5LCJpYXQiOjE3NTQ2NDUzNzl9.g2xkwaskoaQf9D1KtdWbI8AB4PdXmoDh0PQE7Ov_cPI'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-08-2025 15:05:54.447 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-08-2025 15:05:54.447 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTU3MiwiZXhwIjoxNzU0Njc0MzcyLCJpYXQiOjE3NTQ2NDU1NzJ9.dWQSKvWvNOCDHdN0as-Ifeffeam7nzOFLKbpJhu5Ocw'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 15:06:40.453 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 15:06:40.469 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTM3OSwiZXhwIjoxNzU0Njc0MTc5LCJpYXQiOjE3NTQ2NDUzNzl9.g2xkwaskoaQf9D1KtdWbI8AB4PdXmoDh0PQE7Ov_cPI'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-08-2025 15:06:54.414 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-08-2025 15:06:54.430 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTU3MiwiZXhwIjoxNzU0Njc0MzcyLCJpYXQiOjE3NTQ2NDU1NzJ9.dWQSKvWvNOCDHdN0as-Ifeffeam7nzOFLKbpJhu5Ocw'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 15:07:40.453 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 15:07:40.468 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTM3OSwiZXhwIjoxNzU0Njc0MTc5LCJpYXQiOjE3NTQ2NDUzNzl9.g2xkwaskoaQf9D1KtdWbI8AB4PdXmoDh0PQE7Ov_cPI'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-08-2025 15:07:53.388 | General Service|:: CompanyIndex:53 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.77] DEBUG | 08-08-2025 15:07:53.403 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTU3MiwiZXhwIjoxNzU0Njc0MzcyLCJpYXQiOjE3NTQ2NDU1NzJ9.dWQSKvWvNOCDHdN0as-Ifeffeam7nzOFLKbpJhu5Ocw'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-08-2025 15:07:54.387 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-08-2025 15:07:54.387 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTU3MiwiZXhwIjoxNzU0Njc0MzcyLCJpYXQiOjE3NTQ2NDU1NzJ9.dWQSKvWvNOCDHdN0as-Ifeffeam7nzOFLKbpJhu5Ocw'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 15:08:40.452 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 15:08:40.452 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTM3OSwiZXhwIjoxNzU0Njc0MTc5LCJpYXQiOjE3NTQ2NDUzNzl9.g2xkwaskoaQf9D1KtdWbI8AB4PdXmoDh0PQE7Ov_cPI'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-08-2025 15:08:55.427 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-08-2025 15:08:55.427 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTU3MiwiZXhwIjoxNzU0Njc0MzcyLCJpYXQiOjE3NTQ2NDU1NzJ9.dWQSKvWvNOCDHdN0as-Ifeffeam7nzOFLKbpJhu5Ocw'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 15:09:39.497 | General Service|:: CompanyIndex:53 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.73] DEBUG | 08-08-2025 15:09:39.497 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTM3OSwiZXhwIjoxNzU0Njc0MTc5LCJpYXQiOjE3NTQ2NDUzNzl9.g2xkwaskoaQf9D1KtdWbI8AB4PdXmoDh0PQE7Ov_cPI'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 15:09:40.435 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 15:09:40.435 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTM3OSwiZXhwIjoxNzU0Njc0MTc5LCJpYXQiOjE3NTQ2NDUzNzl9.g2xkwaskoaQf9D1KtdWbI8AB4PdXmoDh0PQE7Ov_cPI'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-08-2025 15:09:56.432 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-08-2025 15:09:56.432 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTU3MiwiZXhwIjoxNzU0Njc0MzcyLCJpYXQiOjE3NTQ2NDU1NzJ9.dWQSKvWvNOCDHdN0as-Ifeffeam7nzOFLKbpJhu5Ocw'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 15:10:40.438 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 15:10:40.454 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTM3OSwiZXhwIjoxNzU0Njc0MTc5LCJpYXQiOjE3NTQ2NDUzNzl9.g2xkwaskoaQf9D1KtdWbI8AB4PdXmoDh0PQE7Ov_cPI'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-08-2025 15:10:57.429 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-08-2025 15:10:57.429 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTU3MiwiZXhwIjoxNzU0Njc0MzcyLCJpYXQiOjE3NTQ2NDU1NzJ9.dWQSKvWvNOCDHdN0as-Ifeffeam7nzOFLKbpJhu5Ocw'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 15:11:40.434 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 15:11:40.434 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTM3OSwiZXhwIjoxNzU0Njc0MTc5LCJpYXQiOjE3NTQ2NDUzNzl9.g2xkwaskoaQf9D1KtdWbI8AB4PdXmoDh0PQE7Ov_cPI'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-08-2025 15:11:58.434 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-08-2025 15:11:58.434 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTU3MiwiZXhwIjoxNzU0Njc0MzcyLCJpYXQiOjE3NTQ2NDU1NzJ9.dWQSKvWvNOCDHdN0as-Ifeffeam7nzOFLKbpJhu5Ocw'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 15:12:40.429 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 15:12:40.445 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTM3OSwiZXhwIjoxNzU0Njc0MTc5LCJpYXQiOjE3NTQ2NDUzNzl9.g2xkwaskoaQf9D1KtdWbI8AB4PdXmoDh0PQE7Ov_cPI'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-08-2025 15:12:53.397 | General Service|:: CompanyIndex:53 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.77] DEBUG | 08-08-2025 15:12:53.397 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTU3MiwiZXhwIjoxNzU0Njc0MzcyLCJpYXQiOjE3NTQ2NDU1NzJ9.dWQSKvWvNOCDHdN0as-Ifeffeam7nzOFLKbpJhu5Ocw'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-08-2025 15:12:54.366 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-08-2025 15:12:54.381 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTU3MiwiZXhwIjoxNzU0Njc0MzcyLCJpYXQiOjE3NTQ2NDU1NzJ9.dWQSKvWvNOCDHdN0as-Ifeffeam7nzOFLKbpJhu5Ocw'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 15:13:40.445 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 15:13:40.445 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTM3OSwiZXhwIjoxNzU0Njc0MTc5LCJpYXQiOjE3NTQ2NDUzNzl9.g2xkwaskoaQf9D1KtdWbI8AB4PdXmoDh0PQE7Ov_cPI'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-08-2025 15:13:54.434 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-08-2025 15:13:54.434 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTU3MiwiZXhwIjoxNzU0Njc0MzcyLCJpYXQiOjE3NTQ2NDU1NzJ9.dWQSKvWvNOCDHdN0as-Ifeffeam7nzOFLKbpJhu5Ocw'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 15:14:39.506 | General Service|:: CompanyIndex:53 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.73] DEBUG | 08-08-2025 15:14:39.506 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTM3OSwiZXhwIjoxNzU0Njc0MTc5LCJpYXQiOjE3NTQ2NDUzNzl9.g2xkwaskoaQf9D1KtdWbI8AB4PdXmoDh0PQE7Ov_cPI'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 15:14:39.522 | General Service|:: CompanyIndex:0 SpName: spADM_Login 
 4
 ,''
 ,''
 ,''
 ,'declare @AllowSession bit,@GUID nvarchar(50)
set @AllowSession=0
set @GUID=''39d911aa-9564-4bef-a8d7-2926e404b842''
if exists(select [GUID] from ADM_Login with(nolock) where [GUID]=@GUID)
begin
    update ADM_Login  set LastAccessTime=convert(float,getdate()) where [GUID]=@GUID
    set @AllowSession=1
end
select @AllowSession AllowSession
'
 ,''
 ,0
[System: 192.168.1.73] DEBUG | 08-08-2025 15:14:39.522 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTM3OSwiZXhwIjoxNzU0Njc0MTc5LCJpYXQiOjE3NTQ2NDUzNzl9.g2xkwaskoaQf9D1KtdWbI8AB4PdXmoDh0PQE7Ov_cPI'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 15:14:40.444 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 15:14:40.444 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTM3OSwiZXhwIjoxNzU0Njc0MTc5LCJpYXQiOjE3NTQ2NDUzNzl9.g2xkwaskoaQf9D1KtdWbI8AB4PdXmoDh0PQE7Ov_cPI'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-08-2025 15:14:55.433 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-08-2025 15:14:55.433 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTU3MiwiZXhwIjoxNzU0Njc0MzcyLCJpYXQiOjE3NTQ2NDU1NzJ9.dWQSKvWvNOCDHdN0as-Ifeffeam7nzOFLKbpJhu5Ocw'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 15:15:40.432 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 15:15:40.432 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTM3OSwiZXhwIjoxNzU0Njc0MTc5LCJpYXQiOjE3NTQ2NDUzNzl9.g2xkwaskoaQf9D1KtdWbI8AB4PdXmoDh0PQE7Ov_cPI'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-08-2025 15:15:56.430 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-08-2025 15:15:56.446 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTU3MiwiZXhwIjoxNzU0Njc0MzcyLCJpYXQiOjE3NTQ2NDU1NzJ9.dWQSKvWvNOCDHdN0as-Ifeffeam7nzOFLKbpJhu5Ocw'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 15:16:40.435 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 15:16:40.435 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTM3OSwiZXhwIjoxNzU0Njc0MTc5LCJpYXQiOjE3NTQ2NDUzNzl9.g2xkwaskoaQf9D1KtdWbI8AB4PdXmoDh0PQE7Ov_cPI'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-08-2025 15:16:57.422 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-08-2025 15:16:57.438 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTU3MiwiZXhwIjoxNzU0Njc0MzcyLCJpYXQiOjE3NTQ2NDU1NzJ9.dWQSKvWvNOCDHdN0as-Ifeffeam7nzOFLKbpJhu5Ocw'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 15:17:40.616 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 15:17:40.631 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTM3OSwiZXhwIjoxNzU0Njc0MTc5LCJpYXQiOjE3NTQ2NDUzNzl9.g2xkwaskoaQf9D1KtdWbI8AB4PdXmoDh0PQE7Ov_cPI'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-08-2025 15:17:53.401 | General Service|:: CompanyIndex:53 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.77] DEBUG | 08-08-2025 15:17:53.401 | General Service|:: CompanyIndex:0 SpName: spADM_Login 
 4
 ,''
 ,''
 ,''
 ,'declare @AllowSession bit,@GUID nvarchar(50)
set @AllowSession=0
set @GUID=''9c62d1c4-6a96-4ea5-9de0-4093d8a85b1d''
if exists(select [GUID] from ADM_Login with(nolock) where [GUID]=@GUID)
begin
    update ADM_Login  set LastAccessTime=convert(float,getdate()) where [GUID]=@GUID
    set @AllowSession=1
end
select @AllowSession AllowSession
'
 ,''
 ,0
[System: 192.168.1.77] DEBUG | 08-08-2025 15:17:53.417 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTU3MiwiZXhwIjoxNzU0Njc0MzcyLCJpYXQiOjE3NTQ2NDU1NzJ9.dWQSKvWvNOCDHdN0as-Ifeffeam7nzOFLKbpJhu5Ocw'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-08-2025 15:17:53.417 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTU3MiwiZXhwIjoxNzU0Njc0MzcyLCJpYXQiOjE3NTQ2NDU1NzJ9.dWQSKvWvNOCDHdN0as-Ifeffeam7nzOFLKbpJhu5Ocw'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-08-2025 15:17:58.519 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-08-2025 15:17:58.519 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTU3MiwiZXhwIjoxNzU0Njc0MzcyLCJpYXQiOjE3NTQ2NDU1NzJ9.dWQSKvWvNOCDHdN0as-Ifeffeam7nzOFLKbpJhu5Ocw'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 15:18:40.434 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 15:18:40.434 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTM3OSwiZXhwIjoxNzU0Njc0MTc5LCJpYXQiOjE3NTQ2NDUzNzl9.g2xkwaskoaQf9D1KtdWbI8AB4PdXmoDh0PQE7Ov_cPI'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-08-2025 15:18:59.466 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-08-2025 15:18:59.466 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTU3MiwiZXhwIjoxNzU0Njc0MzcyLCJpYXQiOjE3NTQ2NDU1NzJ9.dWQSKvWvNOCDHdN0as-Ifeffeam7nzOFLKbpJhu5Ocw'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 15:19:39.480 | General Service|:: CompanyIndex:53 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.73] DEBUG | 08-08-2025 15:19:39.495 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTM3OSwiZXhwIjoxNzU0Njc0MTc5LCJpYXQiOjE3NTQ2NDUzNzl9.g2xkwaskoaQf9D1KtdWbI8AB4PdXmoDh0PQE7Ov_cPI'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 15:19:40.433 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 15:19:40.433 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTM3OSwiZXhwIjoxNzU0Njc0MTc5LCJpYXQiOjE3NTQ2NDUzNzl9.g2xkwaskoaQf9D1KtdWbI8AB4PdXmoDh0PQE7Ov_cPI'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-08-2025 15:20:00.412 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-08-2025 15:20:00.428 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTU3MiwiZXhwIjoxNzU0Njc0MzcyLCJpYXQiOjE3NTQ2NDU1NzJ9.dWQSKvWvNOCDHdN0as-Ifeffeam7nzOFLKbpJhu5Ocw'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 15:20:40.431 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 08-08-2025 15:20:40.431 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDY0NTM3OSwiZXhwIjoxNzU0Njc0MTc5LCJpYXQiOjE3NTQ2NDUzNzl9.g2xkwaskoaQf9D1KtdWbI8AB4PdXmoDh0PQE7Ov_cPI'''
 ,1
 ,1
