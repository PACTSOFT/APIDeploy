[System: 192.168.1.77] DEBUG | 11-13-2025 15:30:23.750 | General Service|:: CompanyIndex:0 SpName: spADM_GetClientUserDetails2C 
 'admin'
 ,1
 ,0
[System: 192.168.1.77] DEBUG | 11-13-2025 15:30:23.953 | General Service|:: CompanyIndex:0 SpName: spADM_UserLoginCheck 
 2
 ,'admin'
 ,0
 ,'192.168.1.77'
 ,'192.168.1.77'
 ,''
 ,'Web'
 ,1
[System: 192.168.1.77] DEBUG | 11-13-2025 15:30:35.249 | General Service|:: CompanyIndex:53 SpName: spADM_GetClientUserDetails 
 'admin'
 ,1
 ,'26.8.6'
 ,0
[System: 192.168.1.77] DEBUG | 11-13-2025 15:30:35.483 | General Service|:: CompanyIndex:0 SpName: spADM_UserLoginCheck 
 2
 ,'admin'
 ,53
 ,'192.168.1.77'
 ,'192.168.1.77'
 ,''
 ,'Web'
 ,1
[System: 192.168.1.77] DEBUG | 11-13-2025 15:30:35.608 | General Service|:: CompanyIndex:0 SpName: spADM_Login 
 1
 ,''
 ,''
 ,''
 ,''
 ,''
 ,53
[System: 192.168.1.77] DEBUG | 11-13-2025 15:30:35.627 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select Value from ADM_GlobalPreferences with (nolock) where name =''EnableReLogin'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 11-13-2025 15:30:35.627 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODAzNSwiZXhwIjoxNzYzMDU2ODM1LCJpYXQiOjE3NjMwMjgwMzV9.c4J7sRklVhN3hJ2g3cvBPJ5nYIFJIc4QnnPUO71wek4'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 11-13-2025 15:30:35.674 | General Service|:: CompanyIndex:0 SpName: spADM_Login 
 4
 ,''
 ,''
 ,''
 ,'declare @Cnt int,@ExpiredGUID nvarchar(50),@AllowSession int,@GUID nvarchar(50),@CurrDate float,@UserID INT,@Instances INT,@InstancesExists INT,@LCDBIndex int
set @CurrDate= convert(float,dateadd(minute,-21,getdate()))
set @AllowSession=0
set @GUID=''121ff338-b5c8-4a84-97d6-2f90b6c2705f''
set @LCDBIndex=0
select top 1 @UserID=UserID,@Instances=InstanceCount from ADM_Users with(nolock) where UserName=''admin''
if exists(select [GUID] from ADM_Login with(nolock) where [GUID]=@GUID)
begin
	update ADM_Login 
	set LastAccessTime=convert(float,getdate()),UserID=@UserID
	where [GUID]=@GUID
    set @AllowSession=1
end
else
begin
	select @Cnt=count(*) from ADM_Login with(nolock) where LCDBIndex=@LCDBIndex and [GUID]!=''ACCESSRIGHTS'' and AP =''WEB''
    if(@Cnt<100)
		set @AllowSession=1
	else
	begin
		select top 1 @ExpiredGUID=[GUID] from ADM_Login with(nolock)
		where [GUID]!=''ACCESSRIGHTS'' and LCDBIndex=@LCDBIndex and LastAccessTime<@CurrDate  and AP =''WEB''
        order by LastAccessTime asc
		if @ExpiredGUID is not null
		begin
			delete from ADM_Login where [GUID]=@ExpiredGUID
			set @AllowSession=1
		end
	end
	if @AllowSession=1
	begin
        select @InstancesExists=COUNT(*) from ADM_Login with(nolock)
		where [GUID]!=''ACCESSRIGHTS'' and LCDBIndex=@LCDBIndex and LastAccessTime>=@CurrDate and UserID=@UserID and AP =''WEB''
		if(@Instances!=0 and @Instances<=@InstancesExists)
			set @AllowSession=2
		else
		    INSERT INTO ADM_Login([GUID],[SysName],IPAddress,[Status],LoginTime,LastAccessTime,AccessRights,UserID,DBIndex,LCDBIndex,AP)
		    VALUES(@GUID,''WEB'',''192.168.1.77'',1,convert(float,getdate()),convert(float,getdate()),null,@UserID,53,@LCDBIndex, ''WEB'')
	end
end

select @AllowSession AllowSession,@Instances Instances,@InstancesExists InstancesExists
'
 ,''
 ,0
[System: 192.168.1.77] DEBUG | 11-13-2025 15:30:35.674 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODAzNSwiZXhwIjoxNzYzMDU2ODM1LCJpYXQiOjE3NjMwMjgwMzV9.c4J7sRklVhN3hJ2g3cvBPJ5nYIFJIc4QnnPUO71wek4'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 11-13-2025 15:30:35.846 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT (SELECT COUNT(*) FROM COM_Location L WITH(NOLOCK) JOIN COM_Status S WITH(NOLOCK) ON S.StatusID=L.StatusID WHERE L.IsGroup=0 AND S.[Status]=''Active'') ML
,(SELECT COUNT(*) FROM ADM_Features WITH(NOLOCK) WHERE ((FeatureID>50000 AND FeatureID<=50050) OR FeatureID>=51000) AND IsEnabled=1) MD
,(SELECT ISNULL(COUNT(*),0) FROM ADM_RevenUReports WITH(NOLOCK) WHERE IsGroup=0 AND ReportID>10000 AND StaticReportType IN (0,-1)) MR'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 11-13-2025 15:30:35.846 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODAzNSwiZXhwIjoxNzYzMDU2ODM1LCJpYXQiOjE3NjMwMjgwMzV9.c4J7sRklVhN3hJ2g3cvBPJ5nYIFJIc4QnnPUO71wek4'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 11-13-2025 15:30:35.877 | General Service|:: CompanyIndex:53 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.77] DEBUG | 11-13-2025 15:30:35.877 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODAzNSwiZXhwIjoxNzYzMDU2ODM1LCJpYXQiOjE3NjMwMjgwMzV9.c4J7sRklVhN3hJ2g3cvBPJ5nYIFJIc4QnnPUO71wek4'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 11-13-2025 15:30:36.096 | General Service|:: CompanyIndex:53 SpName: spADM_GetRibbonView 
 1
 ,1
 ,1
 ,1
 ,0
 ,''
[System: 192.168.1.77] DEBUG | 11-13-2025 15:30:36.096 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODAzNSwiZXhwIjoxNzYzMDU2ODM1LCJpYXQiOjE3NjMwMjgwMzV9.c4J7sRklVhN3hJ2g3cvBPJ5nYIFJIc4QnnPUO71wek4'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 11-13-2025 15:30:36.361 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 2
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.77] DEBUG | 11-13-2025 15:30:36.377 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODAzNSwiZXhwIjoxNzYzMDU2ODM1LCJpYXQiOjE3NjMwMjgwMzV9.c4J7sRklVhN3hJ2g3cvBPJ5nYIFJIc4QnnPUO71wek4'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 11-13-2025 15:30:36.392 | General Service|:: CompanyIndex:53 SpName: spADM_GetDashBoard 
 2
 ,0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.77] DEBUG | 11-13-2025 15:30:36.392 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODAzNSwiZXhwIjoxNzYzMDU2ODM1LCJpYXQiOjE3NjMwMjgwMzV9.c4J7sRklVhN3hJ2g3cvBPJ5nYIFJIc4QnnPUO71wek4'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 11-13-2025 15:30:36.408 | General Service|:: CompanyIndex:53 SpName: spCOM_ConfigValues 
 1
 ,'LandingDocs'
 ,'1'
[System: 192.168.1.77] DEBUG | 11-13-2025 15:30:36.408 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODAzNSwiZXhwIjoxNzYzMDU2ODM1LCJpYXQiOjE3NjMwMjgwMzV9.c4J7sRklVhN3hJ2g3cvBPJ5nYIFJIc4QnnPUO71wek4'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 11-13-2025 15:30:36.455 | General Service|:: CompanyIndex:53 SpName: spCOM_GetFavorites 
 'GETLIST0'
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.77] DEBUG | 11-13-2025 15:30:36.470 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODAzNSwiZXhwIjoxNzYzMDU2ODM1LCJpYXQiOjE3NjMwMjgwMzV9.c4J7sRklVhN3hJ2g3cvBPJ5nYIFJIc4QnnPUO71wek4'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 11-13-2025 15:30:36.486 | General Service|:: CompanyIndex:53 SpName: spADM_GetAllListViewsDef 
 1
 ,1
[System: 192.168.1.77] DEBUG | 11-13-2025 15:30:36.486 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODAzNSwiZXhwIjoxNzYzMDU2ODM1LCJpYXQiOjE3NjMwMjgwMzV9.c4J7sRklVhN3hJ2g3cvBPJ5nYIFJIc4QnnPUO71wek4'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 11-13-2025 15:30:36.611 | General Service|:: CompanyIndex:53 SpName: spADM_GetAllListViewsDef 
 1
 ,1
[System: 192.168.1.77] DEBUG | 11-13-2025 15:30:36.611 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODAzNSwiZXhwIjoxNzYzMDU2ODM1LCJpYXQiOjE3NjMwMjgwMzV9.c4J7sRklVhN3hJ2g3cvBPJ5nYIFJIc4QnnPUO71wek4'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 11-13-2025 15:30:36.752 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'Select CostCenterID,CostCenterColID,CostCenterName,SysTableName,UserColumnName,SysColumnName,ISNULL(UserDefaultValue,'''') UserDefaultValue
From AdM_CostCenterDef WITH(NOLOCK)
Where SysColumnName IN(''CreditAccount'',''DebitAccount'',''ProductID'') 
AND CostCenterID>40000 AND CostCenterID<50000 

SELECT * FROM ADM_Features WITH(NOLOCK) '
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 11-13-2025 15:30:36.752 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODAzNSwiZXhwIjoxNzYzMDU2ODM1LCJpYXQiOjE3NjMwMjgwMzV9.c4J7sRklVhN3hJ2g3cvBPJ5nYIFJIc4QnnPUO71wek4'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 11-13-2025 15:30:36.798 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 '  SELECT * FROM PAY_PayrollPreferences WITH(NOLOCK) '
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 11-13-2025 15:30:36.798 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODAzNSwiZXhwIjoxNzYzMDU2ODM1LCJpYXQiOjE3NjMwMjgwMzV9.c4J7sRklVhN3hJ2g3cvBPJ5nYIFJIc4QnnPUO71wek4'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 11-13-2025 15:30:36.861 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 '  --0
                                Select * FROM COM_CC50051 WITH(NOLOCK) WHERE IsGroup=0 AND LoginUserID=''admin''
                                --1                                
                                Select * FROM COM_CC50051 WITH(NOLOCK) WHERE RptManager IN (Select NodeID FROM COM_CC50051 WITH(NOLOCK) WHERE IsGroup=0 AND LoginUserID=''admin'')
                                UNION ALL
                                Select * FROM COM_CC50051 WITH(NOLOCK) WHERE RptManager IN 
                                (
	                                Select NodeID FROM COM_CC50051 WITH(NOLOCK) 
	                                WHERE IsGroup=0 AND LoginUserID IN
	                                (
	                                SELECT fe.LoginUserID
	                                FROM INV_DocDetails a WITH(NOLOCK) 
	                                JOIN COM_DocCCData b WITH(NOLOCK) ON b.InvDocDetailsID=a.InvDocDetailsID
	                                JOIN COM_DocNumData c WITH(NOLOCK) ON c.InvDocDetailsID=a.InvDocDetailsID
	                                JOIN COM_DocTextData d WITH(NOLOCK) ON d.InvDocDetailsID=a.InvDocDetailsID
	                                JOIN COM_CC50051 fe WITH(NOLOCK) on fe.NodeID=b.dcCCNID51
	                                JOIN COM_CC50051 te WITH(NOLOCK) on CONVERT(NVARCHAR,te.NodeID)=d.dcAlpha1
	                                WHERE a.CostCenterID=40098 and a.StatusID=369 AND d.dcAlpha3=''Temporary''
	                                AND te.LoginUserID=''admin'' 
	                                AND ISDATE(d.dcAlpha4)=1 AND ISDATE(d.dcAlpha5)=1 
	                                AND CONVERT(DATETIME,''13 Nov 2025'') BETWEEN CONVERT(DATETIME,d.dcAlpha4) AND CONVERT(DATETIME,d.dcAlpha5)
	                                )
                                )
                                --2
                                Select * FROM ADM_USERS WITH(NOLOCK) WHERE USERID=1
                                --3
                                Select * FROM COM_CostCenterCostCenterMap WITH(NOLOCK) WHERE ParentCostCenterID=7 AND ParentNodeID=1
                                --4                                
                                Select * FROM COM_CostCenterCostCenterMap WITH(NOLOCK) WHERE ParentCostCenterID=7 AND ParentNodeID=1
                                AND CostCenterID IN(Select ColumnCostCenterID From ADM_CostCenterDef Where CostCenterID=50051 AND IsColumnInUse=1 AND SysColumnName LIKE ''CCNID%'')
                                --5
                                Select * from COM_Files WITH(NOLOCK) WHERE FeatureID=50051 AND FeaturePK IN (Select NodeID FROM COM_CC50051 WITH(NOLOCK) WHERE IsGroup=0 AND LoginUserID=''admin'')                         
'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 11-13-2025 15:30:36.877 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODAzNSwiZXhwIjoxNzYzMDU2ODM1LCJpYXQiOjE3NjMwMjgwMzV9.c4J7sRklVhN3hJ2g3cvBPJ5nYIFJIc4QnnPUO71wek4'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 11-13-2025 15:30:37.111 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 11-13-2025 15:30:37.111 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODAzNSwiZXhwIjoxNzYzMDU2ODM1LCJpYXQiOjE3NjMwMjgwMzV9.c4J7sRklVhN3hJ2g3cvBPJ5nYIFJIc4QnnPUO71wek4'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 11-13-2025 15:30:37.423 | General Service|:: CompanyIndex:53 SpName: spADM_GetDashBoard 
 1
 ,41
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.77] DEBUG | 11-13-2025 15:30:37.423 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODAzNSwiZXhwIjoxNzYzMDU2ODM1LCJpYXQiOjE3NjMwMjgwMzV9.c4J7sRklVhN3hJ2g3cvBPJ5nYIFJIc4QnnPUO71wek4'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 11-13-2025 15:30:37.455 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,60583
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.77] DEBUG | 11-13-2025 15:30:37.455 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,60586
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.77] DEBUG | 11-13-2025 15:30:37.455 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,60585
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.77] DEBUG | 11-13-2025 15:30:37.455 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,60588
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.77] DEBUG | 11-13-2025 15:30:37.455 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODAzNSwiZXhwIjoxNzYzMDU2ODM1LCJpYXQiOjE3NjMwMjgwMzV9.c4J7sRklVhN3hJ2g3cvBPJ5nYIFJIc4QnnPUO71wek4'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 11-13-2025 15:30:37.455 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODAzNSwiZXhwIjoxNzYzMDU2ODM1LCJpYXQiOjE3NjMwMjgwMzV9.c4J7sRklVhN3hJ2g3cvBPJ5nYIFJIc4QnnPUO71wek4'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 11-13-2025 15:30:37.455 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODAzNSwiZXhwIjoxNzYzMDU2ODM1LCJpYXQiOjE3NjMwMjgwMzV9.c4J7sRklVhN3hJ2g3cvBPJ5nYIFJIc4QnnPUO71wek4'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 11-13-2025 15:30:37.455 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODAzNSwiZXhwIjoxNzYzMDU2ODM1LCJpYXQiOjE3NjMwMjgwMzV9.c4J7sRklVhN3hJ2g3cvBPJ5nYIFJIc4QnnPUO71wek4'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 11-13-2025 15:30:37.455 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,60584
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.77] DEBUG | 11-13-2025 15:30:37.470 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODAzNSwiZXhwIjoxNzYzMDU2ODM1LCJpYXQiOjE3NjMwMjgwMzV9.c4J7sRklVhN3hJ2g3cvBPJ5nYIFJIc4QnnPUO71wek4'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 11-13-2025 15:30:37.470 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,60587
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.77] DEBUG | 11-13-2025 15:30:37.470 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.77] DEBUG | 11-13-2025 15:30:37.470 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODAzNSwiZXhwIjoxNzYzMDU2ODM1LCJpYXQiOjE3NjMwMjgwMzV9.c4J7sRklVhN3hJ2g3cvBPJ5nYIFJIc4QnnPUO71wek4'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 11-13-2025 15:30:37.470 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,60583
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.77] DEBUG | 11-13-2025 15:30:37.470 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,60585
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.77] DEBUG | 11-13-2025 15:30:37.470 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODAzNSwiZXhwIjoxNzYzMDU2ODM1LCJpYXQiOjE3NjMwMjgwMzV9.c4J7sRklVhN3hJ2g3cvBPJ5nYIFJIc4QnnPUO71wek4'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 11-13-2025 15:30:37.470 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,60586
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.77] DEBUG | 11-13-2025 15:30:37.470 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODAzNSwiZXhwIjoxNzYzMDU2ODM1LCJpYXQiOjE3NjMwMjgwMzV9.c4J7sRklVhN3hJ2g3cvBPJ5nYIFJIc4QnnPUO71wek4'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 11-13-2025 15:30:37.470 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODAzNSwiZXhwIjoxNzYzMDU2ODM1LCJpYXQiOjE3NjMwMjgwMzV9.c4J7sRklVhN3hJ2g3cvBPJ5nYIFJIc4QnnPUO71wek4'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 11-13-2025 15:30:37.486 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,60588
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.77] DEBUG | 11-13-2025 15:30:37.486 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODAzNSwiZXhwIjoxNzYzMDU2ODM1LCJpYXQiOjE3NjMwMjgwMzV9.c4J7sRklVhN3hJ2g3cvBPJ5nYIFJIc4QnnPUO71wek4'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 11-13-2025 15:30:37.486 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODAzNSwiZXhwIjoxNzYzMDU2ODM1LCJpYXQiOjE3NjMwMjgwMzV9.c4J7sRklVhN3hJ2g3cvBPJ5nYIFJIc4QnnPUO71wek4'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 11-13-2025 15:30:37.486 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,60584
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.77] DEBUG | 11-13-2025 15:30:37.486 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.77] DEBUG | 11-13-2025 15:30:37.486 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODAzNSwiZXhwIjoxNzYzMDU2ODM1LCJpYXQiOjE3NjMwMjgwMzV9.c4J7sRklVhN3hJ2g3cvBPJ5nYIFJIc4QnnPUO71wek4'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 11-13-2025 15:30:37.486 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODAzNSwiZXhwIjoxNzYzMDU2ODM1LCJpYXQiOjE3NjMwMjgwMzV9.c4J7sRklVhN3hJ2g3cvBPJ5nYIFJIc4QnnPUO71wek4'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 11-13-2025 15:30:37.501 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,60587
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.77] DEBUG | 11-13-2025 15:30:37.501 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODAzNSwiZXhwIjoxNzYzMDU2ODM1LCJpYXQiOjE3NjMwMjgwMzV9.c4J7sRklVhN3hJ2g3cvBPJ5nYIFJIc4QnnPUO71wek4'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 11-13-2025 15:30:37.501 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.77] DEBUG | 11-13-2025 15:30:37.501 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODAzNSwiZXhwIjoxNzYzMDU2ODM1LCJpYXQiOjE3NjMwMjgwMzV9.c4J7sRklVhN3hJ2g3cvBPJ5nYIFJIc4QnnPUO71wek4'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 11-13-2025 15:30:37.517 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.77] DEBUG | 11-13-2025 15:30:37.517 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODAzNSwiZXhwIjoxNzYzMDU2ODM1LCJpYXQiOjE3NjMwMjgwMzV9.c4J7sRklVhN3hJ2g3cvBPJ5nYIFJIc4QnnPUO71wek4'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 11-13-2025 15:30:37.517 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.77] DEBUG | 11-13-2025 15:30:37.533 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODAzNSwiZXhwIjoxNzYzMDU2ODM1LCJpYXQiOjE3NjMwMjgwMzV9.c4J7sRklVhN3hJ2g3cvBPJ5nYIFJIc4QnnPUO71wek4'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 11-13-2025 15:30:37.533 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.77] DEBUG | 11-13-2025 15:30:37.533 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODAzNSwiZXhwIjoxNzYzMDU2ODM1LCJpYXQiOjE3NjMwMjgwMzV9.c4J7sRklVhN3hJ2g3cvBPJ5nYIFJIc4QnnPUO71wek4'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 11-13-2025 15:30:37.548 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.77] DEBUG | 11-13-2025 15:30:37.548 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODAzNSwiZXhwIjoxNzYzMDU2ODM1LCJpYXQiOjE3NjMwMjgwMzV9.c4J7sRklVhN3hJ2g3cvBPJ5nYIFJIc4QnnPUO71wek4'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 11-13-2025 15:30:37.548 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.77] DEBUG | 11-13-2025 15:30:37.548 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODAzNSwiZXhwIjoxNzYzMDU2ODM1LCJpYXQiOjE3NjMwMjgwMzV9.c4J7sRklVhN3hJ2g3cvBPJ5nYIFJIc4QnnPUO71wek4'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 11-13-2025 15:30:37.564 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.77] DEBUG | 11-13-2025 15:30:37.564 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODAzNSwiZXhwIjoxNzYzMDU2ODM1LCJpYXQiOjE3NjMwMjgwMzV9.c4J7sRklVhN3hJ2g3cvBPJ5nYIFJIc4QnnPUO71wek4'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 11-13-2025 15:30:37.564 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.77] DEBUG | 11-13-2025 15:30:37.564 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODAzNSwiZXhwIjoxNzYzMDU2ODM1LCJpYXQiOjE3NjMwMjgwMzV9.c4J7sRklVhN3hJ2g3cvBPJ5nYIFJIc4QnnPUO71wek4'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 11-13-2025 15:30:37.580 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.77] DEBUG | 11-13-2025 15:30:37.580 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODAzNSwiZXhwIjoxNzYzMDU2ODM1LCJpYXQiOjE3NjMwMjgwMzV9.c4J7sRklVhN3hJ2g3cvBPJ5nYIFJIc4QnnPUO71wek4'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 11-13-2025 15:30:37.580 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.77] DEBUG | 11-13-2025 15:30:37.580 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODAzNSwiZXhwIjoxNzYzMDU2ODM1LCJpYXQiOjE3NjMwMjgwMzV9.c4J7sRklVhN3hJ2g3cvBPJ5nYIFJIc4QnnPUO71wek4'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 11-13-2025 15:30:37.673 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60583'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 11-13-2025 15:30:37.689 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODAzNSwiZXhwIjoxNzYzMDU2ODM1LCJpYXQiOjE3NjMwMjgwMzV9.c4J7sRklVhN3hJ2g3cvBPJ5nYIFJIc4QnnPUO71wek4'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 11-13-2025 15:30:37.970 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReportCategoryandField 
 -1
 ,0
 ,1
 ,0
 ,'1'
 ,1
[System: 192.168.1.77] DEBUG | 11-13-2025 15:30:37.970 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODAzNSwiZXhwIjoxNzYzMDU2ODM1LCJpYXQiOjE3NjMwMjgwMzV9.c4J7sRklVhN3hJ2g3cvBPJ5nYIFJIc4QnnPUO71wek4'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 11-13-2025 15:30:38.033 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60584'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 11-13-2025 15:30:38.033 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODAzNSwiZXhwIjoxNzYzMDU2ODM1LCJpYXQiOjE3NjMwMjgwMzV9.c4J7sRklVhN3hJ2g3cvBPJ5nYIFJIc4QnnPUO71wek4'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 11-13-2025 15:30:38.064 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60585'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 11-13-2025 15:30:38.064 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODAzNSwiZXhwIjoxNzYzMDU2ODM1LCJpYXQiOjE3NjMwMjgwMzV9.c4J7sRklVhN3hJ2g3cvBPJ5nYIFJIc4QnnPUO71wek4'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 11-13-2025 15:30:38.095 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60586'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 11-13-2025 15:30:38.095 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODAzNSwiZXhwIjoxNzYzMDU2ODM1LCJpYXQiOjE3NjMwMjgwMzV9.c4J7sRklVhN3hJ2g3cvBPJ5nYIFJIc4QnnPUO71wek4'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 11-13-2025 15:30:38.111 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60587'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 11-13-2025 15:30:38.126 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODAzNSwiZXhwIjoxNzYzMDU2ODM1LCJpYXQiOjE3NjMwMjgwMzV9.c4J7sRklVhN3hJ2g3cvBPJ5nYIFJIc4QnnPUO71wek4'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 11-13-2025 15:30:38.142 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60588'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 11-13-2025 15:30:38.142 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODAzNSwiZXhwIjoxNzYzMDU2ODM1LCJpYXQiOjE3NjMwMjgwMzV9.c4J7sRklVhN3hJ2g3cvBPJ5nYIFJIc4QnnPUO71wek4'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 11-13-2025 15:30:38.173 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60583'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 11-13-2025 15:30:38.173 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODAzNSwiZXhwIjoxNzYzMDU2ODM1LCJpYXQiOjE3NjMwMjgwMzV9.c4J7sRklVhN3hJ2g3cvBPJ5nYIFJIc4QnnPUO71wek4'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 11-13-2025 15:30:38.220 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select * from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0  
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) a  where UnitStatus=''Expired'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 11-13-2025 15:30:38.220 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODAzNSwiZXhwIjoxNzYzMDU2ODM1LCJpYXQiOjE3NjMwMjgwMzV9.c4J7sRklVhN3hJ2g3cvBPJ5nYIFJIc4QnnPUO71wek4'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 11-13-2025 15:30:38.220 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select * from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0  
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) a where UnitStatus=''Occupied'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 11-13-2025 15:30:38.220 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60584'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 11-13-2025 15:30:38.236 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODAzNSwiZXhwIjoxNzYzMDU2ODM1LCJpYXQiOjE3NjMwMjgwMzV9.c4J7sRklVhN3hJ2g3cvBPJ5nYIFJIc4QnnPUO71wek4'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 11-13-2025 15:30:38.236 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODAzNSwiZXhwIjoxNzYzMDU2ODM1LCJpYXQiOjE3NjMwMjgwMzV9.c4J7sRklVhN3hJ2g3cvBPJ5nYIFJIc4QnnPUO71wek4'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 11-13-2025 15:30:38.251 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60585'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 11-13-2025 15:30:38.251 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODAzNSwiZXhwIjoxNzYzMDU2ODM1LCJpYXQiOjE3NjMwMjgwMzV9.c4J7sRklVhN3hJ2g3cvBPJ5nYIFJIc4QnnPUO71wek4'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 11-13-2025 15:30:38.283 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60586'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 11-13-2025 15:30:38.283 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODAzNSwiZXhwIjoxNzYzMDU2ODM1LCJpYXQiOjE3NjMwMjgwMzV9.c4J7sRklVhN3hJ2g3cvBPJ5nYIFJIc4QnnPUO71wek4'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 11-13-2025 15:30:38.298 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select * from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0  
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) a where UStatus like ''%Case%'' 
'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 11-13-2025 15:30:38.298 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODAzNSwiZXhwIjoxNzYzMDU2ODM1LCJpYXQiOjE3NjMwMjgwMzV9.c4J7sRklVhN3hJ2g3cvBPJ5nYIFJIc4QnnPUO71wek4'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 11-13-2025 15:30:38.314 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select * from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0  
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) a --where UStatus like ''%Hold%'' 
'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 11-13-2025 15:30:38.314 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select * from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0  
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) a where UnitStatus=''Occupied'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 11-13-2025 15:30:38.314 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60587'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 11-13-2025 15:30:38.314 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODAzNSwiZXhwIjoxNzYzMDU2ODM1LCJpYXQiOjE3NjMwMjgwMzV9.c4J7sRklVhN3hJ2g3cvBPJ5nYIFJIc4QnnPUO71wek4'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 11-13-2025 15:30:38.314 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODAzNSwiZXhwIjoxNzYzMDU2ODM1LCJpYXQiOjE3NjMwMjgwMzV9.c4J7sRklVhN3hJ2g3cvBPJ5nYIFJIc4QnnPUO71wek4'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 11-13-2025 15:30:38.314 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select * from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0  
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) a  where UnitStatus=''Expired'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 11-13-2025 15:30:38.314 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select * from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0  
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) a where UnitStatus=''Vacant''
'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 11-13-2025 15:30:38.314 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODAzNSwiZXhwIjoxNzYzMDU2ODM1LCJpYXQiOjE3NjMwMjgwMzV9.c4J7sRklVhN3hJ2g3cvBPJ5nYIFJIc4QnnPUO71wek4'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 11-13-2025 15:30:38.314 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODAzNSwiZXhwIjoxNzYzMDU2ODM1LCJpYXQiOjE3NjMwMjgwMzV9.c4J7sRklVhN3hJ2g3cvBPJ5nYIFJIc4QnnPUO71wek4'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 11-13-2025 15:30:38.314 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODAzNSwiZXhwIjoxNzYzMDU2ODM1LCJpYXQiOjE3NjMwMjgwMzV9.c4J7sRklVhN3hJ2g3cvBPJ5nYIFJIc4QnnPUO71wek4'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 11-13-2025 15:30:38.345 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60588'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 11-13-2025 15:30:38.345 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODAzNSwiZXhwIjoxNzYzMDU2ODM1LCJpYXQiOjE3NjMwMjgwMzV9.c4J7sRklVhN3hJ2g3cvBPJ5nYIFJIc4QnnPUO71wek4'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 11-13-2025 15:30:38.345 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select * from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0  
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) a where UStatus like ''%Case%'' 
'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 11-13-2025 15:30:38.361 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODAzNSwiZXhwIjoxNzYzMDU2ODM1LCJpYXQiOjE3NjMwMjgwMzV9.c4J7sRklVhN3hJ2g3cvBPJ5nYIFJIc4QnnPUO71wek4'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 11-13-2025 15:30:38.361 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select * from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0  
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) a where UnitStatus=''Vacant''
'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 11-13-2025 15:30:38.361 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODAzNSwiZXhwIjoxNzYzMDU2ODM1LCJpYXQiOjE3NjMwMjgwMzV9.c4J7sRklVhN3hJ2g3cvBPJ5nYIFJIc4QnnPUO71wek4'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 11-13-2025 15:30:38.361 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select * from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0  
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) a --where UStatus like ''%Hold%'' 
'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 11-13-2025 15:30:38.376 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODAzNSwiZXhwIjoxNzYzMDU2ODM1LCJpYXQiOjE3NjMwMjgwMzV9.c4J7sRklVhN3hJ2g3cvBPJ5nYIFJIc4QnnPUO71wek4'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 11-13-2025 15:30:38.392 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 '/*
DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select * from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0  
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) a where UStatus like ''%Reserve%'' 
*/

DECLARE @FROM FLOAT
SET @FROM=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @UnitID BIGINT,@StatusID BIGINT,@TotalAmount FLOAT,@I INT,@COUNT INT,@ContractID BIGINT
DECLARE @NoofDays INT,@VacantSince DATETIME

DECLARE @TAB TABLE(ID INT IDENTITY(1,1) PRIMARY KEY,UnitID BIGINT,CurrentRent FLOAT,Status NVARCHAR(10),NoofDays INT,VacantSince DATETIME,ContractID BIGINT)

INSERT INTO @TAB (UnitID)
SELECT U.UnitID
FROM REN_Units U WITH(NOLOCK) 
LEFT JOIN REN_Property P WITH(NOLOCK) ON P.NodeID=U.PropertyID
LEFT JOIN COM_Lookup LK WITH(NOLOCK) ON U.UnitStatus=LK.NodeID
WHERE U.UnitID>1 AND P.Name <> U.Name AND U.IsGroup=0 AND U.Status=424 and U.UnitStatus=306 
-- AND P.NodeID IN (207)
SELECT @I=1,@COUNT=COUNT(*) FROM @TAB
WHILE(@I<=@COUNT)
BEGIN
	SET @StatusID=0
	SET @TotalAmount=0
	SET @ContractID=0
	SELECT @UnitID=UnitID FROM @TAB WHERE ID=@I

	SELECT TOP 1 @ContractID=(CASE WHEN RefContractID>0 THEN RefContractID ELSE ContractID END),@StatusID=StatusID
	,@VacantSince=(CASE WHEN StatusID = 450 THEN ( CASE WHEN RefundDate IS NOT NULL THEN CONVERT(DATETIME,RefundDate) ELSE CONVERT(DATETIME,VacancyDate) END ) 
			ELSE CONVERT(DATETIME,TerminationDate) END )
	,@NoofDays=(CASE WHEN StatusID = 450 THEN (CASE WHEN RefundDate IS NOT NULL THEN DATEDIFF(DAY, CONVERT(DATETIME,RefundDate),CONVERT(DATETIME,@FROM) ) 
			ELSE DATEDIFF(DAY, CONVERT(DATETIME,VacancyDate),CONVERT(DATETIME,@FROM) ) END )
			ELSE DATEDIFF(DAY, CONVERT(DATETIME,TerminationDate),CONVERT(DATETIME,@FROM) ) END )  
	FROM REN_Contract WITH(NOLOCK) WHERE StatusID<>451 AND StartDate<@FROM AND UNITID=@UnitID 
	ORDER BY StartDate DESC,StatusID
	
	SELECT @TotalAmount=ISNULL(SUM(RPD.Amount),MAX(RentAmount)/(CASE WHEN MAX(RC.NoOfUnits)=0 THEN 1 ELSE MAX(RC.NoOfUnits) END)) 
	FROM REN_Contract RC WITH(NOLOCK)
	JOIN REN_ContractParticulars RP WITH(NOLOCK) ON RP.ContractID=RC.ContractID AND RP.Sno=1
	LEFT JOIN REN_ContractParticularsDetail RPD WITH(NOLOCK) ON RPD.ParticularNodeID=RP.NodeID AND RPD.Unit=@UnitID 
	AND @FROM BETWEEN ISNULL(RPD.FromDate,@FROM) AND ISNULL(RPD.ToDate,@FROM)
	WHERE RC.ContractID=@ContractID
	
	IF @StatusID=427 OR @StatusID=426 OR @StatusID=466
	BEGIN
		UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Occupied'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
	END
	ELSE IF @StatusID=440
	BEGIN
		UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''UnAproved'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
	END
	ELSE IF @StatusID=428 OR @StatusID=450
	BEGIN 
		IF EXISTS (SELECT * FROM REN_Quotation WITH(NOLOCK) WHERE COSTCENTERID=129 AND UNITID=@UnitID AND CONVERT(DATETIME,@FROM) BETWEEN CONVERT(DATETIME,STARTDATE) AND CONVERT(DATETIME,ENDDATE) and statusid=467 )
			UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Reserved'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
		ELSE IF EXISTS (SELECT * FROM REN_Quotation WITH(NOLOCK) WHERE COSTCENTERID=103 AND UNITID=@UnitID AND CONVERT(DATETIME,@FROM) BETWEEN CONVERT(DATETIME,STARTDATE) AND CONVERT(DATETIME,ENDDATE) and statusid=426 )
			UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Quoted'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
		ELSE
			UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Vacant'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
	END
	ELSE
	BEGIN 
		IF EXISTS (SELECT * FROM REN_Quotation WITH(NOLOCK) WHERE COSTCENTERID=129 AND UNITID=@UnitID AND CONVERT(DATETIME,@FROM) BETWEEN CONVERT(DATETIME,STARTDATE) AND CONVERT(DATETIME,ENDDATE) and statusid=467 )
			UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Reserved'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
		ELSE IF EXISTS (SELECT * FROM REN_Quotation WITH(NOLOCK) WHERE COSTCENTERID=103 AND UNITID=@UnitID AND CONVERT(DATETIME,@FROM) BETWEEN CONVERT(DATETIME,STARTDATE) AND CONVERT(DATETIME,ENDDATE) and statusid=426 )
			UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Quoted'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
		ELSE
			UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Vacant'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
	END
	set @I=@I+1
END

select * from (
SELECT TEMP.*,RP.NodeID Building_ID,RP.NAME Property,TEMP.UnitID Unit_ID,RU.NAME Unit,C18.NAME UnitType,RU.UnitStatus,RU.RentableArea UnitArea,RU.RentPerSQFT UnitRate
,RU.AnnualRent 
,T.FirstName AS [C98c7d2679f99489e9f0e010026eeb563]
,RUL.Name LandLord , RUC.Name Location 
,1 Cnt
FROM @TAB TEMP
JOIN REN_Units RU WITH(NOLOCK) ON TEMP.UnitID=RU.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
LEFT JOIN COM_CC50018 C18 WITH(NOLOCK) ON C18.NodeID=RU.NodeID
LEFT JOIN REN_Contract C WITH(NOLOCK) ON TEMP.ContractID=C.ContractID
LEFT JOIN REN_Tenant T WITH(NOLOCK) ON T.TenantID=C.TenantID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID

 )a where a.Status =''Reserved''
 order by Property,VacantSince'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 11-13-2025 15:30:38.392 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODAzNSwiZXhwIjoxNzYzMDU2ODM1LCJpYXQiOjE3NjMwMjgwMzV9.c4J7sRklVhN3hJ2g3cvBPJ5nYIFJIc4QnnPUO71wek4'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 11-13-2025 15:30:38.408 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 '/*
DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select * from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0  
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) a where UStatus like ''%Reserve%'' 
*/

DECLARE @FROM FLOAT
SET @FROM=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @UnitID BIGINT,@StatusID BIGINT,@TotalAmount FLOAT,@I INT,@COUNT INT,@ContractID BIGINT
DECLARE @NoofDays INT,@VacantSince DATETIME

DECLARE @TAB TABLE(ID INT IDENTITY(1,1) PRIMARY KEY,UnitID BIGINT,CurrentRent FLOAT,Status NVARCHAR(10),NoofDays INT,VacantSince DATETIME,ContractID BIGINT)

INSERT INTO @TAB (UnitID)
SELECT U.UnitID
FROM REN_Units U WITH(NOLOCK) 
LEFT JOIN REN_Property P WITH(NOLOCK) ON P.NodeID=U.PropertyID
LEFT JOIN COM_Lookup LK WITH(NOLOCK) ON U.UnitStatus=LK.NodeID
WHERE U.UnitID>1 AND P.Name <> U.Name AND U.IsGroup=0 AND U.Status=424 and U.UnitStatus=306 
-- AND P.NodeID IN (207)
SELECT @I=1,@COUNT=COUNT(*) FROM @TAB
WHILE(@I<=@COUNT)
BEGIN
	SET @StatusID=0
	SET @TotalAmount=0
	SET @ContractID=0
	SELECT @UnitID=UnitID FROM @TAB WHERE ID=@I

	SELECT TOP 1 @ContractID=(CASE WHEN RefContractID>0 THEN RefContractID ELSE ContractID END),@StatusID=StatusID
	,@VacantSince=(CASE WHEN StatusID = 450 THEN ( CASE WHEN RefundDate IS NOT NULL THEN CONVERT(DATETIME,RefundDate) ELSE CONVERT(DATETIME,VacancyDate) END ) 
			ELSE CONVERT(DATETIME,TerminationDate) END )
	,@NoofDays=(CASE WHEN StatusID = 450 THEN (CASE WHEN RefundDate IS NOT NULL THEN DATEDIFF(DAY, CONVERT(DATETIME,RefundDate),CONVERT(DATETIME,@FROM) ) 
			ELSE DATEDIFF(DAY, CONVERT(DATETIME,VacancyDate),CONVERT(DATETIME,@FROM) ) END )
			ELSE DATEDIFF(DAY, CONVERT(DATETIME,TerminationDate),CONVERT(DATETIME,@FROM) ) END )  
	FROM REN_Contract WITH(NOLOCK) WHERE StatusID<>451 AND StartDate<@FROM AND UNITID=@UnitID 
	ORDER BY StartDate DESC,StatusID
	
	SELECT @TotalAmount=ISNULL(SUM(RPD.Amount),MAX(RentAmount)/(CASE WHEN MAX(RC.NoOfUnits)=0 THEN 1 ELSE MAX(RC.NoOfUnits) END)) 
	FROM REN_Contract RC WITH(NOLOCK)
	JOIN REN_ContractParticulars RP WITH(NOLOCK) ON RP.ContractID=RC.ContractID AND RP.Sno=1
	LEFT JOIN REN_ContractParticularsDetail RPD WITH(NOLOCK) ON RPD.ParticularNodeID=RP.NodeID AND RPD.Unit=@UnitID 
	AND @FROM BETWEEN ISNULL(RPD.FromDate,@FROM) AND ISNULL(RPD.ToDate,@FROM)
	WHERE RC.ContractID=@ContractID
	
	IF @StatusID=427 OR @StatusID=426 OR @StatusID=466
	BEGIN
		UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Occupied'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
	END
	ELSE IF @StatusID=440
	BEGIN
		UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''UnAproved'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
	END
	ELSE IF @StatusID=428 OR @StatusID=450
	BEGIN 
		IF EXISTS (SELECT * FROM REN_Quotation WITH(NOLOCK) WHERE COSTCENTERID=129 AND UNITID=@UnitID AND CONVERT(DATETIME,@FROM) BETWEEN CONVERT(DATETIME,STARTDATE) AND CONVERT(DATETIME,ENDDATE) and statusid=467 )
			UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Reserved'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
		ELSE IF EXISTS (SELECT * FROM REN_Quotation WITH(NOLOCK) WHERE COSTCENTERID=103 AND UNITID=@UnitID AND CONVERT(DATETIME,@FROM) BETWEEN CONVERT(DATETIME,STARTDATE) AND CONVERT(DATETIME,ENDDATE) and statusid=426 )
			UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Quoted'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
		ELSE
			UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Vacant'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
	END
	ELSE
	BEGIN 
		IF EXISTS (SELECT * FROM REN_Quotation WITH(NOLOCK) WHERE COSTCENTERID=129 AND UNITID=@UnitID AND CONVERT(DATETIME,@FROM) BETWEEN CONVERT(DATETIME,STARTDATE) AND CONVERT(DATETIME,ENDDATE) and statusid=467 )
			UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Reserved'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
		ELSE IF EXISTS (SELECT * FROM REN_Quotation WITH(NOLOCK) WHERE COSTCENTERID=103 AND UNITID=@UnitID AND CONVERT(DATETIME,@FROM) BETWEEN CONVERT(DATETIME,STARTDATE) AND CONVERT(DATETIME,ENDDATE) and statusid=426 )
			UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Quoted'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
		ELSE
			UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Vacant'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
	END
	set @I=@I+1
END

select * from (
SELECT TEMP.*,RP.NodeID Building_ID,RP.NAME Property,TEMP.UnitID Unit_ID,RU.NAME Unit,C18.NAME UnitType,RU.UnitStatus,RU.RentableArea UnitArea,RU.RentPerSQFT UnitRate
,RU.AnnualRent 
,T.FirstName AS [C98c7d2679f99489e9f0e010026eeb563]
,RUL.Name LandLord , RUC.Name Location 
,1 Cnt
FROM @TAB TEMP
JOIN REN_Units RU WITH(NOLOCK) ON TEMP.UnitID=RU.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
LEFT JOIN COM_CC50018 C18 WITH(NOLOCK) ON C18.NodeID=RU.NodeID
LEFT JOIN REN_Contract C WITH(NOLOCK) ON TEMP.ContractID=C.ContractID
LEFT JOIN REN_Tenant T WITH(NOLOCK) ON T.TenantID=C.TenantID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID

 )a where a.Status =''Reserved''
 order by Property,VacantSince'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 11-13-2025 15:30:38.408 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODAzNSwiZXhwIjoxNzYzMDU2ODM1LCJpYXQiOjE3NjMwMjgwMzV9.c4J7sRklVhN3hJ2g3cvBPJ5nYIFJIc4QnnPUO71wek4'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:30:42.861 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:30:42.861 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTAzLDEiLCJuYmYiOjE3NjMwMjczNjEsImV4cCI6MTc2MzA1NjE2MSwiaWF0IjoxNzYzMDI3MzYxfQ.MM4Bcir0G16SgFZ-r9pNC1t4YTZPYf_0qtj1BDBDQy4'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:30:49.852 | General Service|:: CompanyIndex:0 SpName: spADM_GetClientUserDetails2C 
 'admin'
 ,1
 ,0
[System: 192.168.1.79] DEBUG | 11-13-2025 15:30:49.898 | General Service|:: CompanyIndex:0 SpName: spADM_UserLoginCheck 
 2
 ,'admin'
 ,0
 ,'192.168.1.79'
 ,'192.168.1.79'
 ,''
 ,'Web'
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:30:55.635 | General Service|:: CompanyIndex:103 SpName: spADM_GetClientUserDetails 
 'admin'
 ,1
 ,'26.8.6'
 ,0
[System: 192.168.1.79] DEBUG | 11-13-2025 15:30:55.682 | General Service|:: CompanyIndex:0 SpName: spADM_UserLoginCheck 
 2
 ,'admin'
 ,103
 ,'192.168.1.79'
 ,'192.168.1.79'
 ,''
 ,'Web'
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:30:55.698 | General Service|:: CompanyIndex:0 SpName: spADM_Login 
 1
 ,''
 ,''
 ,''
 ,''
 ,''
 ,103
[System: 192.168.1.79] DEBUG | 11-13-2025 15:30:55.713 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'select Value from ADM_GlobalPreferences with (nolock) where name =''EnableReLogin'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:30:55.713 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTAzLDEiLCJuYmYiOjE3NjMwMjgwNTUsImV4cCI6MTc2MzA1Njg1NSwiaWF0IjoxNzYzMDI4MDU1fQ.0HTaw4flBBHsHK2bJWh6sp2X4QOe-Ng7oRTrZaWOVrw'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:30:55.745 | General Service|:: CompanyIndex:0 SpName: spADM_Login 
 4
 ,''
 ,''
 ,''
 ,'declare @Cnt int,@ExpiredGUID nvarchar(50),@AllowSession int,@GUID nvarchar(50),@CurrDate float,@UserID INT,@Instances INT,@InstancesExists INT,@LCDBIndex int
set @CurrDate= convert(float,dateadd(minute,-21,getdate()))
set @AllowSession=0
set @GUID=''164cb27f-5bf3-4c8b-8615-5ac7edccee24''
set @LCDBIndex=0
select top 1 @UserID=UserID,@Instances=InstanceCount from ADM_Users with(nolock) where UserName=''admin''
if exists(select [GUID] from ADM_Login with(nolock) where [GUID]=@GUID)
begin
	update ADM_Login 
	set LastAccessTime=convert(float,getdate()),UserID=@UserID
	where [GUID]=@GUID
    set @AllowSession=1
end
else
begin
	select @Cnt=count(*) from ADM_Login with(nolock) where LCDBIndex=@LCDBIndex and [GUID]!=''ACCESSRIGHTS'' and AP =''WEB''
    if(@Cnt<100)
		set @AllowSession=1
	else
	begin
		select top 1 @ExpiredGUID=[GUID] from ADM_Login with(nolock)
		where [GUID]!=''ACCESSRIGHTS'' and LCDBIndex=@LCDBIndex and LastAccessTime<@CurrDate  and AP =''WEB''
        order by LastAccessTime asc
		if @ExpiredGUID is not null
		begin
			delete from ADM_Login where [GUID]=@ExpiredGUID
			set @AllowSession=1
		end
	end
	if @AllowSession=1
	begin
        select @InstancesExists=COUNT(*) from ADM_Login with(nolock)
		where [GUID]!=''ACCESSRIGHTS'' and LCDBIndex=@LCDBIndex and LastAccessTime>=@CurrDate and UserID=@UserID and AP =''WEB''
		if(@Instances!=0 and @Instances<=@InstancesExists)
			set @AllowSession=2
		else
		    INSERT INTO ADM_Login([GUID],[SysName],IPAddress,[Status],LoginTime,LastAccessTime,AccessRights,UserID,DBIndex,LCDBIndex,AP)
		    VALUES(@GUID,''WEB'',''192.168.1.79'',1,convert(float,getdate()),convert(float,getdate()),null,@UserID,103,@LCDBIndex, ''WEB'')
	end
end

select @AllowSession AllowSession,@Instances Instances,@InstancesExists InstancesExists
'
 ,''
 ,0
[System: 192.168.1.79] DEBUG | 11-13-2025 15:30:55.745 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTAzLDEiLCJuYmYiOjE3NjMwMjgwNTUsImV4cCI6MTc2MzA1Njg1NSwiaWF0IjoxNzYzMDI4MDU1fQ.0HTaw4flBBHsHK2bJWh6sp2X4QOe-Ng7oRTrZaWOVrw'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:30:55.791 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'SELECT (SELECT COUNT(*) FROM COM_Location L WITH(NOLOCK) JOIN COM_Status S WITH(NOLOCK) ON S.StatusID=L.StatusID WHERE L.IsGroup=0 AND S.[Status]=''Active'') ML
,(SELECT COUNT(*) FROM ADM_Features WITH(NOLOCK) WHERE ((FeatureID>50000 AND FeatureID<=50050) OR FeatureID>=51000) AND IsEnabled=1) MD
,(SELECT ISNULL(COUNT(*),0) FROM ADM_RevenUReports WITH(NOLOCK) WHERE IsGroup=0 AND ReportID>10000 AND StaticReportType IN (0,-1)) MR'
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:30:55.791 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTAzLDEiLCJuYmYiOjE3NjMwMjgwNTUsImV4cCI6MTc2MzA1Njg1NSwiaWF0IjoxNzYzMDI4MDU1fQ.0HTaw4flBBHsHK2bJWh6sp2X4QOe-Ng7oRTrZaWOVrw'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:30:59.229 | General Service|:: CompanyIndex:103 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.79] DEBUG | 11-13-2025 15:30:59.229 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTAzLDEiLCJuYmYiOjE3NjMwMjgwNTUsImV4cCI6MTc2MzA1Njg1NSwiaWF0IjoxNzYzMDI4MDU1fQ.0HTaw4flBBHsHK2bJWh6sp2X4QOe-Ng7oRTrZaWOVrw'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:31:01.017 | General Service|:: CompanyIndex:103 SpName: spADM_GetRibbonView 
 1
 ,1
 ,1
 ,1
 ,0
 ,''
[System: 192.168.1.79] DEBUG | 11-13-2025 15:31:01.032 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTAzLDEiLCJuYmYiOjE3NjMwMjgwNTUsImV4cCI6MTc2MzA1Njg1NSwiaWF0IjoxNzYzMDI4MDU1fQ.0HTaw4flBBHsHK2bJWh6sp2X4QOe-Ng7oRTrZaWOVrw'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:31:01.204 | General Service|:: CompanyIndex:103 SpName: spRPT_GetReport 
 2
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:31:01.220 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTAzLDEiLCJuYmYiOjE3NjMwMjgwNTUsImV4cCI6MTc2MzA1Njg1NSwiaWF0IjoxNzYzMDI4MDU1fQ.0HTaw4flBBHsHK2bJWh6sp2X4QOe-Ng7oRTrZaWOVrw'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:31:01.220 | General Service|:: CompanyIndex:103 SpName: spADM_GetDashBoard 
 2
 ,0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:31:01.236 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTAzLDEiLCJuYmYiOjE3NjMwMjgwNTUsImV4cCI6MTc2MzA1Njg1NSwiaWF0IjoxNzYzMDI4MDU1fQ.0HTaw4flBBHsHK2bJWh6sp2X4QOe-Ng7oRTrZaWOVrw'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:31:01.251 | General Service|:: CompanyIndex:103 SpName: spCOM_ConfigValues 
 1
 ,'LandingDocs'
 ,'1'
[System: 192.168.1.79] DEBUG | 11-13-2025 15:31:01.251 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTAzLDEiLCJuYmYiOjE3NjMwMjgwNTUsImV4cCI6MTc2MzA1Njg1NSwiaWF0IjoxNzYzMDI4MDU1fQ.0HTaw4flBBHsHK2bJWh6sp2X4QOe-Ng7oRTrZaWOVrw'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:31:01.298 | General Service|:: CompanyIndex:103 SpName: spCOM_GetFavorites 
 'GETLIST0'
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:31:01.298 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTAzLDEiLCJuYmYiOjE3NjMwMjgwNTUsImV4cCI6MTc2MzA1Njg1NSwiaWF0IjoxNzYzMDI4MDU1fQ.0HTaw4flBBHsHK2bJWh6sp2X4QOe-Ng7oRTrZaWOVrw'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:31:01.298 | General Service|:: CompanyIndex:103 SpName: spADM_GetAllListViewsDef 
 1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:31:01.298 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTAzLDEiLCJuYmYiOjE3NjMwMjgwNTUsImV4cCI6MTc2MzA1Njg1NSwiaWF0IjoxNzYzMDI4MDU1fQ.0HTaw4flBBHsHK2bJWh6sp2X4QOe-Ng7oRTrZaWOVrw'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:31:01.407 | General Service|:: CompanyIndex:103 SpName: spADM_GetAllListViewsDef 
 1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:31:01.407 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTAzLDEiLCJuYmYiOjE3NjMwMjgwNTUsImV4cCI6MTc2MzA1Njg1NSwiaWF0IjoxNzYzMDI4MDU1fQ.0HTaw4flBBHsHK2bJWh6sp2X4QOe-Ng7oRTrZaWOVrw'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:31:01.517 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'Select CostCenterID,CostCenterColID,CostCenterName,SysTableName,UserColumnName,SysColumnName,ISNULL(UserDefaultValue,'''') UserDefaultValue
From AdM_CostCenterDef WITH(NOLOCK)
Where SysColumnName IN(''CreditAccount'',''DebitAccount'',''ProductID'') 
AND CostCenterID>40000 AND CostCenterID<50000 

SELECT * FROM ADM_Features WITH(NOLOCK) '
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:31:01.517 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTAzLDEiLCJuYmYiOjE3NjMwMjgwNTUsImV4cCI6MTc2MzA1Njg1NSwiaWF0IjoxNzYzMDI4MDU1fQ.0HTaw4flBBHsHK2bJWh6sp2X4QOe-Ng7oRTrZaWOVrw'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:31:01.548 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 '  SELECT * FROM PAY_PayrollPreferences WITH(NOLOCK) '
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:31:01.564 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTAzLDEiLCJuYmYiOjE3NjMwMjgwNTUsImV4cCI6MTc2MzA1Njg1NSwiaWF0IjoxNzYzMDI4MDU1fQ.0HTaw4flBBHsHK2bJWh6sp2X4QOe-Ng7oRTrZaWOVrw'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:31:01.611 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 '  --0
                                Select * FROM COM_CC50051 WITH(NOLOCK) WHERE IsGroup=0 AND LoginUserID=''admin''
                                --1                                
                                Select * FROM COM_CC50051 WITH(NOLOCK) WHERE RptManager IN (Select NodeID FROM COM_CC50051 WITH(NOLOCK) WHERE IsGroup=0 AND LoginUserID=''admin'')
                                UNION ALL
                                Select * FROM COM_CC50051 WITH(NOLOCK) WHERE RptManager IN 
                                (
	                                Select NodeID FROM COM_CC50051 WITH(NOLOCK) 
	                                WHERE IsGroup=0 AND LoginUserID IN
	                                (
	                                SELECT fe.LoginUserID
	                                FROM INV_DocDetails a WITH(NOLOCK) 
	                                JOIN COM_DocCCData b WITH(NOLOCK) ON b.InvDocDetailsID=a.InvDocDetailsID
	                                JOIN COM_DocNumData c WITH(NOLOCK) ON c.InvDocDetailsID=a.InvDocDetailsID
	                                JOIN COM_DocTextData d WITH(NOLOCK) ON d.InvDocDetailsID=a.InvDocDetailsID
	                                JOIN COM_CC50051 fe WITH(NOLOCK) on fe.NodeID=b.dcCCNID51
	                                JOIN COM_CC50051 te WITH(NOLOCK) on CONVERT(NVARCHAR,te.NodeID)=d.dcAlpha1
	                                WHERE a.CostCenterID=40098 and a.StatusID=369 AND d.dcAlpha3=''Temporary''
	                                AND te.LoginUserID=''admin'' 
	                                AND ISDATE(d.dcAlpha4)=1 AND ISDATE(d.dcAlpha5)=1 
	                                AND CONVERT(DATETIME,''13 Nov 2025'') BETWEEN CONVERT(DATETIME,d.dcAlpha4) AND CONVERT(DATETIME,d.dcAlpha5)
	                                )
                                )
                                --2
                                Select * FROM ADM_USERS WITH(NOLOCK) WHERE USERID=1
                                --3
                                Select * FROM COM_CostCenterCostCenterMap WITH(NOLOCK) WHERE ParentCostCenterID=7 AND ParentNodeID=1
                                --4                                
                                Select * FROM COM_CostCenterCostCenterMap WITH(NOLOCK) WHERE ParentCostCenterID=7 AND ParentNodeID=1
                                AND CostCenterID IN(Select ColumnCostCenterID From ADM_CostCenterDef Where CostCenterID=50051 AND IsColumnInUse=1 AND SysColumnName LIKE ''CCNID%'')
                                --5
                                Select * from COM_Files WITH(NOLOCK) WHERE FeatureID=50051 AND FeaturePK IN (Select NodeID FROM COM_CC50051 WITH(NOLOCK) WHERE IsGroup=0 AND LoginUserID=''admin'')                         
'
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:31:01.611 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTAzLDEiLCJuYmYiOjE3NjMwMjgwNTUsImV4cCI6MTc2MzA1Njg1NSwiaWF0IjoxNzYzMDI4MDU1fQ.0HTaw4flBBHsHK2bJWh6sp2X4QOe-Ng7oRTrZaWOVrw'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:31:01.673 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:31:01.689 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTAzLDEiLCJuYmYiOjE3NjMwMjgwNTUsImV4cCI6MTc2MzA1Njg1NSwiaWF0IjoxNzYzMDI4MDU1fQ.0HTaw4flBBHsHK2bJWh6sp2X4QOe-Ng7oRTrZaWOVrw'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:31:02.173 | General Service|:: CompanyIndex:103 SpName: spADM_GetDashBoard 
 1
 ,39
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:31:02.173 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTAzLDEiLCJuYmYiOjE3NjMwMjgwNTUsImV4cCI6MTc2MzA1Njg1NSwiaWF0IjoxNzYzMDI4MDU1fQ.0HTaw4flBBHsHK2bJWh6sp2X4QOe-Ng7oRTrZaWOVrw'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:31:02.267 | General Service|:: CompanyIndex:103 SpName: spCOM_GetFavorites 
 'VIEW'
 ,557
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:31:02.267 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTAzLDEiLCJuYmYiOjE3NjMwMjgwNTUsImV4cCI6MTc2MzA1Njg1NSwiaWF0IjoxNzYzMDI4MDU1fQ.0HTaw4flBBHsHK2bJWh6sp2X4QOe-Ng7oRTrZaWOVrw'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:31:02.313 | General Service|:: CompanyIndex:103 SpName: spCOM_GetFavorites 
 'VIEW'
 ,566
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:31:02.313 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTAzLDEiLCJuYmYiOjE3NjMwMjgwNTUsImV4cCI6MTc2MzA1Njg1NSwiaWF0IjoxNzYzMDI4MDU1fQ.0HTaw4flBBHsHK2bJWh6sp2X4QOe-Ng7oRTrZaWOVrw'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:31:06.976 | General Service|:: CompanyIndex:103 SpName: spADM_GetCostCenterGridViewList 
 200
 ,1
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:31:06.992 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTAzLDEiLCJuYmYiOjE3NjMwMjgwNTUsImV4cCI6MTc2MzA1Njg1NSwiaWF0IjoxNzYzMDI4MDU1fQ.0HTaw4flBBHsHK2bJWh6sp2X4QOe-Ng7oRTrZaWOVrw'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:31:07.132 | General Service|:: CompanyIndex:103 SpName: spCom_GetCostCenterSummary 
 267
 ,-1
 ,1000
 ,''
 ,''
 ,''
 ,0
 ,'13-Nov-2025'
 ,NULL
 ,''
 ,1
 ,1
 ,0
 ,0
 ,False
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:31:07.132 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTAzLDEiLCJuYmYiOjE3NjMwMjgwNTUsImV4cCI6MTc2MzA1Njg1NSwiaWF0IjoxNzYzMDI4MDU1fQ.0HTaw4flBBHsHK2bJWh6sp2X4QOe-Ng7oRTrZaWOVrw'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:31:08.680 | General Service|:: CompanyIndex:103 SpName: spCom_GetCostCenterQuickViewDefn 
 200
 ,'20334'
 ,200
 ,1
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:31:08.695 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTAzLDEiLCJuYmYiOjE3NjMwMjgwNTUsImV4cCI6MTc2MzA1Njg1NSwiaWF0IjoxNzYzMDI4MDU1fQ.0HTaw4flBBHsHK2bJWh6sp2X4QOe-Ng7oRTrZaWOVrw'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:31:08.917 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=20334'
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:31:08.917 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTAzLDEiLCJuYmYiOjE3NjMwMjgwNTUsImV4cCI6MTc2MzA1Njg1NSwiaWF0IjoxNzYzMDI4MDU1fQ.0HTaw4flBBHsHK2bJWh6sp2X4QOe-Ng7oRTrZaWOVrw'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:31:09.011 | General Service|:: CompanyIndex:103 SpName: spRPT_GetReport 
 0
 ,20334
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:31:09.027 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTAzLDEiLCJuYmYiOjE3NjMwMjgwNTUsImV4cCI6MTc2MzA1Njg1NSwiaWF0IjoxNzYzMDI4MDU1fQ.0HTaw4flBBHsHK2bJWh6sp2X4QOe-Ng7oRTrZaWOVrw'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:31:09.183 | General Service|:: CompanyIndex:103 SpName: spRPT_GetReportCategoryandField 
 -1
 ,0
 ,1
 ,0
 ,'1'
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:31:09.183 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTAzLDEiLCJuYmYiOjE3NjMwMjgwNTUsImV4cCI6MTc2MzA1Njg1NSwiaWF0IjoxNzYzMDI4MDU1fQ.0HTaw4flBBHsHK2bJWh6sp2X4QOe-Ng7oRTrZaWOVrw'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:31:09.277 | General Service|:: CompanyIndex:103 SpName: spRPT_GetReportFields 
 40001
 ,0
 ,'1'
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:31:09.277 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTAzLDEiLCJuYmYiOjE3NjMwMjgwNTUsImV4cCI6MTc2MzA1Njg1NSwiaWF0IjoxNzYzMDI4MDU1fQ.0HTaw4flBBHsHK2bJWh6sp2X4QOe-Ng7oRTrZaWOVrw'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:31:09.371 | General Service|:: CompanyIndex:103 SpName: spDOC_GetVPTPrintCopies 
 4
 ,50
 ,20334
 ,2
 ,4
 ,'View~admin'
 ,'admin'
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:31:09.698 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTAzLDEiLCJuYmYiOjE3NjMwMjgwNTUsImV4cCI6MTc2MzA1Njg1NSwiaWF0IjoxNzYzMDI4MDU1fQ.0HTaw4flBBHsHK2bJWh6sp2X4QOe-Ng7oRTrZaWOVrw'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:31:09.761 | General Service|:: CompanyIndex:103 SpName: spRPT_GetReportFields 
 400
 ,0
 ,'1'
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:31:09.777 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTAzLDEiLCJuYmYiOjE3NjMwMjgwNTUsImV4cCI6MTc2MzA1Njg1NSwiaWF0IjoxNzYzMDI4MDU1fQ.0HTaw4flBBHsHK2bJWh6sp2X4QOe-Ng7oRTrZaWOVrw'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:31:09.808 | General Service|:: CompanyIndex:103 SpName: spRPT_GetReportFields 
 40001
 ,0
 ,'1'
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:31:09.808 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTAzLDEiLCJuYmYiOjE3NjMwMjgwNTUsImV4cCI6MTc2MzA1Njg1NSwiaWF0IjoxNzYzMDI4MDU1fQ.0HTaw4flBBHsHK2bJWh6sp2X4QOe-Ng7oRTrZaWOVrw'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:31:09.855 | General Service|:: CompanyIndex:103 SpName: spRPT_GetReportFields 
 2
 ,0
 ,'1'
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:31:09.855 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTAzLDEiLCJuYmYiOjE3NjMwMjgwNTUsImV4cCI6MTc2MzA1Njg1NSwiaWF0IjoxNzYzMDI4MDU1fQ.0HTaw4flBBHsHK2bJWh6sp2X4QOe-Ng7oRTrZaWOVrw'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:31:09.886 | General Service|:: CompanyIndex:103 SpName: spRPT_GetReportFields 
 110
 ,0
 ,'1'
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:31:09.902 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTAzLDEiLCJuYmYiOjE3NjMwMjgwNTUsImV4cCI6MTc2MzA1Njg1NSwiaWF0IjoxNzYzMDI4MDU1fQ.0HTaw4flBBHsHK2bJWh6sp2X4QOe-Ng7oRTrZaWOVrw'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:31:09.933 | General Service|:: CompanyIndex:103 SpName: spRPT_GetReportFields 
 50009
 ,0
 ,'1'
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:31:09.933 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTAzLDEiLCJuYmYiOjE3NjMwMjgwNTUsImV4cCI6MTc2MzA1Njg1NSwiaWF0IjoxNzYzMDI4MDU1fQ.0HTaw4flBBHsHK2bJWh6sp2X4QOe-Ng7oRTrZaWOVrw'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:31:09.964 | General Service|:: CompanyIndex:103 SpName: spADM_GetCostCenterGridViewList 
 2
 ,1
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:31:09.964 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTAzLDEiLCJuYmYiOjE3NjMwMjgwNTUsImV4cCI6MTc2MzA1Njg1NSwiaWF0IjoxNzYzMDI4MDU1fQ.0HTaw4flBBHsHK2bJWh6sp2X4QOe-Ng7oRTrZaWOVrw'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:31:10.670 | General Service|:: CompanyIndex:103 SpName: spCom_GetCostCenterSummary 
 126
 ,-1
 ,1000
 ,'#DEBITORCREDITORTEE#'
 ,''
 ,''
 ,0
 ,'13-Nov-2025'
 ,NULL
 ,''
 ,1
 ,1
 ,0
 ,0
 ,False
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:31:10.686 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTAzLDEiLCJuYmYiOjE3NjMwMjgwNTUsImV4cCI6MTc2MzA1Njg1NSwiaWF0IjoxNzYzMDI4MDU1fQ.0HTaw4flBBHsHK2bJWh6sp2X4QOe-Ng7oRTrZaWOVrw'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:31:10.733 | General Service|:: CompanyIndex:103 SpName: spADM_GetLocationRole 
 50002
 ,1
 message=Saved Succesfully
[System: 192.168.1.79] DEBUG | 11-13-2025 15:31:10.733 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTAzLDEiLCJuYmYiOjE3NjMwMjgwNTUsImV4cCI6MTc2MzA1Njg1NSwiaWF0IjoxNzYzMDI4MDU1fQ.0HTaw4flBBHsHK2bJWh6sp2X4QOe-Ng7oRTrZaWOVrw'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:31:10.748 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'SELECT CL.RESOURCEDATA Name FROM [ADM_Features] ADF WITH(NOLOCK),COM_LANGUAGERESOURCES CL WITH(NOLOCK) WHERE ADF.RESOURCEID=CL.RESOURCEID AND ADF.FeatureID=50002 AND CL.LanguageID=1'
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:31:10.764 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTAzLDEiLCJuYmYiOjE3NjMwMjgwNTUsImV4cCI6MTc2MzA1Njg1NSwiaWF0IjoxNzYzMDI4MDU1fQ.0HTaw4flBBHsHK2bJWh6sp2X4QOe-Ng7oRTrZaWOVrw'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:31:10.780 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'SELECT CurrencyID,Name,ExchangeRate FROM COM_Currency WITH(NOLOCK)'
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:31:10.780 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTAzLDEiLCJuYmYiOjE3NjMwMjgwNTUsImV4cCI6MTc2MzA1Njg1NSwiaWF0IjoxNzYzMDI4MDU1fQ.0HTaw4flBBHsHK2bJWh6sp2X4QOe-Ng7oRTrZaWOVrw'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:31:10.795 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'SELECT CurrencyID,Name,ExchangeRate FROM COM_Currency WITH(NOLOCK)'
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:31:10.795 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTAzLDEiLCJuYmYiOjE3NjMwMjgwNTUsImV4cCI6MTc2MzA1Njg1NSwiaWF0IjoxNzYzMDI4MDU1fQ.0HTaw4flBBHsHK2bJWh6sp2X4QOe-Ng7oRTrZaWOVrw'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:31:16.412 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'SELECT DefaultPreferences FROM ADM_RevenUReports with(nolock) WHERE ReportID=13'
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:31:16.412 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTAzLDEiLCJuYmYiOjE3NjMwMjgwNTUsImV4cCI6MTc2MzA1Njg1NSwiaWF0IjoxNzYzMDI4MDU1fQ.0HTaw4flBBHsHK2bJWh6sp2X4QOe-Ng7oRTrZaWOVrw'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:31:16.443 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'select CostCenterID from ADM_CostCenterDef with(nolock) where SysColumnName=''BillNo'' and IsVisible=1 and SysTableName=''ACC_DocDetails'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:31:16.443 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTAzLDEiLCJuYmYiOjE3NjMwMjgwNTUsImV4cCI6MTc2MzA1Njg1NSwiaWF0IjoxNzYzMDI4MDU1fQ.0HTaw4flBBHsHK2bJWh6sp2X4QOe-Ng7oRTrZaWOVrw'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:31:17.318 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'DECLARE @To FLOAT
SET @To=CONVERT(FLOAT,CONVERT(DATETIME,''13 Nov 2025''))
SELECT *,case when Amount>0 then 1 else 0 end AmtOrder FROM (	SELECT A.AccountID,B.DocSeqNo,A.AccountName AS AccountName,A.AccountID AS AccountName_ID,CONVERT(DATETIME,B.DocDate) DocDate,CONVERT(DATETIME,B.DocDueDate) DueDate,CONVERT(DATETIME,B.DocDate) VoucherDate,B.DocNo,AdjAmount+ISNULL((select sum(CB.AdjAmount) from COM_Billwise CB with(nolock) where CB.AccountID=B.AccountID AND CB.DocNo=B.DocNo and CB.IsNewReference=0 AND CB.DocSeqNo=B.DocSeqNo AND CB.RefDocDate>@To),0) Amount,AdjAmount BillAmount,case when B.DocType=16 then (SELECT TOP 1 BillNo FROM ACC_DocDetails WITH(NOLOCK) WHERE B.DocNo=VoucherNo and B.DocSeqNo=DocSeqNo) else (SELECT TOP 1 BillNo FROM INV_DocDetails WITH(NOLOCK) WHERE B.DocNo=VoucherNo) end BillNo,case when B.DocType=16 then (SELECT TOP 1 CONVERT(DATETIME, BillDate) FROM ACC_DocDetails WITH(NOLOCK) WHERE B.DocNo=VoucherNo and B.DocSeqNo=DocSeqNo) else (SELECT TOP 1 CONVERT(DATETIME, BillDate) FROM INV_DocDetails WITH(NOLOCK) WHERE B.DocNo=VoucherNo) end BillDate,C50002.Name AS Location,    
(SELECT SUM(AdjAmount) Adjusted FROM COM_Billwise CB WITH(NOLOCK) WHERE IsNewReference=0 AND CB.DocDate<=@To AND CB.AccountID=B.AccountID AND CB.RefDocNo=B.DocNo AND  CB.DocType<>14 AND CB.DocType<>19 AND (SELECT top(1) 1 FROM ACC_DocDetails ACC WITH(NOLOCK) WHERE ACC.VoucherNo=CB.DocNo and (StatusID=369 or StatusID=429))=1 AND CB.RefDocSeqNo=B.DocSeqNo) Adjusted,CASE WHEN DType.IsInventory=0 THEN
  (SELECT MAX(DOC.CommonNarration) FROM Acc_DocDetails DOC WITH(NOLOCK) WHERE DOC.VoucherNo=B.DocNo and Doc.DocSeqNo=B.DocSeqNo)
  ELSE
  (SELECT MAX(DOC.CommonNarration) FROM INV_DocDetails DOC WITH(NOLOCK) WHERE DOC.VoucherNo=B.DocNo)  END AS C337e1c8baa3b4ac0b3a2682d9d88fc63,CASE WHEN DType.IsInventory=0 THEN NULL ELSE
(STUFF((SELECT distinct '',''+VoucherNo FROM INV_DocDetails with(nolock) WHERE InvDocDetailsID IN 
(select LinkedInvDocDetailsID from INV_DocDetails with(nolock) WHERE VoucherNo=B.DocNo and LinkedInvDocDetailsID>0) FOR XML PATH('''')),1,1,'''')) END AS Cdf3533811555463c963af67849b1c17e,T1.Code Cd6882cec5b8a44fcb0c1be3976f3c29a,T1.Name C02934645c08a4ed3a3dfbd5a980f1761,T2.Name Cda273e47f52943fcae5bf08cc75c5512,CASE WHEN DType.IsInventory=0 THEN
  (SELECT MAX(convert(datetime,DOC.DueDate)) FROM Acc_DocDetails DOC WITH(NOLOCK) WHERE DOC.VoucherNo=B.DocNo and Doc.DocSeqNo=B.DocSeqNo)
  ELSE
  (SELECT MAX(convert(datetime,DOC.DueDate)) FROM INV_DocDetails DOC WITH(NOLOCK) WHERE DOC.VoucherNo=B.DocNo)  END AS C9256e42b51c94b18b0cfb15615481c0d,(B.DocDueDate-B.DocDate) CreditDays
,@To-B.DocDate OverDue
,B.DocType,(SELECT TOP 1 ACC.StatusID FROM ACC_DocDetails ACC with(nolock) WHERE ACC.VoucherNo=B.DocNo) StatusID 
FROM COM_Billwise B with(nolock) INNER JOIN ACC_Accounts A WITH(NOLOCK) ON B.AccountID=A.AccountID     
INNER JOIN COM_Location AS C50002 with(nolock) ON B.dcCCNID2 = C50002.NodeID  INNER JOIN (SELECT DocumentType DocType1,IsInventory FROM ADM_DocumentTypes with(nolock) Group By DocumentType,IsInventory) AS DType ON  DType.DocType1=B.DocType  INNER JOIN COM_CC50009 AS T1 with(nolock) ON T1.NodeID=B.dcCCNID9 INNER JOIN COM_Salesman AS T2 with(nolock) ON T2.NodeID=B.dcCCNID5,(select T.AccountID GTID from ACC_Accounts T with(nolock),ACC_Accounts GT1 with(nolock) where T.lft BETWEEN GT1.lft AND GT1.rgt AND GT1.AccountID=13055 group by T.AccountID) AS GTP  WHERE B.IsNewReference=1 AND B.DocDate<=@To AND A.AccountID=GTP.GTID AND A.AccountTypeID IN (6,7) ) AS T  WHERE (Adjusted IS NULL OR abs(Amount+Adjusted)>0.099) AND DocType<>14 AND DocType<>19 and (StatusID=369 or StatusID=429)
 UNION ALL  SELECT *,case when Amount>0 then 1 else 0 end AmtOrder FROM (	SELECT A.AccountID,B.DocSeqNo,A.AccountName AS AccountName,A.AccountID AS AccountName_ID,CONVERT(DATETIME,B.DocDate) DocDate,CONVERT(DATETIME,B.DocDueDate) DueDate,CONVERT(DATETIME,B.DocDate) VoucherDate,B.DocNo,B.AdjAmount Amount,B.AdjAmount BillAmount,case when B.DocType=16 then (SELECT TOP 1 BillNo FROM ACC_DocDetails WITH(NOLOCK) WHERE B.DocNo=VoucherNo and B.DocSeqNo=DocSeqNo) else (SELECT TOP 1 BillNo FROM INV_DocDetails WITH(NOLOCK) WHERE B.DocNo=VoucherNo) end BillNo,case when B.DocType=16 then (SELECT TOP 1 CONVERT(DATETIME, BillDate) FROM ACC_DocDetails WITH(NOLOCK) WHERE B.DocNo=VoucherNo and B.DocSeqNo=DocSeqNo) else (SELECT TOP 1 CONVERT(DATETIME, BillDate) FROM INV_DocDetails WITH(NOLOCK) WHERE B.DocNo=VoucherNo) end BillDate,C50002.Name AS Location,    
(SELECT SUM(CB.AdjAmount) Adjusted FROM COM_Billwise CB WITH(NOLOCK) WHERE IsNewReference=0 AND CB.DocDate<=@To AND CB.AccountID=B.AccountID AND CB.RefDocNo=B.DocNo AND  CB.DocType<>14 AND CB.DocType<>19 AND (SELECT top(1) 1 FROM ACC_DocDetails ACC WITH(NOLOCK) WHERE ACC.VoucherNo=CB.DocNo and (StatusID=369 or StatusID=429))=1 AND CB.RefDocSeqNo=B.DocSeqNo) Adjusted,CASE WHEN DType.IsInventory=0 THEN
  (SELECT MAX(DOC.CommonNarration) FROM Acc_DocDetails DOC WITH(NOLOCK) WHERE DOC.VoucherNo=B.DocNo and Doc.DocSeqNo=B.DocSeqNo)
  ELSE
  (SELECT MAX(DOC.CommonNarration) FROM INV_DocDetails DOC WITH(NOLOCK) WHERE DOC.VoucherNo=B.DocNo)  END AS C337e1c8baa3b4ac0b3a2682d9d88fc63,CASE WHEN DType.IsInventory=0 THEN NULL ELSE
(STUFF((SELECT distinct '',''+VoucherNo FROM INV_DocDetails with(nolock) WHERE InvDocDetailsID IN 
(select LinkedInvDocDetailsID from INV_DocDetails with(nolock) WHERE VoucherNo=B.DocNo and LinkedInvDocDetailsID>0) FOR XML PATH('''')),1,1,'''')) END AS Cdf3533811555463c963af67849b1c17e,T1.Code Cd6882cec5b8a44fcb0c1be3976f3c29a,T1.Name C02934645c08a4ed3a3dfbd5a980f1761,T2.Name Cda273e47f52943fcae5bf08cc75c5512,CASE WHEN DType.IsInventory=0 THEN
  (SELECT MAX(convert(datetime,DOC.DueDate)) FROM Acc_DocDetails DOC WITH(NOLOCK) WHERE DOC.VoucherNo=B.DocNo and Doc.DocSeqNo=B.DocSeqNo)
  ELSE
  (SELECT MAX(convert(datetime,DOC.DueDate)) FROM INV_DocDetails DOC WITH(NOLOCK) WHERE DOC.VoucherNo=B.DocNo)  END AS C9256e42b51c94b18b0cfb15615481c0d,(B.DocDueDate-B.DocDate) CreditDays
 ,@To-B.DocDate OverDue
 ,B.DocType,(SELECT TOP 1 ACC.StatusID FROM ACC_DocDetails ACC with(nolock) WHERE ACC.VoucherNo=B.DocNo) StatusID 
 FROM COM_Billwise B with(nolock) INNER JOIN ACC_Accounts A WITH(NOLOCK) ON B.AccountID=A.AccountID     
 INNER JOIN COM_Location AS C50002 with(nolock) ON B.dcCCNID2 = C50002.NodeID  INNER JOIN (SELECT DocumentType DocType1,IsInventory FROM ADM_DocumentTypes with(nolock) Group By DocumentType,IsInventory) AS DType ON  DType.DocType1=B.DocType  INNER JOIN COM_CC50009 AS T1 with(nolock) ON T1.NodeID=B.dcCCNID9 INNER JOIN COM_Salesman AS T2 with(nolock) ON T2.NodeID=B.dcCCNID5 
 LEFT JOIN COM_Billwise BCB with(nolock) ON BCB.AccountID=B.AccountID AND BCB.DocNo=B.DocNo and BCB.IsNewReference=1 AND BCB.DocSeqNo=B.DocSeqNo ,(select T.AccountID GTID from ACC_Accounts T with(nolock),ACC_Accounts GT1 with(nolock) where T.lft BETWEEN GT1.lft AND GT1.rgt AND GT1.AccountID=13055 group by T.AccountID) AS GTP  WHERE B.IsNewReference=0 AND B.DocDate<=@To AND B.RefDocDate>@To AND BCB.AccountID is null AND A.AccountID=GTP.GTID AND A.AccountTypeID IN (6,7) ) AS T  WHERE (Adjusted IS NULL OR abs(Amount+Adjusted)>0.099) AND DocType<>14 AND DocType<>19 and (StatusID=369 or StatusID=429) ORDER BY AccountName,DocDate,AmtOrder,DocNo'
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:31:17.318 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTAzLDEiLCJuYmYiOjE3NjMwMjgwNTUsImV4cCI6MTc2MzA1Njg1NSwiaWF0IjoxNzYzMDI4MDU1fQ.0HTaw4flBBHsHK2bJWh6sp2X4QOe-Ng7oRTrZaWOVrw'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:31:17.490 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'select CostCenterID from ADM_CostCenterDef with(nolock) where SysColumnName=''BillNo'' and IsVisible=1 and SysTableName=''ACC_DocDetails'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:31:17.490 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTAzLDEiLCJuYmYiOjE3NjMwMjgwNTUsImV4cCI6MTc2MzA1Njg1NSwiaWF0IjoxNzYzMDI4MDU1fQ.0HTaw4flBBHsHK2bJWh6sp2X4QOe-Ng7oRTrZaWOVrw'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:31:17.739 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'DECLARE @AccountingDate FLOAT,@AsOnDate FLOAT
SET @AccountingDate=CONVERT(FLOAT,CONVERT(DATETIME,''04 Jun 2015'')) SET @AsOnDate=CONVERT(FLOAT,CONVERT(DATETIME,''13 Nov 2025''))SELECT A.AccountID,A.AccountName FROM ACC_Accounts A with(nolock),(select T.AccountID GTID from ACC_Accounts T with(nolock),ACC_Accounts GT1 with(nolock) where T.lft BETWEEN GT1.lft AND GT1.rgt AND GT1.AccountID=13055 group by T.AccountID) AS GTP  WHERE A.Depth>0 AND A.AccountID=GTP.GTID AND A.AccountTypeID IN (6,7) ORDER BY A.AccountName SELECT * from ( SELECT CONVERT(DATETIME,B.DocDate) DocDate,B.AccountID,B.AdjAmount+ISNULL((SELECT SUM(CB.AdjAmount) FROM COM_Billwise CB with(nolock) WHERE CB.RefDocNo=B.DocNo AND CB.AccountID=B.AccountID AND CB.RefDocSeqNo=B.DocSeqNo AND CB.IsNewReference=0 AND CB.DocDate<=@AsOnDate AND  DocType<>14 AND DocType<>19 AND (SELECT top(1) 1 FROM ACC_DocDetails ACC WITH(NOLOCK) WHERE ACC.VoucherNo=CB.DocNo and (StatusID=369 or StatusID=429))=1),0) AdjAmount FROM COM_Billwise B WITH(NOLOCK) INNER JOIN ACC_Accounts A ON A.AccountID=B.AccountID AND A.AccountTypeID IN (6,7),(select T.AccountID GTID from ACC_Accounts T with(nolock),ACC_Accounts GT1 with(nolock) where T.lft BETWEEN GT1.lft AND GT1.rgt AND GT1.AccountID=13055 group by T.AccountID) AS GTP  WHERE B.IsNewReference=1 AND B.DocDate<=@AsOnDate AND DocType<>14 AND DocType<>19 AND (SELECT top(1) 1 FROM ACC_DocDetails ACC WITH(NOLOCK) WHERE ACC.VoucherNo=B.DocNo and (StatusID=369 or StatusID=429))=1 AND B.AccountID=GTP.GTID ) AS T WHERE abs(AdjAmount)>0.099'
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:31:17.739 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTAzLDEiLCJuYmYiOjE3NjMwMjgwNTUsImV4cCI6MTc2MzA1Njg1NSwiaWF0IjoxNzYzMDI4MDU1fQ.0HTaw4flBBHsHK2bJWh6sp2X4QOe-Ng7oRTrZaWOVrw'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:31:17.786 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'select CostCenterID from ADM_CostCenterDef with(nolock) where SysColumnName=''BillNo'' and IsVisible=1 and SysTableName=''ACC_DocDetails'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:31:17.786 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTAzLDEiLCJuYmYiOjE3NjMwMjgwNTUsImV4cCI6MTc2MzA1Njg1NSwiaWF0IjoxNzYzMDI4MDU1fQ.0HTaw4flBBHsHK2bJWh6sp2X4QOe-Ng7oRTrZaWOVrw'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:31:17.802 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'DECLARE @AccountingDate FLOAT,@AsOnDate FLOAT
SET @AccountingDate=CONVERT(FLOAT,CONVERT(DATETIME,''04 Jun 2015'')) SET @AsOnDate=CONVERT(FLOAT,CONVERT(DATETIME,''13 Nov 2025''))SELECT A.AccountID,A.AccountName FROM ACC_Accounts A with(nolock),(select T.AccountID GTID from ACC_Accounts T with(nolock),ACC_Accounts GT1 with(nolock) where T.lft BETWEEN GT1.lft AND GT1.rgt AND GT1.AccountID= group by T.AccountID) AS GTP  WHERE A.Depth>0 AND A.AccountID=GTP.GTID AND A.AccountTypeID IN (6,7) ORDER BY A.AccountName SELECT * from ( SELECT CONVERT(DATETIME,B.DocDate) DocDate,B.AccountID,B.AdjAmount+ISNULL((SELECT SUM(CB.AdjAmount) FROM COM_Billwise CB with(nolock) WHERE CB.RefDocNo=B.DocNo AND CB.AccountID=B.AccountID AND CB.RefDocSeqNo=B.DocSeqNo AND CB.IsNewReference=0 AND CB.DocDate<=@AsOnDate AND  DocType<>14 AND DocType<>19 AND (SELECT top(1) 1 FROM ACC_DocDetails ACC WITH(NOLOCK) WHERE ACC.VoucherNo=CB.DocNo and (StatusID=369 or StatusID=429))=1),0) AdjAmount FROM COM_Billwise B WITH(NOLOCK) INNER JOIN ACC_Accounts A ON A.AccountID=B.AccountID AND A.AccountTypeID IN (6,7),(select T.AccountID GTID from ACC_Accounts T with(nolock),ACC_Accounts GT1 with(nolock) where T.lft BETWEEN GT1.lft AND GT1.rgt AND GT1.AccountID= group by T.AccountID) AS GTP  WHERE B.IsNewReference=1 AND B.DocDate<=@AsOnDate AND DocType<>14 AND DocType<>19 AND (SELECT top(1) 1 FROM ACC_DocDetails ACC WITH(NOLOCK) WHERE ACC.VoucherNo=B.DocNo and (StatusID=369 or StatusID=429))=1 AND B.AccountID=GTP.GTID ) AS T WHERE abs(AdjAmount)>0.099'
 ,1
 ,1
 message=Incorrect syntax near the keyword 'group'.
[System: 192.168.1.79] DEBUG | 11-13-2025 15:31:17.802 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'DECLARE @AccountingDate FLOAT,@AsOnDate FLOAT
SET @AccountingDate=CONVERT(FLOAT,CONVERT(DATETIME,''04 Jun 2015'')) SET @AsOnDate=CONVERT(FLOAT,CONVERT(DATETIME,''13 Nov 2025''))SELECT A.AccountID,A.AccountName FROM ACC_Accounts A with(nolock),(select T.AccountID GTID from ACC_Accounts T with(nolock),ACC_Accounts GT1 with(nolock) where T.lft BETWEEN GT1.lft AND GT1.rgt AND GT1.AccountID= group by T.AccountID) AS GTP  WHERE A.Depth>0 AND A.AccountID=GTP.GTID AND A.AccountTypeID IN (6,7) ORDER BY A.AccountName SELECT * from ( SELECT CONVERT(DATETIME,B.DocDate) DocDate,B.AccountID,B.AdjAmount+ISNULL((SELECT SUM(CB.AdjAmount) FROM COM_Billwise CB with(nolock) WHERE CB.RefDocNo=B.DocNo AND CB.AccountID=B.AccountID AND CB.RefDocSeqNo=B.DocSeqNo AND CB.IsNewReference=0 AND CB.DocDate<=@AsOnDate AND  DocType<>14 AND DocType<>19 AND (SELECT top(1) 1 FROM ACC_DocDetails ACC WITH(NOLOCK) WHERE ACC.VoucherNo=CB.DocNo and (StatusID=369 or StatusID=429))=1),0) AdjAmount FROM COM_Billwise B WITH(NOLOCK) INNER JOIN ACC_Accounts A ON A.AccountID=B.AccountID AND A.AccountTypeID IN (6,7),(select T.AccountID GTID from ACC_Accounts T with(nolock),ACC_Accounts GT1 with(nolock) where T.lft BETWEEN GT1.lft AND GT1.rgt AND GT1.AccountID= group by T.AccountID) AS GTP  WHERE B.IsNewReference=1 AND B.DocDate<=@AsOnDate AND DocType<>14 AND DocType<>19 AND (SELECT top(1) 1 FROM ACC_DocDetails ACC WITH(NOLOCK) WHERE ACC.VoucherNo=B.DocNo and (StatusID=369 or StatusID=429))=1 AND B.AccountID=GTP.GTID ) AS T WHERE abs(AdjAmount)>0.099'
 ,1
 ,1
 message=Problem in processing your request, Please contact administrator.
[System: 192.168.1.79] INFO | 11-13-2025 15:31:17.802 | OnStartup: Logger Instance Created Successfully
[System: 192.168.1.79] INFO | 11-13-2025 15:31:17.802 | OnStartup: Application Starting...
[System: 192.168.1.79] ERROR | 11-13-2025 15:31:17.802 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSetParameters :
 'DECLARE @AccountingDate FLOAT,@AsOnDate FLOAT
SET @AccountingDate=CONVERT(FLOAT,CONVERT(DATETIME,''04 Jun 2015'')) SET @AsOnDate=CONVERT(FLOAT,CONVERT(DATETIME,''13 Nov 2025''))SELECT A.AccountID,A.AccountName FROM ACC_Accounts A with(nolock),(select T.AccountID GTID from ACC_Accounts T with(nolock),ACC_Accounts GT1 with(nolock) where T.lft BETWEEN GT1.lft AND GT1.rgt AND GT1.AccountID= group by T.AccountID) AS GTP  WHERE A.Depth>0 AND A.AccountID=GTP.GTID AND A.AccountTypeID IN (6,7) ORDER BY A.AccountName SELECT * from ( SELECT CONVERT(DATETIME,B.DocDate) DocDate,B.AccountID,B.AdjAmount+ISNULL((SELECT SUM(CB.AdjAmount) FROM COM_Billwise CB with(nolock) WHERE CB.RefDocNo=B.DocNo AND CB.AccountID=B.AccountID AND CB.RefDocSeqNo=B.DocSeqNo AND CB.IsNewReference=0 AND CB.DocDate<=@AsOnDate AND  DocType<>14 AND DocType<>19 AND (SELECT top(1) 1 FROM ACC_DocDetails ACC WITH(NOLOCK) WHERE ACC.VoucherNo=CB.DocNo and (StatusID=369 or StatusID=429))=1),0) AdjAmount FROM COM_Billwise B WITH(NOLOCK) INNER JOIN ACC_Accounts A ON A.AccountID=B.AccountID AND A.AccountTypeID IN (6,7),(select T.AccountID GTID from ACC_Accounts T with(nolock),ACC_Accounts GT1 with(nolock) where T.lft BETWEEN GT1.lft AND GT1.rgt AND GT1.AccountID= group by T.AccountID) AS GTP  WHERE B.IsNewReference=1 AND B.DocDate<=@AsOnDate AND DocType<>14 AND DocType<>19 AND (SELECT top(1) 1 FROM ACC_DocDetails ACC WITH(NOLOCK) WHERE ACC.VoucherNo=B.DocNo and (StatusID=369 or StatusID=429))=1 AND B.AccountID=GTP.GTID ) AS T WHERE abs(AdjAmount)>0.099'
 ,1
 ,1|Incorrect syntax near the keyword 'group'.
[System: 192.168.1.79] DEBUG | 11-13-2025 15:31:17.802 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTAzLDEiLCJuYmYiOjE3NjMwMjgwNTUsImV4cCI6MTc2MzA1Njg1NSwiaWF0IjoxNzYzMDI4MDU1fQ.0HTaw4flBBHsHK2bJWh6sp2X4QOe-Ng7oRTrZaWOVrw'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 11-13-2025 15:31:21.826 | General Service|:: CompanyIndex:0 SpName: spADM_GetClientUserDetails2C 
 'admin'
 ,1
 ,0
[System: 192.168.1.73] DEBUG | 11-13-2025 15:31:21.904 | General Service|:: CompanyIndex:0 SpName: spADM_UserLoginCheck 
 2
 ,'admin'
 ,0
 ,'192.168.1.73'
 ,'192.168.1.73'
 ,''
 ,'Web'
 ,1
[System: 192.168.1.73] DEBUG | 11-13-2025 15:31:25.095 | General Service|:: CompanyIndex:53 SpName: spADM_GetClientUserDetails 
 'admin'
 ,1
 ,'26.8.6'
 ,0
[System: 192.168.1.73] DEBUG | 11-13-2025 15:31:25.173 | General Service|:: CompanyIndex:0 SpName: spADM_UserLoginCheck 
 2
 ,'admin'
 ,53
 ,'192.168.1.73'
 ,'192.168.1.73'
 ,''
 ,'Web'
 ,1
[System: 192.168.1.73] DEBUG | 11-13-2025 15:31:25.173 | General Service|:: CompanyIndex:0 SpName: spADM_Login 
 1
 ,''
 ,''
 ,''
 ,''
 ,''
 ,53
[System: 192.168.1.73] DEBUG | 11-13-2025 15:31:25.188 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select Value from ADM_GlobalPreferences with (nolock) where name =''EnableReLogin'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 11-13-2025 15:31:25.188 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODA4NSwiZXhwIjoxNzYzMDU2ODg1LCJpYXQiOjE3NjMwMjgwODV9.eRlSN9oidYho75qh1pF4jTpIB4tw3U5pKBPBFSOfZsw'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 11-13-2025 15:31:25.220 | General Service|:: CompanyIndex:0 SpName: spADM_Login 
 4
 ,''
 ,''
 ,''
 ,'declare @Cnt int,@ExpiredGUID nvarchar(50),@AllowSession int,@GUID nvarchar(50),@CurrDate float,@UserID INT,@Instances INT,@InstancesExists INT,@LCDBIndex int
set @CurrDate= convert(float,dateadd(minute,-21,getdate()))
set @AllowSession=0
set @GUID=''d4029f57-5c55-4753-9a28-35c1bffc2b4e''
set @LCDBIndex=0
select top 1 @UserID=UserID,@Instances=InstanceCount from ADM_Users with(nolock) where UserName=''admin''
if exists(select [GUID] from ADM_Login with(nolock) where [GUID]=@GUID)
begin
	update ADM_Login 
	set LastAccessTime=convert(float,getdate()),UserID=@UserID
	where [GUID]=@GUID
    set @AllowSession=1
end
else
begin
	select @Cnt=count(*) from ADM_Login with(nolock) where LCDBIndex=@LCDBIndex and [GUID]!=''ACCESSRIGHTS'' and AP =''WEB''
    if(@Cnt<100)
		set @AllowSession=1
	else
	begin
		select top 1 @ExpiredGUID=[GUID] from ADM_Login with(nolock)
		where [GUID]!=''ACCESSRIGHTS'' and LCDBIndex=@LCDBIndex and LastAccessTime<@CurrDate  and AP =''WEB''
        order by LastAccessTime asc
		if @ExpiredGUID is not null
		begin
			delete from ADM_Login where [GUID]=@ExpiredGUID
			set @AllowSession=1
		end
	end
	if @AllowSession=1
	begin
        select @InstancesExists=COUNT(*) from ADM_Login with(nolock)
		where [GUID]!=''ACCESSRIGHTS'' and LCDBIndex=@LCDBIndex and LastAccessTime>=@CurrDate and UserID=@UserID and AP =''WEB''
		if(@Instances!=0 and @Instances<=@InstancesExists)
			set @AllowSession=2
		else
		    INSERT INTO ADM_Login([GUID],[SysName],IPAddress,[Status],LoginTime,LastAccessTime,AccessRights,UserID,DBIndex,LCDBIndex,AP)
		    VALUES(@GUID,''WEB'',''192.168.1.73'',1,convert(float,getdate()),convert(float,getdate()),null,@UserID,53,@LCDBIndex, ''WEB'')
	end
end

select @AllowSession AllowSession,@Instances Instances,@InstancesExists InstancesExists
'
 ,''
 ,0
[System: 192.168.1.73] DEBUG | 11-13-2025 15:31:25.220 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODA4NSwiZXhwIjoxNzYzMDU2ODg1LCJpYXQiOjE3NjMwMjgwODV9.eRlSN9oidYho75qh1pF4jTpIB4tw3U5pKBPBFSOfZsw'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 11-13-2025 15:31:25.251 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT (SELECT COUNT(*) FROM COM_Location L WITH(NOLOCK) JOIN COM_Status S WITH(NOLOCK) ON S.StatusID=L.StatusID WHERE L.IsGroup=0 AND S.[Status]=''Active'') ML
,(SELECT COUNT(*) FROM ADM_Features WITH(NOLOCK) WHERE ((FeatureID>50000 AND FeatureID<=50050) OR FeatureID>=51000) AND IsEnabled=1) MD
,(SELECT ISNULL(COUNT(*),0) FROM ADM_RevenUReports WITH(NOLOCK) WHERE IsGroup=0 AND ReportID>10000 AND StaticReportType IN (0,-1)) MR'
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 11-13-2025 15:31:25.251 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODA4NSwiZXhwIjoxNzYzMDU2ODg1LCJpYXQiOjE3NjMwMjgwODV9.eRlSN9oidYho75qh1pF4jTpIB4tw3U5pKBPBFSOfZsw'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 11-13-2025 15:31:25.266 | General Service|:: CompanyIndex:53 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.73] DEBUG | 11-13-2025 15:31:25.266 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODA4NSwiZXhwIjoxNzYzMDU2ODg1LCJpYXQiOjE3NjMwMjgwODV9.eRlSN9oidYho75qh1pF4jTpIB4tw3U5pKBPBFSOfZsw'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 11-13-2025 15:31:25.485 | General Service|:: CompanyIndex:53 SpName: spADM_GetRibbonView 
 1
 ,1
 ,1
 ,1
 ,0
 ,''
[System: 192.168.1.73] DEBUG | 11-13-2025 15:31:25.485 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODA4NSwiZXhwIjoxNzYzMDU2ODg1LCJpYXQiOjE3NjMwMjgwODV9.eRlSN9oidYho75qh1pF4jTpIB4tw3U5pKBPBFSOfZsw'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 11-13-2025 15:31:25.719 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 2
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.73] DEBUG | 11-13-2025 15:31:25.719 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODA4NSwiZXhwIjoxNzYzMDU2ODg1LCJpYXQiOjE3NjMwMjgwODV9.eRlSN9oidYho75qh1pF4jTpIB4tw3U5pKBPBFSOfZsw'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 11-13-2025 15:31:25.735 | General Service|:: CompanyIndex:53 SpName: spADM_GetDashBoard 
 2
 ,0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.73] DEBUG | 11-13-2025 15:31:25.735 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODA4NSwiZXhwIjoxNzYzMDU2ODg1LCJpYXQiOjE3NjMwMjgwODV9.eRlSN9oidYho75qh1pF4jTpIB4tw3U5pKBPBFSOfZsw'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 11-13-2025 15:31:25.766 | General Service|:: CompanyIndex:53 SpName: spCOM_ConfigValues 
 1
 ,'LandingDocs'
 ,'1'
[System: 192.168.1.73] DEBUG | 11-13-2025 15:31:25.766 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODA4NSwiZXhwIjoxNzYzMDU2ODg1LCJpYXQiOjE3NjMwMjgwODV9.eRlSN9oidYho75qh1pF4jTpIB4tw3U5pKBPBFSOfZsw'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 11-13-2025 15:31:25.813 | General Service|:: CompanyIndex:53 SpName: spCOM_GetFavorites 
 'GETLIST0'
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.73] DEBUG | 11-13-2025 15:31:25.813 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODA4NSwiZXhwIjoxNzYzMDU2ODg1LCJpYXQiOjE3NjMwMjgwODV9.eRlSN9oidYho75qh1pF4jTpIB4tw3U5pKBPBFSOfZsw'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 11-13-2025 15:31:25.829 | General Service|:: CompanyIndex:53 SpName: spADM_GetAllListViewsDef 
 1
 ,1
[System: 192.168.1.73] DEBUG | 11-13-2025 15:31:25.829 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODA4NSwiZXhwIjoxNzYzMDU2ODg1LCJpYXQiOjE3NjMwMjgwODV9.eRlSN9oidYho75qh1pF4jTpIB4tw3U5pKBPBFSOfZsw'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 11-13-2025 15:31:25.938 | General Service|:: CompanyIndex:53 SpName: spADM_GetAllListViewsDef 
 1
 ,1
[System: 192.168.1.73] DEBUG | 11-13-2025 15:31:25.938 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODA4NSwiZXhwIjoxNzYzMDU2ODg1LCJpYXQiOjE3NjMwMjgwODV9.eRlSN9oidYho75qh1pF4jTpIB4tw3U5pKBPBFSOfZsw'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 11-13-2025 15:31:26.047 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'Select CostCenterID,CostCenterColID,CostCenterName,SysTableName,UserColumnName,SysColumnName,ISNULL(UserDefaultValue,'''') UserDefaultValue
From AdM_CostCenterDef WITH(NOLOCK)
Where SysColumnName IN(''CreditAccount'',''DebitAccount'',''ProductID'') 
AND CostCenterID>40000 AND CostCenterID<50000 

SELECT * FROM ADM_Features WITH(NOLOCK) '
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 11-13-2025 15:31:26.063 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODA4NSwiZXhwIjoxNzYzMDU2ODg1LCJpYXQiOjE3NjMwMjgwODV9.eRlSN9oidYho75qh1pF4jTpIB4tw3U5pKBPBFSOfZsw'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 11-13-2025 15:31:26.094 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 '  SELECT * FROM PAY_PayrollPreferences WITH(NOLOCK) '
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 11-13-2025 15:31:26.094 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODA4NSwiZXhwIjoxNzYzMDU2ODg1LCJpYXQiOjE3NjMwMjgwODV9.eRlSN9oidYho75qh1pF4jTpIB4tw3U5pKBPBFSOfZsw'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 11-13-2025 15:31:26.172 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 '  --0
                                Select * FROM COM_CC50051 WITH(NOLOCK) WHERE IsGroup=0 AND LoginUserID=''admin''
                                --1                                
                                Select * FROM COM_CC50051 WITH(NOLOCK) WHERE RptManager IN (Select NodeID FROM COM_CC50051 WITH(NOLOCK) WHERE IsGroup=0 AND LoginUserID=''admin'')
                                UNION ALL
                                Select * FROM COM_CC50051 WITH(NOLOCK) WHERE RptManager IN 
                                (
	                                Select NodeID FROM COM_CC50051 WITH(NOLOCK) 
	                                WHERE IsGroup=0 AND LoginUserID IN
	                                (
	                                SELECT fe.LoginUserID
	                                FROM INV_DocDetails a WITH(NOLOCK) 
	                                JOIN COM_DocCCData b WITH(NOLOCK) ON b.InvDocDetailsID=a.InvDocDetailsID
	                                JOIN COM_DocNumData c WITH(NOLOCK) ON c.InvDocDetailsID=a.InvDocDetailsID
	                                JOIN COM_DocTextData d WITH(NOLOCK) ON d.InvDocDetailsID=a.InvDocDetailsID
	                                JOIN COM_CC50051 fe WITH(NOLOCK) on fe.NodeID=b.dcCCNID51
	                                JOIN COM_CC50051 te WITH(NOLOCK) on CONVERT(NVARCHAR,te.NodeID)=d.dcAlpha1
	                                WHERE a.CostCenterID=40098 and a.StatusID=369 AND d.dcAlpha3=''Temporary''
	                                AND te.LoginUserID=''admin'' 
	                                AND ISDATE(d.dcAlpha4)=1 AND ISDATE(d.dcAlpha5)=1 
	                                AND CONVERT(DATETIME,''13 Nov 2025'') BETWEEN CONVERT(DATETIME,d.dcAlpha4) AND CONVERT(DATETIME,d.dcAlpha5)
	                                )
                                )
                                --2
                                Select * FROM ADM_USERS WITH(NOLOCK) WHERE USERID=1
                                --3
                                Select * FROM COM_CostCenterCostCenterMap WITH(NOLOCK) WHERE ParentCostCenterID=7 AND ParentNodeID=1
                                --4                                
                                Select * FROM COM_CostCenterCostCenterMap WITH(NOLOCK) WHERE ParentCostCenterID=7 AND ParentNodeID=1
                                AND CostCenterID IN(Select ColumnCostCenterID From ADM_CostCenterDef Where CostCenterID=50051 AND IsColumnInUse=1 AND SysColumnName LIKE ''CCNID%'')
                                --5
                                Select * from COM_Files WITH(NOLOCK) WHERE FeatureID=50051 AND FeaturePK IN (Select NodeID FROM COM_CC50051 WITH(NOLOCK) WHERE IsGroup=0 AND LoginUserID=''admin'')                         
'
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 11-13-2025 15:31:26.344 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODA4NSwiZXhwIjoxNzYzMDU2ODg1LCJpYXQiOjE3NjMwMjgwODV9.eRlSN9oidYho75qh1pF4jTpIB4tw3U5pKBPBFSOfZsw'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 11-13-2025 15:31:26.548 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 11-13-2025 15:31:26.548 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODA4NSwiZXhwIjoxNzYzMDU2ODg1LCJpYXQiOjE3NjMwMjgwODV9.eRlSN9oidYho75qh1pF4jTpIB4tw3U5pKBPBFSOfZsw'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 11-13-2025 15:31:26.829 | General Service|:: CompanyIndex:53 SpName: spADM_GetDashBoard 
 1
 ,41
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.73] DEBUG | 11-13-2025 15:31:26.844 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODA4NSwiZXhwIjoxNzYzMDU2ODg1LCJpYXQiOjE3NjMwMjgwODV9.eRlSN9oidYho75qh1pF4jTpIB4tw3U5pKBPBFSOfZsw'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 11-13-2025 15:31:26.860 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,60583
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.73] DEBUG | 11-13-2025 15:31:26.860 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,60587
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.73] DEBUG | 11-13-2025 15:31:26.860 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,60588
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.73] DEBUG | 11-13-2025 15:31:26.860 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODA4NSwiZXhwIjoxNzYzMDU2ODg1LCJpYXQiOjE3NjMwMjgwODV9.eRlSN9oidYho75qh1pF4jTpIB4tw3U5pKBPBFSOfZsw'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 11-13-2025 15:31:26.860 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODA4NSwiZXhwIjoxNzYzMDU2ODg1LCJpYXQiOjE3NjMwMjgwODV9.eRlSN9oidYho75qh1pF4jTpIB4tw3U5pKBPBFSOfZsw'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 11-13-2025 15:31:26.860 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODA4NSwiZXhwIjoxNzYzMDU2ODg1LCJpYXQiOjE3NjMwMjgwODV9.eRlSN9oidYho75qh1pF4jTpIB4tw3U5pKBPBFSOfZsw'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 11-13-2025 15:31:26.860 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,60586
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.73] DEBUG | 11-13-2025 15:31:26.860 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,60584
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.73] DEBUG | 11-13-2025 15:31:26.860 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,60585
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.73] DEBUG | 11-13-2025 15:31:26.860 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODA4NSwiZXhwIjoxNzYzMDU2ODg1LCJpYXQiOjE3NjMwMjgwODV9.eRlSN9oidYho75qh1pF4jTpIB4tw3U5pKBPBFSOfZsw'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 11-13-2025 15:31:26.860 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODA4NSwiZXhwIjoxNzYzMDU2ODg1LCJpYXQiOjE3NjMwMjgwODV9.eRlSN9oidYho75qh1pF4jTpIB4tw3U5pKBPBFSOfZsw'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 11-13-2025 15:31:26.860 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODA4NSwiZXhwIjoxNzYzMDU2ODg1LCJpYXQiOjE3NjMwMjgwODV9.eRlSN9oidYho75qh1pF4jTpIB4tw3U5pKBPBFSOfZsw'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 11-13-2025 15:31:26.875 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.73] DEBUG | 11-13-2025 15:31:26.875 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,60583
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.73] DEBUG | 11-13-2025 15:31:26.875 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODA4NSwiZXhwIjoxNzYzMDU2ODg1LCJpYXQiOjE3NjMwMjgwODV9.eRlSN9oidYho75qh1pF4jTpIB4tw3U5pKBPBFSOfZsw'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 11-13-2025 15:31:26.875 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,60587
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.73] DEBUG | 11-13-2025 15:31:26.875 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODA4NSwiZXhwIjoxNzYzMDU2ODg1LCJpYXQiOjE3NjMwMjgwODV9.eRlSN9oidYho75qh1pF4jTpIB4tw3U5pKBPBFSOfZsw'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 11-13-2025 15:31:26.875 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODA4NSwiZXhwIjoxNzYzMDU2ODg1LCJpYXQiOjE3NjMwMjgwODV9.eRlSN9oidYho75qh1pF4jTpIB4tw3U5pKBPBFSOfZsw'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 11-13-2025 15:31:26.875 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,60586
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.73] DEBUG | 11-13-2025 15:31:26.875 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,60584
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.73] DEBUG | 11-13-2025 15:31:26.875 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,60588
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.73] DEBUG | 11-13-2025 15:31:26.875 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODA4NSwiZXhwIjoxNzYzMDU2ODg1LCJpYXQiOjE3NjMwMjgwODV9.eRlSN9oidYho75qh1pF4jTpIB4tw3U5pKBPBFSOfZsw'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 11-13-2025 15:31:26.875 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODA4NSwiZXhwIjoxNzYzMDU2ODg1LCJpYXQiOjE3NjMwMjgwODV9.eRlSN9oidYho75qh1pF4jTpIB4tw3U5pKBPBFSOfZsw'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 11-13-2025 15:31:26.875 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODA4NSwiZXhwIjoxNzYzMDU2ODg1LCJpYXQiOjE3NjMwMjgwODV9.eRlSN9oidYho75qh1pF4jTpIB4tw3U5pKBPBFSOfZsw'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 11-13-2025 15:31:26.875 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,60585
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.73] DEBUG | 11-13-2025 15:31:26.875 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.73] DEBUG | 11-13-2025 15:31:26.891 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODA4NSwiZXhwIjoxNzYzMDU2ODg1LCJpYXQiOjE3NjMwMjgwODV9.eRlSN9oidYho75qh1pF4jTpIB4tw3U5pKBPBFSOfZsw'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 11-13-2025 15:31:26.891 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODA4NSwiZXhwIjoxNzYzMDU2ODg1LCJpYXQiOjE3NjMwMjgwODV9.eRlSN9oidYho75qh1pF4jTpIB4tw3U5pKBPBFSOfZsw'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 11-13-2025 15:31:26.891 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.73] DEBUG | 11-13-2025 15:31:26.891 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODA4NSwiZXhwIjoxNzYzMDU2ODg1LCJpYXQiOjE3NjMwMjgwODV9.eRlSN9oidYho75qh1pF4jTpIB4tw3U5pKBPBFSOfZsw'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 11-13-2025 15:31:26.907 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.73] DEBUG | 11-13-2025 15:31:26.907 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODA4NSwiZXhwIjoxNzYzMDU2ODg1LCJpYXQiOjE3NjMwMjgwODV9.eRlSN9oidYho75qh1pF4jTpIB4tw3U5pKBPBFSOfZsw'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 11-13-2025 15:31:26.907 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.73] DEBUG | 11-13-2025 15:31:26.907 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODA4NSwiZXhwIjoxNzYzMDU2ODg1LCJpYXQiOjE3NjMwMjgwODV9.eRlSN9oidYho75qh1pF4jTpIB4tw3U5pKBPBFSOfZsw'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 11-13-2025 15:31:26.922 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.73] DEBUG | 11-13-2025 15:31:26.922 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODA4NSwiZXhwIjoxNzYzMDU2ODg1LCJpYXQiOjE3NjMwMjgwODV9.eRlSN9oidYho75qh1pF4jTpIB4tw3U5pKBPBFSOfZsw'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 11-13-2025 15:31:26.922 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.73] DEBUG | 11-13-2025 15:31:26.922 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODA4NSwiZXhwIjoxNzYzMDU2ODg1LCJpYXQiOjE3NjMwMjgwODV9.eRlSN9oidYho75qh1pF4jTpIB4tw3U5pKBPBFSOfZsw'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 11-13-2025 15:31:26.938 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.73] DEBUG | 11-13-2025 15:31:26.938 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODA4NSwiZXhwIjoxNzYzMDU2ODg1LCJpYXQiOjE3NjMwMjgwODV9.eRlSN9oidYho75qh1pF4jTpIB4tw3U5pKBPBFSOfZsw'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 11-13-2025 15:31:26.938 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.73] DEBUG | 11-13-2025 15:31:26.938 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODA4NSwiZXhwIjoxNzYzMDU2ODg1LCJpYXQiOjE3NjMwMjgwODV9.eRlSN9oidYho75qh1pF4jTpIB4tw3U5pKBPBFSOfZsw'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 11-13-2025 15:31:26.953 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.73] DEBUG | 11-13-2025 15:31:26.953 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODA4NSwiZXhwIjoxNzYzMDU2ODg1LCJpYXQiOjE3NjMwMjgwODV9.eRlSN9oidYho75qh1pF4jTpIB4tw3U5pKBPBFSOfZsw'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 11-13-2025 15:31:26.953 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.73] DEBUG | 11-13-2025 15:31:26.953 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODA4NSwiZXhwIjoxNzYzMDU2ODg1LCJpYXQiOjE3NjMwMjgwODV9.eRlSN9oidYho75qh1pF4jTpIB4tw3U5pKBPBFSOfZsw'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 11-13-2025 15:31:26.969 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.73] DEBUG | 11-13-2025 15:31:26.969 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODA4NSwiZXhwIjoxNzYzMDU2ODg1LCJpYXQiOjE3NjMwMjgwODV9.eRlSN9oidYho75qh1pF4jTpIB4tw3U5pKBPBFSOfZsw'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 11-13-2025 15:31:27.063 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60583'
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 11-13-2025 15:31:27.063 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODA4NSwiZXhwIjoxNzYzMDU2ODg1LCJpYXQiOjE3NjMwMjgwODV9.eRlSN9oidYho75qh1pF4jTpIB4tw3U5pKBPBFSOfZsw'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 11-13-2025 15:31:27.344 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReportCategoryandField 
 -1
 ,0
 ,1
 ,0
 ,'1'
 ,1
[System: 192.168.1.73] DEBUG | 11-13-2025 15:31:27.344 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODA4NSwiZXhwIjoxNzYzMDU2ODg1LCJpYXQiOjE3NjMwMjgwODV9.eRlSN9oidYho75qh1pF4jTpIB4tw3U5pKBPBFSOfZsw'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 11-13-2025 15:31:27.391 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60584'
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 11-13-2025 15:31:27.391 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODA4NSwiZXhwIjoxNzYzMDU2ODg1LCJpYXQiOjE3NjMwMjgwODV9.eRlSN9oidYho75qh1pF4jTpIB4tw3U5pKBPBFSOfZsw'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 11-13-2025 15:31:27.422 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60585'
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 11-13-2025 15:31:27.422 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODA4NSwiZXhwIjoxNzYzMDU2ODg1LCJpYXQiOjE3NjMwMjgwODV9.eRlSN9oidYho75qh1pF4jTpIB4tw3U5pKBPBFSOfZsw'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 11-13-2025 15:31:27.438 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select * from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0  
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) a --where UStatus like ''%Hold%'' 
'
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 11-13-2025 15:31:27.453 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60586'
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 11-13-2025 15:31:27.453 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODA4NSwiZXhwIjoxNzYzMDU2ODg1LCJpYXQiOjE3NjMwMjgwODV9.eRlSN9oidYho75qh1pF4jTpIB4tw3U5pKBPBFSOfZsw'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 11-13-2025 15:31:27.453 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODA4NSwiZXhwIjoxNzYzMDU2ODg1LCJpYXQiOjE3NjMwMjgwODV9.eRlSN9oidYho75qh1pF4jTpIB4tw3U5pKBPBFSOfZsw'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 11-13-2025 15:31:27.453 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select * from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0  
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) a where UnitStatus=''Occupied'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 11-13-2025 15:31:27.469 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODA4NSwiZXhwIjoxNzYzMDU2ODg1LCJpYXQiOjE3NjMwMjgwODV9.eRlSN9oidYho75qh1pF4jTpIB4tw3U5pKBPBFSOfZsw'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 11-13-2025 15:31:27.469 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select * from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0  
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) a where UnitStatus=''Vacant''
'
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 11-13-2025 15:31:27.469 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODA4NSwiZXhwIjoxNzYzMDU2ODg1LCJpYXQiOjE3NjMwMjgwODV9.eRlSN9oidYho75qh1pF4jTpIB4tw3U5pKBPBFSOfZsw'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 11-13-2025 15:31:27.485 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60587'
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 11-13-2025 15:31:27.485 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODA4NSwiZXhwIjoxNzYzMDU2ODg1LCJpYXQiOjE3NjMwMjgwODV9.eRlSN9oidYho75qh1pF4jTpIB4tw3U5pKBPBFSOfZsw'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 11-13-2025 15:31:27.485 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select * from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0  
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) a  where UnitStatus=''Expired'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 11-13-2025 15:31:27.485 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODA4NSwiZXhwIjoxNzYzMDU2ODg1LCJpYXQiOjE3NjMwMjgwODV9.eRlSN9oidYho75qh1pF4jTpIB4tw3U5pKBPBFSOfZsw'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 11-13-2025 15:31:27.500 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60588'
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 11-13-2025 15:31:27.500 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODA4NSwiZXhwIjoxNzYzMDU2ODg1LCJpYXQiOjE3NjMwMjgwODV9.eRlSN9oidYho75qh1pF4jTpIB4tw3U5pKBPBFSOfZsw'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 11-13-2025 15:31:27.516 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select * from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0  
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) a where UStatus like ''%Case%'' 
'
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 11-13-2025 15:31:27.516 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60583'
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 11-13-2025 15:31:27.516 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODA4NSwiZXhwIjoxNzYzMDU2ODg1LCJpYXQiOjE3NjMwMjgwODV9.eRlSN9oidYho75qh1pF4jTpIB4tw3U5pKBPBFSOfZsw'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 11-13-2025 15:31:27.516 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODA4NSwiZXhwIjoxNzYzMDU2ODg1LCJpYXQiOjE3NjMwMjgwODV9.eRlSN9oidYho75qh1pF4jTpIB4tw3U5pKBPBFSOfZsw'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 11-13-2025 15:31:27.532 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60584'
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 11-13-2025 15:31:27.532 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODA4NSwiZXhwIjoxNzYzMDU2ODg1LCJpYXQiOjE3NjMwMjgwODV9.eRlSN9oidYho75qh1pF4jTpIB4tw3U5pKBPBFSOfZsw'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 11-13-2025 15:31:27.563 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60585'
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 11-13-2025 15:31:27.563 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODA4NSwiZXhwIjoxNzYzMDU2ODg1LCJpYXQiOjE3NjMwMjgwODV9.eRlSN9oidYho75qh1pF4jTpIB4tw3U5pKBPBFSOfZsw'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 11-13-2025 15:31:27.563 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select * from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0  
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) a --where UStatus like ''%Hold%'' 
'
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 11-13-2025 15:31:27.563 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODA4NSwiZXhwIjoxNzYzMDU2ODg1LCJpYXQiOjE3NjMwMjgwODV9.eRlSN9oidYho75qh1pF4jTpIB4tw3U5pKBPBFSOfZsw'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 11-13-2025 15:31:27.578 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 '/*
DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select * from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0  
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) a where UStatus like ''%Reserve%'' 
*/

DECLARE @FROM FLOAT
SET @FROM=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @UnitID BIGINT,@StatusID BIGINT,@TotalAmount FLOAT,@I INT,@COUNT INT,@ContractID BIGINT
DECLARE @NoofDays INT,@VacantSince DATETIME

DECLARE @TAB TABLE(ID INT IDENTITY(1,1) PRIMARY KEY,UnitID BIGINT,CurrentRent FLOAT,Status NVARCHAR(10),NoofDays INT,VacantSince DATETIME,ContractID BIGINT)

INSERT INTO @TAB (UnitID)
SELECT U.UnitID
FROM REN_Units U WITH(NOLOCK) 
LEFT JOIN REN_Property P WITH(NOLOCK) ON P.NodeID=U.PropertyID
LEFT JOIN COM_Lookup LK WITH(NOLOCK) ON U.UnitStatus=LK.NodeID
WHERE U.UnitID>1 AND P.Name <> U.Name AND U.IsGroup=0 AND U.Status=424 and U.UnitStatus=306 
-- AND P.NodeID IN (207)
SELECT @I=1,@COUNT=COUNT(*) FROM @TAB
WHILE(@I<=@COUNT)
BEGIN
	SET @StatusID=0
	SET @TotalAmount=0
	SET @ContractID=0
	SELECT @UnitID=UnitID FROM @TAB WHERE ID=@I

	SELECT TOP 1 @ContractID=(CASE WHEN RefContractID>0 THEN RefContractID ELSE ContractID END),@StatusID=StatusID
	,@VacantSince=(CASE WHEN StatusID = 450 THEN ( CASE WHEN RefundDate IS NOT NULL THEN CONVERT(DATETIME,RefundDate) ELSE CONVERT(DATETIME,VacancyDate) END ) 
			ELSE CONVERT(DATETIME,TerminationDate) END )
	,@NoofDays=(CASE WHEN StatusID = 450 THEN (CASE WHEN RefundDate IS NOT NULL THEN DATEDIFF(DAY, CONVERT(DATETIME,RefundDate),CONVERT(DATETIME,@FROM) ) 
			ELSE DATEDIFF(DAY, CONVERT(DATETIME,VacancyDate),CONVERT(DATETIME,@FROM) ) END )
			ELSE DATEDIFF(DAY, CONVERT(DATETIME,TerminationDate),CONVERT(DATETIME,@FROM) ) END )  
	FROM REN_Contract WITH(NOLOCK) WHERE StatusID<>451 AND StartDate<@FROM AND UNITID=@UnitID 
	ORDER BY StartDate DESC,StatusID
	
	SELECT @TotalAmount=ISNULL(SUM(RPD.Amount),MAX(RentAmount)/(CASE WHEN MAX(RC.NoOfUnits)=0 THEN 1 ELSE MAX(RC.NoOfUnits) END)) 
	FROM REN_Contract RC WITH(NOLOCK)
	JOIN REN_ContractParticulars RP WITH(NOLOCK) ON RP.ContractID=RC.ContractID AND RP.Sno=1
	LEFT JOIN REN_ContractParticularsDetail RPD WITH(NOLOCK) ON RPD.ParticularNodeID=RP.NodeID AND RPD.Unit=@UnitID 
	AND @FROM BETWEEN ISNULL(RPD.FromDate,@FROM) AND ISNULL(RPD.ToDate,@FROM)
	WHERE RC.ContractID=@ContractID
	
	IF @StatusID=427 OR @StatusID=426 OR @StatusID=466
	BEGIN
		UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Occupied'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
	END
	ELSE IF @StatusID=440
	BEGIN
		UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''UnAproved'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
	END
	ELSE IF @StatusID=428 OR @StatusID=450
	BEGIN 
		IF EXISTS (SELECT * FROM REN_Quotation WITH(NOLOCK) WHERE COSTCENTERID=129 AND UNITID=@UnitID AND CONVERT(DATETIME,@FROM) BETWEEN CONVERT(DATETIME,STARTDATE) AND CONVERT(DATETIME,ENDDATE) and statusid=467 )
			UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Reserved'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
		ELSE IF EXISTS (SELECT * FROM REN_Quotation WITH(NOLOCK) WHERE COSTCENTERID=103 AND UNITID=@UnitID AND CONVERT(DATETIME,@FROM) BETWEEN CONVERT(DATETIME,STARTDATE) AND CONVERT(DATETIME,ENDDATE) and statusid=426 )
			UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Quoted'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
		ELSE
			UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Vacant'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
	END
	ELSE
	BEGIN 
		IF EXISTS (SELECT * FROM REN_Quotation WITH(NOLOCK) WHERE COSTCENTERID=129 AND UNITID=@UnitID AND CONVERT(DATETIME,@FROM) BETWEEN CONVERT(DATETIME,STARTDATE) AND CONVERT(DATETIME,ENDDATE) and statusid=467 )
			UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Reserved'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
		ELSE IF EXISTS (SELECT * FROM REN_Quotation WITH(NOLOCK) WHERE COSTCENTERID=103 AND UNITID=@UnitID AND CONVERT(DATETIME,@FROM) BETWEEN CONVERT(DATETIME,STARTDATE) AND CONVERT(DATETIME,ENDDATE) and statusid=426 )
			UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Quoted'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
		ELSE
			UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Vacant'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
	END
	set @I=@I+1
END

select * from (
SELECT TEMP.*,RP.NodeID Building_ID,RP.NAME Property,TEMP.UnitID Unit_ID,RU.NAME Unit,C18.NAME UnitType,RU.UnitStatus,RU.RentableArea UnitArea,RU.RentPerSQFT UnitRate
,RU.AnnualRent 
,T.FirstName AS [C98c7d2679f99489e9f0e010026eeb563]
,RUL.Name LandLord , RUC.Name Location 
,1 Cnt
FROM @TAB TEMP
JOIN REN_Units RU WITH(NOLOCK) ON TEMP.UnitID=RU.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
LEFT JOIN COM_CC50018 C18 WITH(NOLOCK) ON C18.NodeID=RU.NodeID
LEFT JOIN REN_Contract C WITH(NOLOCK) ON TEMP.ContractID=C.ContractID
LEFT JOIN REN_Tenant T WITH(NOLOCK) ON T.TenantID=C.TenantID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID

 )a where a.Status =''Reserved''
 order by Property,VacantSince'
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 11-13-2025 15:31:27.578 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODA4NSwiZXhwIjoxNzYzMDU2ODg1LCJpYXQiOjE3NjMwMjgwODV9.eRlSN9oidYho75qh1pF4jTpIB4tw3U5pKBPBFSOfZsw'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 11-13-2025 15:31:27.578 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select * from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0  
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) a where UnitStatus=''Vacant''
'
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 11-13-2025 15:31:27.578 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODA4NSwiZXhwIjoxNzYzMDU2ODg1LCJpYXQiOjE3NjMwMjgwODV9.eRlSN9oidYho75qh1pF4jTpIB4tw3U5pKBPBFSOfZsw'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 11-13-2025 15:31:27.578 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select * from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0  
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) a where UnitStatus=''Occupied'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 11-13-2025 15:31:27.578 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODA4NSwiZXhwIjoxNzYzMDU2ODg1LCJpYXQiOjE3NjMwMjgwODV9.eRlSN9oidYho75qh1pF4jTpIB4tw3U5pKBPBFSOfZsw'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 11-13-2025 15:31:27.594 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60586'
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 11-13-2025 15:31:27.594 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODA4NSwiZXhwIjoxNzYzMDU2ODg1LCJpYXQiOjE3NjMwMjgwODV9.eRlSN9oidYho75qh1pF4jTpIB4tw3U5pKBPBFSOfZsw'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 11-13-2025 15:31:27.610 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60587'
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 11-13-2025 15:31:27.625 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select * from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0  
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) a  where UnitStatus=''Expired'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 11-13-2025 15:31:27.625 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODA4NSwiZXhwIjoxNzYzMDU2ODg1LCJpYXQiOjE3NjMwMjgwODV9.eRlSN9oidYho75qh1pF4jTpIB4tw3U5pKBPBFSOfZsw'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 11-13-2025 15:31:27.625 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODA4NSwiZXhwIjoxNzYzMDU2ODg1LCJpYXQiOjE3NjMwMjgwODV9.eRlSN9oidYho75qh1pF4jTpIB4tw3U5pKBPBFSOfZsw'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 11-13-2025 15:31:27.641 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60588'
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 11-13-2025 15:31:27.641 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODA4NSwiZXhwIjoxNzYzMDU2ODg1LCJpYXQiOjE3NjMwMjgwODV9.eRlSN9oidYho75qh1pF4jTpIB4tw3U5pKBPBFSOfZsw'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 11-13-2025 15:31:27.641 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select * from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0  
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) a where UStatus like ''%Case%'' 
'
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 11-13-2025 15:31:27.641 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODA4NSwiZXhwIjoxNzYzMDU2ODg1LCJpYXQiOjE3NjMwMjgwODV9.eRlSN9oidYho75qh1pF4jTpIB4tw3U5pKBPBFSOfZsw'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 11-13-2025 15:31:27.703 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 '/*
DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select * from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0  
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) a where UStatus like ''%Reserve%'' 
*/

DECLARE @FROM FLOAT
SET @FROM=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @UnitID BIGINT,@StatusID BIGINT,@TotalAmount FLOAT,@I INT,@COUNT INT,@ContractID BIGINT
DECLARE @NoofDays INT,@VacantSince DATETIME

DECLARE @TAB TABLE(ID INT IDENTITY(1,1) PRIMARY KEY,UnitID BIGINT,CurrentRent FLOAT,Status NVARCHAR(10),NoofDays INT,VacantSince DATETIME,ContractID BIGINT)

INSERT INTO @TAB (UnitID)
SELECT U.UnitID
FROM REN_Units U WITH(NOLOCK) 
LEFT JOIN REN_Property P WITH(NOLOCK) ON P.NodeID=U.PropertyID
LEFT JOIN COM_Lookup LK WITH(NOLOCK) ON U.UnitStatus=LK.NodeID
WHERE U.UnitID>1 AND P.Name <> U.Name AND U.IsGroup=0 AND U.Status=424 and U.UnitStatus=306 
-- AND P.NodeID IN (207)
SELECT @I=1,@COUNT=COUNT(*) FROM @TAB
WHILE(@I<=@COUNT)
BEGIN
	SET @StatusID=0
	SET @TotalAmount=0
	SET @ContractID=0
	SELECT @UnitID=UnitID FROM @TAB WHERE ID=@I

	SELECT TOP 1 @ContractID=(CASE WHEN RefContractID>0 THEN RefContractID ELSE ContractID END),@StatusID=StatusID
	,@VacantSince=(CASE WHEN StatusID = 450 THEN ( CASE WHEN RefundDate IS NOT NULL THEN CONVERT(DATETIME,RefundDate) ELSE CONVERT(DATETIME,VacancyDate) END ) 
			ELSE CONVERT(DATETIME,TerminationDate) END )
	,@NoofDays=(CASE WHEN StatusID = 450 THEN (CASE WHEN RefundDate IS NOT NULL THEN DATEDIFF(DAY, CONVERT(DATETIME,RefundDate),CONVERT(DATETIME,@FROM) ) 
			ELSE DATEDIFF(DAY, CONVERT(DATETIME,VacancyDate),CONVERT(DATETIME,@FROM) ) END )
			ELSE DATEDIFF(DAY, CONVERT(DATETIME,TerminationDate),CONVERT(DATETIME,@FROM) ) END )  
	FROM REN_Contract WITH(NOLOCK) WHERE StatusID<>451 AND StartDate<@FROM AND UNITID=@UnitID 
	ORDER BY StartDate DESC,StatusID
	
	SELECT @TotalAmount=ISNULL(SUM(RPD.Amount),MAX(RentAmount)/(CASE WHEN MAX(RC.NoOfUnits)=0 THEN 1 ELSE MAX(RC.NoOfUnits) END)) 
	FROM REN_Contract RC WITH(NOLOCK)
	JOIN REN_ContractParticulars RP WITH(NOLOCK) ON RP.ContractID=RC.ContractID AND RP.Sno=1
	LEFT JOIN REN_ContractParticularsDetail RPD WITH(NOLOCK) ON RPD.ParticularNodeID=RP.NodeID AND RPD.Unit=@UnitID 
	AND @FROM BETWEEN ISNULL(RPD.FromDate,@FROM) AND ISNULL(RPD.ToDate,@FROM)
	WHERE RC.ContractID=@ContractID
	
	IF @StatusID=427 OR @StatusID=426 OR @StatusID=466
	BEGIN
		UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Occupied'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
	END
	ELSE IF @StatusID=440
	BEGIN
		UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''UnAproved'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
	END
	ELSE IF @StatusID=428 OR @StatusID=450
	BEGIN 
		IF EXISTS (SELECT * FROM REN_Quotation WITH(NOLOCK) WHERE COSTCENTERID=129 AND UNITID=@UnitID AND CONVERT(DATETIME,@FROM) BETWEEN CONVERT(DATETIME,STARTDATE) AND CONVERT(DATETIME,ENDDATE) and statusid=467 )
			UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Reserved'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
		ELSE IF EXISTS (SELECT * FROM REN_Quotation WITH(NOLOCK) WHERE COSTCENTERID=103 AND UNITID=@UnitID AND CONVERT(DATETIME,@FROM) BETWEEN CONVERT(DATETIME,STARTDATE) AND CONVERT(DATETIME,ENDDATE) and statusid=426 )
			UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Quoted'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
		ELSE
			UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Vacant'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
	END
	ELSE
	BEGIN 
		IF EXISTS (SELECT * FROM REN_Quotation WITH(NOLOCK) WHERE COSTCENTERID=129 AND UNITID=@UnitID AND CONVERT(DATETIME,@FROM) BETWEEN CONVERT(DATETIME,STARTDATE) AND CONVERT(DATETIME,ENDDATE) and statusid=467 )
			UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Reserved'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
		ELSE IF EXISTS (SELECT * FROM REN_Quotation WITH(NOLOCK) WHERE COSTCENTERID=103 AND UNITID=@UnitID AND CONVERT(DATETIME,@FROM) BETWEEN CONVERT(DATETIME,STARTDATE) AND CONVERT(DATETIME,ENDDATE) and statusid=426 )
			UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Quoted'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
		ELSE
			UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Vacant'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
	END
	set @I=@I+1
END

select * from (
SELECT TEMP.*,RP.NodeID Building_ID,RP.NAME Property,TEMP.UnitID Unit_ID,RU.NAME Unit,C18.NAME UnitType,RU.UnitStatus,RU.RentableArea UnitArea,RU.RentPerSQFT UnitRate
,RU.AnnualRent 
,T.FirstName AS [C98c7d2679f99489e9f0e010026eeb563]
,RUL.Name LandLord , RUC.Name Location 
,1 Cnt
FROM @TAB TEMP
JOIN REN_Units RU WITH(NOLOCK) ON TEMP.UnitID=RU.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
LEFT JOIN COM_CC50018 C18 WITH(NOLOCK) ON C18.NodeID=RU.NodeID
LEFT JOIN REN_Contract C WITH(NOLOCK) ON TEMP.ContractID=C.ContractID
LEFT JOIN REN_Tenant T WITH(NOLOCK) ON T.TenantID=C.TenantID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID

 )a where a.Status =''Reserved''
 order by Property,VacantSince'
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 11-13-2025 15:31:27.703 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODA4NSwiZXhwIjoxNzYzMDU2ODg1LCJpYXQiOjE3NjMwMjgwODV9.eRlSN9oidYho75qh1pF4jTpIB4tw3U5pKBPBFSOfZsw'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 11-13-2025 15:31:36.923 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 11-13-2025 15:31:36.938 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODAzNSwiZXhwIjoxNzYzMDU2ODM1LCJpYXQiOjE3NjMwMjgwMzV9.c4J7sRklVhN3hJ2g3cvBPJ5nYIFJIc4QnnPUO71wek4'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:32:01.703 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:32:01.718 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTAzLDEiLCJuYmYiOjE3NjMwMjgwNTUsImV4cCI6MTc2MzA1Njg1NSwiaWF0IjoxNzYzMDI4MDU1fQ.0HTaw4flBBHsHK2bJWh6sp2X4QOe-Ng7oRTrZaWOVrw'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 11-13-2025 15:32:26.433 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 11-13-2025 15:32:26.433 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODA4NSwiZXhwIjoxNzYzMDU2ODg1LCJpYXQiOjE3NjMwMjgwODV9.eRlSN9oidYho75qh1pF4jTpIB4tw3U5pKBPBFSOfZsw'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 11-13-2025 15:32:37.893 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 11-13-2025 15:32:37.893 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODAzNSwiZXhwIjoxNzYzMDU2ODM1LCJpYXQiOjE3NjMwMjgwMzV9.c4J7sRklVhN3hJ2g3cvBPJ5nYIFJIc4QnnPUO71wek4'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:33:01.672 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:33:01.687 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTAzLDEiLCJuYmYiOjE3NjMwMjgwNTUsImV4cCI6MTc2MzA1Njg1NSwiaWF0IjoxNzYzMDI4MDU1fQ.0HTaw4flBBHsHK2bJWh6sp2X4QOe-Ng7oRTrZaWOVrw'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:33:22.735 | General Service|:: CompanyIndex:103 SpName: spCom_GetCostCenterSummary 
 267
 ,-1
 ,1000
 ,''
 ,''
 ,''
 ,0
 ,'13-Nov-2025'
 ,NULL
 ,''
 ,1
 ,1
 ,0
 ,0
 ,False
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:33:22.735 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTAzLDEiLCJuYmYiOjE3NjMwMjgwNTUsImV4cCI6MTc2MzA1Njg1NSwiaWF0IjoxNzYzMDI4MDU1fQ.0HTaw4flBBHsHK2bJWh6sp2X4QOe-Ng7oRTrZaWOVrw'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:33:25.096 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=20334'
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:33:25.096 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTAzLDEiLCJuYmYiOjE3NjMwMjgwNTUsImV4cCI6MTc2MzA1Njg1NSwiaWF0IjoxNzYzMDI4MDU1fQ.0HTaw4flBBHsHK2bJWh6sp2X4QOe-Ng7oRTrZaWOVrw'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:33:25.127 | General Service|:: CompanyIndex:103 SpName: spRPT_GetReport 
 0
 ,20334
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:33:25.127 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTAzLDEiLCJuYmYiOjE3NjMwMjgwNTUsImV4cCI6MTc2MzA1Njg1NSwiaWF0IjoxNzYzMDI4MDU1fQ.0HTaw4flBBHsHK2bJWh6sp2X4QOe-Ng7oRTrZaWOVrw'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:33:25.159 | General Service|:: CompanyIndex:103 SpName: spRPT_GetReportFields 
 40001
 ,0
 ,'1'
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:33:25.159 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTAzLDEiLCJuYmYiOjE3NjMwMjgwNTUsImV4cCI6MTc2MzA1Njg1NSwiaWF0IjoxNzYzMDI4MDU1fQ.0HTaw4flBBHsHK2bJWh6sp2X4QOe-Ng7oRTrZaWOVrw'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:33:25.190 | General Service|:: CompanyIndex:103 SpName: spDOC_GetVPTPrintCopies 
 4
 ,50
 ,20334
 ,2
 ,4
 ,'View~admin'
 ,'admin'
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:33:25.190 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTAzLDEiLCJuYmYiOjE3NjMwMjgwNTUsImV4cCI6MTc2MzA1Njg1NSwiaWF0IjoxNzYzMDI4MDU1fQ.0HTaw4flBBHsHK2bJWh6sp2X4QOe-Ng7oRTrZaWOVrw'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:33:25.221 | General Service|:: CompanyIndex:103 SpName: spRPT_GetReportFields 
 400
 ,0
 ,'1'
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:33:25.221 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTAzLDEiLCJuYmYiOjE3NjMwMjgwNTUsImV4cCI6MTc2MzA1Njg1NSwiaWF0IjoxNzYzMDI4MDU1fQ.0HTaw4flBBHsHK2bJWh6sp2X4QOe-Ng7oRTrZaWOVrw'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:33:25.252 | General Service|:: CompanyIndex:103 SpName: spRPT_GetReportFields 
 40001
 ,0
 ,'1'
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:33:25.252 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTAzLDEiLCJuYmYiOjE3NjMwMjgwNTUsImV4cCI6MTc2MzA1Njg1NSwiaWF0IjoxNzYzMDI4MDU1fQ.0HTaw4flBBHsHK2bJWh6sp2X4QOe-Ng7oRTrZaWOVrw'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:33:25.299 | General Service|:: CompanyIndex:103 SpName: spRPT_GetReportFields 
 2
 ,0
 ,'1'
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:33:25.299 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTAzLDEiLCJuYmYiOjE3NjMwMjgwNTUsImV4cCI6MTc2MzA1Njg1NSwiaWF0IjoxNzYzMDI4MDU1fQ.0HTaw4flBBHsHK2bJWh6sp2X4QOe-Ng7oRTrZaWOVrw'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:33:25.331 | General Service|:: CompanyIndex:103 SpName: spRPT_GetReportFields 
 110
 ,0
 ,'1'
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:33:25.331 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTAzLDEiLCJuYmYiOjE3NjMwMjgwNTUsImV4cCI6MTc2MzA1Njg1NSwiaWF0IjoxNzYzMDI4MDU1fQ.0HTaw4flBBHsHK2bJWh6sp2X4QOe-Ng7oRTrZaWOVrw'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:33:25.346 | General Service|:: CompanyIndex:103 SpName: spRPT_GetReportFields 
 50009
 ,0
 ,'1'
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:33:25.346 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTAzLDEiLCJuYmYiOjE3NjMwMjgwNTUsImV4cCI6MTc2MzA1Njg1NSwiaWF0IjoxNzYzMDI4MDU1fQ.0HTaw4flBBHsHK2bJWh6sp2X4QOe-Ng7oRTrZaWOVrw'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:33:25.377 | General Service|:: CompanyIndex:103 SpName: spADM_GetCostCenterGridViewList 
 2
 ,1
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:33:25.377 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTAzLDEiLCJuYmYiOjE3NjMwMjgwNTUsImV4cCI6MTc2MzA1Njg1NSwiaWF0IjoxNzYzMDI4MDU1fQ.0HTaw4flBBHsHK2bJWh6sp2X4QOe-Ng7oRTrZaWOVrw'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:33:25.721 | General Service|:: CompanyIndex:103 SpName: spCom_GetCostCenterSummary 
 126
 ,-1
 ,1000
 ,'#DEBITORCREDITORTEE#'
 ,''
 ,''
 ,0
 ,'13-Nov-2025'
 ,NULL
 ,''
 ,1
 ,1
 ,0
 ,0
 ,False
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:33:25.737 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTAzLDEiLCJuYmYiOjE3NjMwMjgwNTUsImV4cCI6MTc2MzA1Njg1NSwiaWF0IjoxNzYzMDI4MDU1fQ.0HTaw4flBBHsHK2bJWh6sp2X4QOe-Ng7oRTrZaWOVrw'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:33:25.784 | General Service|:: CompanyIndex:103 SpName: spADM_GetLocationRole 
 50002
 ,1
 message=Saved Succesfully
[System: 192.168.1.79] DEBUG | 11-13-2025 15:33:25.784 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTAzLDEiLCJuYmYiOjE3NjMwMjgwNTUsImV4cCI6MTc2MzA1Njg1NSwiaWF0IjoxNzYzMDI4MDU1fQ.0HTaw4flBBHsHK2bJWh6sp2X4QOe-Ng7oRTrZaWOVrw'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:33:25.784 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'SELECT CL.RESOURCEDATA Name FROM [ADM_Features] ADF WITH(NOLOCK),COM_LANGUAGERESOURCES CL WITH(NOLOCK) WHERE ADF.RESOURCEID=CL.RESOURCEID AND ADF.FeatureID=50002 AND CL.LanguageID=1'
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:33:25.799 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTAzLDEiLCJuYmYiOjE3NjMwMjgwNTUsImV4cCI6MTc2MzA1Njg1NSwiaWF0IjoxNzYzMDI4MDU1fQ.0HTaw4flBBHsHK2bJWh6sp2X4QOe-Ng7oRTrZaWOVrw'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:33:25.799 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'SELECT CurrencyID,Name,ExchangeRate FROM COM_Currency WITH(NOLOCK)'
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:33:25.799 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTAzLDEiLCJuYmYiOjE3NjMwMjgwNTUsImV4cCI6MTc2MzA1Njg1NSwiaWF0IjoxNzYzMDI4MDU1fQ.0HTaw4flBBHsHK2bJWh6sp2X4QOe-Ng7oRTrZaWOVrw'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:33:25.815 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'SELECT CurrencyID,Name,ExchangeRate FROM COM_Currency WITH(NOLOCK)'
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:33:25.815 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTAzLDEiLCJuYmYiOjE3NjMwMjgwNTUsImV4cCI6MTc2MzA1Njg1NSwiaWF0IjoxNzYzMDI4MDU1fQ.0HTaw4flBBHsHK2bJWh6sp2X4QOe-Ng7oRTrZaWOVrw'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 11-13-2025 15:33:26.399 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 11-13-2025 15:33:26.415 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODA4NSwiZXhwIjoxNzYzMDU2ODg1LCJpYXQiOjE3NjMwMjgwODV9.eRlSN9oidYho75qh1pF4jTpIB4tw3U5pKBPBFSOfZsw'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:33:30.300 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'SELECT DefaultPreferences FROM ADM_RevenUReports with(nolock) WHERE ReportID=13'
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:33:30.300 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTAzLDEiLCJuYmYiOjE3NjMwMjgwNTUsImV4cCI6MTc2MzA1Njg1NSwiaWF0IjoxNzYzMDI4MDU1fQ.0HTaw4flBBHsHK2bJWh6sp2X4QOe-Ng7oRTrZaWOVrw'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:33:30.331 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'select CostCenterID from ADM_CostCenterDef with(nolock) where SysColumnName=''BillNo'' and IsVisible=1 and SysTableName=''ACC_DocDetails'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:33:30.331 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTAzLDEiLCJuYmYiOjE3NjMwMjgwNTUsImV4cCI6MTc2MzA1Njg1NSwiaWF0IjoxNzYzMDI4MDU1fQ.0HTaw4flBBHsHK2bJWh6sp2X4QOe-Ng7oRTrZaWOVrw'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:33:31.066 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'DECLARE @To FLOAT
SET @To=CONVERT(FLOAT,CONVERT(DATETIME,''13 Nov 2025''))
SELECT *,case when Amount>0 then 1 else 0 end AmtOrder FROM (	SELECT A.AccountID,B.DocSeqNo,A.AccountName AS AccountName,A.AccountID AS AccountName_ID,CONVERT(DATETIME,B.DocDate) DocDate,CONVERT(DATETIME,B.DocDueDate) DueDate,CONVERT(DATETIME,B.DocDate) VoucherDate,B.DocNo,AdjAmount+ISNULL((select sum(CB.AdjAmount) from COM_Billwise CB with(nolock) where CB.AccountID=B.AccountID AND CB.DocNo=B.DocNo and CB.IsNewReference=0 AND CB.DocSeqNo=B.DocSeqNo AND CB.RefDocDate>@To),0) Amount,AdjAmount BillAmount,case when B.DocType=16 then (SELECT TOP 1 BillNo FROM ACC_DocDetails WITH(NOLOCK) WHERE B.DocNo=VoucherNo and B.DocSeqNo=DocSeqNo) else (SELECT TOP 1 BillNo FROM INV_DocDetails WITH(NOLOCK) WHERE B.DocNo=VoucherNo) end BillNo,case when B.DocType=16 then (SELECT TOP 1 CONVERT(DATETIME, BillDate) FROM ACC_DocDetails WITH(NOLOCK) WHERE B.DocNo=VoucherNo and B.DocSeqNo=DocSeqNo) else (SELECT TOP 1 CONVERT(DATETIME, BillDate) FROM INV_DocDetails WITH(NOLOCK) WHERE B.DocNo=VoucherNo) end BillDate,C50002.Name AS Location,    
(SELECT SUM(AdjAmount) Adjusted FROM COM_Billwise CB WITH(NOLOCK) WHERE IsNewReference=0 AND CB.DocDate<=@To AND CB.AccountID=B.AccountID AND CB.RefDocNo=B.DocNo AND  CB.DocType<>14 AND CB.DocType<>19 AND (SELECT top(1) 1 FROM ACC_DocDetails ACC WITH(NOLOCK) WHERE ACC.VoucherNo=CB.DocNo and (StatusID=369 or StatusID=429))=1 AND CB.RefDocSeqNo=B.DocSeqNo) Adjusted,CASE WHEN DType.IsInventory=0 THEN
  (SELECT MAX(DOC.CommonNarration) FROM Acc_DocDetails DOC WITH(NOLOCK) WHERE DOC.VoucherNo=B.DocNo and Doc.DocSeqNo=B.DocSeqNo)
  ELSE
  (SELECT MAX(DOC.CommonNarration) FROM INV_DocDetails DOC WITH(NOLOCK) WHERE DOC.VoucherNo=B.DocNo)  END AS C337e1c8baa3b4ac0b3a2682d9d88fc63,CASE WHEN DType.IsInventory=0 THEN NULL ELSE
(STUFF((SELECT distinct '',''+VoucherNo FROM INV_DocDetails with(nolock) WHERE InvDocDetailsID IN 
(select LinkedInvDocDetailsID from INV_DocDetails with(nolock) WHERE VoucherNo=B.DocNo and LinkedInvDocDetailsID>0) FOR XML PATH('''')),1,1,'''')) END AS Cdf3533811555463c963af67849b1c17e,T1.Code Cd6882cec5b8a44fcb0c1be3976f3c29a,T1.Name C02934645c08a4ed3a3dfbd5a980f1761,T2.Name Cda273e47f52943fcae5bf08cc75c5512,CASE WHEN DType.IsInventory=0 THEN
  (SELECT MAX(convert(datetime,DOC.DueDate)) FROM Acc_DocDetails DOC WITH(NOLOCK) WHERE DOC.VoucherNo=B.DocNo and Doc.DocSeqNo=B.DocSeqNo)
  ELSE
  (SELECT MAX(convert(datetime,DOC.DueDate)) FROM INV_DocDetails DOC WITH(NOLOCK) WHERE DOC.VoucherNo=B.DocNo)  END AS C9256e42b51c94b18b0cfb15615481c0d,(B.DocDueDate-B.DocDate) CreditDays
,@To-B.DocDate OverDue
,B.DocType,(SELECT TOP 1 ACC.StatusID FROM ACC_DocDetails ACC with(nolock) WHERE ACC.VoucherNo=B.DocNo) StatusID 
FROM COM_Billwise B with(nolock) INNER JOIN ACC_Accounts A WITH(NOLOCK) ON B.AccountID=A.AccountID     
INNER JOIN COM_Location AS C50002 with(nolock) ON B.dcCCNID2 = C50002.NodeID  INNER JOIN (SELECT DocumentType DocType1,IsInventory FROM ADM_DocumentTypes with(nolock) Group By DocumentType,IsInventory) AS DType ON  DType.DocType1=B.DocType  INNER JOIN COM_CC50009 AS T1 with(nolock) ON T1.NodeID=B.dcCCNID9 INNER JOIN COM_Salesman AS T2 with(nolock) ON T2.NodeID=B.dcCCNID5,(select T.AccountID GTID from ACC_Accounts T with(nolock),ACC_Accounts GT1 with(nolock) where T.lft BETWEEN GT1.lft AND GT1.rgt AND GT1.AccountID=13055 group by T.AccountID) AS GTP  WHERE B.IsNewReference=1 AND B.DocDate<=@To AND A.AccountID=GTP.GTID AND A.AccountTypeID IN (6,7) ) AS T  WHERE (Adjusted IS NULL OR abs(Amount+Adjusted)>0.099) AND DocType<>14 AND DocType<>19 and (StatusID=369 or StatusID=429)
 UNION ALL  SELECT *,case when Amount>0 then 1 else 0 end AmtOrder FROM (	SELECT A.AccountID,B.DocSeqNo,A.AccountName AS AccountName,A.AccountID AS AccountName_ID,CONVERT(DATETIME,B.DocDate) DocDate,CONVERT(DATETIME,B.DocDueDate) DueDate,CONVERT(DATETIME,B.DocDate) VoucherDate,B.DocNo,B.AdjAmount Amount,B.AdjAmount BillAmount,case when B.DocType=16 then (SELECT TOP 1 BillNo FROM ACC_DocDetails WITH(NOLOCK) WHERE B.DocNo=VoucherNo and B.DocSeqNo=DocSeqNo) else (SELECT TOP 1 BillNo FROM INV_DocDetails WITH(NOLOCK) WHERE B.DocNo=VoucherNo) end BillNo,case when B.DocType=16 then (SELECT TOP 1 CONVERT(DATETIME, BillDate) FROM ACC_DocDetails WITH(NOLOCK) WHERE B.DocNo=VoucherNo and B.DocSeqNo=DocSeqNo) else (SELECT TOP 1 CONVERT(DATETIME, BillDate) FROM INV_DocDetails WITH(NOLOCK) WHERE B.DocNo=VoucherNo) end BillDate,C50002.Name AS Location,    
(SELECT SUM(CB.AdjAmount) Adjusted FROM COM_Billwise CB WITH(NOLOCK) WHERE IsNewReference=0 AND CB.DocDate<=@To AND CB.AccountID=B.AccountID AND CB.RefDocNo=B.DocNo AND  CB.DocType<>14 AND CB.DocType<>19 AND (SELECT top(1) 1 FROM ACC_DocDetails ACC WITH(NOLOCK) WHERE ACC.VoucherNo=CB.DocNo and (StatusID=369 or StatusID=429))=1 AND CB.RefDocSeqNo=B.DocSeqNo) Adjusted,CASE WHEN DType.IsInventory=0 THEN
  (SELECT MAX(DOC.CommonNarration) FROM Acc_DocDetails DOC WITH(NOLOCK) WHERE DOC.VoucherNo=B.DocNo and Doc.DocSeqNo=B.DocSeqNo)
  ELSE
  (SELECT MAX(DOC.CommonNarration) FROM INV_DocDetails DOC WITH(NOLOCK) WHERE DOC.VoucherNo=B.DocNo)  END AS C337e1c8baa3b4ac0b3a2682d9d88fc63,CASE WHEN DType.IsInventory=0 THEN NULL ELSE
(STUFF((SELECT distinct '',''+VoucherNo FROM INV_DocDetails with(nolock) WHERE InvDocDetailsID IN 
(select LinkedInvDocDetailsID from INV_DocDetails with(nolock) WHERE VoucherNo=B.DocNo and LinkedInvDocDetailsID>0) FOR XML PATH('''')),1,1,'''')) END AS Cdf3533811555463c963af67849b1c17e,T1.Code Cd6882cec5b8a44fcb0c1be3976f3c29a,T1.Name C02934645c08a4ed3a3dfbd5a980f1761,T2.Name Cda273e47f52943fcae5bf08cc75c5512,CASE WHEN DType.IsInventory=0 THEN
  (SELECT MAX(convert(datetime,DOC.DueDate)) FROM Acc_DocDetails DOC WITH(NOLOCK) WHERE DOC.VoucherNo=B.DocNo and Doc.DocSeqNo=B.DocSeqNo)
  ELSE
  (SELECT MAX(convert(datetime,DOC.DueDate)) FROM INV_DocDetails DOC WITH(NOLOCK) WHERE DOC.VoucherNo=B.DocNo)  END AS C9256e42b51c94b18b0cfb15615481c0d,(B.DocDueDate-B.DocDate) CreditDays
 ,@To-B.DocDate OverDue
 ,B.DocType,(SELECT TOP 1 ACC.StatusID FROM ACC_DocDetails ACC with(nolock) WHERE ACC.VoucherNo=B.DocNo) StatusID 
 FROM COM_Billwise B with(nolock) INNER JOIN ACC_Accounts A WITH(NOLOCK) ON B.AccountID=A.AccountID     
 INNER JOIN COM_Location AS C50002 with(nolock) ON B.dcCCNID2 = C50002.NodeID  INNER JOIN (SELECT DocumentType DocType1,IsInventory FROM ADM_DocumentTypes with(nolock) Group By DocumentType,IsInventory) AS DType ON  DType.DocType1=B.DocType  INNER JOIN COM_CC50009 AS T1 with(nolock) ON T1.NodeID=B.dcCCNID9 INNER JOIN COM_Salesman AS T2 with(nolock) ON T2.NodeID=B.dcCCNID5 
 LEFT JOIN COM_Billwise BCB with(nolock) ON BCB.AccountID=B.AccountID AND BCB.DocNo=B.DocNo and BCB.IsNewReference=1 AND BCB.DocSeqNo=B.DocSeqNo ,(select T.AccountID GTID from ACC_Accounts T with(nolock),ACC_Accounts GT1 with(nolock) where T.lft BETWEEN GT1.lft AND GT1.rgt AND GT1.AccountID=13055 group by T.AccountID) AS GTP  WHERE B.IsNewReference=0 AND B.DocDate<=@To AND B.RefDocDate>@To AND BCB.AccountID is null AND A.AccountID=GTP.GTID AND A.AccountTypeID IN (6,7) ) AS T  WHERE (Adjusted IS NULL OR abs(Amount+Adjusted)>0.099) AND DocType<>14 AND DocType<>19 and (StatusID=369 or StatusID=429) ORDER BY AccountName,DocDate,AmtOrder,DocNo'
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:33:31.066 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTAzLDEiLCJuYmYiOjE3NjMwMjgwNTUsImV4cCI6MTc2MzA1Njg1NSwiaWF0IjoxNzYzMDI4MDU1fQ.0HTaw4flBBHsHK2bJWh6sp2X4QOe-Ng7oRTrZaWOVrw'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:33:31.222 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'select CostCenterID from ADM_CostCenterDef with(nolock) where SysColumnName=''BillNo'' and IsVisible=1 and SysTableName=''ACC_DocDetails'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:33:31.238 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTAzLDEiLCJuYmYiOjE3NjMwMjgwNTUsImV4cCI6MTc2MzA1Njg1NSwiaWF0IjoxNzYzMDI4MDU1fQ.0HTaw4flBBHsHK2bJWh6sp2X4QOe-Ng7oRTrZaWOVrw'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:33:31.441 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'DECLARE @AccountingDate FLOAT,@AsOnDate FLOAT
SET @AccountingDate=CONVERT(FLOAT,CONVERT(DATETIME,''04 Jun 2015'')) SET @AsOnDate=CONVERT(FLOAT,CONVERT(DATETIME,''13 Nov 2025''))SELECT A.AccountID,A.AccountName FROM ACC_Accounts A with(nolock),(select T.AccountID GTID from ACC_Accounts T with(nolock),ACC_Accounts GT1 with(nolock) where T.lft BETWEEN GT1.lft AND GT1.rgt AND GT1.AccountID=13055 group by T.AccountID) AS GTP  WHERE A.Depth>0 AND A.AccountID=GTP.GTID AND A.AccountTypeID IN (6,7) ORDER BY A.AccountName SELECT * from ( SELECT CONVERT(DATETIME,B.DocDate) DocDate,B.AccountID,B.AdjAmount+ISNULL((SELECT SUM(CB.AdjAmount) FROM COM_Billwise CB with(nolock) WHERE CB.RefDocNo=B.DocNo AND CB.AccountID=B.AccountID AND CB.RefDocSeqNo=B.DocSeqNo AND CB.IsNewReference=0 AND CB.DocDate<=@AsOnDate AND  DocType<>14 AND DocType<>19 AND (SELECT top(1) 1 FROM ACC_DocDetails ACC WITH(NOLOCK) WHERE ACC.VoucherNo=CB.DocNo and (StatusID=369 or StatusID=429))=1),0) AdjAmount FROM COM_Billwise B WITH(NOLOCK) INNER JOIN ACC_Accounts A ON A.AccountID=B.AccountID AND A.AccountTypeID IN (6,7),(select T.AccountID GTID from ACC_Accounts T with(nolock),ACC_Accounts GT1 with(nolock) where T.lft BETWEEN GT1.lft AND GT1.rgt AND GT1.AccountID=13055 group by T.AccountID) AS GTP  WHERE B.IsNewReference=1 AND B.DocDate<=@AsOnDate AND DocType<>14 AND DocType<>19 AND (SELECT top(1) 1 FROM ACC_DocDetails ACC WITH(NOLOCK) WHERE ACC.VoucherNo=B.DocNo and (StatusID=369 or StatusID=429))=1 AND B.AccountID=GTP.GTID ) AS T WHERE abs(AdjAmount)>0.099'
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:33:31.456 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTAzLDEiLCJuYmYiOjE3NjMwMjgwNTUsImV4cCI6MTc2MzA1Njg1NSwiaWF0IjoxNzYzMDI4MDU1fQ.0HTaw4flBBHsHK2bJWh6sp2X4QOe-Ng7oRTrZaWOVrw'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:33:31.503 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'select CostCenterID from ADM_CostCenterDef with(nolock) where SysColumnName=''BillNo'' and IsVisible=1 and SysTableName=''ACC_DocDetails'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:33:31.503 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTAzLDEiLCJuYmYiOjE3NjMwMjgwNTUsImV4cCI6MTc2MzA1Njg1NSwiaWF0IjoxNzYzMDI4MDU1fQ.0HTaw4flBBHsHK2bJWh6sp2X4QOe-Ng7oRTrZaWOVrw'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:33:31.503 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'DECLARE @AccountingDate FLOAT,@AsOnDate FLOAT
SET @AccountingDate=CONVERT(FLOAT,CONVERT(DATETIME,''04 Jun 2015'')) SET @AsOnDate=CONVERT(FLOAT,CONVERT(DATETIME,''13 Nov 2025''))SELECT A.AccountID,A.AccountName FROM ACC_Accounts A with(nolock),(select T.AccountID GTID from ACC_Accounts T with(nolock),ACC_Accounts GT1 with(nolock) where T.lft BETWEEN GT1.lft AND GT1.rgt AND GT1.AccountID= group by T.AccountID) AS GTP  WHERE A.Depth>0 AND A.AccountID=GTP.GTID AND A.AccountTypeID IN (6,7) ORDER BY A.AccountName SELECT * from ( SELECT CONVERT(DATETIME,B.DocDate) DocDate,B.AccountID,B.AdjAmount+ISNULL((SELECT SUM(CB.AdjAmount) FROM COM_Billwise CB with(nolock) WHERE CB.RefDocNo=B.DocNo AND CB.AccountID=B.AccountID AND CB.RefDocSeqNo=B.DocSeqNo AND CB.IsNewReference=0 AND CB.DocDate<=@AsOnDate AND  DocType<>14 AND DocType<>19 AND (SELECT top(1) 1 FROM ACC_DocDetails ACC WITH(NOLOCK) WHERE ACC.VoucherNo=CB.DocNo and (StatusID=369 or StatusID=429))=1),0) AdjAmount FROM COM_Billwise B WITH(NOLOCK) INNER JOIN ACC_Accounts A ON A.AccountID=B.AccountID AND A.AccountTypeID IN (6,7),(select T.AccountID GTID from ACC_Accounts T with(nolock),ACC_Accounts GT1 with(nolock) where T.lft BETWEEN GT1.lft AND GT1.rgt AND GT1.AccountID= group by T.AccountID) AS GTP  WHERE B.IsNewReference=1 AND B.DocDate<=@AsOnDate AND DocType<>14 AND DocType<>19 AND (SELECT top(1) 1 FROM ACC_DocDetails ACC WITH(NOLOCK) WHERE ACC.VoucherNo=B.DocNo and (StatusID=369 or StatusID=429))=1 AND B.AccountID=GTP.GTID ) AS T WHERE abs(AdjAmount)>0.099'
 ,1
 ,1
 message=Incorrect syntax near the keyword 'group'.
[System: 192.168.1.79] DEBUG | 11-13-2025 15:33:31.503 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'DECLARE @AccountingDate FLOAT,@AsOnDate FLOAT
SET @AccountingDate=CONVERT(FLOAT,CONVERT(DATETIME,''04 Jun 2015'')) SET @AsOnDate=CONVERT(FLOAT,CONVERT(DATETIME,''13 Nov 2025''))SELECT A.AccountID,A.AccountName FROM ACC_Accounts A with(nolock),(select T.AccountID GTID from ACC_Accounts T with(nolock),ACC_Accounts GT1 with(nolock) where T.lft BETWEEN GT1.lft AND GT1.rgt AND GT1.AccountID= group by T.AccountID) AS GTP  WHERE A.Depth>0 AND A.AccountID=GTP.GTID AND A.AccountTypeID IN (6,7) ORDER BY A.AccountName SELECT * from ( SELECT CONVERT(DATETIME,B.DocDate) DocDate,B.AccountID,B.AdjAmount+ISNULL((SELECT SUM(CB.AdjAmount) FROM COM_Billwise CB with(nolock) WHERE CB.RefDocNo=B.DocNo AND CB.AccountID=B.AccountID AND CB.RefDocSeqNo=B.DocSeqNo AND CB.IsNewReference=0 AND CB.DocDate<=@AsOnDate AND  DocType<>14 AND DocType<>19 AND (SELECT top(1) 1 FROM ACC_DocDetails ACC WITH(NOLOCK) WHERE ACC.VoucherNo=CB.DocNo and (StatusID=369 or StatusID=429))=1),0) AdjAmount FROM COM_Billwise B WITH(NOLOCK) INNER JOIN ACC_Accounts A ON A.AccountID=B.AccountID AND A.AccountTypeID IN (6,7),(select T.AccountID GTID from ACC_Accounts T with(nolock),ACC_Accounts GT1 with(nolock) where T.lft BETWEEN GT1.lft AND GT1.rgt AND GT1.AccountID= group by T.AccountID) AS GTP  WHERE B.IsNewReference=1 AND B.DocDate<=@AsOnDate AND DocType<>14 AND DocType<>19 AND (SELECT top(1) 1 FROM ACC_DocDetails ACC WITH(NOLOCK) WHERE ACC.VoucherNo=B.DocNo and (StatusID=369 or StatusID=429))=1 AND B.AccountID=GTP.GTID ) AS T WHERE abs(AdjAmount)>0.099'
 ,1
 ,1
 message=Problem in processing your request, Please contact administrator.
[System: 192.168.1.79] INFO | 11-13-2025 15:33:31.519 | OnStartup: Logger Instance Created Successfully
[System: 192.168.1.79] INFO | 11-13-2025 15:33:31.519 | OnStartup: Application Starting...
[System: 192.168.1.79] ERROR | 11-13-2025 15:33:31.519 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSetParameters :
 'DECLARE @AccountingDate FLOAT,@AsOnDate FLOAT
SET @AccountingDate=CONVERT(FLOAT,CONVERT(DATETIME,''04 Jun 2015'')) SET @AsOnDate=CONVERT(FLOAT,CONVERT(DATETIME,''13 Nov 2025''))SELECT A.AccountID,A.AccountName FROM ACC_Accounts A with(nolock),(select T.AccountID GTID from ACC_Accounts T with(nolock),ACC_Accounts GT1 with(nolock) where T.lft BETWEEN GT1.lft AND GT1.rgt AND GT1.AccountID= group by T.AccountID) AS GTP  WHERE A.Depth>0 AND A.AccountID=GTP.GTID AND A.AccountTypeID IN (6,7) ORDER BY A.AccountName SELECT * from ( SELECT CONVERT(DATETIME,B.DocDate) DocDate,B.AccountID,B.AdjAmount+ISNULL((SELECT SUM(CB.AdjAmount) FROM COM_Billwise CB with(nolock) WHERE CB.RefDocNo=B.DocNo AND CB.AccountID=B.AccountID AND CB.RefDocSeqNo=B.DocSeqNo AND CB.IsNewReference=0 AND CB.DocDate<=@AsOnDate AND  DocType<>14 AND DocType<>19 AND (SELECT top(1) 1 FROM ACC_DocDetails ACC WITH(NOLOCK) WHERE ACC.VoucherNo=CB.DocNo and (StatusID=369 or StatusID=429))=1),0) AdjAmount FROM COM_Billwise B WITH(NOLOCK) INNER JOIN ACC_Accounts A ON A.AccountID=B.AccountID AND A.AccountTypeID IN (6,7),(select T.AccountID GTID from ACC_Accounts T with(nolock),ACC_Accounts GT1 with(nolock) where T.lft BETWEEN GT1.lft AND GT1.rgt AND GT1.AccountID= group by T.AccountID) AS GTP  WHERE B.IsNewReference=1 AND B.DocDate<=@AsOnDate AND DocType<>14 AND DocType<>19 AND (SELECT top(1) 1 FROM ACC_DocDetails ACC WITH(NOLOCK) WHERE ACC.VoucherNo=B.DocNo and (StatusID=369 or StatusID=429))=1 AND B.AccountID=GTP.GTID ) AS T WHERE abs(AdjAmount)>0.099'
 ,1
 ,1|Incorrect syntax near the keyword 'group'.
[System: 192.168.1.79] DEBUG | 11-13-2025 15:33:31.519 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTAzLDEiLCJuYmYiOjE3NjMwMjgwNTUsImV4cCI6MTc2MzA1Njg1NSwiaWF0IjoxNzYzMDI4MDU1fQ.0HTaw4flBBHsHK2bJWh6sp2X4QOe-Ng7oRTrZaWOVrw'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 11-13-2025 15:33:36.928 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 11-13-2025 15:33:36.928 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODAzNSwiZXhwIjoxNzYzMDU2ODM1LCJpYXQiOjE3NjMwMjgwMzV9.c4J7sRklVhN3hJ2g3cvBPJ5nYIFJIc4QnnPUO71wek4'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 11-13-2025 15:33:39.695 | General Service|:: CompanyIndex:326 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.77] DEBUG | 11-13-2025 15:33:39.695 | General Service|:: CompanyIndex:326 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMzI2LDEiLCJuYmYiOjE3NjMwMjY1OTIsImV4cCI6MTc2MzA1NTM5MiwiaWF0IjoxNzYzMDI2NTkyfQ.8Y5az9OV6b5kMlVwowet8ECaMfD5D_XA3Uq65skYL8E'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 11-13-2025 15:33:39.867 | General Service|:: CompanyIndex:326 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 11-13-2025 15:33:39.867 | General Service|:: CompanyIndex:326 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMzI2LDEiLCJuYmYiOjE3NjMwMjY1OTIsImV4cCI6MTc2MzA1NTM5MiwiaWF0IjoxNzYzMDI2NTkyfQ.8Y5az9OV6b5kMlVwowet8ECaMfD5D_XA3Uq65skYL8E'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:34:00.854 | General Service|:: CompanyIndex:0 SpName: spADM_GetClientUserDetails2C 
 'admin'
 ,1
 ,0
[System: 192.168.1.79] DEBUG | 11-13-2025 15:34:00.901 | General Service|:: CompanyIndex:0 SpName: spADM_UserLoginCheck 
 2
 ,'admin'
 ,0
 ,'192.168.1.79'
 ,'192.168.1.79'
 ,''
 ,'Web'
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:34:10.445 | General Service|:: CompanyIndex:103 SpName: spADM_GetClientUserDetails 
 'admin'
 ,1
 ,'26.8.6'
 ,0
[System: 192.168.1.79] DEBUG | 11-13-2025 15:34:10.523 | General Service|:: CompanyIndex:0 SpName: spADM_UserLoginCheck 
 2
 ,'admin'
 ,103
 ,'192.168.1.79'
 ,'192.168.1.79'
 ,''
 ,'Web'
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:34:10.523 | General Service|:: CompanyIndex:0 SpName: spADM_Login 
 1
 ,''
 ,''
 ,''
 ,''
 ,''
 ,103
[System: 192.168.1.79] DEBUG | 11-13-2025 15:34:10.539 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'select Value from ADM_GlobalPreferences with (nolock) where name =''EnableReLogin'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:34:10.539 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTAzLDEiLCJuYmYiOjE3NjMwMjgyNTAsImV4cCI6MTc2MzA1NzA1MCwiaWF0IjoxNzYzMDI4MjUwfQ.5VFrg8f_0BSZw2McmqeZ92viY4v7nfM5d455zkGKh4w'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:34:10.570 | General Service|:: CompanyIndex:0 SpName: spADM_Login 
 4
 ,''
 ,''
 ,''
 ,'declare @Cnt int,@ExpiredGUID nvarchar(50),@AllowSession int,@GUID nvarchar(50),@CurrDate float,@UserID INT,@Instances INT,@InstancesExists INT,@LCDBIndex int
set @CurrDate= convert(float,dateadd(minute,-21,getdate()))
set @AllowSession=0
set @GUID=''a389655e-6441-4451-a287-077f94ff847e''
set @LCDBIndex=0
select top 1 @UserID=UserID,@Instances=InstanceCount from ADM_Users with(nolock) where UserName=''admin''
if exists(select [GUID] from ADM_Login with(nolock) where [GUID]=@GUID)
begin
	update ADM_Login 
	set LastAccessTime=convert(float,getdate()),UserID=@UserID
	where [GUID]=@GUID
    set @AllowSession=1
end
else
begin
	select @Cnt=count(*) from ADM_Login with(nolock) where LCDBIndex=@LCDBIndex and [GUID]!=''ACCESSRIGHTS'' and AP =''WEB''
    if(@Cnt<100)
		set @AllowSession=1
	else
	begin
		select top 1 @ExpiredGUID=[GUID] from ADM_Login with(nolock)
		where [GUID]!=''ACCESSRIGHTS'' and LCDBIndex=@LCDBIndex and LastAccessTime<@CurrDate  and AP =''WEB''
        order by LastAccessTime asc
		if @ExpiredGUID is not null
		begin
			delete from ADM_Login where [GUID]=@ExpiredGUID
			set @AllowSession=1
		end
	end
	if @AllowSession=1
	begin
        select @InstancesExists=COUNT(*) from ADM_Login with(nolock)
		where [GUID]!=''ACCESSRIGHTS'' and LCDBIndex=@LCDBIndex and LastAccessTime>=@CurrDate and UserID=@UserID and AP =''WEB''
		if(@Instances!=0 and @Instances<=@InstancesExists)
			set @AllowSession=2
		else
		    INSERT INTO ADM_Login([GUID],[SysName],IPAddress,[Status],LoginTime,LastAccessTime,AccessRights,UserID,DBIndex,LCDBIndex,AP)
		    VALUES(@GUID,''WEB'',''192.168.1.79'',1,convert(float,getdate()),convert(float,getdate()),null,@UserID,103,@LCDBIndex, ''WEB'')
	end
end

select @AllowSession AllowSession,@Instances Instances,@InstancesExists InstancesExists
'
 ,''
 ,0
[System: 192.168.1.79] DEBUG | 11-13-2025 15:34:10.586 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTAzLDEiLCJuYmYiOjE3NjMwMjgyNTAsImV4cCI6MTc2MzA1NzA1MCwiaWF0IjoxNzYzMDI4MjUwfQ.5VFrg8f_0BSZw2McmqeZ92viY4v7nfM5d455zkGKh4w'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:34:10.617 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'SELECT (SELECT COUNT(*) FROM COM_Location L WITH(NOLOCK) JOIN COM_Status S WITH(NOLOCK) ON S.StatusID=L.StatusID WHERE L.IsGroup=0 AND S.[Status]=''Active'') ML
,(SELECT COUNT(*) FROM ADM_Features WITH(NOLOCK) WHERE ((FeatureID>50000 AND FeatureID<=50050) OR FeatureID>=51000) AND IsEnabled=1) MD
,(SELECT ISNULL(COUNT(*),0) FROM ADM_RevenUReports WITH(NOLOCK) WHERE IsGroup=0 AND ReportID>10000 AND StaticReportType IN (0,-1)) MR'
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:34:10.617 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTAzLDEiLCJuYmYiOjE3NjMwMjgyNTAsImV4cCI6MTc2MzA1NzA1MCwiaWF0IjoxNzYzMDI4MjUwfQ.5VFrg8f_0BSZw2McmqeZ92viY4v7nfM5d455zkGKh4w'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:34:16.980 | General Service|:: CompanyIndex:103 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.79] DEBUG | 11-13-2025 15:34:16.980 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTAzLDEiLCJuYmYiOjE3NjMwMjgyNTAsImV4cCI6MTc2MzA1NzA1MCwiaWF0IjoxNzYzMDI4MjUwfQ.5VFrg8f_0BSZw2McmqeZ92viY4v7nfM5d455zkGKh4w'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:34:17.121 | General Service|:: CompanyIndex:103 SpName: spADM_GetRibbonView 
 1
 ,1
 ,1
 ,1
 ,0
 ,''
[System: 192.168.1.79] DEBUG | 11-13-2025 15:34:17.121 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTAzLDEiLCJuYmYiOjE3NjMwMjgyNTAsImV4cCI6MTc2MzA1NzA1MCwiaWF0IjoxNzYzMDI4MjUwfQ.5VFrg8f_0BSZw2McmqeZ92viY4v7nfM5d455zkGKh4w'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:34:17.277 | General Service|:: CompanyIndex:103 SpName: spRPT_GetReport 
 2
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:34:17.277 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTAzLDEiLCJuYmYiOjE3NjMwMjgyNTAsImV4cCI6MTc2MzA1NzA1MCwiaWF0IjoxNzYzMDI4MjUwfQ.5VFrg8f_0BSZw2McmqeZ92viY4v7nfM5d455zkGKh4w'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:34:17.293 | General Service|:: CompanyIndex:103 SpName: spADM_GetDashBoard 
 2
 ,0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:34:17.309 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTAzLDEiLCJuYmYiOjE3NjMwMjgyNTAsImV4cCI6MTc2MzA1NzA1MCwiaWF0IjoxNzYzMDI4MjUwfQ.5VFrg8f_0BSZw2McmqeZ92viY4v7nfM5d455zkGKh4w'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:34:17.324 | General Service|:: CompanyIndex:103 SpName: spCOM_ConfigValues 
 1
 ,'LandingDocs'
 ,'1'
[System: 192.168.1.79] DEBUG | 11-13-2025 15:34:17.324 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTAzLDEiLCJuYmYiOjE3NjMwMjgyNTAsImV4cCI6MTc2MzA1NzA1MCwiaWF0IjoxNzYzMDI4MjUwfQ.5VFrg8f_0BSZw2McmqeZ92viY4v7nfM5d455zkGKh4w'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:34:17.387 | General Service|:: CompanyIndex:103 SpName: spCOM_GetFavorites 
 'GETLIST0'
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:34:17.387 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTAzLDEiLCJuYmYiOjE3NjMwMjgyNTAsImV4cCI6MTc2MzA1NzA1MCwiaWF0IjoxNzYzMDI4MjUwfQ.5VFrg8f_0BSZw2McmqeZ92viY4v7nfM5d455zkGKh4w'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:34:17.402 | General Service|:: CompanyIndex:103 SpName: spADM_GetAllListViewsDef 
 1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:34:17.402 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTAzLDEiLCJuYmYiOjE3NjMwMjgyNTAsImV4cCI6MTc2MzA1NzA1MCwiaWF0IjoxNzYzMDI4MjUwfQ.5VFrg8f_0BSZw2McmqeZ92viY4v7nfM5d455zkGKh4w'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:34:17.512 | General Service|:: CompanyIndex:103 SpName: spADM_GetAllListViewsDef 
 1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:34:17.512 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTAzLDEiLCJuYmYiOjE3NjMwMjgyNTAsImV4cCI6MTc2MzA1NzA1MCwiaWF0IjoxNzYzMDI4MjUwfQ.5VFrg8f_0BSZw2McmqeZ92viY4v7nfM5d455zkGKh4w'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:34:17.621 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'Select CostCenterID,CostCenterColID,CostCenterName,SysTableName,UserColumnName,SysColumnName,ISNULL(UserDefaultValue,'''') UserDefaultValue
From AdM_CostCenterDef WITH(NOLOCK)
Where SysColumnName IN(''CreditAccount'',''DebitAccount'',''ProductID'') 
AND CostCenterID>40000 AND CostCenterID<50000 

SELECT * FROM ADM_Features WITH(NOLOCK) '
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:34:17.621 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTAzLDEiLCJuYmYiOjE3NjMwMjgyNTAsImV4cCI6MTc2MzA1NzA1MCwiaWF0IjoxNzYzMDI4MjUwfQ.5VFrg8f_0BSZw2McmqeZ92viY4v7nfM5d455zkGKh4w'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:34:17.668 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 '  SELECT * FROM PAY_PayrollPreferences WITH(NOLOCK) '
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:34:17.668 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTAzLDEiLCJuYmYiOjE3NjMwMjgyNTAsImV4cCI6MTc2MzA1NzA1MCwiaWF0IjoxNzYzMDI4MjUwfQ.5VFrg8f_0BSZw2McmqeZ92viY4v7nfM5d455zkGKh4w'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:34:17.715 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 '  --0
                                Select * FROM COM_CC50051 WITH(NOLOCK) WHERE IsGroup=0 AND LoginUserID=''admin''
                                --1                                
                                Select * FROM COM_CC50051 WITH(NOLOCK) WHERE RptManager IN (Select NodeID FROM COM_CC50051 WITH(NOLOCK) WHERE IsGroup=0 AND LoginUserID=''admin'')
                                UNION ALL
                                Select * FROM COM_CC50051 WITH(NOLOCK) WHERE RptManager IN 
                                (
	                                Select NodeID FROM COM_CC50051 WITH(NOLOCK) 
	                                WHERE IsGroup=0 AND LoginUserID IN
	                                (
	                                SELECT fe.LoginUserID
	                                FROM INV_DocDetails a WITH(NOLOCK) 
	                                JOIN COM_DocCCData b WITH(NOLOCK) ON b.InvDocDetailsID=a.InvDocDetailsID
	                                JOIN COM_DocNumData c WITH(NOLOCK) ON c.InvDocDetailsID=a.InvDocDetailsID
	                                JOIN COM_DocTextData d WITH(NOLOCK) ON d.InvDocDetailsID=a.InvDocDetailsID
	                                JOIN COM_CC50051 fe WITH(NOLOCK) on fe.NodeID=b.dcCCNID51
	                                JOIN COM_CC50051 te WITH(NOLOCK) on CONVERT(NVARCHAR,te.NodeID)=d.dcAlpha1
	                                WHERE a.CostCenterID=40098 and a.StatusID=369 AND d.dcAlpha3=''Temporary''
	                                AND te.LoginUserID=''admin'' 
	                                AND ISDATE(d.dcAlpha4)=1 AND ISDATE(d.dcAlpha5)=1 
	                                AND CONVERT(DATETIME,''13 Nov 2025'') BETWEEN CONVERT(DATETIME,d.dcAlpha4) AND CONVERT(DATETIME,d.dcAlpha5)
	                                )
                                )
                                --2
                                Select * FROM ADM_USERS WITH(NOLOCK) WHERE USERID=1
                                --3
                                Select * FROM COM_CostCenterCostCenterMap WITH(NOLOCK) WHERE ParentCostCenterID=7 AND ParentNodeID=1
                                --4                                
                                Select * FROM COM_CostCenterCostCenterMap WITH(NOLOCK) WHERE ParentCostCenterID=7 AND ParentNodeID=1
                                AND CostCenterID IN(Select ColumnCostCenterID From ADM_CostCenterDef Where CostCenterID=50051 AND IsColumnInUse=1 AND SysColumnName LIKE ''CCNID%'')
                                --5
                                Select * from COM_Files WITH(NOLOCK) WHERE FeatureID=50051 AND FeaturePK IN (Select NodeID FROM COM_CC50051 WITH(NOLOCK) WHERE IsGroup=0 AND LoginUserID=''admin'')                         
'
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:34:17.730 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTAzLDEiLCJuYmYiOjE3NjMwMjgyNTAsImV4cCI6MTc2MzA1NzA1MCwiaWF0IjoxNzYzMDI4MjUwfQ.5VFrg8f_0BSZw2McmqeZ92viY4v7nfM5d455zkGKh4w'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:34:17.934 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:34:17.949 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTAzLDEiLCJuYmYiOjE3NjMwMjgyNTAsImV4cCI6MTc2MzA1NzA1MCwiaWF0IjoxNzYzMDI4MjUwfQ.5VFrg8f_0BSZw2McmqeZ92viY4v7nfM5d455zkGKh4w'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:34:18.121 | General Service|:: CompanyIndex:103 SpName: spADM_GetDashBoard 
 1
 ,39
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:34:18.121 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTAzLDEiLCJuYmYiOjE3NjMwMjgyNTAsImV4cCI6MTc2MzA1NzA1MCwiaWF0IjoxNzYzMDI4MjUwfQ.5VFrg8f_0BSZw2McmqeZ92viY4v7nfM5d455zkGKh4w'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:34:18.230 | General Service|:: CompanyIndex:103 SpName: spCOM_GetFavorites 
 'VIEW'
 ,557
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:34:18.230 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTAzLDEiLCJuYmYiOjE3NjMwMjgyNTAsImV4cCI6MTc2MzA1NzA1MCwiaWF0IjoxNzYzMDI4MjUwfQ.5VFrg8f_0BSZw2McmqeZ92viY4v7nfM5d455zkGKh4w'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:34:18.262 | General Service|:: CompanyIndex:103 SpName: spCOM_GetFavorites 
 'VIEW'
 ,566
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:34:18.262 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTAzLDEiLCJuYmYiOjE3NjMwMjgyNTAsImV4cCI6MTc2MzA1NzA1MCwiaWF0IjoxNzYzMDI4MjUwfQ.5VFrg8f_0BSZw2McmqeZ92viY4v7nfM5d455zkGKh4w'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:34:22.352 | General Service|:: CompanyIndex:103 SpName: spADM_GetCostCenterGridViewList 
 200
 ,1
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:34:22.352 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTAzLDEiLCJuYmYiOjE3NjMwMjgyNTAsImV4cCI6MTc2MzA1NzA1MCwiaWF0IjoxNzYzMDI4MjUwfQ.5VFrg8f_0BSZw2McmqeZ92viY4v7nfM5d455zkGKh4w'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:34:22.415 | General Service|:: CompanyIndex:103 SpName: spCom_GetCostCenterSummary 
 267
 ,-1
 ,1000
 ,''
 ,''
 ,''
 ,0
 ,'13-Nov-2025'
 ,NULL
 ,''
 ,1
 ,1
 ,0
 ,0
 ,False
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:34:22.430 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTAzLDEiLCJuYmYiOjE3NjMwMjgyNTAsImV4cCI6MTc2MzA1NzA1MCwiaWF0IjoxNzYzMDI4MjUwfQ.5VFrg8f_0BSZw2McmqeZ92viY4v7nfM5d455zkGKh4w'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:34:24.165 | General Service|:: CompanyIndex:103 SpName: spCom_GetCostCenterQuickViewDefn 
 200
 ,'20334'
 ,200
 ,1
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:34:24.181 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTAzLDEiLCJuYmYiOjE3NjMwMjgyNTAsImV4cCI6MTc2MzA1NzA1MCwiaWF0IjoxNzYzMDI4MjUwfQ.5VFrg8f_0BSZw2McmqeZ92viY4v7nfM5d455zkGKh4w'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:34:25.853 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=20334'
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:34:25.853 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTAzLDEiLCJuYmYiOjE3NjMwMjgyNTAsImV4cCI6MTc2MzA1NzA1MCwiaWF0IjoxNzYzMDI4MjUwfQ.5VFrg8f_0BSZw2McmqeZ92viY4v7nfM5d455zkGKh4w'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:34:25.869 | General Service|:: CompanyIndex:103 SpName: spRPT_GetReport 
 0
 ,20334
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:34:25.885 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTAzLDEiLCJuYmYiOjE3NjMwMjgyNTAsImV4cCI6MTc2MzA1NzA1MCwiaWF0IjoxNzYzMDI4MjUwfQ.5VFrg8f_0BSZw2McmqeZ92viY4v7nfM5d455zkGKh4w'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:34:26.010 | General Service|:: CompanyIndex:103 SpName: spRPT_GetReportCategoryandField 
 -1
 ,0
 ,1
 ,0
 ,'1'
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:34:26.010 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTAzLDEiLCJuYmYiOjE3NjMwMjgyNTAsImV4cCI6MTc2MzA1NzA1MCwiaWF0IjoxNzYzMDI4MjUwfQ.5VFrg8f_0BSZw2McmqeZ92viY4v7nfM5d455zkGKh4w'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:34:26.056 | General Service|:: CompanyIndex:103 SpName: spRPT_GetReportFields 
 40001
 ,0
 ,'1'
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:34:26.056 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTAzLDEiLCJuYmYiOjE3NjMwMjgyNTAsImV4cCI6MTc2MzA1NzA1MCwiaWF0IjoxNzYzMDI4MjUwfQ.5VFrg8f_0BSZw2McmqeZ92viY4v7nfM5d455zkGKh4w'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:34:26.072 | General Service|:: CompanyIndex:103 SpName: spDOC_GetVPTPrintCopies 
 4
 ,50
 ,20334
 ,2
 ,4
 ,'View~admin'
 ,'admin'
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:34:26.088 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTAzLDEiLCJuYmYiOjE3NjMwMjgyNTAsImV4cCI6MTc2MzA1NzA1MCwiaWF0IjoxNzYzMDI4MjUwfQ.5VFrg8f_0BSZw2McmqeZ92viY4v7nfM5d455zkGKh4w'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:34:26.103 | General Service|:: CompanyIndex:103 SpName: spRPT_GetReportFields 
 400
 ,0
 ,'1'
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:34:26.103 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTAzLDEiLCJuYmYiOjE3NjMwMjgyNTAsImV4cCI6MTc2MzA1NzA1MCwiaWF0IjoxNzYzMDI4MjUwfQ.5VFrg8f_0BSZw2McmqeZ92viY4v7nfM5d455zkGKh4w'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:34:26.150 | General Service|:: CompanyIndex:103 SpName: spRPT_GetReportFields 
 40001
 ,0
 ,'1'
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:34:26.150 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTAzLDEiLCJuYmYiOjE3NjMwMjgyNTAsImV4cCI6MTc2MzA1NzA1MCwiaWF0IjoxNzYzMDI4MjUwfQ.5VFrg8f_0BSZw2McmqeZ92viY4v7nfM5d455zkGKh4w'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:34:26.197 | General Service|:: CompanyIndex:103 SpName: spRPT_GetReportFields 
 2
 ,0
 ,'1'
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:34:26.197 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTAzLDEiLCJuYmYiOjE3NjMwMjgyNTAsImV4cCI6MTc2MzA1NzA1MCwiaWF0IjoxNzYzMDI4MjUwfQ.5VFrg8f_0BSZw2McmqeZ92viY4v7nfM5d455zkGKh4w'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:34:26.228 | General Service|:: CompanyIndex:103 SpName: spRPT_GetReportFields 
 110
 ,0
 ,'1'
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:34:26.228 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTAzLDEiLCJuYmYiOjE3NjMwMjgyNTAsImV4cCI6MTc2MzA1NzA1MCwiaWF0IjoxNzYzMDI4MjUwfQ.5VFrg8f_0BSZw2McmqeZ92viY4v7nfM5d455zkGKh4w'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:34:26.260 | General Service|:: CompanyIndex:103 SpName: spRPT_GetReportFields 
 50009
 ,0
 ,'1'
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:34:26.260 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTAzLDEiLCJuYmYiOjE3NjMwMjgyNTAsImV4cCI6MTc2MzA1NzA1MCwiaWF0IjoxNzYzMDI4MjUwfQ.5VFrg8f_0BSZw2McmqeZ92viY4v7nfM5d455zkGKh4w'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:34:26.306 | General Service|:: CompanyIndex:103 SpName: spADM_GetCostCenterGridViewList 
 2
 ,1
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:34:26.306 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTAzLDEiLCJuYmYiOjE3NjMwMjgyNTAsImV4cCI6MTc2MzA1NzA1MCwiaWF0IjoxNzYzMDI4MjUwfQ.5VFrg8f_0BSZw2McmqeZ92viY4v7nfM5d455zkGKh4w'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 11-13-2025 15:34:26.541 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 11-13-2025 15:34:26.541 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODA4NSwiZXhwIjoxNzYzMDU2ODg1LCJpYXQiOjE3NjMwMjgwODV9.eRlSN9oidYho75qh1pF4jTpIB4tw3U5pKBPBFSOfZsw'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:34:26.634 | General Service|:: CompanyIndex:103 SpName: spCom_GetCostCenterSummary 
 126
 ,-1
 ,1000
 ,'#DEBITORCREDITORTEE#'
 ,''
 ,''
 ,0
 ,'13-Nov-2025'
 ,NULL
 ,''
 ,1
 ,1
 ,0
 ,0
 ,False
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:34:26.634 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTAzLDEiLCJuYmYiOjE3NjMwMjgyNTAsImV4cCI6MTc2MzA1NzA1MCwiaWF0IjoxNzYzMDI4MjUwfQ.5VFrg8f_0BSZw2McmqeZ92viY4v7nfM5d455zkGKh4w'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:34:26.697 | General Service|:: CompanyIndex:103 SpName: spADM_GetLocationRole 
 50002
 ,1
 message=Saved Succesfully
[System: 192.168.1.79] DEBUG | 11-13-2025 15:34:26.697 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTAzLDEiLCJuYmYiOjE3NjMwMjgyNTAsImV4cCI6MTc2MzA1NzA1MCwiaWF0IjoxNzYzMDI4MjUwfQ.5VFrg8f_0BSZw2McmqeZ92viY4v7nfM5d455zkGKh4w'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:34:26.713 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'SELECT CL.RESOURCEDATA Name FROM [ADM_Features] ADF WITH(NOLOCK),COM_LANGUAGERESOURCES CL WITH(NOLOCK) WHERE ADF.RESOURCEID=CL.RESOURCEID AND ADF.FeatureID=50002 AND CL.LanguageID=1'
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:34:26.713 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTAzLDEiLCJuYmYiOjE3NjMwMjgyNTAsImV4cCI6MTc2MzA1NzA1MCwiaWF0IjoxNzYzMDI4MjUwfQ.5VFrg8f_0BSZw2McmqeZ92viY4v7nfM5d455zkGKh4w'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:34:26.728 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'SELECT CurrencyID,Name,ExchangeRate FROM COM_Currency WITH(NOLOCK)'
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:34:26.728 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTAzLDEiLCJuYmYiOjE3NjMwMjgyNTAsImV4cCI6MTc2MzA1NzA1MCwiaWF0IjoxNzYzMDI4MjUwfQ.5VFrg8f_0BSZw2McmqeZ92viY4v7nfM5d455zkGKh4w'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:34:26.744 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'SELECT CurrencyID,Name,ExchangeRate FROM COM_Currency WITH(NOLOCK)'
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:34:26.744 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTAzLDEiLCJuYmYiOjE3NjMwMjgyNTAsImV4cCI6MTc2MzA1NzA1MCwiaWF0IjoxNzYzMDI4MjUwfQ.5VFrg8f_0BSZw2McmqeZ92viY4v7nfM5d455zkGKh4w'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:34:30.325 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'SELECT DefaultPreferences FROM ADM_RevenUReports with(nolock) WHERE ReportID=13'
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:34:30.325 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTAzLDEiLCJuYmYiOjE3NjMwMjgyNTAsImV4cCI6MTc2MzA1NzA1MCwiaWF0IjoxNzYzMDI4MjUwfQ.5VFrg8f_0BSZw2McmqeZ92viY4v7nfM5d455zkGKh4w'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:34:30.356 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'select CostCenterID from ADM_CostCenterDef with(nolock) where SysColumnName=''BillNo'' and IsVisible=1 and SysTableName=''ACC_DocDetails'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:34:30.356 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTAzLDEiLCJuYmYiOjE3NjMwMjgyNTAsImV4cCI6MTc2MzA1NzA1MCwiaWF0IjoxNzYzMDI4MjUwfQ.5VFrg8f_0BSZw2McmqeZ92viY4v7nfM5d455zkGKh4w'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:34:31.601 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'DECLARE @To FLOAT
SET @To=CONVERT(FLOAT,CONVERT(DATETIME,''13 Nov 2025''))
SELECT *,case when Amount>0 then 1 else 0 end AmtOrder FROM (	SELECT A.AccountID,B.DocSeqNo,A.AccountName AS AccountName,A.AccountID AS AccountName_ID,CONVERT(DATETIME,B.DocDate) DocDate,CONVERT(DATETIME,B.DocDueDate) DueDate,CONVERT(DATETIME,B.DocDate) VoucherDate,B.DocNo,AdjAmount+ISNULL((select sum(CB.AdjAmount) from COM_Billwise CB with(nolock) where CB.AccountID=B.AccountID AND CB.DocNo=B.DocNo and CB.IsNewReference=0 AND CB.DocSeqNo=B.DocSeqNo AND CB.RefDocDate>@To),0) Amount,AdjAmount BillAmount,case when B.DocType=16 then (SELECT TOP 1 BillNo FROM ACC_DocDetails WITH(NOLOCK) WHERE B.DocNo=VoucherNo and B.DocSeqNo=DocSeqNo) else (SELECT TOP 1 BillNo FROM INV_DocDetails WITH(NOLOCK) WHERE B.DocNo=VoucherNo) end BillNo,case when B.DocType=16 then (SELECT TOP 1 CONVERT(DATETIME, BillDate) FROM ACC_DocDetails WITH(NOLOCK) WHERE B.DocNo=VoucherNo and B.DocSeqNo=DocSeqNo) else (SELECT TOP 1 CONVERT(DATETIME, BillDate) FROM INV_DocDetails WITH(NOLOCK) WHERE B.DocNo=VoucherNo) end BillDate,C50002.Name AS Location,    
(SELECT SUM(AdjAmount) Adjusted FROM COM_Billwise CB WITH(NOLOCK) WHERE IsNewReference=0 AND CB.DocDate<=@To AND CB.AccountID=B.AccountID AND CB.RefDocNo=B.DocNo AND  CB.DocType<>14 AND CB.DocType<>19 AND (SELECT top(1) 1 FROM ACC_DocDetails ACC WITH(NOLOCK) WHERE ACC.VoucherNo=CB.DocNo and (StatusID=369 or StatusID=429))=1 AND CB.RefDocSeqNo=B.DocSeqNo) Adjusted,CASE WHEN DType.IsInventory=0 THEN
  (SELECT MAX(DOC.CommonNarration) FROM Acc_DocDetails DOC WITH(NOLOCK) WHERE DOC.VoucherNo=B.DocNo and Doc.DocSeqNo=B.DocSeqNo)
  ELSE
  (SELECT MAX(DOC.CommonNarration) FROM INV_DocDetails DOC WITH(NOLOCK) WHERE DOC.VoucherNo=B.DocNo)  END AS C337e1c8baa3b4ac0b3a2682d9d88fc63,CASE WHEN DType.IsInventory=0 THEN NULL ELSE
(STUFF((SELECT distinct '',''+VoucherNo FROM INV_DocDetails with(nolock) WHERE InvDocDetailsID IN 
(select LinkedInvDocDetailsID from INV_DocDetails with(nolock) WHERE VoucherNo=B.DocNo and LinkedInvDocDetailsID>0) FOR XML PATH('''')),1,1,'''')) END AS Cdf3533811555463c963af67849b1c17e,T1.Code Cd6882cec5b8a44fcb0c1be3976f3c29a,T1.Name C02934645c08a4ed3a3dfbd5a980f1761,T2.Name Cda273e47f52943fcae5bf08cc75c5512,CASE WHEN DType.IsInventory=0 THEN
  (SELECT MAX(convert(datetime,DOC.DueDate)) FROM Acc_DocDetails DOC WITH(NOLOCK) WHERE DOC.VoucherNo=B.DocNo and Doc.DocSeqNo=B.DocSeqNo)
  ELSE
  (SELECT MAX(convert(datetime,DOC.DueDate)) FROM INV_DocDetails DOC WITH(NOLOCK) WHERE DOC.VoucherNo=B.DocNo)  END AS C9256e42b51c94b18b0cfb15615481c0d,(B.DocDueDate-B.DocDate) CreditDays
,@To-B.DocDate OverDue
,B.DocType,(SELECT TOP 1 ACC.StatusID FROM ACC_DocDetails ACC with(nolock) WHERE ACC.VoucherNo=B.DocNo) StatusID 
FROM COM_Billwise B with(nolock) INNER JOIN ACC_Accounts A WITH(NOLOCK) ON B.AccountID=A.AccountID     
INNER JOIN COM_Location AS C50002 with(nolock) ON B.dcCCNID2 = C50002.NodeID  INNER JOIN (SELECT DocumentType DocType1,IsInventory FROM ADM_DocumentTypes with(nolock) Group By DocumentType,IsInventory) AS DType ON  DType.DocType1=B.DocType  INNER JOIN COM_CC50009 AS T1 with(nolock) ON T1.NodeID=B.dcCCNID9 INNER JOIN COM_Salesman AS T2 with(nolock) ON T2.NodeID=B.dcCCNID5 WHERE B.IsNewReference=1 AND B.DocDate<=@To AND A.AccountTypeID IN (6,7) ) AS T  WHERE (Adjusted IS NULL OR abs(Amount+Adjusted)>0.099) AND DocType<>14 AND DocType<>19 and (StatusID=369 or StatusID=429)
 UNION ALL  SELECT *,case when Amount>0 then 1 else 0 end AmtOrder FROM (	SELECT A.AccountID,B.DocSeqNo,A.AccountName AS AccountName,A.AccountID AS AccountName_ID,CONVERT(DATETIME,B.DocDate) DocDate,CONVERT(DATETIME,B.DocDueDate) DueDate,CONVERT(DATETIME,B.DocDate) VoucherDate,B.DocNo,B.AdjAmount Amount,B.AdjAmount BillAmount,case when B.DocType=16 then (SELECT TOP 1 BillNo FROM ACC_DocDetails WITH(NOLOCK) WHERE B.DocNo=VoucherNo and B.DocSeqNo=DocSeqNo) else (SELECT TOP 1 BillNo FROM INV_DocDetails WITH(NOLOCK) WHERE B.DocNo=VoucherNo) end BillNo,case when B.DocType=16 then (SELECT TOP 1 CONVERT(DATETIME, BillDate) FROM ACC_DocDetails WITH(NOLOCK) WHERE B.DocNo=VoucherNo and B.DocSeqNo=DocSeqNo) else (SELECT TOP 1 CONVERT(DATETIME, BillDate) FROM INV_DocDetails WITH(NOLOCK) WHERE B.DocNo=VoucherNo) end BillDate,C50002.Name AS Location,    
(SELECT SUM(CB.AdjAmount) Adjusted FROM COM_Billwise CB WITH(NOLOCK) WHERE IsNewReference=0 AND CB.DocDate<=@To AND CB.AccountID=B.AccountID AND CB.RefDocNo=B.DocNo AND  CB.DocType<>14 AND CB.DocType<>19 AND (SELECT top(1) 1 FROM ACC_DocDetails ACC WITH(NOLOCK) WHERE ACC.VoucherNo=CB.DocNo and (StatusID=369 or StatusID=429))=1 AND CB.RefDocSeqNo=B.DocSeqNo) Adjusted,CASE WHEN DType.IsInventory=0 THEN
  (SELECT MAX(DOC.CommonNarration) FROM Acc_DocDetails DOC WITH(NOLOCK) WHERE DOC.VoucherNo=B.DocNo and Doc.DocSeqNo=B.DocSeqNo)
  ELSE
  (SELECT MAX(DOC.CommonNarration) FROM INV_DocDetails DOC WITH(NOLOCK) WHERE DOC.VoucherNo=B.DocNo)  END AS C337e1c8baa3b4ac0b3a2682d9d88fc63,CASE WHEN DType.IsInventory=0 THEN NULL ELSE
(STUFF((SELECT distinct '',''+VoucherNo FROM INV_DocDetails with(nolock) WHERE InvDocDetailsID IN 
(select LinkedInvDocDetailsID from INV_DocDetails with(nolock) WHERE VoucherNo=B.DocNo and LinkedInvDocDetailsID>0) FOR XML PATH('''')),1,1,'''')) END AS Cdf3533811555463c963af67849b1c17e,T1.Code Cd6882cec5b8a44fcb0c1be3976f3c29a,T1.Name C02934645c08a4ed3a3dfbd5a980f1761,T2.Name Cda273e47f52943fcae5bf08cc75c5512,CASE WHEN DType.IsInventory=0 THEN
  (SELECT MAX(convert(datetime,DOC.DueDate)) FROM Acc_DocDetails DOC WITH(NOLOCK) WHERE DOC.VoucherNo=B.DocNo and Doc.DocSeqNo=B.DocSeqNo)
  ELSE
  (SELECT MAX(convert(datetime,DOC.DueDate)) FROM INV_DocDetails DOC WITH(NOLOCK) WHERE DOC.VoucherNo=B.DocNo)  END AS C9256e42b51c94b18b0cfb15615481c0d,(B.DocDueDate-B.DocDate) CreditDays
 ,@To-B.DocDate OverDue
 ,B.DocType,(SELECT TOP 1 ACC.StatusID FROM ACC_DocDetails ACC with(nolock) WHERE ACC.VoucherNo=B.DocNo) StatusID 
 FROM COM_Billwise B with(nolock) INNER JOIN ACC_Accounts A WITH(NOLOCK) ON B.AccountID=A.AccountID     
 INNER JOIN COM_Location AS C50002 with(nolock) ON B.dcCCNID2 = C50002.NodeID  INNER JOIN (SELECT DocumentType DocType1,IsInventory FROM ADM_DocumentTypes with(nolock) Group By DocumentType,IsInventory) AS DType ON  DType.DocType1=B.DocType  INNER JOIN COM_CC50009 AS T1 with(nolock) ON T1.NodeID=B.dcCCNID9 INNER JOIN COM_Salesman AS T2 with(nolock) ON T2.NodeID=B.dcCCNID5 
 LEFT JOIN COM_Billwise BCB with(nolock) ON BCB.AccountID=B.AccountID AND BCB.DocNo=B.DocNo and BCB.IsNewReference=1 AND BCB.DocSeqNo=B.DocSeqNo  WHERE B.IsNewReference=0 AND B.DocDate<=@To AND B.RefDocDate>@To AND BCB.AccountID is null AND A.AccountTypeID IN (6,7) ) AS T  WHERE (Adjusted IS NULL OR abs(Amount+Adjusted)>0.099) AND DocType<>14 AND DocType<>19 and (StatusID=369 or StatusID=429) ORDER BY AccountName,DocDate,AmtOrder,DocNo'
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:34:31.617 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTAzLDEiLCJuYmYiOjE3NjMwMjgyNTAsImV4cCI6MTc2MzA1NzA1MCwiaWF0IjoxNzYzMDI4MjUwfQ.5VFrg8f_0BSZw2McmqeZ92viY4v7nfM5d455zkGKh4w'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:34:32.008 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'select CostCenterID from ADM_CostCenterDef with(nolock) where SysColumnName=''BillNo'' and IsVisible=1 and SysTableName=''ACC_DocDetails'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:34:32.008 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTAzLDEiLCJuYmYiOjE3NjMwMjgyNTAsImV4cCI6MTc2MzA1NzA1MCwiaWF0IjoxNzYzMDI4MjUwfQ.5VFrg8f_0BSZw2McmqeZ92viY4v7nfM5d455zkGKh4w'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:34:32.195 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'DECLARE @AccountingDate FLOAT,@AsOnDate FLOAT
SET @AccountingDate=CONVERT(FLOAT,CONVERT(DATETIME,''04 Jun 2015'')) SET @AsOnDate=CONVERT(FLOAT,CONVERT(DATETIME,''13 Nov 2025''))SELECT A.AccountID,A.AccountName FROM ACC_Accounts A with(nolock) WHERE A.Depth>0 AND A.AccountTypeID IN (6,7) ORDER BY A.AccountName SELECT * from ( SELECT CONVERT(DATETIME,B.DocDate) DocDate,B.AccountID,B.AdjAmount+ISNULL((SELECT SUM(CB.AdjAmount) FROM COM_Billwise CB with(nolock) WHERE CB.RefDocNo=B.DocNo AND CB.AccountID=B.AccountID AND CB.RefDocSeqNo=B.DocSeqNo AND CB.IsNewReference=0 AND CB.DocDate<=@AsOnDate AND  DocType<>14 AND DocType<>19 AND (SELECT top(1) 1 FROM ACC_DocDetails ACC WITH(NOLOCK) WHERE ACC.VoucherNo=CB.DocNo and (StatusID=369 or StatusID=429))=1),0) AdjAmount FROM COM_Billwise B WITH(NOLOCK) INNER JOIN ACC_Accounts A ON A.AccountID=B.AccountID AND A.AccountTypeID IN (6,7) WHERE B.IsNewReference=1 AND B.DocDate<=@AsOnDate AND DocType<>14 AND DocType<>19 AND (SELECT top(1) 1 FROM ACC_DocDetails ACC WITH(NOLOCK) WHERE ACC.VoucherNo=B.DocNo and (StatusID=369 or StatusID=429))=1 ) AS T WHERE abs(AdjAmount)>0.099'
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:34:32.195 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTAzLDEiLCJuYmYiOjE3NjMwMjgyNTAsImV4cCI6MTc2MzA1NzA1MCwiaWF0IjoxNzYzMDI4MjUwfQ.5VFrg8f_0BSZw2McmqeZ92viY4v7nfM5d455zkGKh4w'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:34:32.273 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'select CostCenterID from ADM_CostCenterDef with(nolock) where SysColumnName=''BillNo'' and IsVisible=1 and SysTableName=''ACC_DocDetails'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:34:32.273 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTAzLDEiLCJuYmYiOjE3NjMwMjgyNTAsImV4cCI6MTc2MzA1NzA1MCwiaWF0IjoxNzYzMDI4MjUwfQ.5VFrg8f_0BSZw2McmqeZ92viY4v7nfM5d455zkGKh4w'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:34:32.398 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'DECLARE @AccountingDate FLOAT,@AsOnDate FLOAT
SET @AccountingDate=CONVERT(FLOAT,CONVERT(DATETIME,''04 Jun 2015'')) SET @AsOnDate=CONVERT(FLOAT,CONVERT(DATETIME,''13 Nov 2025''))SELECT A.AccountID,A.AccountName FROM ACC_Accounts A with(nolock) WHERE A.Depth>0 AND A.AccountTypeID IN (6,7) ORDER BY A.AccountName SELECT * from ( SELECT CONVERT(DATETIME,B.DocDate) DocDate,B.AccountID,B.AdjAmount+ISNULL((SELECT SUM(CB.AdjAmount) FROM COM_Billwise CB with(nolock) WHERE CB.RefDocNo=B.DocNo AND CB.AccountID=B.AccountID AND CB.RefDocSeqNo=B.DocSeqNo AND CB.IsNewReference=0 AND CB.DocDate<=@AsOnDate AND  DocType<>14 AND DocType<>19 AND (SELECT top(1) 1 FROM ACC_DocDetails ACC WITH(NOLOCK) WHERE ACC.VoucherNo=CB.DocNo and (StatusID=369 or StatusID=429))=1),0) AdjAmount FROM COM_Billwise B WITH(NOLOCK) INNER JOIN ACC_Accounts A ON A.AccountID=B.AccountID AND A.AccountTypeID IN (6,7) WHERE B.IsNewReference=1 AND B.DocDate<=@AsOnDate AND DocType<>14 AND DocType<>19 AND (SELECT top(1) 1 FROM ACC_DocDetails ACC WITH(NOLOCK) WHERE ACC.VoucherNo=B.DocNo and (StatusID=369 or StatusID=429))=1 ) AS T WHERE abs(AdjAmount)>0.099'
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:34:32.398 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTAzLDEiLCJuYmYiOjE3NjMwMjgyNTAsImV4cCI6MTc2MzA1NzA1MCwiaWF0IjoxNzYzMDI4MjUwfQ.5VFrg8f_0BSZw2McmqeZ92viY4v7nfM5d455zkGKh4w'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 11-13-2025 15:34:36.933 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 11-13-2025 15:34:36.948 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODAzNSwiZXhwIjoxNzYzMDU2ODM1LCJpYXQiOjE3NjMwMjgwMzV9.c4J7sRklVhN3hJ2g3cvBPJ5nYIFJIc4QnnPUO71wek4'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 11-13-2025 15:35:02.712 | General Service|:: CompanyIndex:0 SpName: spADM_GetClientUserDetails2C 
 'admin'
 ,1
 ,0
[System: 192.168.1.73] DEBUG | 11-13-2025 15:35:02.775 | General Service|:: CompanyIndex:0 SpName: spADM_UserLoginCheck 
 2
 ,'admin'
 ,0
 ,'192.168.1.73'
 ,'192.168.1.73'
 ,''
 ,'Web'
 ,1
[System: 192.168.1.73] DEBUG | 11-13-2025 15:35:06.425 | General Service|:: CompanyIndex:7 SpName: spADM_GetClientUserDetails 
 'admin'
 ,1
 ,'26.8.6'
 ,0
[System: 192.168.1.73] DEBUG | 11-13-2025 15:35:06.518 | General Service|:: CompanyIndex:0 SpName: spADM_UserLoginCheck 
 2
 ,'admin'
 ,7
 ,'192.168.1.73'
 ,'192.168.1.73'
 ,''
 ,'Web'
 ,1
[System: 192.168.1.73] DEBUG | 11-13-2025 15:35:06.534 | General Service|:: CompanyIndex:0 SpName: spADM_Login 
 1
 ,''
 ,''
 ,''
 ,''
 ,''
 ,7
[System: 192.168.1.73] DEBUG | 11-13-2025 15:35:06.550 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select Value from ADM_GlobalPreferences with (nolock) where name =''EnableReLogin'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 11-13-2025 15:35:06.550 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzYzMDI4MzA2LCJleHAiOjE3NjMwNTcxMDYsImlhdCI6MTc2MzAyODMwNn0.9MTBuB63fLAG0fQGvThybvQM9mQbqpwWlrfMtHu1T_M'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 11-13-2025 15:35:06.581 | General Service|:: CompanyIndex:0 SpName: spADM_Login 
 4
 ,''
 ,''
 ,''
 ,'declare @Cnt int,@ExpiredGUID nvarchar(50),@AllowSession int,@GUID nvarchar(50),@CurrDate float,@UserID INT,@Instances INT,@InstancesExists INT,@LCDBIndex int
set @CurrDate= convert(float,dateadd(minute,-21,getdate()))
set @AllowSession=0
set @GUID=''deccf859-a497-461c-85c6-f1886f35dfb8''
set @LCDBIndex=0
select top 1 @UserID=UserID,@Instances=InstanceCount from ADM_Users with(nolock) where UserName=''admin''
if exists(select [GUID] from ADM_Login with(nolock) where [GUID]=@GUID)
begin
	update ADM_Login 
	set LastAccessTime=convert(float,getdate()),UserID=@UserID
	where [GUID]=@GUID
    set @AllowSession=1
end
else
begin
	select @Cnt=count(*) from ADM_Login with(nolock) where LCDBIndex=@LCDBIndex and [GUID]!=''ACCESSRIGHTS'' and AP =''WEB''
    if(@Cnt<100)
		set @AllowSession=1
	else
	begin
		select top 1 @ExpiredGUID=[GUID] from ADM_Login with(nolock)
		where [GUID]!=''ACCESSRIGHTS'' and LCDBIndex=@LCDBIndex and LastAccessTime<@CurrDate  and AP =''WEB''
        order by LastAccessTime asc
		if @ExpiredGUID is not null
		begin
			delete from ADM_Login where [GUID]=@ExpiredGUID
			set @AllowSession=1
		end
	end
	if @AllowSession=1
	begin
        select @InstancesExists=COUNT(*) from ADM_Login with(nolock)
		where [GUID]!=''ACCESSRIGHTS'' and LCDBIndex=@LCDBIndex and LastAccessTime>=@CurrDate and UserID=@UserID and AP =''WEB''
		if(@Instances!=0 and @Instances<=@InstancesExists)
			set @AllowSession=2
		else
		    INSERT INTO ADM_Login([GUID],[SysName],IPAddress,[Status],LoginTime,LastAccessTime,AccessRights,UserID,DBIndex,LCDBIndex,AP)
		    VALUES(@GUID,''WEB'',''192.168.1.73'',1,convert(float,getdate()),convert(float,getdate()),null,@UserID,7,@LCDBIndex, ''WEB'')
	end
end

select @AllowSession AllowSession,@Instances Instances,@InstancesExists InstancesExists
'
 ,''
 ,0
[System: 192.168.1.73] DEBUG | 11-13-2025 15:35:06.581 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzYzMDI4MzA2LCJleHAiOjE3NjMwNTcxMDYsImlhdCI6MTc2MzAyODMwNn0.9MTBuB63fLAG0fQGvThybvQM9mQbqpwWlrfMtHu1T_M'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 11-13-2025 15:35:06.612 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'SELECT (SELECT COUNT(*) FROM COM_Location L WITH(NOLOCK) JOIN COM_Status S WITH(NOLOCK) ON S.StatusID=L.StatusID WHERE L.IsGroup=0 AND S.[Status]=''Active'') ML
,(SELECT COUNT(*) FROM ADM_Features WITH(NOLOCK) WHERE ((FeatureID>50000 AND FeatureID<=50050) OR FeatureID>=51000) AND IsEnabled=1) MD
,(SELECT ISNULL(COUNT(*),0) FROM ADM_RevenUReports WITH(NOLOCK) WHERE IsGroup=0 AND ReportID>10000 AND StaticReportType IN (0,-1)) MR'
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 11-13-2025 15:35:06.612 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzYzMDI4MzA2LCJleHAiOjE3NjMwNTcxMDYsImlhdCI6MTc2MzAyODMwNn0.9MTBuB63fLAG0fQGvThybvQM9mQbqpwWlrfMtHu1T_M'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 11-13-2025 15:35:10.173 | General Service|:: CompanyIndex:7 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.73] DEBUG | 11-13-2025 15:35:10.173 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzYzMDI4MzA2LCJleHAiOjE3NjMwNTcxMDYsImlhdCI6MTc2MzAyODMwNn0.9MTBuB63fLAG0fQGvThybvQM9mQbqpwWlrfMtHu1T_M'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 11-13-2025 15:35:10.454 | General Service|:: CompanyIndex:7 SpName: spADM_GetRibbonView 
 1
 ,1
 ,1
 ,1
 ,0
 ,''
[System: 192.168.1.73] DEBUG | 11-13-2025 15:35:10.454 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzYzMDI4MzA2LCJleHAiOjE3NjMwNTcxMDYsImlhdCI6MTc2MzAyODMwNn0.9MTBuB63fLAG0fQGvThybvQM9mQbqpwWlrfMtHu1T_M'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 11-13-2025 15:35:10.735 | General Service|:: CompanyIndex:7 SpName: spRPT_GetReport 
 2
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.73] DEBUG | 11-13-2025 15:35:10.735 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzYzMDI4MzA2LCJleHAiOjE3NjMwNTcxMDYsImlhdCI6MTc2MzAyODMwNn0.9MTBuB63fLAG0fQGvThybvQM9mQbqpwWlrfMtHu1T_M'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 11-13-2025 15:35:10.751 | General Service|:: CompanyIndex:7 SpName: spADM_GetDashBoard 
 2
 ,0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.73] DEBUG | 11-13-2025 15:35:10.751 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzYzMDI4MzA2LCJleHAiOjE3NjMwNTcxMDYsImlhdCI6MTc2MzAyODMwNn0.9MTBuB63fLAG0fQGvThybvQM9mQbqpwWlrfMtHu1T_M'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 11-13-2025 15:35:10.766 | General Service|:: CompanyIndex:7 SpName: spCOM_ConfigValues 
 1
 ,'LandingDocs'
 ,'1'
[System: 192.168.1.73] DEBUG | 11-13-2025 15:35:10.782 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzYzMDI4MzA2LCJleHAiOjE3NjMwNTcxMDYsImlhdCI6MTc2MzAyODMwNn0.9MTBuB63fLAG0fQGvThybvQM9mQbqpwWlrfMtHu1T_M'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 11-13-2025 15:35:10.844 | General Service|:: CompanyIndex:7 SpName: spADM_GetAllListViewsDef 
 1
 ,1
[System: 192.168.1.73] DEBUG | 11-13-2025 15:35:10.844 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzYzMDI4MzA2LCJleHAiOjE3NjMwNTcxMDYsImlhdCI6MTc2MzAyODMwNn0.9MTBuB63fLAG0fQGvThybvQM9mQbqpwWlrfMtHu1T_M'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 11-13-2025 15:35:10.969 | General Service|:: CompanyIndex:7 SpName: spADM_GetAllListViewsDef 
 1
 ,1
[System: 192.168.1.73] DEBUG | 11-13-2025 15:35:10.969 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzYzMDI4MzA2LCJleHAiOjE3NjMwNTcxMDYsImlhdCI6MTc2MzAyODMwNn0.9MTBuB63fLAG0fQGvThybvQM9mQbqpwWlrfMtHu1T_M'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 11-13-2025 15:35:11.126 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'Select CostCenterID,CostCenterColID,CostCenterName,SysTableName,UserColumnName,SysColumnName,ISNULL(UserDefaultValue,'''') UserDefaultValue
From AdM_CostCenterDef WITH(NOLOCK)
Where SysColumnName IN(''CreditAccount'',''DebitAccount'',''ProductID'') 
AND CostCenterID>40000 AND CostCenterID<50000 

SELECT * FROM ADM_Features WITH(NOLOCK) '
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 11-13-2025 15:35:11.126 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzYzMDI4MzA2LCJleHAiOjE3NjMwNTcxMDYsImlhdCI6MTc2MzAyODMwNn0.9MTBuB63fLAG0fQGvThybvQM9mQbqpwWlrfMtHu1T_M'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 11-13-2025 15:35:11.173 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 '  SELECT * FROM PAY_PayrollPreferences WITH(NOLOCK) '
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 11-13-2025 15:35:11.188 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzYzMDI4MzA2LCJleHAiOjE3NjMwNTcxMDYsImlhdCI6MTc2MzAyODMwNn0.9MTBuB63fLAG0fQGvThybvQM9mQbqpwWlrfMtHu1T_M'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 11-13-2025 15:35:11.251 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 '  --0
                                Select * FROM COM_CC50051 WITH(NOLOCK) WHERE IsGroup=0 AND LoginUserID=''admin''
                                --1                                
                                Select * FROM COM_CC50051 WITH(NOLOCK) WHERE RptManager IN (Select NodeID FROM COM_CC50051 WITH(NOLOCK) WHERE IsGroup=0 AND LoginUserID=''admin'')
                                UNION ALL
                                Select * FROM COM_CC50051 WITH(NOLOCK) WHERE RptManager IN 
                                (
	                                Select NodeID FROM COM_CC50051 WITH(NOLOCK) 
	                                WHERE IsGroup=0 AND LoginUserID IN
	                                (
	                                SELECT fe.LoginUserID
	                                FROM INV_DocDetails a WITH(NOLOCK) 
	                                JOIN COM_DocCCData b WITH(NOLOCK) ON b.InvDocDetailsID=a.InvDocDetailsID
	                                JOIN COM_DocNumData c WITH(NOLOCK) ON c.InvDocDetailsID=a.InvDocDetailsID
	                                JOIN COM_DocTextData d WITH(NOLOCK) ON d.InvDocDetailsID=a.InvDocDetailsID
	                                JOIN COM_CC50051 fe WITH(NOLOCK) on fe.NodeID=b.dcCCNID51
	                                JOIN COM_CC50051 te WITH(NOLOCK) on CONVERT(NVARCHAR,te.NodeID)=d.dcAlpha1
	                                WHERE a.CostCenterID=40098 and a.StatusID=369 AND d.dcAlpha3=''Temporary''
	                                AND te.LoginUserID=''admin'' 
	                                AND ISDATE(d.dcAlpha4)=1 AND ISDATE(d.dcAlpha5)=1 
	                                AND CONVERT(DATETIME,''13 Nov 2025'') BETWEEN CONVERT(DATETIME,d.dcAlpha4) AND CONVERT(DATETIME,d.dcAlpha5)
	                                )
                                )
                                --2
                                Select * FROM ADM_USERS WITH(NOLOCK) WHERE USERID=1
                                --3
                                Select * FROM COM_CostCenterCostCenterMap WITH(NOLOCK) WHERE ParentCostCenterID=7 AND ParentNodeID=1
                                --4                                
                                Select * FROM COM_CostCenterCostCenterMap WITH(NOLOCK) WHERE ParentCostCenterID=7 AND ParentNodeID=1
                                AND CostCenterID IN(Select ColumnCostCenterID From ADM_CostCenterDef Where CostCenterID=50051 AND IsColumnInUse=1 AND SysColumnName LIKE ''CCNID%'')
                                --5
                                Select * from COM_Files WITH(NOLOCK) WHERE FeatureID=50051 AND FeaturePK IN (Select NodeID FROM COM_CC50051 WITH(NOLOCK) WHERE IsGroup=0 AND LoginUserID=''admin'')                         
'
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 11-13-2025 15:35:11.266 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzYzMDI4MzA2LCJleHAiOjE3NjMwNTcxMDYsImlhdCI6MTc2MzAyODMwNn0.9MTBuB63fLAG0fQGvThybvQM9mQbqpwWlrfMtHu1T_M'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 11-13-2025 15:35:11.282 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'UPDATE C SET STATUSID=CASE WHEN ResignType=''Resigned'' THEN 302 WHEN ResignType=''Terminated With Cause'' THEN 303 WHEN ResignType=''Terminated Without Cause'' THEN 304 END 
                            FROM COM_CC50051 C WITH(NOLOCK)
                            WHERE ResignStatus=''Posted'' AND ResignType NOT IN(''Pending'',''Rejected'') 
                            AND DOResign IS NOT NULL AND DORelieve IS NOT NULL
                            AND STATUSID NOT IN(302,303,304)
                            AND DATEDIFF(D,GETDATE(),DORelieve)<0'
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 11-13-2025 15:35:11.282 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzYzMDI4MzA2LCJleHAiOjE3NjMwNTcxMDYsImlhdCI6MTc2MzAyODMwNn0.9MTBuB63fLAG0fQGvThybvQM9mQbqpwWlrfMtHu1T_M'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 11-13-2025 15:35:11.423 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 11-13-2025 15:35:11.423 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzYzMDI4MzA2LCJleHAiOjE3NjMwNTcxMDYsImlhdCI6MTc2MzAyODMwNn0.9MTBuB63fLAG0fQGvThybvQM9mQbqpwWlrfMtHu1T_M'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 11-13-2025 15:35:11.673 | General Service|:: CompanyIndex:7 SpName: spCOM_GetFavorites 
 'GETLIST0'
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.73] DEBUG | 11-13-2025 15:35:11.673 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzYzMDI4MzA2LCJleHAiOjE3NjMwNTcxMDYsImlhdCI6MTc2MzAyODMwNn0.9MTBuB63fLAG0fQGvThybvQM9mQbqpwWlrfMtHu1T_M'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 11-13-2025 15:35:11.688 | General Service|:: CompanyIndex:7 SpName: spCOM_GetFavorites 
 'VIEW'
 ,26546
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.73] DEBUG | 11-13-2025 15:35:11.704 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzYzMDI4MzA2LCJleHAiOjE3NjMwNTcxMDYsImlhdCI6MTc2MzAyODMwNn0.9MTBuB63fLAG0fQGvThybvQM9mQbqpwWlrfMtHu1T_M'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 11-13-2025 15:35:26.449 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 11-13-2025 15:35:26.449 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODA4NSwiZXhwIjoxNzYzMDU2ODg1LCJpYXQiOjE3NjMwMjgwODV9.eRlSN9oidYho75qh1pF4jTpIB4tw3U5pKBPBFSOfZsw'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 11-13-2025 15:35:35.878 | General Service|:: CompanyIndex:53 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.77] DEBUG | 11-13-2025 15:35:35.878 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODAzNSwiZXhwIjoxNzYzMDU2ODM1LCJpYXQiOjE3NjMwMjgwMzV9.c4J7sRklVhN3hJ2g3cvBPJ5nYIFJIc4QnnPUO71wek4'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 11-13-2025 15:35:36.925 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 11-13-2025 15:35:36.925 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODAzNSwiZXhwIjoxNzYzMDU2ODM1LCJpYXQiOjE3NjMwMjgwMzV9.c4J7sRklVhN3hJ2g3cvBPJ5nYIFJIc4QnnPUO71wek4'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 11-13-2025 15:36:00.047 | General Service|:: CompanyIndex:326 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 11-13-2025 15:36:00.047 | General Service|:: CompanyIndex:326 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMzI2LDEiLCJuYmYiOjE3NjMwMjY1OTIsImV4cCI6MTc2MzA1NTM5MiwiaWF0IjoxNzYzMDI2NTkyfQ.8Y5az9OV6b5kMlVwowet8ECaMfD5D_XA3Uq65skYL8E'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 11-13-2025 15:36:11.665 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 11-13-2025 15:36:11.665 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzYzMDI4MzA2LCJleHAiOjE3NjMwNTcxMDYsImlhdCI6MTc2MzAyODMwNn0.9MTBuB63fLAG0fQGvThybvQM9mQbqpwWlrfMtHu1T_M'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 11-13-2025 15:36:25.429 | General Service|:: CompanyIndex:53 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.73] DEBUG | 11-13-2025 15:36:25.429 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODA4NSwiZXhwIjoxNzYzMDU2ODg1LCJpYXQiOjE3NjMwMjgwODV9.eRlSN9oidYho75qh1pF4jTpIB4tw3U5pKBPBFSOfZsw'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 11-13-2025 15:36:26.445 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 11-13-2025 15:36:26.461 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODA4NSwiZXhwIjoxNzYzMDU2ODg1LCJpYXQiOjE3NjMwMjgwODV9.eRlSN9oidYho75qh1pF4jTpIB4tw3U5pKBPBFSOfZsw'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 11-13-2025 15:36:35.203 | General Service|:: CompanyIndex:0 SpName: spADM_GetClientUserDetails2C 
 'admin'
 ,1
 ,0
[System: 192.168.1.99] DEBUG | 11-13-2025 15:36:35.265 | General Service|:: CompanyIndex:0 SpName: spADM_UserLoginCheck 
 2
 ,'admin'
 ,0
 ,'192.168.1.99'
 ,'192.168.1.99'
 ,''
 ,'Web'
 ,1
[System: 192.168.1.77] DEBUG | 11-13-2025 15:36:37.899 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 11-13-2025 15:36:37.899 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODAzNSwiZXhwIjoxNzYzMDU2ODM1LCJpYXQiOjE3NjMwMjgwMzV9.c4J7sRklVhN3hJ2g3cvBPJ5nYIFJIc4QnnPUO71wek4'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 11-13-2025 15:36:39.930 | General Service|:: CompanyIndex:53 SpName: spADM_GetClientUserDetails 
 'admin'
 ,1
 ,'26.8.6'
 ,0
[System: 192.168.1.99] DEBUG | 11-13-2025 15:36:40.008 | General Service|:: CompanyIndex:0 SpName: spADM_UserLoginCheck 
 2
 ,'admin'
 ,53
 ,'192.168.1.99'
 ,'192.168.1.99'
 ,''
 ,'Web'
 ,1
[System: 192.168.1.99] DEBUG | 11-13-2025 15:36:40.024 | General Service|:: CompanyIndex:0 SpName: spADM_Login 
 1
 ,''
 ,''
 ,''
 ,''
 ,''
 ,53
[System: 192.168.1.99] DEBUG | 11-13-2025 15:36:40.024 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select Value from ADM_GlobalPreferences with (nolock) where name =''EnableReLogin'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 11-13-2025 15:36:40.040 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODM5OSwiZXhwIjoxNzYzMDU3MTk5LCJpYXQiOjE3NjMwMjgzOTl9.4C8ThE_cHIEfIjZ1CBanPjBKQvRYmWCFqKDKuEFYDd8'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 11-13-2025 15:36:40.071 | General Service|:: CompanyIndex:0 SpName: spADM_Login 
 4
 ,''
 ,''
 ,''
 ,'declare @Cnt int,@ExpiredGUID nvarchar(50),@AllowSession int,@GUID nvarchar(50),@CurrDate float,@UserID INT,@Instances INT,@InstancesExists INT,@LCDBIndex int
set @CurrDate= convert(float,dateadd(minute,-21,getdate()))
set @AllowSession=0
set @GUID=''852ad5f8-4312-489a-838e-104bb1b2aba8''
set @LCDBIndex=0
select top 1 @UserID=UserID,@Instances=InstanceCount from ADM_Users with(nolock) where UserName=''admin''
if exists(select [GUID] from ADM_Login with(nolock) where [GUID]=@GUID)
begin
	update ADM_Login 
	set LastAccessTime=convert(float,getdate()),UserID=@UserID
	where [GUID]=@GUID
    set @AllowSession=1
end
else
begin
	select @Cnt=count(*) from ADM_Login with(nolock) where LCDBIndex=@LCDBIndex and [GUID]!=''ACCESSRIGHTS'' and AP =''WEB''
    if(@Cnt<100)
		set @AllowSession=1
	else
	begin
		select top 1 @ExpiredGUID=[GUID] from ADM_Login with(nolock)
		where [GUID]!=''ACCESSRIGHTS'' and LCDBIndex=@LCDBIndex and LastAccessTime<@CurrDate  and AP =''WEB''
        order by LastAccessTime asc
		if @ExpiredGUID is not null
		begin
			delete from ADM_Login where [GUID]=@ExpiredGUID
			set @AllowSession=1
		end
	end
	if @AllowSession=1
	begin
        select @InstancesExists=COUNT(*) from ADM_Login with(nolock)
		where [GUID]!=''ACCESSRIGHTS'' and LCDBIndex=@LCDBIndex and LastAccessTime>=@CurrDate and UserID=@UserID and AP =''WEB''
		if(@Instances!=0 and @Instances<=@InstancesExists)
			set @AllowSession=2
		else
		    INSERT INTO ADM_Login([GUID],[SysName],IPAddress,[Status],LoginTime,LastAccessTime,AccessRights,UserID,DBIndex,LCDBIndex,AP)
		    VALUES(@GUID,''WEB'',''192.168.1.99'',1,convert(float,getdate()),convert(float,getdate()),null,@UserID,53,@LCDBIndex, ''WEB'')
	end
end

select @AllowSession AllowSession,@Instances Instances,@InstancesExists InstancesExists
'
 ,''
 ,0
[System: 192.168.1.99] DEBUG | 11-13-2025 15:36:40.071 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODM5OSwiZXhwIjoxNzYzMDU3MTk5LCJpYXQiOjE3NjMwMjgzOTl9.4C8ThE_cHIEfIjZ1CBanPjBKQvRYmWCFqKDKuEFYDd8'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 11-13-2025 15:36:40.118 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT (SELECT COUNT(*) FROM COM_Location L WITH(NOLOCK) JOIN COM_Status S WITH(NOLOCK) ON S.StatusID=L.StatusID WHERE L.IsGroup=0 AND S.[Status]=''Active'') ML
,(SELECT COUNT(*) FROM ADM_Features WITH(NOLOCK) WHERE ((FeatureID>50000 AND FeatureID<=50050) OR FeatureID>=51000) AND IsEnabled=1) MD
,(SELECT ISNULL(COUNT(*),0) FROM ADM_RevenUReports WITH(NOLOCK) WHERE IsGroup=0 AND ReportID>10000 AND StaticReportType IN (0,-1)) MR'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 11-13-2025 15:36:40.133 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODM5OSwiZXhwIjoxNzYzMDU3MTk5LCJpYXQiOjE3NjMwMjgzOTl9.4C8ThE_cHIEfIjZ1CBanPjBKQvRYmWCFqKDKuEFYDd8'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 11-13-2025 15:36:40.149 | General Service|:: CompanyIndex:53 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.99] DEBUG | 11-13-2025 15:36:40.149 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODM5OSwiZXhwIjoxNzYzMDU3MTk5LCJpYXQiOjE3NjMwMjgzOTl9.4C8ThE_cHIEfIjZ1CBanPjBKQvRYmWCFqKDKuEFYDd8'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 11-13-2025 15:36:40.383 | General Service|:: CompanyIndex:53 SpName: spADM_GetRibbonView 
 1
 ,1
 ,1
 ,1
 ,0
 ,''
[System: 192.168.1.99] DEBUG | 11-13-2025 15:36:40.383 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODM5OSwiZXhwIjoxNzYzMDU3MTk5LCJpYXQiOjE3NjMwMjgzOTl9.4C8ThE_cHIEfIjZ1CBanPjBKQvRYmWCFqKDKuEFYDd8'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 11-13-2025 15:36:40.618 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 2
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 11-13-2025 15:36:40.633 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODM5OSwiZXhwIjoxNzYzMDU3MTk5LCJpYXQiOjE3NjMwMjgzOTl9.4C8ThE_cHIEfIjZ1CBanPjBKQvRYmWCFqKDKuEFYDd8'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 11-13-2025 15:36:40.649 | General Service|:: CompanyIndex:53 SpName: spADM_GetDashBoard 
 2
 ,0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 11-13-2025 15:36:40.649 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODM5OSwiZXhwIjoxNzYzMDU3MTk5LCJpYXQiOjE3NjMwMjgzOTl9.4C8ThE_cHIEfIjZ1CBanPjBKQvRYmWCFqKDKuEFYDd8'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 11-13-2025 15:36:40.665 | General Service|:: CompanyIndex:53 SpName: spCOM_ConfigValues 
 1
 ,'LandingDocs'
 ,'1'
[System: 192.168.1.99] DEBUG | 11-13-2025 15:36:40.665 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODM5OSwiZXhwIjoxNzYzMDU3MTk5LCJpYXQiOjE3NjMwMjgzOTl9.4C8ThE_cHIEfIjZ1CBanPjBKQvRYmWCFqKDKuEFYDd8'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 11-13-2025 15:36:40.711 | General Service|:: CompanyIndex:53 SpName: spCOM_GetFavorites 
 'GETLIST0'
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 11-13-2025 15:36:40.711 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODM5OSwiZXhwIjoxNzYzMDU3MTk5LCJpYXQiOjE3NjMwMjgzOTl9.4C8ThE_cHIEfIjZ1CBanPjBKQvRYmWCFqKDKuEFYDd8'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 11-13-2025 15:36:40.711 | General Service|:: CompanyIndex:53 SpName: spADM_GetAllListViewsDef 
 1
 ,1
[System: 192.168.1.99] DEBUG | 11-13-2025 15:36:40.711 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODM5OSwiZXhwIjoxNzYzMDU3MTk5LCJpYXQiOjE3NjMwMjgzOTl9.4C8ThE_cHIEfIjZ1CBanPjBKQvRYmWCFqKDKuEFYDd8'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 11-13-2025 15:36:40.821 | General Service|:: CompanyIndex:53 SpName: spADM_GetAllListViewsDef 
 1
 ,1
[System: 192.168.1.99] DEBUG | 11-13-2025 15:36:40.821 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODM5OSwiZXhwIjoxNzYzMDU3MTk5LCJpYXQiOjE3NjMwMjgzOTl9.4C8ThE_cHIEfIjZ1CBanPjBKQvRYmWCFqKDKuEFYDd8'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 11-13-2025 15:36:40.946 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'Select CostCenterID,CostCenterColID,CostCenterName,SysTableName,UserColumnName,SysColumnName,ISNULL(UserDefaultValue,'''') UserDefaultValue
From AdM_CostCenterDef WITH(NOLOCK)
Where SysColumnName IN(''CreditAccount'',''DebitAccount'',''ProductID'') 
AND CostCenterID>40000 AND CostCenterID<50000 

SELECT * FROM ADM_Features WITH(NOLOCK) '
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 11-13-2025 15:36:40.946 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODM5OSwiZXhwIjoxNzYzMDU3MTk5LCJpYXQiOjE3NjMwMjgzOTl9.4C8ThE_cHIEfIjZ1CBanPjBKQvRYmWCFqKDKuEFYDd8'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 11-13-2025 15:36:40.993 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 '  SELECT * FROM PAY_PayrollPreferences WITH(NOLOCK) '
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 11-13-2025 15:36:40.993 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODM5OSwiZXhwIjoxNzYzMDU3MTk5LCJpYXQiOjE3NjMwMjgzOTl9.4C8ThE_cHIEfIjZ1CBanPjBKQvRYmWCFqKDKuEFYDd8'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 11-13-2025 15:36:41.008 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 '  --0
                                Select * FROM COM_CC50051 WITH(NOLOCK) WHERE IsGroup=0 AND LoginUserID=''admin''
                                --1                                
                                Select * FROM COM_CC50051 WITH(NOLOCK) WHERE RptManager IN (Select NodeID FROM COM_CC50051 WITH(NOLOCK) WHERE IsGroup=0 AND LoginUserID=''admin'')
                                UNION ALL
                                Select * FROM COM_CC50051 WITH(NOLOCK) WHERE RptManager IN 
                                (
	                                Select NodeID FROM COM_CC50051 WITH(NOLOCK) 
	                                WHERE IsGroup=0 AND LoginUserID IN
	                                (
	                                SELECT fe.LoginUserID
	                                FROM INV_DocDetails a WITH(NOLOCK) 
	                                JOIN COM_DocCCData b WITH(NOLOCK) ON b.InvDocDetailsID=a.InvDocDetailsID
	                                JOIN COM_DocNumData c WITH(NOLOCK) ON c.InvDocDetailsID=a.InvDocDetailsID
	                                JOIN COM_DocTextData d WITH(NOLOCK) ON d.InvDocDetailsID=a.InvDocDetailsID
	                                JOIN COM_CC50051 fe WITH(NOLOCK) on fe.NodeID=b.dcCCNID51
	                                JOIN COM_CC50051 te WITH(NOLOCK) on CONVERT(NVARCHAR,te.NodeID)=d.dcAlpha1
	                                WHERE a.CostCenterID=40098 and a.StatusID=369 AND d.dcAlpha3=''Temporary''
	                                AND te.LoginUserID=''admin'' 
	                                AND ISDATE(d.dcAlpha4)=1 AND ISDATE(d.dcAlpha5)=1 
	                                AND CONVERT(DATETIME,''13 Nov 2025'') BETWEEN CONVERT(DATETIME,d.dcAlpha4) AND CONVERT(DATETIME,d.dcAlpha5)
	                                )
                                )
                                --2
                                Select * FROM ADM_USERS WITH(NOLOCK) WHERE USERID=1
                                --3
                                Select * FROM COM_CostCenterCostCenterMap WITH(NOLOCK) WHERE ParentCostCenterID=7 AND ParentNodeID=1
                                --4                                
                                Select * FROM COM_CostCenterCostCenterMap WITH(NOLOCK) WHERE ParentCostCenterID=7 AND ParentNodeID=1
                                AND CostCenterID IN(Select ColumnCostCenterID From ADM_CostCenterDef Where CostCenterID=50051 AND IsColumnInUse=1 AND SysColumnName LIKE ''CCNID%'')
                                --5
                                Select * from COM_Files WITH(NOLOCK) WHERE FeatureID=50051 AND FeaturePK IN (Select NodeID FROM COM_CC50051 WITH(NOLOCK) WHERE IsGroup=0 AND LoginUserID=''admin'')                         
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 11-13-2025 15:36:41.008 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODM5OSwiZXhwIjoxNzYzMDU3MTk5LCJpYXQiOjE3NjMwMjgzOTl9.4C8ThE_cHIEfIjZ1CBanPjBKQvRYmWCFqKDKuEFYDd8'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 11-13-2025 15:36:41.055 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 11-13-2025 15:36:41.071 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODM5OSwiZXhwIjoxNzYzMDU3MTk5LCJpYXQiOjE3NjMwMjgzOTl9.4C8ThE_cHIEfIjZ1CBanPjBKQvRYmWCFqKDKuEFYDd8'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 11-13-2025 15:36:41.508 | General Service|:: CompanyIndex:53 SpName: spADM_GetDashBoard 
 1
 ,41
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 11-13-2025 15:36:41.508 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODM5OSwiZXhwIjoxNzYzMDU3MTk5LCJpYXQiOjE3NjMwMjgzOTl9.4C8ThE_cHIEfIjZ1CBanPjBKQvRYmWCFqKDKuEFYDd8'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 11-13-2025 15:36:41.539 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,60586
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 11-13-2025 15:36:41.539 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,60584
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 11-13-2025 15:36:41.539 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,60585
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 11-13-2025 15:36:41.539 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,60587
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 11-13-2025 15:36:41.539 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODM5OSwiZXhwIjoxNzYzMDU3MTk5LCJpYXQiOjE3NjMwMjgzOTl9.4C8ThE_cHIEfIjZ1CBanPjBKQvRYmWCFqKDKuEFYDd8'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 11-13-2025 15:36:41.539 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,60583
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 11-13-2025 15:36:41.539 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODM5OSwiZXhwIjoxNzYzMDU3MTk5LCJpYXQiOjE3NjMwMjgzOTl9.4C8ThE_cHIEfIjZ1CBanPjBKQvRYmWCFqKDKuEFYDd8'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 11-13-2025 15:36:41.539 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODM5OSwiZXhwIjoxNzYzMDU3MTk5LCJpYXQiOjE3NjMwMjgzOTl9.4C8ThE_cHIEfIjZ1CBanPjBKQvRYmWCFqKDKuEFYDd8'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 11-13-2025 15:36:41.555 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODM5OSwiZXhwIjoxNzYzMDU3MTk5LCJpYXQiOjE3NjMwMjgzOTl9.4C8ThE_cHIEfIjZ1CBanPjBKQvRYmWCFqKDKuEFYDd8'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 11-13-2025 15:36:41.555 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODM5OSwiZXhwIjoxNzYzMDU3MTk5LCJpYXQiOjE3NjMwMjgzOTl9.4C8ThE_cHIEfIjZ1CBanPjBKQvRYmWCFqKDKuEFYDd8'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 11-13-2025 15:36:41.555 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,60588
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 11-13-2025 15:36:41.555 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODM5OSwiZXhwIjoxNzYzMDU3MTk5LCJpYXQiOjE3NjMwMjgzOTl9.4C8ThE_cHIEfIjZ1CBanPjBKQvRYmWCFqKDKuEFYDd8'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 11-13-2025 15:36:41.555 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 11-13-2025 15:36:41.555 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,60585
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 11-13-2025 15:36:41.555 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,60586
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 11-13-2025 15:36:41.555 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,60583
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 11-13-2025 15:36:41.555 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODM5OSwiZXhwIjoxNzYzMDU3MTk5LCJpYXQiOjE3NjMwMjgzOTl9.4C8ThE_cHIEfIjZ1CBanPjBKQvRYmWCFqKDKuEFYDd8'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 11-13-2025 15:36:41.571 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODM5OSwiZXhwIjoxNzYzMDU3MTk5LCJpYXQiOjE3NjMwMjgzOTl9.4C8ThE_cHIEfIjZ1CBanPjBKQvRYmWCFqKDKuEFYDd8'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 11-13-2025 15:36:41.571 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,60584
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 11-13-2025 15:36:41.571 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODM5OSwiZXhwIjoxNzYzMDU3MTk5LCJpYXQiOjE3NjMwMjgzOTl9.4C8ThE_cHIEfIjZ1CBanPjBKQvRYmWCFqKDKuEFYDd8'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 11-13-2025 15:36:41.571 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODM5OSwiZXhwIjoxNzYzMDU3MTk5LCJpYXQiOjE3NjMwMjgzOTl9.4C8ThE_cHIEfIjZ1CBanPjBKQvRYmWCFqKDKuEFYDd8'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 11-13-2025 15:36:41.571 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODM5OSwiZXhwIjoxNzYzMDU3MTk5LCJpYXQiOjE3NjMwMjgzOTl9.4C8ThE_cHIEfIjZ1CBanPjBKQvRYmWCFqKDKuEFYDd8'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 11-13-2025 15:36:41.571 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,60587
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 11-13-2025 15:36:41.571 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,60588
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 11-13-2025 15:36:41.571 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 11-13-2025 15:36:41.571 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODM5OSwiZXhwIjoxNzYzMDU3MTk5LCJpYXQiOjE3NjMwMjgzOTl9.4C8ThE_cHIEfIjZ1CBanPjBKQvRYmWCFqKDKuEFYDd8'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 11-13-2025 15:36:41.571 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODM5OSwiZXhwIjoxNzYzMDU3MTk5LCJpYXQiOjE3NjMwMjgzOTl9.4C8ThE_cHIEfIjZ1CBanPjBKQvRYmWCFqKDKuEFYDd8'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 11-13-2025 15:36:41.571 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODM5OSwiZXhwIjoxNzYzMDU3MTk5LCJpYXQiOjE3NjMwMjgzOTl9.4C8ThE_cHIEfIjZ1CBanPjBKQvRYmWCFqKDKuEFYDd8'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 11-13-2025 15:36:41.586 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 11-13-2025 15:36:41.586 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODM5OSwiZXhwIjoxNzYzMDU3MTk5LCJpYXQiOjE3NjMwMjgzOTl9.4C8ThE_cHIEfIjZ1CBanPjBKQvRYmWCFqKDKuEFYDd8'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 11-13-2025 15:36:41.602 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 11-13-2025 15:36:41.602 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODM5OSwiZXhwIjoxNzYzMDU3MTk5LCJpYXQiOjE3NjMwMjgzOTl9.4C8ThE_cHIEfIjZ1CBanPjBKQvRYmWCFqKDKuEFYDd8'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 11-13-2025 15:36:41.602 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 11-13-2025 15:36:41.617 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODM5OSwiZXhwIjoxNzYzMDU3MTk5LCJpYXQiOjE3NjMwMjgzOTl9.4C8ThE_cHIEfIjZ1CBanPjBKQvRYmWCFqKDKuEFYDd8'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 11-13-2025 15:36:41.617 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 11-13-2025 15:36:41.617 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODM5OSwiZXhwIjoxNzYzMDU3MTk5LCJpYXQiOjE3NjMwMjgzOTl9.4C8ThE_cHIEfIjZ1CBanPjBKQvRYmWCFqKDKuEFYDd8'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 11-13-2025 15:36:41.633 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 11-13-2025 15:36:41.633 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODM5OSwiZXhwIjoxNzYzMDU3MTk5LCJpYXQiOjE3NjMwMjgzOTl9.4C8ThE_cHIEfIjZ1CBanPjBKQvRYmWCFqKDKuEFYDd8'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 11-13-2025 15:36:41.633 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 11-13-2025 15:36:41.633 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODM5OSwiZXhwIjoxNzYzMDU3MTk5LCJpYXQiOjE3NjMwMjgzOTl9.4C8ThE_cHIEfIjZ1CBanPjBKQvRYmWCFqKDKuEFYDd8'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 11-13-2025 15:36:41.649 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 11-13-2025 15:36:41.649 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODM5OSwiZXhwIjoxNzYzMDU3MTk5LCJpYXQiOjE3NjMwMjgzOTl9.4C8ThE_cHIEfIjZ1CBanPjBKQvRYmWCFqKDKuEFYDd8'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 11-13-2025 15:36:41.664 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 11-13-2025 15:36:41.664 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODM5OSwiZXhwIjoxNzYzMDU3MTk5LCJpYXQiOjE3NjMwMjgzOTl9.4C8ThE_cHIEfIjZ1CBanPjBKQvRYmWCFqKDKuEFYDd8'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 11-13-2025 15:36:41.664 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 11-13-2025 15:36:41.680 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODM5OSwiZXhwIjoxNzYzMDU3MTk5LCJpYXQiOjE3NjMwMjgzOTl9.4C8ThE_cHIEfIjZ1CBanPjBKQvRYmWCFqKDKuEFYDd8'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 11-13-2025 15:36:41.680 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 11-13-2025 15:36:41.680 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODM5OSwiZXhwIjoxNzYzMDU3MTk5LCJpYXQiOjE3NjMwMjgzOTl9.4C8ThE_cHIEfIjZ1CBanPjBKQvRYmWCFqKDKuEFYDd8'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 11-13-2025 15:36:41.774 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60583'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 11-13-2025 15:36:41.774 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODM5OSwiZXhwIjoxNzYzMDU3MTk5LCJpYXQiOjE3NjMwMjgzOTl9.4C8ThE_cHIEfIjZ1CBanPjBKQvRYmWCFqKDKuEFYDd8'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 11-13-2025 15:36:41.930 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReportCategoryandField 
 -1
 ,0
 ,1
 ,0
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 11-13-2025 15:36:41.930 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODM5OSwiZXhwIjoxNzYzMDU3MTk5LCJpYXQiOjE3NjMwMjgzOTl9.4C8ThE_cHIEfIjZ1CBanPjBKQvRYmWCFqKDKuEFYDd8'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 11-13-2025 15:36:41.977 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60584'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 11-13-2025 15:36:41.977 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODM5OSwiZXhwIjoxNzYzMDU3MTk5LCJpYXQiOjE3NjMwMjgzOTl9.4C8ThE_cHIEfIjZ1CBanPjBKQvRYmWCFqKDKuEFYDd8'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 11-13-2025 15:36:41.992 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60585'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 11-13-2025 15:36:41.992 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODM5OSwiZXhwIjoxNzYzMDU3MTk5LCJpYXQiOjE3NjMwMjgzOTl9.4C8ThE_cHIEfIjZ1CBanPjBKQvRYmWCFqKDKuEFYDd8'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 11-13-2025 15:36:42.008 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select * from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0  
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) a --where UStatus like ''%Hold%'' 
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 11-13-2025 15:36:42.008 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODM5OSwiZXhwIjoxNzYzMDU3MTk5LCJpYXQiOjE3NjMwMjgzOTl9.4C8ThE_cHIEfIjZ1CBanPjBKQvRYmWCFqKDKuEFYDd8'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 11-13-2025 15:36:42.008 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60586'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 11-13-2025 15:36:42.008 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODM5OSwiZXhwIjoxNzYzMDU3MTk5LCJpYXQiOjE3NjMwMjgzOTl9.4C8ThE_cHIEfIjZ1CBanPjBKQvRYmWCFqKDKuEFYDd8'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 11-13-2025 15:36:42.008 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select * from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0  
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) a where UnitStatus=''Occupied'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 11-13-2025 15:36:42.024 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select * from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0  
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) a where UnitStatus=''Vacant''
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 11-13-2025 15:36:42.024 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODM5OSwiZXhwIjoxNzYzMDU3MTk5LCJpYXQiOjE3NjMwMjgzOTl9.4C8ThE_cHIEfIjZ1CBanPjBKQvRYmWCFqKDKuEFYDd8'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 11-13-2025 15:36:42.024 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODM5OSwiZXhwIjoxNzYzMDU3MTk5LCJpYXQiOjE3NjMwMjgzOTl9.4C8ThE_cHIEfIjZ1CBanPjBKQvRYmWCFqKDKuEFYDd8'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 11-13-2025 15:36:42.039 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60587'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 11-13-2025 15:36:42.039 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODM5OSwiZXhwIjoxNzYzMDU3MTk5LCJpYXQiOjE3NjMwMjgzOTl9.4C8ThE_cHIEfIjZ1CBanPjBKQvRYmWCFqKDKuEFYDd8'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 11-13-2025 15:36:42.039 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select * from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0  
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) a  where UnitStatus=''Expired'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 11-13-2025 15:36:42.039 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODM5OSwiZXhwIjoxNzYzMDU3MTk5LCJpYXQiOjE3NjMwMjgzOTl9.4C8ThE_cHIEfIjZ1CBanPjBKQvRYmWCFqKDKuEFYDd8'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 11-13-2025 15:36:42.055 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select * from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0  
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) a where UStatus like ''%Case%'' 
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 11-13-2025 15:36:42.070 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60588'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 11-13-2025 15:36:42.070 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODM5OSwiZXhwIjoxNzYzMDU3MTk5LCJpYXQiOjE3NjMwMjgzOTl9.4C8ThE_cHIEfIjZ1CBanPjBKQvRYmWCFqKDKuEFYDd8'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 11-13-2025 15:36:42.070 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODM5OSwiZXhwIjoxNzYzMDU3MTk5LCJpYXQiOjE3NjMwMjgzOTl9.4C8ThE_cHIEfIjZ1CBanPjBKQvRYmWCFqKDKuEFYDd8'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 11-13-2025 15:36:42.086 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60583'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 11-13-2025 15:36:42.086 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODM5OSwiZXhwIjoxNzYzMDU3MTk5LCJpYXQiOjE3NjMwMjgzOTl9.4C8ThE_cHIEfIjZ1CBanPjBKQvRYmWCFqKDKuEFYDd8'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 11-13-2025 15:36:42.117 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60584'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 11-13-2025 15:36:42.117 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODM5OSwiZXhwIjoxNzYzMDU3MTk5LCJpYXQiOjE3NjMwMjgzOTl9.4C8ThE_cHIEfIjZ1CBanPjBKQvRYmWCFqKDKuEFYDd8'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 11-13-2025 15:36:42.133 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 '/*
DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select * from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0  
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) a where UStatus like ''%Reserve%'' 
*/

DECLARE @FROM FLOAT
SET @FROM=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @UnitID BIGINT,@StatusID BIGINT,@TotalAmount FLOAT,@I INT,@COUNT INT,@ContractID BIGINT
DECLARE @NoofDays INT,@VacantSince DATETIME

DECLARE @TAB TABLE(ID INT IDENTITY(1,1) PRIMARY KEY,UnitID BIGINT,CurrentRent FLOAT,Status NVARCHAR(10),NoofDays INT,VacantSince DATETIME,ContractID BIGINT)

INSERT INTO @TAB (UnitID)
SELECT U.UnitID
FROM REN_Units U WITH(NOLOCK) 
LEFT JOIN REN_Property P WITH(NOLOCK) ON P.NodeID=U.PropertyID
LEFT JOIN COM_Lookup LK WITH(NOLOCK) ON U.UnitStatus=LK.NodeID
WHERE U.UnitID>1 AND P.Name <> U.Name AND U.IsGroup=0 AND U.Status=424 and U.UnitStatus=306 
-- AND P.NodeID IN (207)
SELECT @I=1,@COUNT=COUNT(*) FROM @TAB
WHILE(@I<=@COUNT)
BEGIN
	SET @StatusID=0
	SET @TotalAmount=0
	SET @ContractID=0
	SELECT @UnitID=UnitID FROM @TAB WHERE ID=@I

	SELECT TOP 1 @ContractID=(CASE WHEN RefContractID>0 THEN RefContractID ELSE ContractID END),@StatusID=StatusID
	,@VacantSince=(CASE WHEN StatusID = 450 THEN ( CASE WHEN RefundDate IS NOT NULL THEN CONVERT(DATETIME,RefundDate) ELSE CONVERT(DATETIME,VacancyDate) END ) 
			ELSE CONVERT(DATETIME,TerminationDate) END )
	,@NoofDays=(CASE WHEN StatusID = 450 THEN (CASE WHEN RefundDate IS NOT NULL THEN DATEDIFF(DAY, CONVERT(DATETIME,RefundDate),CONVERT(DATETIME,@FROM) ) 
			ELSE DATEDIFF(DAY, CONVERT(DATETIME,VacancyDate),CONVERT(DATETIME,@FROM) ) END )
			ELSE DATEDIFF(DAY, CONVERT(DATETIME,TerminationDate),CONVERT(DATETIME,@FROM) ) END )  
	FROM REN_Contract WITH(NOLOCK) WHERE StatusID<>451 AND StartDate<@FROM AND UNITID=@UnitID 
	ORDER BY StartDate DESC,StatusID
	
	SELECT @TotalAmount=ISNULL(SUM(RPD.Amount),MAX(RentAmount)/(CASE WHEN MAX(RC.NoOfUnits)=0 THEN 1 ELSE MAX(RC.NoOfUnits) END)) 
	FROM REN_Contract RC WITH(NOLOCK)
	JOIN REN_ContractParticulars RP WITH(NOLOCK) ON RP.ContractID=RC.ContractID AND RP.Sno=1
	LEFT JOIN REN_ContractParticularsDetail RPD WITH(NOLOCK) ON RPD.ParticularNodeID=RP.NodeID AND RPD.Unit=@UnitID 
	AND @FROM BETWEEN ISNULL(RPD.FromDate,@FROM) AND ISNULL(RPD.ToDate,@FROM)
	WHERE RC.ContractID=@ContractID
	
	IF @StatusID=427 OR @StatusID=426 OR @StatusID=466
	BEGIN
		UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Occupied'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
	END
	ELSE IF @StatusID=440
	BEGIN
		UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''UnAproved'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
	END
	ELSE IF @StatusID=428 OR @StatusID=450
	BEGIN 
		IF EXISTS (SELECT * FROM REN_Quotation WITH(NOLOCK) WHERE COSTCENTERID=129 AND UNITID=@UnitID AND CONVERT(DATETIME,@FROM) BETWEEN CONVERT(DATETIME,STARTDATE) AND CONVERT(DATETIME,ENDDATE) and statusid=467 )
			UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Reserved'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
		ELSE IF EXISTS (SELECT * FROM REN_Quotation WITH(NOLOCK) WHERE COSTCENTERID=103 AND UNITID=@UnitID AND CONVERT(DATETIME,@FROM) BETWEEN CONVERT(DATETIME,STARTDATE) AND CONVERT(DATETIME,ENDDATE) and statusid=426 )
			UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Quoted'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
		ELSE
			UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Vacant'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
	END
	ELSE
	BEGIN 
		IF EXISTS (SELECT * FROM REN_Quotation WITH(NOLOCK) WHERE COSTCENTERID=129 AND UNITID=@UnitID AND CONVERT(DATETIME,@FROM) BETWEEN CONVERT(DATETIME,STARTDATE) AND CONVERT(DATETIME,ENDDATE) and statusid=467 )
			UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Reserved'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
		ELSE IF EXISTS (SELECT * FROM REN_Quotation WITH(NOLOCK) WHERE COSTCENTERID=103 AND UNITID=@UnitID AND CONVERT(DATETIME,@FROM) BETWEEN CONVERT(DATETIME,STARTDATE) AND CONVERT(DATETIME,ENDDATE) and statusid=426 )
			UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Quoted'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
		ELSE
			UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Vacant'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
	END
	set @I=@I+1
END

select * from (
SELECT TEMP.*,RP.NodeID Building_ID,RP.NAME Property,TEMP.UnitID Unit_ID,RU.NAME Unit,C18.NAME UnitType,RU.UnitStatus,RU.RentableArea UnitArea,RU.RentPerSQFT UnitRate
,RU.AnnualRent 
,T.FirstName AS [C98c7d2679f99489e9f0e010026eeb563]
,RUL.Name LandLord , RUC.Name Location 
,1 Cnt
FROM @TAB TEMP
JOIN REN_Units RU WITH(NOLOCK) ON TEMP.UnitID=RU.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
LEFT JOIN COM_CC50018 C18 WITH(NOLOCK) ON C18.NodeID=RU.NodeID
LEFT JOIN REN_Contract C WITH(NOLOCK) ON TEMP.ContractID=C.ContractID
LEFT JOIN REN_Tenant T WITH(NOLOCK) ON T.TenantID=C.TenantID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID

 )a where a.Status =''Reserved''
 order by Property,VacantSince'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 11-13-2025 15:36:42.133 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select * from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0  
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) a --where UStatus like ''%Hold%'' 
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 11-13-2025 15:36:42.133 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODM5OSwiZXhwIjoxNzYzMDU3MTk5LCJpYXQiOjE3NjMwMjgzOTl9.4C8ThE_cHIEfIjZ1CBanPjBKQvRYmWCFqKDKuEFYDd8'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 11-13-2025 15:36:42.133 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODM5OSwiZXhwIjoxNzYzMDU3MTk5LCJpYXQiOjE3NjMwMjgzOTl9.4C8ThE_cHIEfIjZ1CBanPjBKQvRYmWCFqKDKuEFYDd8'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 11-13-2025 15:36:42.149 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select * from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0  
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) a where UnitStatus=''Vacant''
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 11-13-2025 15:36:42.149 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODM5OSwiZXhwIjoxNzYzMDU3MTk5LCJpYXQiOjE3NjMwMjgzOTl9.4C8ThE_cHIEfIjZ1CBanPjBKQvRYmWCFqKDKuEFYDd8'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 11-13-2025 15:36:42.289 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60585'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 11-13-2025 15:36:42.305 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODM5OSwiZXhwIjoxNzYzMDU3MTk5LCJpYXQiOjE3NjMwMjgzOTl9.4C8ThE_cHIEfIjZ1CBanPjBKQvRYmWCFqKDKuEFYDd8'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 11-13-2025 15:36:42.320 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60586'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 11-13-2025 15:36:42.320 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODM5OSwiZXhwIjoxNzYzMDU3MTk5LCJpYXQiOjE3NjMwMjgzOTl9.4C8ThE_cHIEfIjZ1CBanPjBKQvRYmWCFqKDKuEFYDd8'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 11-13-2025 15:36:42.336 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select * from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0  
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) a where UnitStatus=''Occupied'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 11-13-2025 15:36:42.336 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODM5OSwiZXhwIjoxNzYzMDU3MTk5LCJpYXQiOjE3NjMwMjgzOTl9.4C8ThE_cHIEfIjZ1CBanPjBKQvRYmWCFqKDKuEFYDd8'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 11-13-2025 15:36:42.336 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60587'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 11-13-2025 15:36:42.352 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODM5OSwiZXhwIjoxNzYzMDU3MTk5LCJpYXQiOjE3NjMwMjgzOTl9.4C8ThE_cHIEfIjZ1CBanPjBKQvRYmWCFqKDKuEFYDd8'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 11-13-2025 15:36:42.367 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select * from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0  
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) a  where UnitStatus=''Expired'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 11-13-2025 15:36:42.367 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODM5OSwiZXhwIjoxNzYzMDU3MTk5LCJpYXQiOjE3NjMwMjgzOTl9.4C8ThE_cHIEfIjZ1CBanPjBKQvRYmWCFqKDKuEFYDd8'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 11-13-2025 15:36:42.571 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60588'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 11-13-2025 15:36:42.571 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODM5OSwiZXhwIjoxNzYzMDU3MTk5LCJpYXQiOjE3NjMwMjgzOTl9.4C8ThE_cHIEfIjZ1CBanPjBKQvRYmWCFqKDKuEFYDd8'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 11-13-2025 15:36:42.571 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select * from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0  
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) a where UStatus like ''%Case%'' 
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 11-13-2025 15:36:42.571 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODM5OSwiZXhwIjoxNzYzMDU3MTk5LCJpYXQiOjE3NjMwMjgzOTl9.4C8ThE_cHIEfIjZ1CBanPjBKQvRYmWCFqKDKuEFYDd8'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 11-13-2025 15:36:42.633 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 '/*
DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select * from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0  
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) a where UStatus like ''%Reserve%'' 
*/

DECLARE @FROM FLOAT
SET @FROM=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @UnitID BIGINT,@StatusID BIGINT,@TotalAmount FLOAT,@I INT,@COUNT INT,@ContractID BIGINT
DECLARE @NoofDays INT,@VacantSince DATETIME

DECLARE @TAB TABLE(ID INT IDENTITY(1,1) PRIMARY KEY,UnitID BIGINT,CurrentRent FLOAT,Status NVARCHAR(10),NoofDays INT,VacantSince DATETIME,ContractID BIGINT)

INSERT INTO @TAB (UnitID)
SELECT U.UnitID
FROM REN_Units U WITH(NOLOCK) 
LEFT JOIN REN_Property P WITH(NOLOCK) ON P.NodeID=U.PropertyID
LEFT JOIN COM_Lookup LK WITH(NOLOCK) ON U.UnitStatus=LK.NodeID
WHERE U.UnitID>1 AND P.Name <> U.Name AND U.IsGroup=0 AND U.Status=424 and U.UnitStatus=306 
-- AND P.NodeID IN (207)
SELECT @I=1,@COUNT=COUNT(*) FROM @TAB
WHILE(@I<=@COUNT)
BEGIN
	SET @StatusID=0
	SET @TotalAmount=0
	SET @ContractID=0
	SELECT @UnitID=UnitID FROM @TAB WHERE ID=@I

	SELECT TOP 1 @ContractID=(CASE WHEN RefContractID>0 THEN RefContractID ELSE ContractID END),@StatusID=StatusID
	,@VacantSince=(CASE WHEN StatusID = 450 THEN ( CASE WHEN RefundDate IS NOT NULL THEN CONVERT(DATETIME,RefundDate) ELSE CONVERT(DATETIME,VacancyDate) END ) 
			ELSE CONVERT(DATETIME,TerminationDate) END )
	,@NoofDays=(CASE WHEN StatusID = 450 THEN (CASE WHEN RefundDate IS NOT NULL THEN DATEDIFF(DAY, CONVERT(DATETIME,RefundDate),CONVERT(DATETIME,@FROM) ) 
			ELSE DATEDIFF(DAY, CONVERT(DATETIME,VacancyDate),CONVERT(DATETIME,@FROM) ) END )
			ELSE DATEDIFF(DAY, CONVERT(DATETIME,TerminationDate),CONVERT(DATETIME,@FROM) ) END )  
	FROM REN_Contract WITH(NOLOCK) WHERE StatusID<>451 AND StartDate<@FROM AND UNITID=@UnitID 
	ORDER BY StartDate DESC,StatusID
	
	SELECT @TotalAmount=ISNULL(SUM(RPD.Amount),MAX(RentAmount)/(CASE WHEN MAX(RC.NoOfUnits)=0 THEN 1 ELSE MAX(RC.NoOfUnits) END)) 
	FROM REN_Contract RC WITH(NOLOCK)
	JOIN REN_ContractParticulars RP WITH(NOLOCK) ON RP.ContractID=RC.ContractID AND RP.Sno=1
	LEFT JOIN REN_ContractParticularsDetail RPD WITH(NOLOCK) ON RPD.ParticularNodeID=RP.NodeID AND RPD.Unit=@UnitID 
	AND @FROM BETWEEN ISNULL(RPD.FromDate,@FROM) AND ISNULL(RPD.ToDate,@FROM)
	WHERE RC.ContractID=@ContractID
	
	IF @StatusID=427 OR @StatusID=426 OR @StatusID=466
	BEGIN
		UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Occupied'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
	END
	ELSE IF @StatusID=440
	BEGIN
		UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''UnAproved'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
	END
	ELSE IF @StatusID=428 OR @StatusID=450
	BEGIN 
		IF EXISTS (SELECT * FROM REN_Quotation WITH(NOLOCK) WHERE COSTCENTERID=129 AND UNITID=@UnitID AND CONVERT(DATETIME,@FROM) BETWEEN CONVERT(DATETIME,STARTDATE) AND CONVERT(DATETIME,ENDDATE) and statusid=467 )
			UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Reserved'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
		ELSE IF EXISTS (SELECT * FROM REN_Quotation WITH(NOLOCK) WHERE COSTCENTERID=103 AND UNITID=@UnitID AND CONVERT(DATETIME,@FROM) BETWEEN CONVERT(DATETIME,STARTDATE) AND CONVERT(DATETIME,ENDDATE) and statusid=426 )
			UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Quoted'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
		ELSE
			UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Vacant'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
	END
	ELSE
	BEGIN 
		IF EXISTS (SELECT * FROM REN_Quotation WITH(NOLOCK) WHERE COSTCENTERID=129 AND UNITID=@UnitID AND CONVERT(DATETIME,@FROM) BETWEEN CONVERT(DATETIME,STARTDATE) AND CONVERT(DATETIME,ENDDATE) and statusid=467 )
			UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Reserved'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
		ELSE IF EXISTS (SELECT * FROM REN_Quotation WITH(NOLOCK) WHERE COSTCENTERID=103 AND UNITID=@UnitID AND CONVERT(DATETIME,@FROM) BETWEEN CONVERT(DATETIME,STARTDATE) AND CONVERT(DATETIME,ENDDATE) and statusid=426 )
			UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Quoted'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
		ELSE
			UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Vacant'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
	END
	set @I=@I+1
END

select * from (
SELECT TEMP.*,RP.NodeID Building_ID,RP.NAME Property,TEMP.UnitID Unit_ID,RU.NAME Unit,C18.NAME UnitType,RU.UnitStatus,RU.RentableArea UnitArea,RU.RentPerSQFT UnitRate
,RU.AnnualRent 
,T.FirstName AS [C98c7d2679f99489e9f0e010026eeb563]
,RUL.Name LandLord , RUC.Name Location 
,1 Cnt
FROM @TAB TEMP
JOIN REN_Units RU WITH(NOLOCK) ON TEMP.UnitID=RU.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
LEFT JOIN COM_CC50018 C18 WITH(NOLOCK) ON C18.NodeID=RU.NodeID
LEFT JOIN REN_Contract C WITH(NOLOCK) ON TEMP.ContractID=C.ContractID
LEFT JOIN REN_Tenant T WITH(NOLOCK) ON T.TenantID=C.TenantID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID

 )a where a.Status =''Reserved''
 order by Property,VacantSince'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 11-13-2025 15:36:42.633 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODM5OSwiZXhwIjoxNzYzMDU3MTk5LCJpYXQiOjE3NjMwMjgzOTl9.4C8ThE_cHIEfIjZ1CBanPjBKQvRYmWCFqKDKuEFYDd8'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 11-13-2025 15:37:11.581 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 11-13-2025 15:37:11.597 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzYzMDI4MzA2LCJleHAiOjE3NjMwNTcxMDYsImlhdCI6MTc2MzAyODMwNn0.9MTBuB63fLAG0fQGvThybvQM9mQbqpwWlrfMtHu1T_M'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 11-13-2025 15:37:26.571 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 11-13-2025 15:37:26.587 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODA4NSwiZXhwIjoxNzYzMDU2ODg1LCJpYXQiOjE3NjMwMjgwODV9.eRlSN9oidYho75qh1pF4jTpIB4tw3U5pKBPBFSOfZsw'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 11-13-2025 15:37:48.742 | General Service|:: CompanyIndex:348 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 11-13-2025 15:37:48.742 | General Service|:: CompanyIndex:348 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMzQ4LDEiLCJuYmYiOjE3NjMwMTk4OTIsImV4cCI6MTc2MzA0ODY5MiwiaWF0IjoxNzYzMDE5ODkyfQ.QTTYhPJDdSuVk1AVSpo5BssLWyVUcTuIVOJ4BQ84bpU'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 11-13-2025 15:37:49.071 | General Service|:: CompanyIndex:348 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 11-13-2025 15:37:49.086 | General Service|:: CompanyIndex:348 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMzQ4LDEiLCJuYmYiOjE3NjMwMTkzMTcsImV4cCI6MTc2MzA0ODExNywiaWF0IjoxNzYzMDE5MzE3fQ.VpcXT6Y3RAP00m4CfI8rjfb5sp4khz2gEjXRlTIen40'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 11-13-2025 15:37:54.411 | General Service|:: CompanyIndex:348 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.99] DEBUG | 11-13-2025 15:37:54.411 | General Service|:: CompanyIndex:348 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.99] DEBUG | 11-13-2025 15:37:54.426 | General Service|:: CompanyIndex:348 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMzQ4LDEiLCJuYmYiOjE3NjMwMTk4OTIsImV4cCI6MTc2MzA0ODY5MiwiaWF0IjoxNzYzMDE5ODkyfQ.QTTYhPJDdSuVk1AVSpo5BssLWyVUcTuIVOJ4BQ84bpU'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 11-13-2025 15:37:54.426 | General Service|:: CompanyIndex:0 SpName: spADM_Login 
 4
 ,''
 ,''
 ,''
 ,'declare @AllowSession bit,@GUID nvarchar(50)
set @AllowSession=0
set @GUID=''1dbadf3d-7c77-49fa-b114-66da7d5c9550''
if exists(select [GUID] from ADM_Login with(nolock) where [GUID]=@GUID)
begin
    update ADM_Login  set LastAccessTime=convert(float,getdate()) where [GUID]=@GUID
    set @AllowSession=1
end
select @AllowSession AllowSession
'
 ,''
 ,0
[System: 192.168.1.99] DEBUG | 11-13-2025 15:37:54.426 | General Service|:: CompanyIndex:348 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMzQ4LDEiLCJuYmYiOjE3NjMwMTkzMTcsImV4cCI6MTc2MzA0ODExNywiaWF0IjoxNzYzMDE5MzE3fQ.VpcXT6Y3RAP00m4CfI8rjfb5sp4khz2gEjXRlTIen40'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 11-13-2025 15:37:54.426 | General Service|:: CompanyIndex:348 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMzQ4LDEiLCJuYmYiOjE3NjMwMTk4OTIsImV4cCI6MTc2MzA0ODY5MiwiaWF0IjoxNzYzMDE5ODkyfQ.QTTYhPJDdSuVk1AVSpo5BssLWyVUcTuIVOJ4BQ84bpU'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 11-13-2025 15:37:54.442 | General Service|:: CompanyIndex:0 SpName: spADM_Login 
 4
 ,''
 ,''
 ,''
 ,'declare @AllowSession bit,@GUID nvarchar(50)
set @AllowSession=0
set @GUID=''3c7218fd-62ec-41bc-ab05-956b5afb9bc4''
if exists(select [GUID] from ADM_Login with(nolock) where [GUID]=@GUID)
begin
    update ADM_Login  set LastAccessTime=convert(float,getdate()) where [GUID]=@GUID
    set @AllowSession=1
end
select @AllowSession AllowSession
'
 ,''
 ,0
[System: 192.168.1.99] DEBUG | 11-13-2025 15:37:54.442 | General Service|:: CompanyIndex:348 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMzQ4LDEiLCJuYmYiOjE3NjMwMTkzMTcsImV4cCI6MTc2MzA0ODExNywiaWF0IjoxNzYzMDE5MzE3fQ.VpcXT6Y3RAP00m4CfI8rjfb5sp4khz2gEjXRlTIen40'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 11-13-2025 15:37:56.848 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 11-13-2025 15:37:56.864 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODAzNSwiZXhwIjoxNzYzMDU2ODM1LCJpYXQiOjE3NjMwMjgwMzV9.c4J7sRklVhN3hJ2g3cvBPJ5nYIFJIc4QnnPUO71wek4'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 11-13-2025 15:38:11.471 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 11-13-2025 15:38:11.471 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzYzMDI4MzA2LCJleHAiOjE3NjMwNTcxMDYsImlhdCI6MTc2MzAyODMwNn0.9MTBuB63fLAG0fQGvThybvQM9mQbqpwWlrfMtHu1T_M'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 11-13-2025 15:38:33.118 | General Service|:: CompanyIndex:0 SpName: spADM_Login 
 4
 ,''
 ,''
 ,''
 ,'declare @AllowSession bit,@GUID nvarchar(50)
set @AllowSession=0
set @GUID=''d048c437-f88c-48a9-b113-df62d0b0a8c4''
if exists(select [GUID] from ADM_Login with(nolock) where [GUID]=@GUID)
begin
    update ADM_Login  set LastAccessTime=convert(float,getdate()) where [GUID]=@GUID
    set @AllowSession=1
end
select @AllowSession AllowSession
'
 ,''
 ,0
[System: 192.168.1.77] DEBUG | 11-13-2025 15:38:33.118 | General Service|:: CompanyIndex:326 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMzI2LDEiLCJuYmYiOjE3NjMwMjY1OTIsImV4cCI6MTc2MzA1NTM5MiwiaWF0IjoxNzYzMDI2NTkyfQ.8Y5az9OV6b5kMlVwowet8ECaMfD5D_XA3Uq65skYL8E'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 11-13-2025 15:38:45.131 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 11-13-2025 15:38:45.131 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODAzNSwiZXhwIjoxNzYzMDU2ODM1LCJpYXQiOjE3NjMwMjgwMzV9.c4J7sRklVhN3hJ2g3cvBPJ5nYIFJIc4QnnPUO71wek4'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 11-13-2025 15:38:45.162 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 11-13-2025 15:38:45.178 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODA4NSwiZXhwIjoxNzYzMDU2ODg1LCJpYXQiOjE3NjMwMjgwODV9.eRlSN9oidYho75qh1pF4jTpIB4tw3U5pKBPBFSOfZsw'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 11-13-2025 15:38:54.501 | General Service|:: CompanyIndex:348 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 11-13-2025 15:38:54.501 | General Service|:: CompanyIndex:348 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 11-13-2025 15:38:54.501 | General Service|:: CompanyIndex:348 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMzQ4LDEiLCJuYmYiOjE3NjMwMTkzMTcsImV4cCI6MTc2MzA0ODExNywiaWF0IjoxNzYzMDE5MzE3fQ.VpcXT6Y3RAP00m4CfI8rjfb5sp4khz2gEjXRlTIen40'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 11-13-2025 15:38:54.516 | General Service|:: CompanyIndex:348 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMzQ4LDEiLCJuYmYiOjE3NjMwMTk4OTIsImV4cCI6MTc2MzA0ODY5MiwiaWF0IjoxNzYzMDE5ODkyfQ.QTTYhPJDdSuVk1AVSpo5BssLWyVUcTuIVOJ4BQ84bpU'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:38:58.503 | General Service|:: CompanyIndex:53 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.79] DEBUG | 11-13-2025 15:38:58.503 | General Service|:: CompanyIndex:0 SpName: spADM_Login 
 4
 ,''
 ,''
 ,''
 ,'declare @AllowSession bit,@GUID nvarchar(50)
set @AllowSession=0
set @GUID=''b1a838e4-0f69-4e17-92a1-6bd885314890''
if exists(select [GUID] from ADM_Login with(nolock) where [GUID]=@GUID)
begin
    update ADM_Login  set LastAccessTime=convert(float,getdate()) where [GUID]=@GUID
    set @AllowSession=1
end
select @AllowSession AllowSession
'
 ,''
 ,0
[System: 192.168.1.79] DEBUG | 11-13-2025 15:38:58.503 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyNjQxNSwiZXhwIjoxNzYzMDU1MjE1LCJpYXQiOjE3NjMwMjY0MTV9.mqMtGCBkQdPQ5Nxx_JYUSK6bjjHUGjTbtvYLdzkTdME'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:38:58.503 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyNjQxNSwiZXhwIjoxNzYzMDU1MjE1LCJpYXQiOjE3NjMwMjY0MTV9.mqMtGCBkQdPQ5Nxx_JYUSK6bjjHUGjTbtvYLdzkTdME'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:38:58.534 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:38:58.534 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyNjQxNSwiZXhwIjoxNzYzMDU1MjE1LCJpYXQiOjE3NjMwMjY0MTV9.mqMtGCBkQdPQ5Nxx_JYUSK6bjjHUGjTbtvYLdzkTdME'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:39:06.873 | General Service|:: CompanyIndex:0 SpName: spADM_GetClientUserDetails2C 
 'admin'
 ,1
 ,0
[System: 192.168.1.79] DEBUG | 11-13-2025 15:39:06.951 | General Service|:: CompanyIndex:0 SpName: spADM_UserLoginCheck 
 2
 ,'admin'
 ,0
 ,'192.168.1.79'
 ,'192.168.1.79'
 ,''
 ,'Web'
 ,1
[System: 192.168.1.73] DEBUG | 11-13-2025 15:39:11.556 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 11-13-2025 15:39:11.649 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzYzMDI4MzA2LCJleHAiOjE3NjMwNTcxMDYsImlhdCI6MTc2MzAyODMwNn0.9MTBuB63fLAG0fQGvThybvQM9mQbqpwWlrfMtHu1T_M'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:39:13.544 | General Service|:: CompanyIndex:103 SpName: spADM_GetClientUserDetails 
 'admin'
 ,1
 ,'26.8.6'
 ,0
[System: 192.168.1.79] DEBUG | 11-13-2025 15:39:13.607 | General Service|:: CompanyIndex:0 SpName: spADM_UserLoginCheck 
 2
 ,'admin'
 ,103
 ,'192.168.1.79'
 ,'192.168.1.79'
 ,''
 ,'Web'
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:39:13.623 | General Service|:: CompanyIndex:0 SpName: spADM_Login 
 1
 ,''
 ,''
 ,''
 ,''
 ,''
 ,103
[System: 192.168.1.79] DEBUG | 11-13-2025 15:39:13.623 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'select Value from ADM_GlobalPreferences with (nolock) where name =''EnableReLogin'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:39:13.623 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTAzLDEiLCJuYmYiOjE3NjMwMjg1NTMsImV4cCI6MTc2MzA1NzM1MywiaWF0IjoxNzYzMDI4NTUzfQ.O2JauUtbpQOyoNxGPcRwthghyHYfgqeSdo-MiM50Fdw'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:39:13.670 | General Service|:: CompanyIndex:0 SpName: spADM_Login 
 4
 ,''
 ,''
 ,''
 ,'declare @Cnt int,@ExpiredGUID nvarchar(50),@AllowSession int,@GUID nvarchar(50),@CurrDate float,@UserID INT,@Instances INT,@InstancesExists INT,@LCDBIndex int
set @CurrDate= convert(float,dateadd(minute,-21,getdate()))
set @AllowSession=0
set @GUID=''afd1133b-381b-4a07-bb1a-c0f566ac13fa''
set @LCDBIndex=0
select top 1 @UserID=UserID,@Instances=InstanceCount from ADM_Users with(nolock) where UserName=''admin''
if exists(select [GUID] from ADM_Login with(nolock) where [GUID]=@GUID)
begin
	update ADM_Login 
	set LastAccessTime=convert(float,getdate()),UserID=@UserID
	where [GUID]=@GUID
    set @AllowSession=1
end
else
begin
	select @Cnt=count(*) from ADM_Login with(nolock) where LCDBIndex=@LCDBIndex and [GUID]!=''ACCESSRIGHTS'' and AP =''WEB''
    if(@Cnt<100)
		set @AllowSession=1
	else
	begin
		select top 1 @ExpiredGUID=[GUID] from ADM_Login with(nolock)
		where [GUID]!=''ACCESSRIGHTS'' and LCDBIndex=@LCDBIndex and LastAccessTime<@CurrDate  and AP =''WEB''
        order by LastAccessTime asc
		if @ExpiredGUID is not null
		begin
			delete from ADM_Login where [GUID]=@ExpiredGUID
			set @AllowSession=1
		end
	end
	if @AllowSession=1
	begin
        select @InstancesExists=COUNT(*) from ADM_Login with(nolock)
		where [GUID]!=''ACCESSRIGHTS'' and LCDBIndex=@LCDBIndex and LastAccessTime>=@CurrDate and UserID=@UserID and AP =''WEB''
		if(@Instances!=0 and @Instances<=@InstancesExists)
			set @AllowSession=2
		else
		    INSERT INTO ADM_Login([GUID],[SysName],IPAddress,[Status],LoginTime,LastAccessTime,AccessRights,UserID,DBIndex,LCDBIndex,AP)
		    VALUES(@GUID,''WEB'',''192.168.1.79'',1,convert(float,getdate()),convert(float,getdate()),null,@UserID,103,@LCDBIndex, ''WEB'')
	end
end

select @AllowSession AllowSession,@Instances Instances,@InstancesExists InstancesExists
'
 ,''
 ,0
[System: 192.168.1.79] DEBUG | 11-13-2025 15:39:13.670 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTAzLDEiLCJuYmYiOjE3NjMwMjg1NTMsImV4cCI6MTc2MzA1NzM1MywiaWF0IjoxNzYzMDI4NTUzfQ.O2JauUtbpQOyoNxGPcRwthghyHYfgqeSdo-MiM50Fdw'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:39:13.748 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'SELECT (SELECT COUNT(*) FROM COM_Location L WITH(NOLOCK) JOIN COM_Status S WITH(NOLOCK) ON S.StatusID=L.StatusID WHERE L.IsGroup=0 AND S.[Status]=''Active'') ML
,(SELECT COUNT(*) FROM ADM_Features WITH(NOLOCK) WHERE ((FeatureID>50000 AND FeatureID<=50050) OR FeatureID>=51000) AND IsEnabled=1) MD
,(SELECT ISNULL(COUNT(*),0) FROM ADM_RevenUReports WITH(NOLOCK) WHERE IsGroup=0 AND ReportID>10000 AND StaticReportType IN (0,-1)) MR'
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:39:13.748 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTAzLDEiLCJuYmYiOjE3NjMwMjg1NTMsImV4cCI6MTc2MzA1NzM1MywiaWF0IjoxNzYzMDI4NTUzfQ.O2JauUtbpQOyoNxGPcRwthghyHYfgqeSdo-MiM50Fdw'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 11-13-2025 15:39:15.857 | General Service|:: CompanyIndex:326 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.77] DEBUG | 11-13-2025 15:39:15.872 | General Service|:: CompanyIndex:326 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMzI2LDEiLCJuYmYiOjE3NjMwMjY1OTIsImV4cCI6MTc2MzA1NTM5MiwiaWF0IjoxNzYzMDI2NTkyfQ.8Y5az9OV6b5kMlVwowet8ECaMfD5D_XA3Uq65skYL8E'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 11-13-2025 15:39:16.075 | General Service|:: CompanyIndex:326 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 11-13-2025 15:39:16.075 | General Service|:: CompanyIndex:326 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMzI2LDEiLCJuYmYiOjE3NjMwMjY1OTIsImV4cCI6MTc2MzA1NTM5MiwiaWF0IjoxNzYzMDI2NTkyfQ.8Y5az9OV6b5kMlVwowet8ECaMfD5D_XA3Uq65skYL8E'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:39:17.356 | General Service|:: CompanyIndex:103 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.79] DEBUG | 11-13-2025 15:39:17.372 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTAzLDEiLCJuYmYiOjE3NjMwMjg1NTMsImV4cCI6MTc2MzA1NzM1MywiaWF0IjoxNzYzMDI4NTUzfQ.O2JauUtbpQOyoNxGPcRwthghyHYfgqeSdo-MiM50Fdw'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:39:17.512 | General Service|:: CompanyIndex:103 SpName: spADM_GetRibbonView 
 1
 ,1
 ,1
 ,1
 ,0
 ,''
[System: 192.168.1.79] DEBUG | 11-13-2025 15:39:17.528 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTAzLDEiLCJuYmYiOjE3NjMwMjg1NTMsImV4cCI6MTc2MzA1NzM1MywiaWF0IjoxNzYzMDI4NTUzfQ.O2JauUtbpQOyoNxGPcRwthghyHYfgqeSdo-MiM50Fdw'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:39:17.684 | General Service|:: CompanyIndex:103 SpName: spRPT_GetReport 
 2
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:39:17.684 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTAzLDEiLCJuYmYiOjE3NjMwMjg1NTMsImV4cCI6MTc2MzA1NzM1MywiaWF0IjoxNzYzMDI4NTUzfQ.O2JauUtbpQOyoNxGPcRwthghyHYfgqeSdo-MiM50Fdw'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:39:17.700 | General Service|:: CompanyIndex:103 SpName: spADM_GetDashBoard 
 2
 ,0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:39:17.700 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTAzLDEiLCJuYmYiOjE3NjMwMjg1NTMsImV4cCI6MTc2MzA1NzM1MywiaWF0IjoxNzYzMDI4NTUzfQ.O2JauUtbpQOyoNxGPcRwthghyHYfgqeSdo-MiM50Fdw'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:39:17.715 | General Service|:: CompanyIndex:103 SpName: spCOM_ConfigValues 
 1
 ,'LandingDocs'
 ,'1'
[System: 192.168.1.79] DEBUG | 11-13-2025 15:39:17.715 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTAzLDEiLCJuYmYiOjE3NjMwMjg1NTMsImV4cCI6MTc2MzA1NzM1MywiaWF0IjoxNzYzMDI4NTUzfQ.O2JauUtbpQOyoNxGPcRwthghyHYfgqeSdo-MiM50Fdw'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:39:17.762 | General Service|:: CompanyIndex:103 SpName: spCOM_GetFavorites 
 'GETLIST0'
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:39:17.762 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTAzLDEiLCJuYmYiOjE3NjMwMjg1NTMsImV4cCI6MTc2MzA1NzM1MywiaWF0IjoxNzYzMDI4NTUzfQ.O2JauUtbpQOyoNxGPcRwthghyHYfgqeSdo-MiM50Fdw'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:39:17.762 | General Service|:: CompanyIndex:103 SpName: spADM_GetAllListViewsDef 
 1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:39:17.762 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTAzLDEiLCJuYmYiOjE3NjMwMjg1NTMsImV4cCI6MTc2MzA1NzM1MywiaWF0IjoxNzYzMDI4NTUzfQ.O2JauUtbpQOyoNxGPcRwthghyHYfgqeSdo-MiM50Fdw'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:39:17.872 | General Service|:: CompanyIndex:103 SpName: spADM_GetAllListViewsDef 
 1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:39:17.887 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTAzLDEiLCJuYmYiOjE3NjMwMjg1NTMsImV4cCI6MTc2MzA1NzM1MywiaWF0IjoxNzYzMDI4NTUzfQ.O2JauUtbpQOyoNxGPcRwthghyHYfgqeSdo-MiM50Fdw'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:39:17.981 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'Select CostCenterID,CostCenterColID,CostCenterName,SysTableName,UserColumnName,SysColumnName,ISNULL(UserDefaultValue,'''') UserDefaultValue
From AdM_CostCenterDef WITH(NOLOCK)
Where SysColumnName IN(''CreditAccount'',''DebitAccount'',''ProductID'') 
AND CostCenterID>40000 AND CostCenterID<50000 

SELECT * FROM ADM_Features WITH(NOLOCK) '
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:39:17.981 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTAzLDEiLCJuYmYiOjE3NjMwMjg1NTMsImV4cCI6MTc2MzA1NzM1MywiaWF0IjoxNzYzMDI4NTUzfQ.O2JauUtbpQOyoNxGPcRwthghyHYfgqeSdo-MiM50Fdw'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:39:18.028 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 '  SELECT * FROM PAY_PayrollPreferences WITH(NOLOCK) '
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:39:18.028 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTAzLDEiLCJuYmYiOjE3NjMwMjg1NTMsImV4cCI6MTc2MzA1NzM1MywiaWF0IjoxNzYzMDI4NTUzfQ.O2JauUtbpQOyoNxGPcRwthghyHYfgqeSdo-MiM50Fdw'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:39:18.059 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 '  --0
                                Select * FROM COM_CC50051 WITH(NOLOCK) WHERE IsGroup=0 AND LoginUserID=''admin''
                                --1                                
                                Select * FROM COM_CC50051 WITH(NOLOCK) WHERE RptManager IN (Select NodeID FROM COM_CC50051 WITH(NOLOCK) WHERE IsGroup=0 AND LoginUserID=''admin'')
                                UNION ALL
                                Select * FROM COM_CC50051 WITH(NOLOCK) WHERE RptManager IN 
                                (
	                                Select NodeID FROM COM_CC50051 WITH(NOLOCK) 
	                                WHERE IsGroup=0 AND LoginUserID IN
	                                (
	                                SELECT fe.LoginUserID
	                                FROM INV_DocDetails a WITH(NOLOCK) 
	                                JOIN COM_DocCCData b WITH(NOLOCK) ON b.InvDocDetailsID=a.InvDocDetailsID
	                                JOIN COM_DocNumData c WITH(NOLOCK) ON c.InvDocDetailsID=a.InvDocDetailsID
	                                JOIN COM_DocTextData d WITH(NOLOCK) ON d.InvDocDetailsID=a.InvDocDetailsID
	                                JOIN COM_CC50051 fe WITH(NOLOCK) on fe.NodeID=b.dcCCNID51
	                                JOIN COM_CC50051 te WITH(NOLOCK) on CONVERT(NVARCHAR,te.NodeID)=d.dcAlpha1
	                                WHERE a.CostCenterID=40098 and a.StatusID=369 AND d.dcAlpha3=''Temporary''
	                                AND te.LoginUserID=''admin'' 
	                                AND ISDATE(d.dcAlpha4)=1 AND ISDATE(d.dcAlpha5)=1 
	                                AND CONVERT(DATETIME,''13 Nov 2025'') BETWEEN CONVERT(DATETIME,d.dcAlpha4) AND CONVERT(DATETIME,d.dcAlpha5)
	                                )
                                )
                                --2
                                Select * FROM ADM_USERS WITH(NOLOCK) WHERE USERID=1
                                --3
                                Select * FROM COM_CostCenterCostCenterMap WITH(NOLOCK) WHERE ParentCostCenterID=7 AND ParentNodeID=1
                                --4                                
                                Select * FROM COM_CostCenterCostCenterMap WITH(NOLOCK) WHERE ParentCostCenterID=7 AND ParentNodeID=1
                                AND CostCenterID IN(Select ColumnCostCenterID From ADM_CostCenterDef Where CostCenterID=50051 AND IsColumnInUse=1 AND SysColumnName LIKE ''CCNID%'')
                                --5
                                Select * from COM_Files WITH(NOLOCK) WHERE FeatureID=50051 AND FeaturePK IN (Select NodeID FROM COM_CC50051 WITH(NOLOCK) WHERE IsGroup=0 AND LoginUserID=''admin'')                         
'
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:39:18.059 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTAzLDEiLCJuYmYiOjE3NjMwMjg1NTMsImV4cCI6MTc2MzA1NzM1MywiaWF0IjoxNzYzMDI4NTUzfQ.O2JauUtbpQOyoNxGPcRwthghyHYfgqeSdo-MiM50Fdw'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:39:18.262 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:39:18.278 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTAzLDEiLCJuYmYiOjE3NjMwMjg1NTMsImV4cCI6MTc2MzA1NzM1MywiaWF0IjoxNzYzMDI4NTUzfQ.O2JauUtbpQOyoNxGPcRwthghyHYfgqeSdo-MiM50Fdw'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:39:18.450 | General Service|:: CompanyIndex:103 SpName: spADM_GetDashBoard 
 1
 ,39
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:39:18.450 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTAzLDEiLCJuYmYiOjE3NjMwMjg1NTMsImV4cCI6MTc2MzA1NzM1MywiaWF0IjoxNzYzMDI4NTUzfQ.O2JauUtbpQOyoNxGPcRwthghyHYfgqeSdo-MiM50Fdw'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:39:18.559 | General Service|:: CompanyIndex:103 SpName: spCOM_GetFavorites 
 'VIEW'
 ,557
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:39:18.559 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTAzLDEiLCJuYmYiOjE3NjMwMjg1NTMsImV4cCI6MTc2MzA1NzM1MywiaWF0IjoxNzYzMDI4NTUzfQ.O2JauUtbpQOyoNxGPcRwthghyHYfgqeSdo-MiM50Fdw'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:39:18.590 | General Service|:: CompanyIndex:103 SpName: spCOM_GetFavorites 
 'VIEW'
 ,566
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:39:18.606 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTAzLDEiLCJuYmYiOjE3NjMwMjg1NTMsImV4cCI6MTc2MzA1NzM1MywiaWF0IjoxNzYzMDI4NTUzfQ.O2JauUtbpQOyoNxGPcRwthghyHYfgqeSdo-MiM50Fdw'''
 ,1
 ,1
[System: 192.168.1.74] DEBUG | 11-13-2025 15:39:19.137 | General Service|:: CompanyIndex:7 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.74] DEBUG | 11-13-2025 15:39:19.137 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzYzMDI2Njc2LCJleHAiOjE3NjMwNTU0NzYsImlhdCI6MTc2MzAyNjY3Nn0.OUTMfeEl3Upn9yWQqlYYcf42TAUVnQ776rkmrCdaBSg'''
 ,1
 ,1
[System: 192.168.1.74] DEBUG | 11-13-2025 15:39:19.168 | General Service|:: CompanyIndex:0 SpName: spADM_Login 
 4
 ,''
 ,''
 ,''
 ,'declare @AllowSession bit,@GUID nvarchar(50)
set @AllowSession=0
set @GUID=''8f62f70d-2727-463c-a2e1-399362e96850''
if exists(select [GUID] from ADM_Login with(nolock) where [GUID]=@GUID)
begin
    update ADM_Login  set LastAccessTime=convert(float,getdate()) where [GUID]=@GUID
    set @AllowSession=1
end
select @AllowSession AllowSession
'
 ,''
 ,0
[System: 192.168.1.74] DEBUG | 11-13-2025 15:39:19.184 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzYzMDI2Njc2LCJleHAiOjE3NjMwNTU0NzYsImlhdCI6MTc2MzAyNjY3Nn0.OUTMfeEl3Upn9yWQqlYYcf42TAUVnQ776rkmrCdaBSg'''
 ,1
 ,1
[System: 192.168.1.74] DEBUG | 11-13-2025 15:39:19.215 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.74] DEBUG | 11-13-2025 15:39:19.215 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzYzMDI2Njc2LCJleHAiOjE3NjMwNTU0NzYsImlhdCI6MTc2MzAyNjY3Nn0.OUTMfeEl3Upn9yWQqlYYcf42TAUVnQ776rkmrCdaBSg'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 11-13-2025 15:39:26.428 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 11-13-2025 15:39:26.428 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODA4NSwiZXhwIjoxNzYzMDU2ODg1LCJpYXQiOjE3NjMwMjgwODV9.eRlSN9oidYho75qh1pF4jTpIB4tw3U5pKBPBFSOfZsw'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:39:30.179 | General Service|:: CompanyIndex:103 SpName: spADM_GetCostCenterGridViewList 
 200
 ,1
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:39:30.179 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTAzLDEiLCJuYmYiOjE3NjMwMjg1NTMsImV4cCI6MTc2MzA1NzM1MywiaWF0IjoxNzYzMDI4NTUzfQ.O2JauUtbpQOyoNxGPcRwthghyHYfgqeSdo-MiM50Fdw'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:39:30.242 | General Service|:: CompanyIndex:103 SpName: spCom_GetCostCenterSummary 
 267
 ,-1
 ,1000
 ,''
 ,''
 ,''
 ,0
 ,'13-Nov-2025'
 ,NULL
 ,''
 ,1
 ,1
 ,0
 ,0
 ,False
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:39:30.242 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTAzLDEiLCJuYmYiOjE3NjMwMjg1NTMsImV4cCI6MTc2MzA1NzM1MywiaWF0IjoxNzYzMDI4NTUzfQ.O2JauUtbpQOyoNxGPcRwthghyHYfgqeSdo-MiM50Fdw'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:39:32.009 | General Service|:: CompanyIndex:103 SpName: spCom_GetCostCenterQuickViewDefn 
 200
 ,'20334'
 ,200
 ,1
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:39:32.024 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTAzLDEiLCJuYmYiOjE3NjMwMjg1NTMsImV4cCI6MTc2MzA1NzM1MywiaWF0IjoxNzYzMDI4NTUzfQ.O2JauUtbpQOyoNxGPcRwthghyHYfgqeSdo-MiM50Fdw'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:39:34.597 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=20334'
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:39:34.597 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTAzLDEiLCJuYmYiOjE3NjMwMjg1NTMsImV4cCI6MTc2MzA1NzM1MywiaWF0IjoxNzYzMDI4NTUzfQ.O2JauUtbpQOyoNxGPcRwthghyHYfgqeSdo-MiM50Fdw'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:39:34.612 | General Service|:: CompanyIndex:103 SpName: spRPT_GetReport 
 0
 ,20334
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:39:34.628 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTAzLDEiLCJuYmYiOjE3NjMwMjg1NTMsImV4cCI6MTc2MzA1NzM1MywiaWF0IjoxNzYzMDI4NTUzfQ.O2JauUtbpQOyoNxGPcRwthghyHYfgqeSdo-MiM50Fdw'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:39:34.769 | General Service|:: CompanyIndex:103 SpName: spRPT_GetReportCategoryandField 
 -1
 ,0
 ,1
 ,0
 ,'1'
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:39:34.784 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTAzLDEiLCJuYmYiOjE3NjMwMjg1NTMsImV4cCI6MTc2MzA1NzM1MywiaWF0IjoxNzYzMDI4NTUzfQ.O2JauUtbpQOyoNxGPcRwthghyHYfgqeSdo-MiM50Fdw'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:39:34.800 | General Service|:: CompanyIndex:103 SpName: spRPT_GetReportFields 
 40001
 ,0
 ,'1'
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:39:34.815 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTAzLDEiLCJuYmYiOjE3NjMwMjg1NTMsImV4cCI6MTc2MzA1NzM1MywiaWF0IjoxNzYzMDI4NTUzfQ.O2JauUtbpQOyoNxGPcRwthghyHYfgqeSdo-MiM50Fdw'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:39:34.831 | General Service|:: CompanyIndex:103 SpName: spDOC_GetVPTPrintCopies 
 4
 ,50
 ,20334
 ,2
 ,4
 ,'View~admin'
 ,'admin'
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:39:34.831 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTAzLDEiLCJuYmYiOjE3NjMwMjg1NTMsImV4cCI6MTc2MzA1NzM1MywiaWF0IjoxNzYzMDI4NTUzfQ.O2JauUtbpQOyoNxGPcRwthghyHYfgqeSdo-MiM50Fdw'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:39:34.862 | General Service|:: CompanyIndex:103 SpName: spRPT_GetReportFields 
 400
 ,0
 ,'1'
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:39:34.862 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTAzLDEiLCJuYmYiOjE3NjMwMjg1NTMsImV4cCI6MTc2MzA1NzM1MywiaWF0IjoxNzYzMDI4NTUzfQ.O2JauUtbpQOyoNxGPcRwthghyHYfgqeSdo-MiM50Fdw'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:39:34.909 | General Service|:: CompanyIndex:103 SpName: spRPT_GetReportFields 
 40001
 ,0
 ,'1'
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:39:34.909 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTAzLDEiLCJuYmYiOjE3NjMwMjg1NTMsImV4cCI6MTc2MzA1NzM1MywiaWF0IjoxNzYzMDI4NTUzfQ.O2JauUtbpQOyoNxGPcRwthghyHYfgqeSdo-MiM50Fdw'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:39:34.956 | General Service|:: CompanyIndex:103 SpName: spRPT_GetReportFields 
 2
 ,0
 ,'1'
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:39:34.956 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTAzLDEiLCJuYmYiOjE3NjMwMjg1NTMsImV4cCI6MTc2MzA1NzM1MywiaWF0IjoxNzYzMDI4NTUzfQ.O2JauUtbpQOyoNxGPcRwthghyHYfgqeSdo-MiM50Fdw'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:39:34.987 | General Service|:: CompanyIndex:103 SpName: spRPT_GetReportFields 
 110
 ,0
 ,'1'
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:39:34.987 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTAzLDEiLCJuYmYiOjE3NjMwMjg1NTMsImV4cCI6MTc2MzA1NzM1MywiaWF0IjoxNzYzMDI4NTUzfQ.O2JauUtbpQOyoNxGPcRwthghyHYfgqeSdo-MiM50Fdw'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:39:35.003 | General Service|:: CompanyIndex:103 SpName: spRPT_GetReportFields 
 50009
 ,0
 ,'1'
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:39:35.019 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTAzLDEiLCJuYmYiOjE3NjMwMjg1NTMsImV4cCI6MTc2MzA1NzM1MywiaWF0IjoxNzYzMDI4NTUzfQ.O2JauUtbpQOyoNxGPcRwthghyHYfgqeSdo-MiM50Fdw'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:39:35.050 | General Service|:: CompanyIndex:103 SpName: spADM_GetCostCenterGridViewList 
 2
 ,1
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:39:35.050 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTAzLDEiLCJuYmYiOjE3NjMwMjg1NTMsImV4cCI6MTc2MzA1NzM1MywiaWF0IjoxNzYzMDI4NTUzfQ.O2JauUtbpQOyoNxGPcRwthghyHYfgqeSdo-MiM50Fdw'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:39:35.393 | General Service|:: CompanyIndex:103 SpName: spCom_GetCostCenterSummary 
 126
 ,-1
 ,1000
 ,'#DEBITORCREDITORTEE#'
 ,''
 ,''
 ,0
 ,'13-Nov-2025'
 ,NULL
 ,''
 ,1
 ,1
 ,0
 ,0
 ,False
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:39:35.393 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTAzLDEiLCJuYmYiOjE3NjMwMjg1NTMsImV4cCI6MTc2MzA1NzM1MywiaWF0IjoxNzYzMDI4NTUzfQ.O2JauUtbpQOyoNxGPcRwthghyHYfgqeSdo-MiM50Fdw'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:39:35.440 | General Service|:: CompanyIndex:103 SpName: spADM_GetLocationRole 
 50002
 ,1
 message=Saved Succesfully
[System: 192.168.1.79] DEBUG | 11-13-2025 15:39:35.440 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTAzLDEiLCJuYmYiOjE3NjMwMjg1NTMsImV4cCI6MTc2MzA1NzM1MywiaWF0IjoxNzYzMDI4NTUzfQ.O2JauUtbpQOyoNxGPcRwthghyHYfgqeSdo-MiM50Fdw'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:39:35.440 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'SELECT CL.RESOURCEDATA Name FROM [ADM_Features] ADF WITH(NOLOCK),COM_LANGUAGERESOURCES CL WITH(NOLOCK) WHERE ADF.RESOURCEID=CL.RESOURCEID AND ADF.FeatureID=50002 AND CL.LanguageID=1'
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:39:35.456 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTAzLDEiLCJuYmYiOjE3NjMwMjg1NTMsImV4cCI6MTc2MzA1NzM1MywiaWF0IjoxNzYzMDI4NTUzfQ.O2JauUtbpQOyoNxGPcRwthghyHYfgqeSdo-MiM50Fdw'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:39:35.456 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'SELECT CurrencyID,Name,ExchangeRate FROM COM_Currency WITH(NOLOCK)'
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:39:35.456 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTAzLDEiLCJuYmYiOjE3NjMwMjg1NTMsImV4cCI6MTc2MzA1NzM1MywiaWF0IjoxNzYzMDI4NTUzfQ.O2JauUtbpQOyoNxGPcRwthghyHYfgqeSdo-MiM50Fdw'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:39:35.472 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'SELECT CurrencyID,Name,ExchangeRate FROM COM_Currency WITH(NOLOCK)'
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:39:35.472 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTAzLDEiLCJuYmYiOjE3NjMwMjg1NTMsImV4cCI6MTc2MzA1NzM1MywiaWF0IjoxNzYzMDI4NTUzfQ.O2JauUtbpQOyoNxGPcRwthghyHYfgqeSdo-MiM50Fdw'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 11-13-2025 15:39:36.933 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 11-13-2025 15:39:36.933 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODAzNSwiZXhwIjoxNzYzMDU2ODM1LCJpYXQiOjE3NjMwMjgwMzV9.c4J7sRklVhN3hJ2g3cvBPJ5nYIFJIc4QnnPUO71wek4'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:39:39.667 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'SELECT DefaultPreferences FROM ADM_RevenUReports with(nolock) WHERE ReportID=13'
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:39:39.667 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTAzLDEiLCJuYmYiOjE3NjMwMjg1NTMsImV4cCI6MTc2MzA1NzM1MywiaWF0IjoxNzYzMDI4NTUzfQ.O2JauUtbpQOyoNxGPcRwthghyHYfgqeSdo-MiM50Fdw'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:39:39.699 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'select CostCenterID from ADM_CostCenterDef with(nolock) where SysColumnName=''BillNo'' and IsVisible=1 and SysTableName=''ACC_DocDetails'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:39:39.699 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTAzLDEiLCJuYmYiOjE3NjMwMjg1NTMsImV4cCI6MTc2MzA1NzM1MywiaWF0IjoxNzYzMDI4NTUzfQ.O2JauUtbpQOyoNxGPcRwthghyHYfgqeSdo-MiM50Fdw'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:39:40.434 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'DECLARE @To FLOAT
SET @To=CONVERT(FLOAT,CONVERT(DATETIME,''13 Nov 2025''))
SELECT *,case when Amount>0 then 1 else 0 end AmtOrder FROM (	SELECT A.AccountID,B.DocSeqNo,A.AccountName AS AccountName,A.AccountID AS AccountName_ID,CONVERT(DATETIME,B.DocDate) DocDate,CONVERT(DATETIME,B.DocDueDate) DueDate,CONVERT(DATETIME,B.DocDate) VoucherDate,B.DocNo,AdjAmount+ISNULL((select sum(CB.AdjAmount) from COM_Billwise CB with(nolock) where CB.AccountID=B.AccountID AND CB.DocNo=B.DocNo and CB.IsNewReference=0 AND CB.DocSeqNo=B.DocSeqNo AND CB.RefDocDate>@To),0) Amount,AdjAmount BillAmount,case when B.DocType=16 then (SELECT TOP 1 BillNo FROM ACC_DocDetails WITH(NOLOCK) WHERE B.DocNo=VoucherNo and B.DocSeqNo=DocSeqNo) else (SELECT TOP 1 BillNo FROM INV_DocDetails WITH(NOLOCK) WHERE B.DocNo=VoucherNo) end BillNo,case when B.DocType=16 then (SELECT TOP 1 CONVERT(DATETIME, BillDate) FROM ACC_DocDetails WITH(NOLOCK) WHERE B.DocNo=VoucherNo and B.DocSeqNo=DocSeqNo) else (SELECT TOP 1 CONVERT(DATETIME, BillDate) FROM INV_DocDetails WITH(NOLOCK) WHERE B.DocNo=VoucherNo) end BillDate,C50002.Name AS Location,    
(SELECT SUM(AdjAmount) Adjusted FROM COM_Billwise CB WITH(NOLOCK) WHERE IsNewReference=0 AND CB.DocDate<=@To AND CB.AccountID=B.AccountID AND CB.RefDocNo=B.DocNo AND  CB.DocType<>14 AND CB.DocType<>19 AND (SELECT top(1) 1 FROM ACC_DocDetails ACC WITH(NOLOCK) WHERE ACC.VoucherNo=CB.DocNo and (StatusID=369 or StatusID=429))=1 AND CB.RefDocSeqNo=B.DocSeqNo) Adjusted,CASE WHEN DType.IsInventory=0 THEN
  (SELECT MAX(DOC.CommonNarration) FROM Acc_DocDetails DOC WITH(NOLOCK) WHERE DOC.VoucherNo=B.DocNo and Doc.DocSeqNo=B.DocSeqNo)
  ELSE
  (SELECT MAX(DOC.CommonNarration) FROM INV_DocDetails DOC WITH(NOLOCK) WHERE DOC.VoucherNo=B.DocNo)  END AS C337e1c8baa3b4ac0b3a2682d9d88fc63,CASE WHEN DType.IsInventory=0 THEN NULL ELSE
(STUFF((SELECT distinct '',''+VoucherNo FROM INV_DocDetails with(nolock) WHERE InvDocDetailsID IN 
(select LinkedInvDocDetailsID from INV_DocDetails with(nolock) WHERE VoucherNo=B.DocNo and LinkedInvDocDetailsID>0) FOR XML PATH('''')),1,1,'''')) END AS Cdf3533811555463c963af67849b1c17e,T1.Code Cd6882cec5b8a44fcb0c1be3976f3c29a,T1.Name C02934645c08a4ed3a3dfbd5a980f1761,T2.Name Cda273e47f52943fcae5bf08cc75c5512,CASE WHEN DType.IsInventory=0 THEN
  (SELECT MAX(convert(datetime,DOC.DueDate)) FROM Acc_DocDetails DOC WITH(NOLOCK) WHERE DOC.VoucherNo=B.DocNo and Doc.DocSeqNo=B.DocSeqNo)
  ELSE
  (SELECT MAX(convert(datetime,DOC.DueDate)) FROM INV_DocDetails DOC WITH(NOLOCK) WHERE DOC.VoucherNo=B.DocNo)  END AS C9256e42b51c94b18b0cfb15615481c0d,(B.DocDueDate-B.DocDate) CreditDays
,@To-B.DocDate OverDue
,B.DocType,(SELECT TOP 1 ACC.StatusID FROM ACC_DocDetails ACC with(nolock) WHERE ACC.VoucherNo=B.DocNo) StatusID 
FROM COM_Billwise B with(nolock) INNER JOIN ACC_Accounts A WITH(NOLOCK) ON B.AccountID=A.AccountID     
INNER JOIN COM_Location AS C50002 with(nolock) ON B.dcCCNID2 = C50002.NodeID  INNER JOIN (SELECT DocumentType DocType1,IsInventory FROM ADM_DocumentTypes with(nolock) Group By DocumentType,IsInventory) AS DType ON  DType.DocType1=B.DocType  INNER JOIN COM_CC50009 AS T1 with(nolock) ON T1.NodeID=B.dcCCNID9 INNER JOIN COM_Salesman AS T2 with(nolock) ON T2.NodeID=B.dcCCNID5 WHERE B.IsNewReference=1 AND B.DocDate<=@To AND A.AccountTypeID IN (6,7) ) AS T  WHERE (Adjusted IS NULL OR abs(Amount+Adjusted)>0.099) AND DocType<>14 AND DocType<>19 and (StatusID=369 or StatusID=429)
 UNION ALL  SELECT *,case when Amount>0 then 1 else 0 end AmtOrder FROM (	SELECT A.AccountID,B.DocSeqNo,A.AccountName AS AccountName,A.AccountID AS AccountName_ID,CONVERT(DATETIME,B.DocDate) DocDate,CONVERT(DATETIME,B.DocDueDate) DueDate,CONVERT(DATETIME,B.DocDate) VoucherDate,B.DocNo,B.AdjAmount Amount,B.AdjAmount BillAmount,case when B.DocType=16 then (SELECT TOP 1 BillNo FROM ACC_DocDetails WITH(NOLOCK) WHERE B.DocNo=VoucherNo and B.DocSeqNo=DocSeqNo) else (SELECT TOP 1 BillNo FROM INV_DocDetails WITH(NOLOCK) WHERE B.DocNo=VoucherNo) end BillNo,case when B.DocType=16 then (SELECT TOP 1 CONVERT(DATETIME, BillDate) FROM ACC_DocDetails WITH(NOLOCK) WHERE B.DocNo=VoucherNo and B.DocSeqNo=DocSeqNo) else (SELECT TOP 1 CONVERT(DATETIME, BillDate) FROM INV_DocDetails WITH(NOLOCK) WHERE B.DocNo=VoucherNo) end BillDate,C50002.Name AS Location,    
(SELECT SUM(CB.AdjAmount) Adjusted FROM COM_Billwise CB WITH(NOLOCK) WHERE IsNewReference=0 AND CB.DocDate<=@To AND CB.AccountID=B.AccountID AND CB.RefDocNo=B.DocNo AND  CB.DocType<>14 AND CB.DocType<>19 AND (SELECT top(1) 1 FROM ACC_DocDetails ACC WITH(NOLOCK) WHERE ACC.VoucherNo=CB.DocNo and (StatusID=369 or StatusID=429))=1 AND CB.RefDocSeqNo=B.DocSeqNo) Adjusted,CASE WHEN DType.IsInventory=0 THEN
  (SELECT MAX(DOC.CommonNarration) FROM Acc_DocDetails DOC WITH(NOLOCK) WHERE DOC.VoucherNo=B.DocNo and Doc.DocSeqNo=B.DocSeqNo)
  ELSE
  (SELECT MAX(DOC.CommonNarration) FROM INV_DocDetails DOC WITH(NOLOCK) WHERE DOC.VoucherNo=B.DocNo)  END AS C337e1c8baa3b4ac0b3a2682d9d88fc63,CASE WHEN DType.IsInventory=0 THEN NULL ELSE
(STUFF((SELECT distinct '',''+VoucherNo FROM INV_DocDetails with(nolock) WHERE InvDocDetailsID IN 
(select LinkedInvDocDetailsID from INV_DocDetails with(nolock) WHERE VoucherNo=B.DocNo and LinkedInvDocDetailsID>0) FOR XML PATH('''')),1,1,'''')) END AS Cdf3533811555463c963af67849b1c17e,T1.Code Cd6882cec5b8a44fcb0c1be3976f3c29a,T1.Name C02934645c08a4ed3a3dfbd5a980f1761,T2.Name Cda273e47f52943fcae5bf08cc75c5512,CASE WHEN DType.IsInventory=0 THEN
  (SELECT MAX(convert(datetime,DOC.DueDate)) FROM Acc_DocDetails DOC WITH(NOLOCK) WHERE DOC.VoucherNo=B.DocNo and Doc.DocSeqNo=B.DocSeqNo)
  ELSE
  (SELECT MAX(convert(datetime,DOC.DueDate)) FROM INV_DocDetails DOC WITH(NOLOCK) WHERE DOC.VoucherNo=B.DocNo)  END AS C9256e42b51c94b18b0cfb15615481c0d,(B.DocDueDate-B.DocDate) CreditDays
 ,@To-B.DocDate OverDue
 ,B.DocType,(SELECT TOP 1 ACC.StatusID FROM ACC_DocDetails ACC with(nolock) WHERE ACC.VoucherNo=B.DocNo) StatusID 
 FROM COM_Billwise B with(nolock) INNER JOIN ACC_Accounts A WITH(NOLOCK) ON B.AccountID=A.AccountID     
 INNER JOIN COM_Location AS C50002 with(nolock) ON B.dcCCNID2 = C50002.NodeID  INNER JOIN (SELECT DocumentType DocType1,IsInventory FROM ADM_DocumentTypes with(nolock) Group By DocumentType,IsInventory) AS DType ON  DType.DocType1=B.DocType  INNER JOIN COM_CC50009 AS T1 with(nolock) ON T1.NodeID=B.dcCCNID9 INNER JOIN COM_Salesman AS T2 with(nolock) ON T2.NodeID=B.dcCCNID5 
 LEFT JOIN COM_Billwise BCB with(nolock) ON BCB.AccountID=B.AccountID AND BCB.DocNo=B.DocNo and BCB.IsNewReference=1 AND BCB.DocSeqNo=B.DocSeqNo  WHERE B.IsNewReference=0 AND B.DocDate<=@To AND B.RefDocDate>@To AND BCB.AccountID is null AND A.AccountTypeID IN (6,7) ) AS T  WHERE (Adjusted IS NULL OR abs(Amount+Adjusted)>0.099) AND DocType<>14 AND DocType<>19 and (StatusID=369 or StatusID=429) ORDER BY AccountName,DocDate,AmtOrder,DocNo'
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:39:40.434 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTAzLDEiLCJuYmYiOjE3NjMwMjg1NTMsImV4cCI6MTc2MzA1NzM1MywiaWF0IjoxNzYzMDI4NTUzfQ.O2JauUtbpQOyoNxGPcRwthghyHYfgqeSdo-MiM50Fdw'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:39:40.841 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'select CostCenterID from ADM_CostCenterDef with(nolock) where SysColumnName=''BillNo'' and IsVisible=1 and SysTableName=''ACC_DocDetails'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:39:40.841 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTAzLDEiLCJuYmYiOjE3NjMwMjg1NTMsImV4cCI6MTc2MzA1NzM1MywiaWF0IjoxNzYzMDI4NTUzfQ.O2JauUtbpQOyoNxGPcRwthghyHYfgqeSdo-MiM50Fdw'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:39:40.950 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'DECLARE @AccountingDate FLOAT,@AsOnDate FLOAT
SET @AccountingDate=CONVERT(FLOAT,CONVERT(DATETIME,''04 Jun 2015'')) SET @AsOnDate=CONVERT(FLOAT,CONVERT(DATETIME,''13 Nov 2025''))SELECT A.AccountID,A.AccountName FROM ACC_Accounts A with(nolock) WHERE A.Depth>0 AND A.AccountTypeID IN (6,7) ORDER BY A.AccountName SELECT * from ( SELECT CONVERT(DATETIME,B.DocDate) DocDate,B.AccountID,B.AdjAmount+ISNULL((SELECT SUM(CB.AdjAmount) FROM COM_Billwise CB with(nolock) WHERE CB.RefDocNo=B.DocNo AND CB.AccountID=B.AccountID AND CB.RefDocSeqNo=B.DocSeqNo AND CB.IsNewReference=0 AND CB.DocDate<=@AsOnDate AND  DocType<>14 AND DocType<>19 AND (SELECT top(1) 1 FROM ACC_DocDetails ACC WITH(NOLOCK) WHERE ACC.VoucherNo=CB.DocNo and (StatusID=369 or StatusID=429))=1),0) AdjAmount FROM COM_Billwise B WITH(NOLOCK) INNER JOIN ACC_Accounts A ON A.AccountID=B.AccountID AND A.AccountTypeID IN (6,7) WHERE B.IsNewReference=1 AND B.DocDate<=@AsOnDate AND DocType<>14 AND DocType<>19 AND (SELECT top(1) 1 FROM ACC_DocDetails ACC WITH(NOLOCK) WHERE ACC.VoucherNo=B.DocNo and (StatusID=369 or StatusID=429))=1 ) AS T WHERE abs(AdjAmount)>0.099'
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:39:40.950 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTAzLDEiLCJuYmYiOjE3NjMwMjg1NTMsImV4cCI6MTc2MzA1NzM1MywiaWF0IjoxNzYzMDI4NTUzfQ.O2JauUtbpQOyoNxGPcRwthghyHYfgqeSdo-MiM50Fdw'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:39:41.028 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'select CostCenterID from ADM_CostCenterDef with(nolock) where SysColumnName=''BillNo'' and IsVisible=1 and SysTableName=''ACC_DocDetails'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:39:41.043 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTAzLDEiLCJuYmYiOjE3NjMwMjg1NTMsImV4cCI6MTc2MzA1NzM1MywiaWF0IjoxNzYzMDI4NTUzfQ.O2JauUtbpQOyoNxGPcRwthghyHYfgqeSdo-MiM50Fdw'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:39:41.200 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'DECLARE @AccountingDate FLOAT,@AsOnDate FLOAT
SET @AccountingDate=CONVERT(FLOAT,CONVERT(DATETIME,''04 Jun 2015'')) SET @AsOnDate=CONVERT(FLOAT,CONVERT(DATETIME,''13 Nov 2025''))SELECT A.AccountID,A.AccountName FROM ACC_Accounts A with(nolock) WHERE A.Depth>0 AND A.AccountTypeID IN (6,7) ORDER BY A.AccountName SELECT * from ( SELECT CONVERT(DATETIME,B.DocDate) DocDate,B.AccountID,B.AdjAmount+ISNULL((SELECT SUM(CB.AdjAmount) FROM COM_Billwise CB with(nolock) WHERE CB.RefDocNo=B.DocNo AND CB.AccountID=B.AccountID AND CB.RefDocSeqNo=B.DocSeqNo AND CB.IsNewReference=0 AND CB.DocDate<=@AsOnDate AND  DocType<>14 AND DocType<>19 AND (SELECT top(1) 1 FROM ACC_DocDetails ACC WITH(NOLOCK) WHERE ACC.VoucherNo=CB.DocNo and (StatusID=369 or StatusID=429))=1),0) AdjAmount FROM COM_Billwise B WITH(NOLOCK) INNER JOIN ACC_Accounts A ON A.AccountID=B.AccountID AND A.AccountTypeID IN (6,7) WHERE B.IsNewReference=1 AND B.DocDate<=@AsOnDate AND DocType<>14 AND DocType<>19 AND (SELECT top(1) 1 FROM ACC_DocDetails ACC WITH(NOLOCK) WHERE ACC.VoucherNo=B.DocNo and (StatusID=369 or StatusID=429))=1 ) AS T WHERE abs(AdjAmount)>0.099'
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:39:41.200 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTAzLDEiLCJuYmYiOjE3NjMwMjg1NTMsImV4cCI6MTc2MzA1NzM1MywiaWF0IjoxNzYzMDI4NTUzfQ.O2JauUtbpQOyoNxGPcRwthghyHYfgqeSdo-MiM50Fdw'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 11-13-2025 15:39:54.446 | General Service|:: CompanyIndex:348 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 11-13-2025 15:39:54.446 | General Service|:: CompanyIndex:348 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 11-13-2025 15:39:54.446 | General Service|:: CompanyIndex:348 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMzQ4LDEiLCJuYmYiOjE3NjMwMTkzMTcsImV4cCI6MTc2MzA0ODExNywiaWF0IjoxNzYzMDE5MzE3fQ.VpcXT6Y3RAP00m4CfI8rjfb5sp4khz2gEjXRlTIen40'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 11-13-2025 15:39:54.446 | General Service|:: CompanyIndex:348 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMzQ4LDEiLCJuYmYiOjE3NjMwMTk4OTIsImV4cCI6MTc2MzA0ODY5MiwiaWF0IjoxNzYzMDE5ODkyfQ.QTTYhPJDdSuVk1AVSpo5BssLWyVUcTuIVOJ4BQ84bpU'''
 ,1
 ,1
[System: 192.168.1.74] DEBUG | 11-13-2025 15:40:00.743 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.74] DEBUG | 11-13-2025 15:40:00.743 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzYzMDI2Njc2LCJleHAiOjE3NjMwNTU0NzYsImlhdCI6MTc2MzAyNjY3Nn0.OUTMfeEl3Upn9yWQqlYYcf42TAUVnQ776rkmrCdaBSg'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 11-13-2025 15:40:10.190 | General Service|:: CompanyIndex:7 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.73] DEBUG | 11-13-2025 15:40:10.190 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzYzMDI4MzA2LCJleHAiOjE3NjMwNTcxMDYsImlhdCI6MTc2MzAyODMwNn0.9MTBuB63fLAG0fQGvThybvQM9mQbqpwWlrfMtHu1T_M'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 11-13-2025 15:40:11.415 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 11-13-2025 15:40:11.415 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzYzMDI4MzA2LCJleHAiOjE3NjMwNTcxMDYsImlhdCI6MTc2MzAyODMwNn0.9MTBuB63fLAG0fQGvThybvQM9mQbqpwWlrfMtHu1T_M'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 11-13-2025 15:40:15.892 | General Service|:: CompanyIndex:326 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 11-13-2025 15:40:15.907 | General Service|:: CompanyIndex:326 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMzI2LDEiLCJuYmYiOjE3NjMwMjY1OTIsImV4cCI6MTc2MzA1NTM5MiwiaWF0IjoxNzYzMDI2NTkyfQ.8Y5az9OV6b5kMlVwowet8ECaMfD5D_XA3Uq65skYL8E'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:40:18.707 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:40:18.707 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTAzLDEiLCJuYmYiOjE3NjMwMjg1NTMsImV4cCI6MTc2MzA1NzM1MywiaWF0IjoxNzYzMDI4NTUzfQ.O2JauUtbpQOyoNxGPcRwthghyHYfgqeSdo-MiM50Fdw'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 11-13-2025 15:40:35.869 | General Service|:: CompanyIndex:53 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.77] DEBUG | 11-13-2025 15:40:35.885 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODAzNSwiZXhwIjoxNzYzMDU2ODM1LCJpYXQiOjE3NjMwMjgwMzV9.c4J7sRklVhN3hJ2g3cvBPJ5nYIFJIc4QnnPUO71wek4'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 11-13-2025 15:40:36.932 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 11-13-2025 15:40:36.932 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODAzNSwiZXhwIjoxNzYzMDU2ODM1LCJpYXQiOjE3NjMwMjgwMzV9.c4J7sRklVhN3hJ2g3cvBPJ5nYIFJIc4QnnPUO71wek4'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 11-13-2025 15:40:54.409 | General Service|:: CompanyIndex:348 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.99] DEBUG | 11-13-2025 15:40:54.409 | General Service|:: CompanyIndex:348 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMzQ4LDEiLCJuYmYiOjE3NjMwMTkzMTcsImV4cCI6MTc2MzA0ODExNywiaWF0IjoxNzYzMDE5MzE3fQ.VpcXT6Y3RAP00m4CfI8rjfb5sp4khz2gEjXRlTIen40'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 11-13-2025 15:40:54.409 | General Service|:: CompanyIndex:348 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.99] DEBUG | 11-13-2025 15:40:54.424 | General Service|:: CompanyIndex:348 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMzQ4LDEiLCJuYmYiOjE3NjMwMTk4OTIsImV4cCI6MTc2MzA0ODY5MiwiaWF0IjoxNzYzMDE5ODkyfQ.QTTYhPJDdSuVk1AVSpo5BssLWyVUcTuIVOJ4BQ84bpU'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 11-13-2025 15:40:54.471 | General Service|:: CompanyIndex:348 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 11-13-2025 15:40:54.471 | General Service|:: CompanyIndex:348 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 11-13-2025 15:40:54.471 | General Service|:: CompanyIndex:348 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMzQ4LDEiLCJuYmYiOjE3NjMwMTkzMTcsImV4cCI6MTc2MzA0ODExNywiaWF0IjoxNzYzMDE5MzE3fQ.VpcXT6Y3RAP00m4CfI8rjfb5sp4khz2gEjXRlTIen40'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 11-13-2025 15:40:54.471 | General Service|:: CompanyIndex:348 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMzQ4LDEiLCJuYmYiOjE3NjMwMTk4OTIsImV4cCI6MTc2MzA0ODY5MiwiaWF0IjoxNzYzMDE5ODkyfQ.QTTYhPJDdSuVk1AVSpo5BssLWyVUcTuIVOJ4BQ84bpU'''
 ,1
 ,1
[System: 192.168.1.74] DEBUG | 11-13-2025 15:41:16.721 | General Service|:: CompanyIndex:0 SpName: spADM_Login 
 6
 ,'8f62f70d-2727-463c-a2e1-399362e96850'
 ,''
 ,''
 ,''
 ,''
 ,0
[System: 192.168.1.74] DEBUG | 11-13-2025 15:41:16.736 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzYzMDI2Njc2LCJleHAiOjE3NjMwNTU0NzYsImlhdCI6MTc2MzAyNjY3Nn0.OUTMfeEl3Upn9yWQqlYYcf42TAUVnQ776rkmrCdaBSg'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 11-13-2025 15:41:18.561 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 11-13-2025 15:41:18.561 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODA4NSwiZXhwIjoxNzYzMDU2ODg1LCJpYXQiOjE3NjMwMjgwODV9.eRlSN9oidYho75qh1pF4jTpIB4tw3U5pKBPBFSOfZsw'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 11-13-2025 15:41:18.561 | General Service|:: CompanyIndex:326 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 11-13-2025 15:41:18.576 | General Service|:: CompanyIndex:326 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMzI2LDEiLCJuYmYiOjE3NjMwMjY1OTIsImV4cCI6MTc2MzA1NTM5MiwiaWF0IjoxNzYzMDI2NTkyfQ.8Y5az9OV6b5kMlVwowet8ECaMfD5D_XA3Uq65skYL8E'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:41:18.748 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:41:18.748 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTAzLDEiLCJuYmYiOjE3NjMwMjg1NTMsImV4cCI6MTc2MzA1NzM1MywiaWF0IjoxNzYzMDI4NTUzfQ.O2JauUtbpQOyoNxGPcRwthghyHYfgqeSdo-MiM50Fdw'''
 ,1
 ,1
[System: 192.168.1.74] DEBUG | 11-13-2025 15:41:18.795 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 11-13-2025 15:41:18.795 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.74] DEBUG | 11-13-2025 15:41:18.811 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzYzMDI2Njc2LCJleHAiOjE3NjMwNTU0NzYsImlhdCI6MTc2MzAyNjY3Nn0.OUTMfeEl3Upn9yWQqlYYcf42TAUVnQ776rkmrCdaBSg'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 11-13-2025 15:41:18.811 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzYzMDI4MzA2LCJleHAiOjE3NjMwNTcxMDYsImlhdCI6MTc2MzAyODMwNn0.9MTBuB63fLAG0fQGvThybvQM9mQbqpwWlrfMtHu1T_M'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 11-13-2025 15:41:25.393 | General Service|:: CompanyIndex:53 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.73] DEBUG | 11-13-2025 15:41:25.393 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODA4NSwiZXhwIjoxNzYzMDU2ODg1LCJpYXQiOjE3NjMwMjgwODV9.eRlSN9oidYho75qh1pF4jTpIB4tw3U5pKBPBFSOfZsw'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 11-13-2025 15:41:36.935 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 11-13-2025 15:41:36.935 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODAzNSwiZXhwIjoxNzYzMDU2ODM1LCJpYXQiOjE3NjMwMjgwMzV9.c4J7sRklVhN3hJ2g3cvBPJ5nYIFJIc4QnnPUO71wek4'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 11-13-2025 15:41:54.464 | General Service|:: CompanyIndex:348 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 11-13-2025 15:41:54.464 | General Service|:: CompanyIndex:348 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMzQ4LDEiLCJuYmYiOjE3NjMwMTkzMTcsImV4cCI6MTc2MzA0ODExNywiaWF0IjoxNzYzMDE5MzE3fQ.VpcXT6Y3RAP00m4CfI8rjfb5sp4khz2gEjXRlTIen40'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 11-13-2025 15:41:54.495 | General Service|:: CompanyIndex:348 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 11-13-2025 15:41:54.495 | General Service|:: CompanyIndex:348 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMzQ4LDEiLCJuYmYiOjE3NjMwMTk4OTIsImV4cCI6MTc2MzA0ODY5MiwiaWF0IjoxNzYzMDE5ODkyfQ.QTTYhPJDdSuVk1AVSpo5BssLWyVUcTuIVOJ4BQ84bpU'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 11-13-2025 15:42:11.416 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 11-13-2025 15:42:11.416 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzYzMDI4MzA2LCJleHAiOjE3NjMwNTcxMDYsImlhdCI6MTc2MzAyODMwNn0.9MTBuB63fLAG0fQGvThybvQM9mQbqpwWlrfMtHu1T_M'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 11-13-2025 15:42:15.871 | General Service|:: CompanyIndex:326 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.77] DEBUG | 11-13-2025 15:42:15.871 | General Service|:: CompanyIndex:326 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMzI2LDEiLCJuYmYiOjE3NjMwMjY1OTIsImV4cCI6MTc2MzA1NTM5MiwiaWF0IjoxNzYzMDI2NTkyfQ.8Y5az9OV6b5kMlVwowet8ECaMfD5D_XA3Uq65skYL8E'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 11-13-2025 15:42:15.918 | General Service|:: CompanyIndex:326 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 11-13-2025 15:42:15.918 | General Service|:: CompanyIndex:326 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMzI2LDEiLCJuYmYiOjE3NjMwMjY1OTIsImV4cCI6MTc2MzA1NTM5MiwiaWF0IjoxNzYzMDI2NTkyfQ.8Y5az9OV6b5kMlVwowet8ECaMfD5D_XA3Uq65skYL8E'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 11-13-2025 15:42:18.434 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 11-13-2025 15:42:18.434 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODA4NSwiZXhwIjoxNzYzMDU2ODg1LCJpYXQiOjE3NjMwMjgwODV9.eRlSN9oidYho75qh1pF4jTpIB4tw3U5pKBPBFSOfZsw'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:42:18.824 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:42:18.824 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTAzLDEiLCJuYmYiOjE3NjMwMjg1NTMsImV4cCI6MTc2MzA1NzM1MywiaWF0IjoxNzYzMDI4NTUzfQ.O2JauUtbpQOyoNxGPcRwthghyHYfgqeSdo-MiM50Fdw'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 11-13-2025 15:42:36.924 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 11-13-2025 15:42:36.939 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODAzNSwiZXhwIjoxNzYzMDU2ODM1LCJpYXQiOjE3NjMwMjgwMzV9.c4J7sRklVhN3hJ2g3cvBPJ5nYIFJIc4QnnPUO71wek4'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 11-13-2025 15:42:54.451 | General Service|:: CompanyIndex:348 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 11-13-2025 15:42:54.451 | General Service|:: CompanyIndex:348 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 11-13-2025 15:42:54.451 | General Service|:: CompanyIndex:348 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMzQ4LDEiLCJuYmYiOjE3NjMwMTk4OTIsImV4cCI6MTc2MzA0ODY5MiwiaWF0IjoxNzYzMDE5ODkyfQ.QTTYhPJDdSuVk1AVSpo5BssLWyVUcTuIVOJ4BQ84bpU'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 11-13-2025 15:42:54.451 | General Service|:: CompanyIndex:348 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMzQ4LDEiLCJuYmYiOjE3NjMwMTkzMTcsImV4cCI6MTc2MzA0ODExNywiaWF0IjoxNzYzMDE5MzE3fQ.VpcXT6Y3RAP00m4CfI8rjfb5sp4khz2gEjXRlTIen40'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 11-13-2025 15:43:11.545 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 11-13-2025 15:43:11.560 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzYzMDI4MzA2LCJleHAiOjE3NjMwNTcxMDYsImlhdCI6MTc2MzAyODMwNn0.9MTBuB63fLAG0fQGvThybvQM9mQbqpwWlrfMtHu1T_M'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 11-13-2025 15:43:15.904 | General Service|:: CompanyIndex:326 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 11-13-2025 15:43:15.904 | General Service|:: CompanyIndex:326 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMzI2LDEiLCJuYmYiOjE3NjMwMjY1OTIsImV4cCI6MTc2MzA1NTM5MiwiaWF0IjoxNzYzMDI2NTkyfQ.8Y5az9OV6b5kMlVwowet8ECaMfD5D_XA3Uq65skYL8E'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 11-13-2025 15:43:18.436 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 11-13-2025 15:43:18.436 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODA4NSwiZXhwIjoxNzYzMDU2ODg1LCJpYXQiOjE3NjMwMjgwODV9.eRlSN9oidYho75qh1pF4jTpIB4tw3U5pKBPBFSOfZsw'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:43:18.686 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:43:18.686 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTAzLDEiLCJuYmYiOjE3NjMwMjg1NTMsImV4cCI6MTc2MzA1NzM1MywiaWF0IjoxNzYzMDI4NTUzfQ.O2JauUtbpQOyoNxGPcRwthghyHYfgqeSdo-MiM50Fdw'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 11-13-2025 15:43:36.943 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 11-13-2025 15:43:36.943 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODAzNSwiZXhwIjoxNzYzMDU2ODM1LCJpYXQiOjE3NjMwMjgwMzV9.c4J7sRklVhN3hJ2g3cvBPJ5nYIFJIc4QnnPUO71wek4'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 11-13-2025 15:43:54.445 | General Service|:: CompanyIndex:348 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 11-13-2025 15:43:54.445 | General Service|:: CompanyIndex:348 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 11-13-2025 15:43:54.445 | General Service|:: CompanyIndex:348 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMzQ4LDEiLCJuYmYiOjE3NjMwMTk4OTIsImV4cCI6MTc2MzA0ODY5MiwiaWF0IjoxNzYzMDE5ODkyfQ.QTTYhPJDdSuVk1AVSpo5BssLWyVUcTuIVOJ4BQ84bpU'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 11-13-2025 15:43:54.445 | General Service|:: CompanyIndex:348 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMzQ4LDEiLCJuYmYiOjE3NjMwMTkzMTcsImV4cCI6MTc2MzA0ODExNywiaWF0IjoxNzYzMDE5MzE3fQ.VpcXT6Y3RAP00m4CfI8rjfb5sp4khz2gEjXRlTIen40'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 11-13-2025 15:44:11.421 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 11-13-2025 15:44:11.436 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzYzMDI4MzA2LCJleHAiOjE3NjMwNTcxMDYsImlhdCI6MTc2MzAyODMwNn0.9MTBuB63fLAG0fQGvThybvQM9mQbqpwWlrfMtHu1T_M'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 11-13-2025 15:44:15.897 | General Service|:: CompanyIndex:326 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 11-13-2025 15:44:15.913 | General Service|:: CompanyIndex:326 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMzI2LDEiLCJuYmYiOjE3NjMwMjY1OTIsImV4cCI6MTc2MzA1NTM5MiwiaWF0IjoxNzYzMDI2NTkyfQ.8Y5az9OV6b5kMlVwowet8ECaMfD5D_XA3Uq65skYL8E'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:44:17.681 | General Service|:: CompanyIndex:103 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.79] DEBUG | 11-13-2025 15:44:17.681 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTAzLDEiLCJuYmYiOjE3NjMwMjg1NTMsImV4cCI6MTc2MzA1NzM1MywiaWF0IjoxNzYzMDI4NTUzfQ.O2JauUtbpQOyoNxGPcRwthghyHYfgqeSdo-MiM50Fdw'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 11-13-2025 15:44:18.431 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 11-13-2025 15:44:18.431 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODA4NSwiZXhwIjoxNzYzMDU2ODg1LCJpYXQiOjE3NjMwMjgwODV9.eRlSN9oidYho75qh1pF4jTpIB4tw3U5pKBPBFSOfZsw'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:44:18.681 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:44:18.681 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTAzLDEiLCJuYmYiOjE3NjMwMjg1NTMsImV4cCI6MTc2MzA1NzM1MywiaWF0IjoxNzYzMDI4NTUzfQ.O2JauUtbpQOyoNxGPcRwthghyHYfgqeSdo-MiM50Fdw'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 11-13-2025 15:44:36.937 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 11-13-2025 15:44:36.937 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODAzNSwiZXhwIjoxNzYzMDU2ODM1LCJpYXQiOjE3NjMwMjgwMzV9.c4J7sRklVhN3hJ2g3cvBPJ5nYIFJIc4QnnPUO71wek4'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 11-13-2025 15:44:54.448 | General Service|:: CompanyIndex:0 SpName: spADM_Login 
 4
 ,''
 ,''
 ,''
 ,'declare @AllowSession bit,@GUID nvarchar(50)
set @AllowSession=0
set @GUID=''1dbadf3d-7c77-49fa-b114-66da7d5c9550''
if exists(select [GUID] from ADM_Login with(nolock) where [GUID]=@GUID)
begin
    update ADM_Login  set LastAccessTime=convert(float,getdate()) where [GUID]=@GUID
    set @AllowSession=1
end
select @AllowSession AllowSession
'
 ,''
 ,0
[System: 192.168.1.99] DEBUG | 11-13-2025 15:44:54.463 | General Service|:: CompanyIndex:348 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 11-13-2025 15:44:54.463 | General Service|:: CompanyIndex:348 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 11-13-2025 15:44:54.463 | General Service|:: CompanyIndex:348 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMzQ4LDEiLCJuYmYiOjE3NjMwMTk4OTIsImV4cCI6MTc2MzA0ODY5MiwiaWF0IjoxNzYzMDE5ODkyfQ.QTTYhPJDdSuVk1AVSpo5BssLWyVUcTuIVOJ4BQ84bpU'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 11-13-2025 15:44:54.463 | General Service|:: CompanyIndex:348 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMzQ4LDEiLCJuYmYiOjE3NjMwMTk4OTIsImV4cCI6MTc2MzA0ODY5MiwiaWF0IjoxNzYzMDE5ODkyfQ.QTTYhPJDdSuVk1AVSpo5BssLWyVUcTuIVOJ4BQ84bpU'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 11-13-2025 15:44:54.463 | General Service|:: CompanyIndex:348 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMzQ4LDEiLCJuYmYiOjE3NjMwMTkzMTcsImV4cCI6MTc2MzA0ODExNywiaWF0IjoxNzYzMDE5MzE3fQ.VpcXT6Y3RAP00m4CfI8rjfb5sp4khz2gEjXRlTIen40'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 11-13-2025 15:45:10.155 | General Service|:: CompanyIndex:7 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.73] DEBUG | 11-13-2025 15:45:10.155 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzYzMDI4MzA2LCJleHAiOjE3NjMwNTcxMDYsImlhdCI6MTc2MzAyODMwNn0.9MTBuB63fLAG0fQGvThybvQM9mQbqpwWlrfMtHu1T_M'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 11-13-2025 15:45:11.405 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 11-13-2025 15:45:11.405 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzYzMDI4MzA2LCJleHAiOjE3NjMwNTcxMDYsImlhdCI6MTc2MzAyODMwNn0.9MTBuB63fLAG0fQGvThybvQM9mQbqpwWlrfMtHu1T_M'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 11-13-2025 15:45:15.904 | General Service|:: CompanyIndex:326 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 11-13-2025 15:45:15.904 | General Service|:: CompanyIndex:326 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMzI2LDEiLCJuYmYiOjE3NjMwMjY1OTIsImV4cCI6MTc2MzA1NTM5MiwiaWF0IjoxNzYzMDI2NTkyfQ.8Y5az9OV6b5kMlVwowet8ECaMfD5D_XA3Uq65skYL8E'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 11-13-2025 15:45:18.419 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 11-13-2025 15:45:18.435 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODA4NSwiZXhwIjoxNzYzMDU2ODg1LCJpYXQiOjE3NjMwMjgwODV9.eRlSN9oidYho75qh1pF4jTpIB4tw3U5pKBPBFSOfZsw'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:45:19.700 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:45:19.716 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTAzLDEiLCJuYmYiOjE3NjMwMjg1NTMsImV4cCI6MTc2MzA1NzM1MywiaWF0IjoxNzYzMDI4NTUzfQ.O2JauUtbpQOyoNxGPcRwthghyHYfgqeSdo-MiM50Fdw'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 11-13-2025 15:45:35.704 | General Service|:: CompanyIndex:0 SpName: spADM_Login 
 4
 ,''
 ,''
 ,''
 ,'declare @AllowSession bit,@GUID nvarchar(50)
set @AllowSession=0
set @GUID=''121ff338-b5c8-4a84-97d6-2f90b6c2705f''
if exists(select [GUID] from ADM_Login with(nolock) where [GUID]=@GUID)
begin
    update ADM_Login  set LastAccessTime=convert(float,getdate()) where [GUID]=@GUID
    set @AllowSession=1
end
select @AllowSession AllowSession
'
 ,''
 ,0
[System: 192.168.1.77] DEBUG | 11-13-2025 15:45:35.720 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODAzNSwiZXhwIjoxNzYzMDU2ODM1LCJpYXQiOjE3NjMwMjgwMzV9.c4J7sRklVhN3hJ2g3cvBPJ5nYIFJIc4QnnPUO71wek4'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 11-13-2025 15:45:35.908 | General Service|:: CompanyIndex:53 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.77] DEBUG | 11-13-2025 15:45:35.908 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODAzNSwiZXhwIjoxNzYzMDU2ODM1LCJpYXQiOjE3NjMwMjgwMzV9.c4J7sRklVhN3hJ2g3cvBPJ5nYIFJIc4QnnPUO71wek4'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 11-13-2025 15:45:36.939 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 11-13-2025 15:45:36.939 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODAzNSwiZXhwIjoxNzYzMDU2ODM1LCJpYXQiOjE3NjMwMjgwMzV9.c4J7sRklVhN3hJ2g3cvBPJ5nYIFJIc4QnnPUO71wek4'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 11-13-2025 15:45:54.402 | General Service|:: CompanyIndex:348 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.99] DEBUG | 11-13-2025 15:45:54.402 | General Service|:: CompanyIndex:348 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.99] DEBUG | 11-13-2025 15:45:54.418 | General Service|:: CompanyIndex:348 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMzQ4LDEiLCJuYmYiOjE3NjMwMTkzMTcsImV4cCI6MTc2MzA0ODExNywiaWF0IjoxNzYzMDE5MzE3fQ.VpcXT6Y3RAP00m4CfI8rjfb5sp4khz2gEjXRlTIen40'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 11-13-2025 15:45:54.418 | General Service|:: CompanyIndex:348 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMzQ4LDEiLCJuYmYiOjE3NjMwMTk4OTIsImV4cCI6MTc2MzA0ODY5MiwiaWF0IjoxNzYzMDE5ODkyfQ.QTTYhPJDdSuVk1AVSpo5BssLWyVUcTuIVOJ4BQ84bpU'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 11-13-2025 15:45:54.465 | General Service|:: CompanyIndex:348 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 11-13-2025 15:45:54.480 | General Service|:: CompanyIndex:348 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 11-13-2025 15:45:54.480 | General Service|:: CompanyIndex:348 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMzQ4LDEiLCJuYmYiOjE3NjMwMTk4OTIsImV4cCI6MTc2MzA0ODY5MiwiaWF0IjoxNzYzMDE5ODkyfQ.QTTYhPJDdSuVk1AVSpo5BssLWyVUcTuIVOJ4BQ84bpU'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 11-13-2025 15:45:54.480 | General Service|:: CompanyIndex:348 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMzQ4LDEiLCJuYmYiOjE3NjMwMTkzMTcsImV4cCI6MTc2MzA0ODExNywiaWF0IjoxNzYzMDE5MzE3fQ.VpcXT6Y3RAP00m4CfI8rjfb5sp4khz2gEjXRlTIen40'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 11-13-2025 15:46:11.403 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 11-13-2025 15:46:11.418 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzYzMDI4MzA2LCJleHAiOjE3NjMwNTcxMDYsImlhdCI6MTc2MzAyODMwNn0.9MTBuB63fLAG0fQGvThybvQM9mQbqpwWlrfMtHu1T_M'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 11-13-2025 15:46:15.917 | General Service|:: CompanyIndex:326 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 11-13-2025 15:46:15.917 | General Service|:: CompanyIndex:326 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMzI2LDEiLCJuYmYiOjE3NjMwMjY1OTIsImV4cCI6MTc2MzA1NTM5MiwiaWF0IjoxNzYzMDI2NTkyfQ.8Y5az9OV6b5kMlVwowet8ECaMfD5D_XA3Uq65skYL8E'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 11-13-2025 15:46:18.432 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 11-13-2025 15:46:18.432 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODA4NSwiZXhwIjoxNzYzMDU2ODg1LCJpYXQiOjE3NjMwMjgwODV9.eRlSN9oidYho75qh1pF4jTpIB4tw3U5pKBPBFSOfZsw'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:46:20.682 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:46:20.682 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTAzLDEiLCJuYmYiOjE3NjMwMjg1NTMsImV4cCI6MTc2MzA1NzM1MywiaWF0IjoxNzYzMDI4NTUzfQ.O2JauUtbpQOyoNxGPcRwthghyHYfgqeSdo-MiM50Fdw'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 11-13-2025 15:46:25.415 | General Service|:: CompanyIndex:53 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.73] DEBUG | 11-13-2025 15:46:25.415 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODA4NSwiZXhwIjoxNzYzMDU2ODg1LCJpYXQiOjE3NjMwMjgwODV9.eRlSN9oidYho75qh1pF4jTpIB4tw3U5pKBPBFSOfZsw'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 11-13-2025 15:46:25.431 | General Service|:: CompanyIndex:0 SpName: spADM_Login 
 4
 ,''
 ,''
 ,''
 ,'declare @AllowSession bit,@GUID nvarchar(50)
set @AllowSession=0
set @GUID=''d4029f57-5c55-4753-9a28-35c1bffc2b4e''
if exists(select [GUID] from ADM_Login with(nolock) where [GUID]=@GUID)
begin
    update ADM_Login  set LastAccessTime=convert(float,getdate()) where [GUID]=@GUID
    set @AllowSession=1
end
select @AllowSession AllowSession
'
 ,''
 ,0
[System: 192.168.1.73] DEBUG | 11-13-2025 15:46:25.431 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODA4NSwiZXhwIjoxNzYzMDU2ODg1LCJpYXQiOjE3NjMwMjgwODV9.eRlSN9oidYho75qh1pF4jTpIB4tw3U5pKBPBFSOfZsw'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 11-13-2025 15:46:36.928 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 11-13-2025 15:46:36.944 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODAzNSwiZXhwIjoxNzYzMDU2ODM1LCJpYXQiOjE3NjMwMjgwMzV9.c4J7sRklVhN3hJ2g3cvBPJ5nYIFJIc4QnnPUO71wek4'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 11-13-2025 15:46:54.455 | General Service|:: CompanyIndex:348 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 11-13-2025 15:46:54.455 | General Service|:: CompanyIndex:348 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMzQ4LDEiLCJuYmYiOjE3NjMwMTk4OTIsImV4cCI6MTc2MzA0ODY5MiwiaWF0IjoxNzYzMDE5ODkyfQ.QTTYhPJDdSuVk1AVSpo5BssLWyVUcTuIVOJ4BQ84bpU'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 11-13-2025 15:46:54.455 | General Service|:: CompanyIndex:348 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 11-13-2025 15:46:54.455 | General Service|:: CompanyIndex:348 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMzQ4LDEiLCJuYmYiOjE3NjMwMTkzMTcsImV4cCI6MTc2MzA0ODExNywiaWF0IjoxNzYzMDE5MzE3fQ.VpcXT6Y3RAP00m4CfI8rjfb5sp4khz2gEjXRlTIen40'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 11-13-2025 15:47:11.498 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 11-13-2025 15:47:11.498 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzYzMDI4MzA2LCJleHAiOjE3NjMwNTcxMDYsImlhdCI6MTc2MzAyODMwNn0.9MTBuB63fLAG0fQGvThybvQM9mQbqpwWlrfMtHu1T_M'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 11-13-2025 15:47:15.872 | General Service|:: CompanyIndex:326 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.77] DEBUG | 11-13-2025 15:47:15.872 | General Service|:: CompanyIndex:326 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMzI2LDEiLCJuYmYiOjE3NjMwMjY1OTIsImV4cCI6MTc2MzA1NTM5MiwiaWF0IjoxNzYzMDI2NTkyfQ.8Y5az9OV6b5kMlVwowet8ECaMfD5D_XA3Uq65skYL8E'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 11-13-2025 15:47:15.935 | General Service|:: CompanyIndex:326 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 11-13-2025 15:47:15.935 | General Service|:: CompanyIndex:326 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMzI2LDEiLCJuYmYiOjE3NjMwMjY1OTIsImV4cCI6MTc2MzA1NTM5MiwiaWF0IjoxNzYzMDI2NTkyfQ.8Y5az9OV6b5kMlVwowet8ECaMfD5D_XA3Uq65skYL8E'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 11-13-2025 15:47:18.419 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 11-13-2025 15:47:18.434 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODA4NSwiZXhwIjoxNzYzMDU2ODg1LCJpYXQiOjE3NjMwMjgwODV9.eRlSN9oidYho75qh1pF4jTpIB4tw3U5pKBPBFSOfZsw'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:47:21.684 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:47:21.684 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTAzLDEiLCJuYmYiOjE3NjMwMjg1NTMsImV4cCI6MTc2MzA1NzM1MywiaWF0IjoxNzYzMDI4NTUzfQ.O2JauUtbpQOyoNxGPcRwthghyHYfgqeSdo-MiM50Fdw'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 11-13-2025 15:47:36.943 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 11-13-2025 15:47:36.943 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODAzNSwiZXhwIjoxNzYzMDU2ODM1LCJpYXQiOjE3NjMwMjgwMzV9.c4J7sRklVhN3hJ2g3cvBPJ5nYIFJIc4QnnPUO71wek4'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 11-13-2025 15:47:54.448 | General Service|:: CompanyIndex:348 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 11-13-2025 15:47:54.448 | General Service|:: CompanyIndex:348 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 11-13-2025 15:47:54.448 | General Service|:: CompanyIndex:348 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMzQ4LDEiLCJuYmYiOjE3NjMwMTk4OTIsImV4cCI6MTc2MzA0ODY5MiwiaWF0IjoxNzYzMDE5ODkyfQ.QTTYhPJDdSuVk1AVSpo5BssLWyVUcTuIVOJ4BQ84bpU'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 11-13-2025 15:47:54.448 | General Service|:: CompanyIndex:348 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMzQ4LDEiLCJuYmYiOjE3NjMwMTkzMTcsImV4cCI6MTc2MzA0ODExNywiaWF0IjoxNzYzMDE5MzE3fQ.VpcXT6Y3RAP00m4CfI8rjfb5sp4khz2gEjXRlTIen40'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 11-13-2025 15:48:11.500 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 11-13-2025 15:48:11.500 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzYzMDI4MzA2LCJleHAiOjE3NjMwNTcxMDYsImlhdCI6MTc2MzAyODMwNn0.9MTBuB63fLAG0fQGvThybvQM9mQbqpwWlrfMtHu1T_M'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 11-13-2025 15:48:15.907 | General Service|:: CompanyIndex:326 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 11-13-2025 15:48:15.907 | General Service|:: CompanyIndex:326 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMzI2LDEiLCJuYmYiOjE3NjMwMjY1OTIsImV4cCI6MTc2MzA1NTM5MiwiaWF0IjoxNzYzMDI2NTkyfQ.8Y5az9OV6b5kMlVwowet8ECaMfD5D_XA3Uq65skYL8E'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 11-13-2025 15:48:18.425 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 11-13-2025 15:48:18.425 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODA4NSwiZXhwIjoxNzYzMDU2ODg1LCJpYXQiOjE3NjMwMjgwODV9.eRlSN9oidYho75qh1pF4jTpIB4tw3U5pKBPBFSOfZsw'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:48:22.673 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:48:22.673 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTAzLDEiLCJuYmYiOjE3NjMwMjg1NTMsImV4cCI6MTc2MzA1NzM1MywiaWF0IjoxNzYzMDI4NTUzfQ.O2JauUtbpQOyoNxGPcRwthghyHYfgqeSdo-MiM50Fdw'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 11-13-2025 15:48:36.933 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 11-13-2025 15:48:36.948 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODAzNSwiZXhwIjoxNzYzMDU2ODM1LCJpYXQiOjE3NjMwMjgwMzV9.c4J7sRklVhN3hJ2g3cvBPJ5nYIFJIc4QnnPUO71wek4'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 11-13-2025 15:48:54.447 | General Service|:: CompanyIndex:348 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 11-13-2025 15:48:54.447 | General Service|:: CompanyIndex:348 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 11-13-2025 15:48:54.447 | General Service|:: CompanyIndex:348 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMzQ4LDEiLCJuYmYiOjE3NjMwMTk4OTIsImV4cCI6MTc2MzA0ODY5MiwiaWF0IjoxNzYzMDE5ODkyfQ.QTTYhPJDdSuVk1AVSpo5BssLWyVUcTuIVOJ4BQ84bpU'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 11-13-2025 15:48:54.447 | General Service|:: CompanyIndex:348 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMzQ4LDEiLCJuYmYiOjE3NjMwMTkzMTcsImV4cCI6MTc2MzA0ODExNywiaWF0IjoxNzYzMDE5MzE3fQ.VpcXT6Y3RAP00m4CfI8rjfb5sp4khz2gEjXRlTIen40'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 11-13-2025 15:49:11.652 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 11-13-2025 15:49:11.652 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNywxIiwibmJmIjoxNzYzMDI4MzA2LCJleHAiOjE3NjMwNTcxMDYsImlhdCI6MTc2MzAyODMwNn0.9MTBuB63fLAG0fQGvThybvQM9mQbqpwWlrfMtHu1T_M'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 11-13-2025 15:49:15.910 | General Service|:: CompanyIndex:326 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 11-13-2025 15:49:15.910 | General Service|:: CompanyIndex:326 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMzI2LDEiLCJuYmYiOjE3NjMwMjY1OTIsImV4cCI6MTc2MzA1NTM5MiwiaWF0IjoxNzYzMDI2NTkyfQ.8Y5az9OV6b5kMlVwowet8ECaMfD5D_XA3Uq65skYL8E'''
 ,1
 ,1
[System: 192.168.1.79] DEBUG | 11-13-2025 15:49:17.645 | General Service|:: CompanyIndex:103 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.79] DEBUG | 11-13-2025 15:49:17.645 | General Service|:: CompanyIndex:103 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTAzLDEiLCJuYmYiOjE3NjMwMjg1NTMsImV4cCI6MTc2MzA1NzM1MywiaWF0IjoxNzYzMDI4NTUzfQ.O2JauUtbpQOyoNxGPcRwthghyHYfgqeSdo-MiM50Fdw'''
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 11-13-2025 15:49:18.426 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.73] DEBUG | 11-13-2025 15:49:18.426 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc2MzAyODA4NSwiZXhwIjoxNzYzMDU2ODg1LCJpYXQiOjE3NjMwMjgwODV9.eRlSN9oidYho75qh1pF4jTpIB4tw3U5pKBPBFSOfZsw'''
 ,1
 ,1
