[System: 192.168.1.99] DEBUG | 08-06-2025 12:46:50.209 | General Service|:: CompanyIndex:0 SpName: spADM_GetClientUserDetails2C 
 'admin'
 ,1
 ,0
[System: 192.168.1.99] DEBUG | 08-06-2025 12:46:50.365 | General Service|:: CompanyIndex:0 SpName: spADM_UserLoginCheck 
 2
 ,'admin'
 ,0
 ,'192.168.1.99'
 ,'192.168.1.99'
 ,''
 ,'Web'
 ,1
[System: 192.168.1.99] DEBUG | 08-06-2025 12:46:55.837 | General Service|:: CompanyIndex:53 SpName: spADM_GetClientUserDetails 
 'admin'
 ,1
 ,'26.2.8'
 ,0
[System: 192.168.1.99] DEBUG | 08-06-2025 12:46:55.993 | General Service|:: CompanyIndex:0 SpName: spADM_UserLoginCheck 
 2
 ,'admin'
 ,53
 ,'192.168.1.99'
 ,'192.168.1.99'
 ,''
 ,'Web'
 ,1
[System: 192.168.1.99] DEBUG | 08-06-2025 12:46:56.087 | General Service|:: CompanyIndex:0 SpName: spADM_Login 
 1
 ,''
 ,''
 ,''
 ,''
 ,''
 ,53
[System: 192.168.1.99] DEBUG | 08-06-2025 12:46:56.118 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select Value from ADM_GlobalPreferences with (nolock) where name =''EnableReLogin'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-06-2025 12:46:56.134 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDQ2NDYxNSwiZXhwIjoxNzU0NDkzNDE1LCJpYXQiOjE3NTQ0NjQ2MTV9.iKjtqChgxXZKVahsAuFt7SXlOzjj0djKlWRjOhCAMlA'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-06-2025 12:46:56.212 | General Service|:: CompanyIndex:0 SpName: spADM_Login 
 4
 ,''
 ,''
 ,''
 ,'declare @Cnt int,@ExpiredGUID nvarchar(50),@AllowSession int,@GUID nvarchar(50),@CurrDate float,@UserID INT,@Instances INT,@InstancesExists INT,@LCDBIndex int
set @CurrDate= convert(float,dateadd(minute,-21,getdate()))
set @AllowSession=0
set @GUID=''3b73cbf0-5b10-47a6-b624-6ae52886a3e6''
set @LCDBIndex=0
select top 1 @UserID=UserID,@Instances=InstanceCount from ADM_Users with(nolock) where UserName=''admin''
if exists(select [GUID] from ADM_Login with(nolock) where [GUID]=@GUID)
begin
	update ADM_Login 
	set LastAccessTime=convert(float,getdate()),UserID=@UserID
	where [GUID]=@GUID
    set @AllowSession=1
end
else
begin
	select @Cnt=count(*) from ADM_Login with(nolock) where LCDBIndex=@LCDBIndex and [GUID]!=''ACCESSRIGHTS'' and AP =''WEB''
    if(@Cnt<100)
		set @AllowSession=1
	else
	begin
		select top 1 @ExpiredGUID=[GUID] from ADM_Login with(nolock)
		where [GUID]!=''ACCESSRIGHTS'' and LCDBIndex=@LCDBIndex and LastAccessTime<@CurrDate  and AP =''WEB''
        order by LastAccessTime asc
		if @ExpiredGUID is not null
		begin
			delete from ADM_Login where [GUID]=@ExpiredGUID
			set @AllowSession=1
		end
	end
	if @AllowSession=1
	begin
        select @InstancesExists=COUNT(*) from ADM_Login with(nolock)
		where [GUID]!=''ACCESSRIGHTS'' and LCDBIndex=@LCDBIndex and LastAccessTime>=@CurrDate and UserID=@UserID and AP =''WEB''
		if(@Instances!=0 and @Instances<=@InstancesExists)
			set @AllowSession=2
		else
		    INSERT INTO ADM_Login([GUID],[SysName],IPAddress,[Status],LoginTime,LastAccessTime,AccessRights,UserID,DBIndex,LCDBIndex,AP)
		    VALUES(@GUID,''WEB'',''192.168.1.99'',1,convert(float,getdate()),convert(float,getdate()),null,@UserID,53,@LCDBIndex, ''WEB'')
	end
end

select @AllowSession AllowSession,@Instances Instances,@InstancesExists InstancesExists
'
 ,''
 ,0
[System: 192.168.1.99] DEBUG | 08-06-2025 12:46:56.212 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDQ2NDYxNSwiZXhwIjoxNzU0NDkzNDE1LCJpYXQiOjE3NTQ0NjQ2MTV9.iKjtqChgxXZKVahsAuFt7SXlOzjj0djKlWRjOhCAMlA'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-06-2025 12:46:56.352 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT (SELECT COUNT(*) FROM COM_Location L WITH(NOLOCK) JOIN COM_Status S WITH(NOLOCK) ON S.StatusID=L.StatusID WHERE L.IsGroup=0 AND S.[Status]=''Active'') ML
,(SELECT COUNT(*) FROM ADM_Features WITH(NOLOCK) WHERE ((FeatureID>50000 AND FeatureID<=50050) OR FeatureID>=51000) AND IsEnabled=1) MD
,(SELECT ISNULL(COUNT(*),0) FROM ADM_RevenUReports WITH(NOLOCK) WHERE IsGroup=0 AND ReportID>10000 AND StaticReportType IN (0,-1)) MR'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-06-2025 12:46:56.352 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDQ2NDYxNSwiZXhwIjoxNzU0NDkzNDE1LCJpYXQiOjE3NTQ0NjQ2MTV9.iKjtqChgxXZKVahsAuFt7SXlOzjj0djKlWRjOhCAMlA'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-06-2025 12:46:56.384 | General Service|:: CompanyIndex:53 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.99] DEBUG | 08-06-2025 12:46:56.384 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDQ2NDYxNSwiZXhwIjoxNzU0NDkzNDE1LCJpYXQiOjE3NTQ0NjQ2MTV9.iKjtqChgxXZKVahsAuFt7SXlOzjj0djKlWRjOhCAMlA'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-06-2025 12:46:56.649 | General Service|:: CompanyIndex:53 SpName: spADM_GetRibbonView 
 1
 ,1
 ,1
 ,1
 ,0
 ,''
[System: 192.168.1.99] DEBUG | 08-06-2025 12:46:56.665 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDQ2NDYxNSwiZXhwIjoxNzU0NDkzNDE1LCJpYXQiOjE3NTQ0NjQ2MTV9.iKjtqChgxXZKVahsAuFt7SXlOzjj0djKlWRjOhCAMlA'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-06-2025 12:46:56.930 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 2
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 08-06-2025 12:46:56.930 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDQ2NDYxNSwiZXhwIjoxNzU0NDkzNDE1LCJpYXQiOjE3NTQ0NjQ2MTV9.iKjtqChgxXZKVahsAuFt7SXlOzjj0djKlWRjOhCAMlA'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-06-2025 12:46:56.977 | General Service|:: CompanyIndex:53 SpName: spADM_GetDashBoard 
 2
 ,0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 08-06-2025 12:46:56.993 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDQ2NDYxNSwiZXhwIjoxNzU0NDkzNDE1LCJpYXQiOjE3NTQ0NjQ2MTV9.iKjtqChgxXZKVahsAuFt7SXlOzjj0djKlWRjOhCAMlA'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-06-2025 12:46:57.040 | General Service|:: CompanyIndex:53 SpName: spCOM_ConfigValues 
 1
 ,'LandingDocs'
 ,'1'
[System: 192.168.1.99] DEBUG | 08-06-2025 12:46:57.055 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDQ2NDYxNSwiZXhwIjoxNzU0NDkzNDE1LCJpYXQiOjE3NTQ0NjQ2MTV9.iKjtqChgxXZKVahsAuFt7SXlOzjj0djKlWRjOhCAMlA'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-06-2025 12:46:57.118 | General Service|:: CompanyIndex:53 SpName: spCOM_GetFavorites 
 'GETLIST0'
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 08-06-2025 12:46:57.118 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDQ2NDYxNSwiZXhwIjoxNzU0NDkzNDE1LCJpYXQiOjE3NTQ0NjQ2MTV9.iKjtqChgxXZKVahsAuFt7SXlOzjj0djKlWRjOhCAMlA'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-06-2025 12:46:57.118 | General Service|:: CompanyIndex:53 SpName: spADM_GetAllListViewsDef 
 1
 ,1
[System: 192.168.1.99] DEBUG | 08-06-2025 12:46:57.118 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDQ2NDYxNSwiZXhwIjoxNzU0NDkzNDE1LCJpYXQiOjE3NTQ0NjQ2MTV9.iKjtqChgxXZKVahsAuFt7SXlOzjj0djKlWRjOhCAMlA'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-06-2025 12:46:57.227 | General Service|:: CompanyIndex:53 SpName: spADM_GetAllListViewsDef 
 1
 ,1
[System: 192.168.1.99] DEBUG | 08-06-2025 12:46:57.243 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDQ2NDYxNSwiZXhwIjoxNzU0NDkzNDE1LCJpYXQiOjE3NTQ0NjQ2MTV9.iKjtqChgxXZKVahsAuFt7SXlOzjj0djKlWRjOhCAMlA'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-06-2025 12:46:57.524 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'Select CostCenterID,CostCenterColID,CostCenterName,SysTableName,UserColumnName,SysColumnName,ISNULL(UserDefaultValue,'''') UserDefaultValue
From AdM_CostCenterDef WITH(NOLOCK)
Where SysColumnName IN(''CreditAccount'',''DebitAccount'',''ProductID'') 
AND CostCenterID>40000 AND CostCenterID<50000 

SELECT * FROM ADM_Features WITH(NOLOCK) '
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-06-2025 12:46:57.524 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDQ2NDYxNSwiZXhwIjoxNzU0NDkzNDE1LCJpYXQiOjE3NTQ0NjQ2MTV9.iKjtqChgxXZKVahsAuFt7SXlOzjj0djKlWRjOhCAMlA'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-06-2025 12:46:57.571 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 '  SELECT * FROM PAY_PayrollPreferences WITH(NOLOCK) '
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-06-2025 12:46:57.571 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDQ2NDYxNSwiZXhwIjoxNzU0NDkzNDE1LCJpYXQiOjE3NTQ0NjQ2MTV9.iKjtqChgxXZKVahsAuFt7SXlOzjj0djKlWRjOhCAMlA'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-06-2025 12:46:57.649 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 '  --0
                                Select * FROM COM_CC50051 WITH(NOLOCK) WHERE IsGroup=0 AND LoginUserID=''admin''
                                --1                                
                                Select * FROM COM_CC50051 WITH(NOLOCK) WHERE RptManager IN (Select NodeID FROM COM_CC50051 WITH(NOLOCK) WHERE IsGroup=0 AND LoginUserID=''admin'')
                                UNION ALL
                                Select * FROM COM_CC50051 WITH(NOLOCK) WHERE RptManager IN 
                                (
	                                Select NodeID FROM COM_CC50051 WITH(NOLOCK) 
	                                WHERE IsGroup=0 AND LoginUserID IN
	                                (
	                                SELECT fe.LoginUserID
	                                FROM INV_DocDetails a WITH(NOLOCK) 
	                                JOIN COM_DocCCData b WITH(NOLOCK) ON b.InvDocDetailsID=a.InvDocDetailsID
	                                JOIN COM_DocNumData c WITH(NOLOCK) ON c.InvDocDetailsID=a.InvDocDetailsID
	                                JOIN COM_DocTextData d WITH(NOLOCK) ON d.InvDocDetailsID=a.InvDocDetailsID
	                                JOIN COM_CC50051 fe WITH(NOLOCK) on fe.NodeID=b.dcCCNID51
	                                JOIN COM_CC50051 te WITH(NOLOCK) on CONVERT(NVARCHAR,te.NodeID)=d.dcAlpha1
	                                WHERE a.CostCenterID=40098 and a.StatusID=369 AND d.dcAlpha3=''Temporary''
	                                AND te.LoginUserID=''admin'' 
	                                AND ISDATE(d.dcAlpha4)=1 AND ISDATE(d.dcAlpha5)=1 
	                                AND CONVERT(DATETIME,''06 Aug 2025'') BETWEEN CONVERT(DATETIME,d.dcAlpha4) AND CONVERT(DATETIME,d.dcAlpha5)
	                                )
                                )
                                --2
                                Select * FROM ADM_USERS WITH(NOLOCK) WHERE USERID=1
                                --3
                                Select * FROM COM_CostCenterCostCenterMap WITH(NOLOCK) WHERE ParentCostCenterID=7 AND ParentNodeID=1
                                --4                                
                                Select * FROM COM_CostCenterCostCenterMap WITH(NOLOCK) WHERE ParentCostCenterID=7 AND ParentNodeID=1
                                AND CostCenterID IN(Select ColumnCostCenterID From ADM_CostCenterDef Where CostCenterID=50051 AND IsColumnInUse=1 AND SysColumnName LIKE ''CCNID%'')
                                --5
                                Select * from COM_Files WITH(NOLOCK) WHERE FeatureID=50051 AND FeaturePK IN (Select NodeID FROM COM_CC50051 WITH(NOLOCK) WHERE IsGroup=0 AND LoginUserID=''admin'')                         
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-06-2025 12:46:57.665 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDQ2NDYxNSwiZXhwIjoxNzU0NDkzNDE1LCJpYXQiOjE3NTQ0NjQ2MTV9.iKjtqChgxXZKVahsAuFt7SXlOzjj0djKlWRjOhCAMlA'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-06-2025 12:46:57.930 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-06-2025 12:46:57.946 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDQ2NDYxNSwiZXhwIjoxNzU0NDkzNDE1LCJpYXQiOjE3NTQ0NjQ2MTV9.iKjtqChgxXZKVahsAuFt7SXlOzjj0djKlWRjOhCAMlA'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-06-2025 12:46:58.180 | General Service|:: CompanyIndex:53 SpName: spADM_GetDashBoard 
 1
 ,41
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 08-06-2025 12:46:58.180 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDQ2NDYxNSwiZXhwIjoxNzU0NDkzNDE1LCJpYXQiOjE3NTQ0NjQ2MTV9.iKjtqChgxXZKVahsAuFt7SXlOzjj0djKlWRjOhCAMlA'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-06-2025 12:46:58.196 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,60585
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 08-06-2025 12:46:58.196 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,60583
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 08-06-2025 12:46:58.196 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,60584
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 08-06-2025 12:46:58.196 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,60587
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 08-06-2025 12:46:58.196 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDQ2NDYxNSwiZXhwIjoxNzU0NDkzNDE1LCJpYXQiOjE3NTQ0NjQ2MTV9.iKjtqChgxXZKVahsAuFt7SXlOzjj0djKlWRjOhCAMlA'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-06-2025 12:46:58.196 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,60588
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 08-06-2025 12:46:58.196 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDQ2NDYxNSwiZXhwIjoxNzU0NDkzNDE1LCJpYXQiOjE3NTQ0NjQ2MTV9.iKjtqChgxXZKVahsAuFt7SXlOzjj0djKlWRjOhCAMlA'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-06-2025 12:46:58.196 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDQ2NDYxNSwiZXhwIjoxNzU0NDkzNDE1LCJpYXQiOjE3NTQ0NjQ2MTV9.iKjtqChgxXZKVahsAuFt7SXlOzjj0djKlWRjOhCAMlA'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-06-2025 12:46:58.196 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDQ2NDYxNSwiZXhwIjoxNzU0NDkzNDE1LCJpYXQiOjE3NTQ0NjQ2MTV9.iKjtqChgxXZKVahsAuFt7SXlOzjj0djKlWRjOhCAMlA'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-06-2025 12:46:58.211 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDQ2NDYxNSwiZXhwIjoxNzU0NDkzNDE1LCJpYXQiOjE3NTQ0NjQ2MTV9.iKjtqChgxXZKVahsAuFt7SXlOzjj0djKlWRjOhCAMlA'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-06-2025 12:46:58.211 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,60586
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 08-06-2025 12:46:58.211 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 08-06-2025 12:46:58.211 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,60585
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 08-06-2025 12:46:58.211 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,60583
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 08-06-2025 12:46:58.211 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDQ2NDYxNSwiZXhwIjoxNzU0NDkzNDE1LCJpYXQiOjE3NTQ0NjQ2MTV9.iKjtqChgxXZKVahsAuFt7SXlOzjj0djKlWRjOhCAMlA'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-06-2025 12:46:58.211 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDQ2NDYxNSwiZXhwIjoxNzU0NDkzNDE1LCJpYXQiOjE3NTQ0NjQ2MTV9.iKjtqChgxXZKVahsAuFt7SXlOzjj0djKlWRjOhCAMlA'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-06-2025 12:46:58.211 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDQ2NDYxNSwiZXhwIjoxNzU0NDkzNDE1LCJpYXQiOjE3NTQ0NjQ2MTV9.iKjtqChgxXZKVahsAuFt7SXlOzjj0djKlWRjOhCAMlA'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-06-2025 12:46:58.211 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,60584
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 08-06-2025 12:46:58.211 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,60587
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 08-06-2025 12:46:58.211 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDQ2NDYxNSwiZXhwIjoxNzU0NDkzNDE1LCJpYXQiOjE3NTQ0NjQ2MTV9.iKjtqChgxXZKVahsAuFt7SXlOzjj0djKlWRjOhCAMlA'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-06-2025 12:46:58.211 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDQ2NDYxNSwiZXhwIjoxNzU0NDkzNDE1LCJpYXQiOjE3NTQ0NjQ2MTV9.iKjtqChgxXZKVahsAuFt7SXlOzjj0djKlWRjOhCAMlA'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-06-2025 12:46:58.227 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDQ2NDYxNSwiZXhwIjoxNzU0NDkzNDE1LCJpYXQiOjE3NTQ0NjQ2MTV9.iKjtqChgxXZKVahsAuFt7SXlOzjj0djKlWRjOhCAMlA'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-06-2025 12:46:58.227 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,60588
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 08-06-2025 12:46:58.227 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 08-06-2025 12:46:58.227 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDQ2NDYxNSwiZXhwIjoxNzU0NDkzNDE1LCJpYXQiOjE3NTQ0NjQ2MTV9.iKjtqChgxXZKVahsAuFt7SXlOzjj0djKlWRjOhCAMlA'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-06-2025 12:46:58.227 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDQ2NDYxNSwiZXhwIjoxNzU0NDkzNDE1LCJpYXQiOjE3NTQ0NjQ2MTV9.iKjtqChgxXZKVahsAuFt7SXlOzjj0djKlWRjOhCAMlA'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-06-2025 12:46:58.227 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,60586
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 08-06-2025 12:46:58.227 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDQ2NDYxNSwiZXhwIjoxNzU0NDkzNDE1LCJpYXQiOjE3NTQ0NjQ2MTV9.iKjtqChgxXZKVahsAuFt7SXlOzjj0djKlWRjOhCAMlA'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-06-2025 12:46:58.305 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 08-06-2025 12:46:58.321 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDQ2NDYxNSwiZXhwIjoxNzU0NDkzNDE1LCJpYXQiOjE3NTQ0NjQ2MTV9.iKjtqChgxXZKVahsAuFt7SXlOzjj0djKlWRjOhCAMlA'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-06-2025 12:46:58.336 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 08-06-2025 12:46:58.336 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDQ2NDYxNSwiZXhwIjoxNzU0NDkzNDE1LCJpYXQiOjE3NTQ0NjQ2MTV9.iKjtqChgxXZKVahsAuFt7SXlOzjj0djKlWRjOhCAMlA'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-06-2025 12:46:58.352 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 08-06-2025 12:46:58.352 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDQ2NDYxNSwiZXhwIjoxNzU0NDkzNDE1LCJpYXQiOjE3NTQ0NjQ2MTV9.iKjtqChgxXZKVahsAuFt7SXlOzjj0djKlWRjOhCAMlA'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-06-2025 12:46:58.368 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 08-06-2025 12:46:58.383 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDQ2NDYxNSwiZXhwIjoxNzU0NDkzNDE1LCJpYXQiOjE3NTQ0NjQ2MTV9.iKjtqChgxXZKVahsAuFt7SXlOzjj0djKlWRjOhCAMlA'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-06-2025 12:46:58.399 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 08-06-2025 12:46:58.399 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDQ2NDYxNSwiZXhwIjoxNzU0NDkzNDE1LCJpYXQiOjE3NTQ0NjQ2MTV9.iKjtqChgxXZKVahsAuFt7SXlOzjj0djKlWRjOhCAMlA'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-06-2025 12:46:58.414 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 08-06-2025 12:46:58.414 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDQ2NDYxNSwiZXhwIjoxNzU0NDkzNDE1LCJpYXQiOjE3NTQ0NjQ2MTV9.iKjtqChgxXZKVahsAuFt7SXlOzjj0djKlWRjOhCAMlA'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-06-2025 12:46:58.430 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 08-06-2025 12:46:58.430 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDQ2NDYxNSwiZXhwIjoxNzU0NDkzNDE1LCJpYXQiOjE3NTQ0NjQ2MTV9.iKjtqChgxXZKVahsAuFt7SXlOzjj0djKlWRjOhCAMlA'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-06-2025 12:46:58.446 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 08-06-2025 12:46:58.446 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDQ2NDYxNSwiZXhwIjoxNzU0NDkzNDE1LCJpYXQiOjE3NTQ0NjQ2MTV9.iKjtqChgxXZKVahsAuFt7SXlOzjj0djKlWRjOhCAMlA'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-06-2025 12:46:58.461 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 08-06-2025 12:46:58.477 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDQ2NDYxNSwiZXhwIjoxNzU0NDkzNDE1LCJpYXQiOjE3NTQ0NjQ2MTV9.iKjtqChgxXZKVahsAuFt7SXlOzjj0djKlWRjOhCAMlA'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-06-2025 12:46:58.492 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 08-06-2025 12:46:58.492 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDQ2NDYxNSwiZXhwIjoxNzU0NDkzNDE1LCJpYXQiOjE3NTQ0NjQ2MTV9.iKjtqChgxXZKVahsAuFt7SXlOzjj0djKlWRjOhCAMlA'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-06-2025 12:46:58.586 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60583'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-06-2025 12:46:58.586 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDQ2NDYxNSwiZXhwIjoxNzU0NDkzNDE1LCJpYXQiOjE3NTQ0NjQ2MTV9.iKjtqChgxXZKVahsAuFt7SXlOzjj0djKlWRjOhCAMlA'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-06-2025 12:46:58.836 | General Service|:: CompanyIndex:53 SpName: spRPT_GetReportCategoryandField 
 -1
 ,0
 ,1
 ,0
 ,'1'
 ,1
[System: 192.168.1.99] DEBUG | 08-06-2025 12:46:58.836 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDQ2NDYxNSwiZXhwIjoxNzU0NDkzNDE1LCJpYXQiOjE3NTQ0NjQ2MTV9.iKjtqChgxXZKVahsAuFt7SXlOzjj0djKlWRjOhCAMlA'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-06-2025 12:46:58.883 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60584'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-06-2025 12:46:58.883 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDQ2NDYxNSwiZXhwIjoxNzU0NDkzNDE1LCJpYXQiOjE3NTQ0NjQ2MTV9.iKjtqChgxXZKVahsAuFt7SXlOzjj0djKlWRjOhCAMlA'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-06-2025 12:46:58.899 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60585'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-06-2025 12:46:58.914 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDQ2NDYxNSwiZXhwIjoxNzU0NDkzNDE1LCJpYXQiOjE3NTQ0NjQ2MTV9.iKjtqChgxXZKVahsAuFt7SXlOzjj0djKlWRjOhCAMlA'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-06-2025 12:46:58.914 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select * from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0  
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) a --where UStatus like ''%Hold%'' 
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-06-2025 12:46:58.914 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDQ2NDYxNSwiZXhwIjoxNzU0NDkzNDE1LCJpYXQiOjE3NTQ0NjQ2MTV9.iKjtqChgxXZKVahsAuFt7SXlOzjj0djKlWRjOhCAMlA'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-06-2025 12:46:58.930 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select * from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0  
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) a where UnitStatus=''Vacant''
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-06-2025 12:46:58.930 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDQ2NDYxNSwiZXhwIjoxNzU0NDkzNDE1LCJpYXQiOjE3NTQ0NjQ2MTV9.iKjtqChgxXZKVahsAuFt7SXlOzjj0djKlWRjOhCAMlA'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-06-2025 12:46:58.945 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select * from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0  
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) a where UnitStatus=''Occupied'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-06-2025 12:46:58.945 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60586'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-06-2025 12:46:58.945 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDQ2NDYxNSwiZXhwIjoxNzU0NDkzNDE1LCJpYXQiOjE3NTQ0NjQ2MTV9.iKjtqChgxXZKVahsAuFt7SXlOzjj0djKlWRjOhCAMlA'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-06-2025 12:46:58.945 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDQ2NDYxNSwiZXhwIjoxNzU0NDkzNDE1LCJpYXQiOjE3NTQ0NjQ2MTV9.iKjtqChgxXZKVahsAuFt7SXlOzjj0djKlWRjOhCAMlA'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-06-2025 12:46:58.961 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60587'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-06-2025 12:46:58.961 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDQ2NDYxNSwiZXhwIjoxNzU0NDkzNDE1LCJpYXQiOjE3NTQ0NjQ2MTV9.iKjtqChgxXZKVahsAuFt7SXlOzjj0djKlWRjOhCAMlA'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-06-2025 12:46:58.961 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select * from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0  
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) a  where UnitStatus=''Expired'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-06-2025 12:46:58.961 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDQ2NDYxNSwiZXhwIjoxNzU0NDkzNDE1LCJpYXQiOjE3NTQ0NjQ2MTV9.iKjtqChgxXZKVahsAuFt7SXlOzjj0djKlWRjOhCAMlA'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-06-2025 12:46:58.961 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60588'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-06-2025 12:46:58.977 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDQ2NDYxNSwiZXhwIjoxNzU0NDkzNDE1LCJpYXQiOjE3NTQ0NjQ2MTV9.iKjtqChgxXZKVahsAuFt7SXlOzjj0djKlWRjOhCAMlA'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-06-2025 12:46:58.977 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60583'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-06-2025 12:46:58.977 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDQ2NDYxNSwiZXhwIjoxNzU0NDkzNDE1LCJpYXQiOjE3NTQ0NjQ2MTV9.iKjtqChgxXZKVahsAuFt7SXlOzjj0djKlWRjOhCAMlA'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-06-2025 12:46:58.977 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select * from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0  
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) a where UStatus like ''%Case%'' 
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-06-2025 12:46:58.992 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDQ2NDYxNSwiZXhwIjoxNzU0NDkzNDE1LCJpYXQiOjE3NTQ0NjQ2MTV9.iKjtqChgxXZKVahsAuFt7SXlOzjj0djKlWRjOhCAMlA'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-06-2025 12:46:59.008 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60584'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-06-2025 12:46:59.008 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDQ2NDYxNSwiZXhwIjoxNzU0NDkzNDE1LCJpYXQiOjE3NTQ0NjQ2MTV9.iKjtqChgxXZKVahsAuFt7SXlOzjj0djKlWRjOhCAMlA'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-06-2025 12:46:59.039 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60585'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-06-2025 12:46:59.039 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select * from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0  
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) a --where UStatus like ''%Hold%'' 
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-06-2025 12:46:59.039 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDQ2NDYxNSwiZXhwIjoxNzU0NDkzNDE1LCJpYXQiOjE3NTQ0NjQ2MTV9.iKjtqChgxXZKVahsAuFt7SXlOzjj0djKlWRjOhCAMlA'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-06-2025 12:46:59.039 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select * from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0  
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) a where UnitStatus=''Vacant''
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-06-2025 12:46:59.039 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDQ2NDYxNSwiZXhwIjoxNzU0NDkzNDE1LCJpYXQiOjE3NTQ0NjQ2MTV9.iKjtqChgxXZKVahsAuFt7SXlOzjj0djKlWRjOhCAMlA'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-06-2025 12:46:59.039 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDQ2NDYxNSwiZXhwIjoxNzU0NDkzNDE1LCJpYXQiOjE3NTQ0NjQ2MTV9.iKjtqChgxXZKVahsAuFt7SXlOzjj0djKlWRjOhCAMlA'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-06-2025 12:46:59.055 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 '/*
DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select * from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0  
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) a where UStatus like ''%Reserve%'' 
*/

DECLARE @FROM FLOAT
SET @FROM=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @UnitID BIGINT,@StatusID BIGINT,@TotalAmount FLOAT,@I INT,@COUNT INT,@ContractID BIGINT
DECLARE @NoofDays INT,@VacantSince DATETIME

DECLARE @TAB TABLE(ID INT IDENTITY(1,1) PRIMARY KEY,UnitID BIGINT,CurrentRent FLOAT,Status NVARCHAR(10),NoofDays INT,VacantSince DATETIME,ContractID BIGINT)

INSERT INTO @TAB (UnitID)
SELECT U.UnitID
FROM REN_Units U WITH(NOLOCK) 
LEFT JOIN REN_Property P WITH(NOLOCK) ON P.NodeID=U.PropertyID
LEFT JOIN COM_Lookup LK WITH(NOLOCK) ON U.UnitStatus=LK.NodeID
WHERE U.UnitID>1 AND P.Name <> U.Name AND U.IsGroup=0 AND U.Status=424 and U.UnitStatus=306 
-- AND P.NodeID IN (207)
SELECT @I=1,@COUNT=COUNT(*) FROM @TAB
WHILE(@I<=@COUNT)
BEGIN
	SET @StatusID=0
	SET @TotalAmount=0
	SET @ContractID=0
	SELECT @UnitID=UnitID FROM @TAB WHERE ID=@I

	SELECT TOP 1 @ContractID=(CASE WHEN RefContractID>0 THEN RefContractID ELSE ContractID END),@StatusID=StatusID
	,@VacantSince=(CASE WHEN StatusID = 450 THEN ( CASE WHEN RefundDate IS NOT NULL THEN CONVERT(DATETIME,RefundDate) ELSE CONVERT(DATETIME,VacancyDate) END ) 
			ELSE CONVERT(DATETIME,TerminationDate) END )
	,@NoofDays=(CASE WHEN StatusID = 450 THEN (CASE WHEN RefundDate IS NOT NULL THEN DATEDIFF(DAY, CONVERT(DATETIME,RefundDate),CONVERT(DATETIME,@FROM) ) 
			ELSE DATEDIFF(DAY, CONVERT(DATETIME,VacancyDate),CONVERT(DATETIME,@FROM) ) END )
			ELSE DATEDIFF(DAY, CONVERT(DATETIME,TerminationDate),CONVERT(DATETIME,@FROM) ) END )  
	FROM REN_Contract WITH(NOLOCK) WHERE StatusID<>451 AND StartDate<@FROM AND UNITID=@UnitID 
	ORDER BY StartDate DESC,StatusID
	
	SELECT @TotalAmount=ISNULL(SUM(RPD.Amount),MAX(RentAmount)/(CASE WHEN MAX(RC.NoOfUnits)=0 THEN 1 ELSE MAX(RC.NoOfUnits) END)) 
	FROM REN_Contract RC WITH(NOLOCK)
	JOIN REN_ContractParticulars RP WITH(NOLOCK) ON RP.ContractID=RC.ContractID AND RP.Sno=1
	LEFT JOIN REN_ContractParticularsDetail RPD WITH(NOLOCK) ON RPD.ParticularNodeID=RP.NodeID AND RPD.Unit=@UnitID 
	AND @FROM BETWEEN ISNULL(RPD.FromDate,@FROM) AND ISNULL(RPD.ToDate,@FROM)
	WHERE RC.ContractID=@ContractID
	
	IF @StatusID=427 OR @StatusID=426 OR @StatusID=466
	BEGIN
		UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Occupied'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
	END
	ELSE IF @StatusID=440
	BEGIN
		UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''UnAproved'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
	END
	ELSE IF @StatusID=428 OR @StatusID=450
	BEGIN 
		IF EXISTS (SELECT * FROM REN_Quotation WITH(NOLOCK) WHERE COSTCENTERID=129 AND UNITID=@UnitID AND CONVERT(DATETIME,@FROM) BETWEEN CONVERT(DATETIME,STARTDATE) AND CONVERT(DATETIME,ENDDATE) and statusid=467 )
			UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Reserved'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
		ELSE IF EXISTS (SELECT * FROM REN_Quotation WITH(NOLOCK) WHERE COSTCENTERID=103 AND UNITID=@UnitID AND CONVERT(DATETIME,@FROM) BETWEEN CONVERT(DATETIME,STARTDATE) AND CONVERT(DATETIME,ENDDATE) and statusid=426 )
			UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Quoted'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
		ELSE
			UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Vacant'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
	END
	ELSE
	BEGIN 
		IF EXISTS (SELECT * FROM REN_Quotation WITH(NOLOCK) WHERE COSTCENTERID=129 AND UNITID=@UnitID AND CONVERT(DATETIME,@FROM) BETWEEN CONVERT(DATETIME,STARTDATE) AND CONVERT(DATETIME,ENDDATE) and statusid=467 )
			UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Reserved'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
		ELSE IF EXISTS (SELECT * FROM REN_Quotation WITH(NOLOCK) WHERE COSTCENTERID=103 AND UNITID=@UnitID AND CONVERT(DATETIME,@FROM) BETWEEN CONVERT(DATETIME,STARTDATE) AND CONVERT(DATETIME,ENDDATE) and statusid=426 )
			UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Quoted'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
		ELSE
			UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Vacant'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
	END
	set @I=@I+1
END

select * from (
SELECT TEMP.*,RP.NodeID Building_ID,RP.NAME Property,TEMP.UnitID Unit_ID,RU.NAME Unit,C18.NAME UnitType,RU.UnitStatus,RU.RentableArea UnitArea,RU.RentPerSQFT UnitRate
,RU.AnnualRent 
,T.FirstName AS [C98c7d2679f99489e9f0e010026eeb563]
,RUL.Name LandLord , RUC.Name Location 
,1 Cnt
FROM @TAB TEMP
JOIN REN_Units RU WITH(NOLOCK) ON TEMP.UnitID=RU.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
LEFT JOIN COM_CC50018 C18 WITH(NOLOCK) ON C18.NodeID=RU.NodeID
LEFT JOIN REN_Contract C WITH(NOLOCK) ON TEMP.ContractID=C.ContractID
LEFT JOIN REN_Tenant T WITH(NOLOCK) ON T.TenantID=C.TenantID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID

 )a where a.Status =''Reserved''
 order by Property,VacantSince'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-06-2025 12:46:59.055 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDQ2NDYxNSwiZXhwIjoxNzU0NDkzNDE1LCJpYXQiOjE3NTQ0NjQ2MTV9.iKjtqChgxXZKVahsAuFt7SXlOzjj0djKlWRjOhCAMlA'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-06-2025 12:46:59.070 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60586'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-06-2025 12:46:59.070 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select * from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0  
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) a where UnitStatus=''Occupied'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-06-2025 12:46:59.070 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDQ2NDYxNSwiZXhwIjoxNzU0NDkzNDE1LCJpYXQiOjE3NTQ0NjQ2MTV9.iKjtqChgxXZKVahsAuFt7SXlOzjj0djKlWRjOhCAMlA'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-06-2025 12:46:59.070 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDQ2NDYxNSwiZXhwIjoxNzU0NDkzNDE1LCJpYXQiOjE3NTQ0NjQ2MTV9.iKjtqChgxXZKVahsAuFt7SXlOzjj0djKlWRjOhCAMlA'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-06-2025 12:46:59.086 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select * from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0  
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) a  where UnitStatus=''Expired'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-06-2025 12:46:59.086 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDQ2NDYxNSwiZXhwIjoxNzU0NDkzNDE1LCJpYXQiOjE3NTQ0NjQ2MTV9.iKjtqChgxXZKVahsAuFt7SXlOzjj0djKlWRjOhCAMlA'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-06-2025 12:46:59.086 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60587'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-06-2025 12:46:59.086 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDQ2NDYxNSwiZXhwIjoxNzU0NDkzNDE1LCJpYXQiOjE3NTQ0NjQ2MTV9.iKjtqChgxXZKVahsAuFt7SXlOzjj0djKlWRjOhCAMlA'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-06-2025 12:46:59.118 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select * from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0  
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) a where UStatus like ''%Case%'' 
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-06-2025 12:46:59.118 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDQ2NDYxNSwiZXhwIjoxNzU0NDkzNDE1LCJpYXQiOjE3NTQ0NjQ2MTV9.iKjtqChgxXZKVahsAuFt7SXlOzjj0djKlWRjOhCAMlA'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-06-2025 12:46:59.321 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60588'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-06-2025 12:46:59.321 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDQ2NDYxNSwiZXhwIjoxNzU0NDkzNDE1LCJpYXQiOjE3NTQ0NjQ2MTV9.iKjtqChgxXZKVahsAuFt7SXlOzjj0djKlWRjOhCAMlA'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-06-2025 12:46:59.399 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 '/*
DECLARE @FROMDATE FLOAT
SET @FROMDATE=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @TAB TABLE (ID INT IDENTITY(1,1),ContractID BIGINT,StatusID INT,PropertyID BIGINT,UnitID BIGINT,TenantID BIGINT,StartDate FLOAT,EndDate FLOAT)
INSERT INTO @TAB
SELECT RC.ContractID,RC.StatusID,RC.PropertyID,RC.UnitID,RC.TenantID,RC.StartDate,
CASE WHEN RC.StatusID=428 THEN RC.TerminationDate WHEN RC.StatusID=450 THEN ISNULL(RC.RefundDate,RC.VacancyDate) ELSE RC.EndDate END EndDate
FROM REN_Contract RC WITH(NOLOCK)
WHERE RC.ContractID>1 AND RC.CostCenterID=95 AND RC.StartDate<=@FROMDATE

select * from (
SELECT RP.Name Property,RU.Name Unit,UT.Name Type
,CASE WHEN RC.StatusID=428 OR RC.StatusID=450 THEN ''Vacant'' WHEN RC.EndDate <= @FROMDATE THEN ''Expired'' ELSE ''Occupied''  END UnitStatus 
,RUL.Name LandLord , RUC.Name Location,isnull(L.Name,''Normal'') UStatus,RCP.Amount ,1 Cnt
FROM @TAB RC
JOIN (SELECT UnitID ,MAX(StartDate) StartDate FROM @TAB GROUP BY UnitID) AS T2 ON T2.UnitID=RC.UnitID AND T2.StartDate=RC.StartDate
JOIN REN_Units RU WITH(NOLOCK) ON RU.UnitID=RC.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RC.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
LEFT JOIN REN_ContractParticulars RCP with(nolock) on RC.ContractID =RCP.ContractID and sno=1

WHERE RU.ContractID=0  
UNION
SELECT RP.Name Property,RU.Name Unit,UT.Name UnitType,''Vacant'' ,RUL.Name LandLord , RUC.Name Location ,isnull(L.Name,''Normal'') UStatus,RU.AnnualRent,1 Cnt
FROM REN_Units RU WITH(NOLOCK)
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
JOIN COM_CC50018 UT WITH(NOLOCK) ON UT.NodeID=RU.NodeID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID
LEFT JOIN COM_Lookup L with(nolock) on L.NodeID=RU.UnitStatus
WHERE RU.UnitID>1 AND RU.ContractID=0 AND RU.IsGroup=0 AND RU.UnitID NOT IN (SELECT DISTINCT UnitID FROM REN_Contract WITH(NOLOCK) WHERE ContractID>1)  
) a where UStatus like ''%Reserve%'' 
*/

DECLARE @FROM FLOAT
SET @FROM=FLOOR(CONVERT(FLOAT,GETDATE()))
DECLARE @UnitID BIGINT,@StatusID BIGINT,@TotalAmount FLOAT,@I INT,@COUNT INT,@ContractID BIGINT
DECLARE @NoofDays INT,@VacantSince DATETIME

DECLARE @TAB TABLE(ID INT IDENTITY(1,1) PRIMARY KEY,UnitID BIGINT,CurrentRent FLOAT,Status NVARCHAR(10),NoofDays INT,VacantSince DATETIME,ContractID BIGINT)

INSERT INTO @TAB (UnitID)
SELECT U.UnitID
FROM REN_Units U WITH(NOLOCK) 
LEFT JOIN REN_Property P WITH(NOLOCK) ON P.NodeID=U.PropertyID
LEFT JOIN COM_Lookup LK WITH(NOLOCK) ON U.UnitStatus=LK.NodeID
WHERE U.UnitID>1 AND P.Name <> U.Name AND U.IsGroup=0 AND U.Status=424 and U.UnitStatus=306 
-- AND P.NodeID IN (207)
SELECT @I=1,@COUNT=COUNT(*) FROM @TAB
WHILE(@I<=@COUNT)
BEGIN
	SET @StatusID=0
	SET @TotalAmount=0
	SET @ContractID=0
	SELECT @UnitID=UnitID FROM @TAB WHERE ID=@I

	SELECT TOP 1 @ContractID=(CASE WHEN RefContractID>0 THEN RefContractID ELSE ContractID END),@StatusID=StatusID
	,@VacantSince=(CASE WHEN StatusID = 450 THEN ( CASE WHEN RefundDate IS NOT NULL THEN CONVERT(DATETIME,RefundDate) ELSE CONVERT(DATETIME,VacancyDate) END ) 
			ELSE CONVERT(DATETIME,TerminationDate) END )
	,@NoofDays=(CASE WHEN StatusID = 450 THEN (CASE WHEN RefundDate IS NOT NULL THEN DATEDIFF(DAY, CONVERT(DATETIME,RefundDate),CONVERT(DATETIME,@FROM) ) 
			ELSE DATEDIFF(DAY, CONVERT(DATETIME,VacancyDate),CONVERT(DATETIME,@FROM) ) END )
			ELSE DATEDIFF(DAY, CONVERT(DATETIME,TerminationDate),CONVERT(DATETIME,@FROM) ) END )  
	FROM REN_Contract WITH(NOLOCK) WHERE StatusID<>451 AND StartDate<@FROM AND UNITID=@UnitID 
	ORDER BY StartDate DESC,StatusID
	
	SELECT @TotalAmount=ISNULL(SUM(RPD.Amount),MAX(RentAmount)/(CASE WHEN MAX(RC.NoOfUnits)=0 THEN 1 ELSE MAX(RC.NoOfUnits) END)) 
	FROM REN_Contract RC WITH(NOLOCK)
	JOIN REN_ContractParticulars RP WITH(NOLOCK) ON RP.ContractID=RC.ContractID AND RP.Sno=1
	LEFT JOIN REN_ContractParticularsDetail RPD WITH(NOLOCK) ON RPD.ParticularNodeID=RP.NodeID AND RPD.Unit=@UnitID 
	AND @FROM BETWEEN ISNULL(RPD.FromDate,@FROM) AND ISNULL(RPD.ToDate,@FROM)
	WHERE RC.ContractID=@ContractID
	
	IF @StatusID=427 OR @StatusID=426 OR @StatusID=466
	BEGIN
		UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Occupied'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
	END
	ELSE IF @StatusID=440
	BEGIN
		UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''UnAproved'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
	END
	ELSE IF @StatusID=428 OR @StatusID=450
	BEGIN 
		IF EXISTS (SELECT * FROM REN_Quotation WITH(NOLOCK) WHERE COSTCENTERID=129 AND UNITID=@UnitID AND CONVERT(DATETIME,@FROM) BETWEEN CONVERT(DATETIME,STARTDATE) AND CONVERT(DATETIME,ENDDATE) and statusid=467 )
			UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Reserved'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
		ELSE IF EXISTS (SELECT * FROM REN_Quotation WITH(NOLOCK) WHERE COSTCENTERID=103 AND UNITID=@UnitID AND CONVERT(DATETIME,@FROM) BETWEEN CONVERT(DATETIME,STARTDATE) AND CONVERT(DATETIME,ENDDATE) and statusid=426 )
			UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Quoted'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
		ELSE
			UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Vacant'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
	END
	ELSE
	BEGIN 
		IF EXISTS (SELECT * FROM REN_Quotation WITH(NOLOCK) WHERE COSTCENTERID=129 AND UNITID=@UnitID AND CONVERT(DATETIME,@FROM) BETWEEN CONVERT(DATETIME,STARTDATE) AND CONVERT(DATETIME,ENDDATE) and statusid=467 )
			UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Reserved'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
		ELSE IF EXISTS (SELECT * FROM REN_Quotation WITH(NOLOCK) WHERE COSTCENTERID=103 AND UNITID=@UnitID AND CONVERT(DATETIME,@FROM) BETWEEN CONVERT(DATETIME,STARTDATE) AND CONVERT(DATETIME,ENDDATE) and statusid=426 )
			UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Quoted'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
		ELSE
			UPDATE @TAB SET CurrentRent=@TotalAmount,Status=''Vacant'',NoofDays=@NoofDays,VacantSince=@VacantSince,ContractID=@ContractID WHERE ID=@I
	END
	set @I=@I+1
END

select * from (
SELECT TEMP.*,RP.NodeID Building_ID,RP.NAME Property,TEMP.UnitID Unit_ID,RU.NAME Unit,C18.NAME UnitType,RU.UnitStatus,RU.RentableArea UnitArea,RU.RentPerSQFT UnitRate
,RU.AnnualRent 
,T.FirstName AS [C98c7d2679f99489e9f0e010026eeb563]
,RUL.Name LandLord , RUC.Name Location 
,1 Cnt
FROM @TAB TEMP
JOIN REN_Units RU WITH(NOLOCK) ON TEMP.UnitID=RU.UnitID
JOIN REN_Property RP WITH(NOLOCK) ON RP.NodeID=RU.PropertyID
LEFT JOIN COM_CC50018 C18 WITH(NOLOCK) ON C18.NodeID=RU.NodeID
LEFT JOIN REN_Contract C WITH(NOLOCK) ON TEMP.ContractID=C.ContractID
LEFT JOIN REN_Tenant T WITH(NOLOCK) ON T.TenantID=C.TenantID
LEFT JOIN COM_Salesman RUL with(nolock) on RU.LandlordID=RUL.NodeID
LEFT JOIN COM_Location RUC with(nolock) on RP.LocationID=RUC .NodeID

 )a where a.Status =''Reserved''
 order by Property,VacantSince'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-06-2025 12:46:59.399 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDQ2NDYxNSwiZXhwIjoxNzU0NDkzNDE1LCJpYXQiOjE3NTQ0NjQ2MTV9.iKjtqChgxXZKVahsAuFt7SXlOzjj0djKlWRjOhCAMlA'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:47:50.838 | General Service|:: CompanyIndex:175 SpName: spADM_GetClientUserDetails 
 'admin'
 ,1
 ,'26.2.8'
 ,0
[System: 192.168.1.56] DEBUG | 08-06-2025 12:47:50.869 | General Service|:: CompanyIndex:0 SpName: spADM_UserLoginCheck 
 2
 ,'admin'
 ,175
 ,'192.168.1.56'
 ,'192.168.1.56'
 ,''
 ,'Web'
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:47:50.869 | General Service|:: CompanyIndex:0 SpName: spADM_Login 
 1
 ,''
 ,''
 ,''
 ,''
 ,''
 ,175
[System: 192.168.1.56] DEBUG | 08-06-2025 12:47:50.900 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select Value from ADM_GlobalPreferences with (nolock) where name =''EnableReLogin'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:47:50.931 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTQ0NjQ2NzAsImV4cCI6MTc1NDQ5MzQ3MCwiaWF0IjoxNzU0NDY0NjcwfQ.gljUKQcmH2LwsrOd4YZw3YAwYmpvShtkPwZUROHaj90'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:47:50.963 | General Service|:: CompanyIndex:0 SpName: spADM_Login 
 4
 ,''
 ,''
 ,''
 ,'declare @Cnt int,@ExpiredGUID nvarchar(50),@AllowSession int,@GUID nvarchar(50),@CurrDate float,@UserID INT,@Instances INT,@InstancesExists INT,@LCDBIndex int
set @CurrDate= convert(float,dateadd(minute,-21,getdate()))
set @AllowSession=0
set @GUID=''c430baf9-a1c5-4bc3-87b9-1649017ff51a''
set @LCDBIndex=0
select top 1 @UserID=UserID,@Instances=InstanceCount from ADM_Users with(nolock) where UserName=''admin''
if exists(select [GUID] from ADM_Login with(nolock) where [GUID]=@GUID)
begin
	update ADM_Login 
	set LastAccessTime=convert(float,getdate()),UserID=@UserID
	where [GUID]=@GUID
    set @AllowSession=1
end
else
begin
	select @Cnt=count(*) from ADM_Login with(nolock) where LCDBIndex=@LCDBIndex and [GUID]!=''ACCESSRIGHTS'' and AP =''WEB''
    if(@Cnt<100)
		set @AllowSession=1
	else
	begin
		select top 1 @ExpiredGUID=[GUID] from ADM_Login with(nolock)
		where [GUID]!=''ACCESSRIGHTS'' and LCDBIndex=@LCDBIndex and LastAccessTime<@CurrDate  and AP =''WEB''
        order by LastAccessTime asc
		if @ExpiredGUID is not null
		begin
			delete from ADM_Login where [GUID]=@ExpiredGUID
			set @AllowSession=1
		end
	end
	if @AllowSession=1
	begin
        select @InstancesExists=COUNT(*) from ADM_Login with(nolock)
		where [GUID]!=''ACCESSRIGHTS'' and LCDBIndex=@LCDBIndex and LastAccessTime>=@CurrDate and UserID=@UserID and AP =''WEB''
		if(@Instances!=0 and @Instances<=@InstancesExists)
			set @AllowSession=2
		else
		    INSERT INTO ADM_Login([GUID],[SysName],IPAddress,[Status],LoginTime,LastAccessTime,AccessRights,UserID,DBIndex,LCDBIndex,AP)
		    VALUES(@GUID,''WEB'',''192.168.1.56'',1,convert(float,getdate()),convert(float,getdate()),null,@UserID,175,@LCDBIndex, ''WEB'')
	end
end

select @AllowSession AllowSession,@Instances Instances,@InstancesExists InstancesExists
'
 ,''
 ,0
[System: 192.168.1.56] DEBUG | 08-06-2025 12:47:50.963 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTQ0NjQ2NzAsImV4cCI6MTc1NDQ5MzQ3MCwiaWF0IjoxNzU0NDY0NjcwfQ.gljUKQcmH2LwsrOd4YZw3YAwYmpvShtkPwZUROHaj90'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:47:51.025 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT (SELECT COUNT(*) FROM COM_Location L WITH(NOLOCK) JOIN COM_Status S WITH(NOLOCK) ON S.StatusID=L.StatusID WHERE L.IsGroup=0 AND S.[Status]=''Active'') ML
,(SELECT COUNT(*) FROM ADM_Features WITH(NOLOCK) WHERE ((FeatureID>50000 AND FeatureID<=50050) OR FeatureID>=51000) AND IsEnabled=1) MD
,(SELECT ISNULL(COUNT(*),0) FROM ADM_RevenUReports WITH(NOLOCK) WHERE IsGroup=0 AND ReportID>10000 AND StaticReportType IN (0,-1)) MR'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:47:51.041 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTQ0NjQ2NzAsImV4cCI6MTc1NDQ5MzQ3MCwiaWF0IjoxNzU0NDY0NjcwfQ.gljUKQcmH2LwsrOd4YZw3YAwYmpvShtkPwZUROHaj90'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:47:54.294 | General Service|:: CompanyIndex:175 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.56] DEBUG | 08-06-2025 12:47:54.294 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTQ0NjQ2NzAsImV4cCI6MTc1NDQ5MzQ3MCwiaWF0IjoxNzU0NDY0NjcwfQ.gljUKQcmH2LwsrOd4YZw3YAwYmpvShtkPwZUROHaj90'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-06-2025 12:47:58.545 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-06-2025 12:47:58.545 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDQ2NDYxNSwiZXhwIjoxNzU0NDkzNDE1LCJpYXQiOjE3NTQ0NjQ2MTV9.iKjtqChgxXZKVahsAuFt7SXlOzjj0djKlWRjOhCAMlA'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:47:59.326 | General Service|:: CompanyIndex:175 SpName: spADM_GetRibbonView 
 1
 ,1
 ,1
 ,1
 ,0
 ,''
[System: 192.168.1.56] DEBUG | 08-06-2025 12:47:59.326 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTQ0NjQ2NzAsImV4cCI6MTc1NDQ5MzQ3MCwiaWF0IjoxNzU0NDY0NjcwfQ.gljUKQcmH2LwsrOd4YZw3YAwYmpvShtkPwZUROHaj90'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:47:59.717 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 2
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:47:59.717 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTQ0NjQ2NzAsImV4cCI6MTc1NDQ5MzQ3MCwiaWF0IjoxNzU0NDY0NjcwfQ.gljUKQcmH2LwsrOd4YZw3YAwYmpvShtkPwZUROHaj90'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:47:59.764 | General Service|:: CompanyIndex:175 SpName: spADM_GetDashBoard 
 2
 ,0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:47:59.764 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTQ0NjQ2NzAsImV4cCI6MTc1NDQ5MzQ3MCwiaWF0IjoxNzU0NDY0NjcwfQ.gljUKQcmH2LwsrOd4YZw3YAwYmpvShtkPwZUROHaj90'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:47:59.811 | General Service|:: CompanyIndex:175 SpName: spCOM_ConfigValues 
 1
 ,'LandingDocs'
 ,'1'
[System: 192.168.1.56] DEBUG | 08-06-2025 12:47:59.811 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTQ0NjQ2NzAsImV4cCI6MTc1NDQ5MzQ3MCwiaWF0IjoxNzU0NDY0NjcwfQ.gljUKQcmH2LwsrOd4YZw3YAwYmpvShtkPwZUROHaj90'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:48:00.877 | General Service|:: CompanyIndex:175 SpName: spCOM_GetFavorites 
 'GETLIST0'
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:48:00.877 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTQ0NjQ2NzAsImV4cCI6MTc1NDQ5MzQ3MCwiaWF0IjoxNzU0NDY0NjcwfQ.gljUKQcmH2LwsrOd4YZw3YAwYmpvShtkPwZUROHaj90'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:48:01.314 | General Service|:: CompanyIndex:175 SpName: spADM_GetAllListViewsDef 
 1
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:48:01.314 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTQ0NjQ2NzAsImV4cCI6MTc1NDQ5MzQ3MCwiaWF0IjoxNzU0NDY0NjcwfQ.gljUKQcmH2LwsrOd4YZw3YAwYmpvShtkPwZUROHaj90'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:48:01.392 | General Service|:: CompanyIndex:175 SpName: spADM_GetAllListViewsDef 
 1
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:48:01.392 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTQ0NjQ2NzAsImV4cCI6MTc1NDQ5MzQ3MCwiaWF0IjoxNzU0NDY0NjcwfQ.gljUKQcmH2LwsrOd4YZw3YAwYmpvShtkPwZUROHaj90'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:48:02.502 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'Select CostCenterID,CostCenterColID,CostCenterName,SysTableName,UserColumnName,SysColumnName,ISNULL(UserDefaultValue,'''') UserDefaultValue
From AdM_CostCenterDef WITH(NOLOCK)
Where SysColumnName IN(''CreditAccount'',''DebitAccount'',''ProductID'') 
AND CostCenterID>40000 AND CostCenterID<50000 

SELECT * FROM ADM_Features WITH(NOLOCK) '
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:48:02.502 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTQ0NjQ2NzAsImV4cCI6MTc1NDQ5MzQ3MCwiaWF0IjoxNzU0NDY0NjcwfQ.gljUKQcmH2LwsrOd4YZw3YAwYmpvShtkPwZUROHaj90'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:48:02.596 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 '  SELECT * FROM PAY_PayrollPreferences WITH(NOLOCK) '
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:48:02.596 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTQ0NjQ2NzAsImV4cCI6MTc1NDQ5MzQ3MCwiaWF0IjoxNzU0NDY0NjcwfQ.gljUKQcmH2LwsrOd4YZw3YAwYmpvShtkPwZUROHaj90'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:48:03.767 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 '  --0
                                Select * FROM COM_CC50051 WITH(NOLOCK) WHERE IsGroup=0 AND LoginUserID=''admin''
                                --1                                
                                Select * FROM COM_CC50051 WITH(NOLOCK) WHERE RptManager IN (Select NodeID FROM COM_CC50051 WITH(NOLOCK) WHERE IsGroup=0 AND LoginUserID=''admin'')
                                UNION ALL
                                Select * FROM COM_CC50051 WITH(NOLOCK) WHERE RptManager IN 
                                (
	                                Select NodeID FROM COM_CC50051 WITH(NOLOCK) 
	                                WHERE IsGroup=0 AND LoginUserID IN
	                                (
	                                SELECT fe.LoginUserID
	                                FROM INV_DocDetails a WITH(NOLOCK) 
	                                JOIN COM_DocCCData b WITH(NOLOCK) ON b.InvDocDetailsID=a.InvDocDetailsID
	                                JOIN COM_DocNumData c WITH(NOLOCK) ON c.InvDocDetailsID=a.InvDocDetailsID
	                                JOIN COM_DocTextData d WITH(NOLOCK) ON d.InvDocDetailsID=a.InvDocDetailsID
	                                JOIN COM_CC50051 fe WITH(NOLOCK) on fe.NodeID=b.dcCCNID51
	                                JOIN COM_CC50051 te WITH(NOLOCK) on CONVERT(NVARCHAR,te.NodeID)=d.dcAlpha1
	                                WHERE a.CostCenterID=40098 and a.StatusID=369 AND d.dcAlpha3=''Temporary''
	                                AND te.LoginUserID=''admin'' 
	                                AND ISDATE(d.dcAlpha4)=1 AND ISDATE(d.dcAlpha5)=1 
	                                AND CONVERT(DATETIME,''06 Aug 2025'') BETWEEN CONVERT(DATETIME,d.dcAlpha4) AND CONVERT(DATETIME,d.dcAlpha5)
	                                )
                                )
                                --2
                                Select * FROM ADM_USERS WITH(NOLOCK) WHERE USERID=1
                                --3
                                Select * FROM COM_CostCenterCostCenterMap WITH(NOLOCK) WHERE ParentCostCenterID=7 AND ParentNodeID=1
                                --4                                
                                Select * FROM COM_CostCenterCostCenterMap WITH(NOLOCK) WHERE ParentCostCenterID=7 AND ParentNodeID=1
                                AND CostCenterID IN(Select ColumnCostCenterID From ADM_CostCenterDef Where CostCenterID=50051 AND IsColumnInUse=1 AND SysColumnName LIKE ''CCNID%'')
                                --5
                                Select * from COM_Files WITH(NOLOCK) WHERE FeatureID=50051 AND FeaturePK IN (Select NodeID FROM COM_CC50051 WITH(NOLOCK) WHERE IsGroup=0 AND LoginUserID=''admin'')                         
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:48:03.767 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTQ0NjQ2NzAsImV4cCI6MTc1NDQ5MzQ3MCwiaWF0IjoxNzU0NDY0NjcwfQ.gljUKQcmH2LwsrOd4YZw3YAwYmpvShtkPwZUROHaj90'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:48:03.846 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'UPDATE C SET STATUSID=CASE WHEN ResignType=''Resigned'' THEN 302 WHEN ResignType=''Terminated With Cause'' THEN 303 WHEN ResignType=''Terminated Without Cause'' THEN 304 END 
                            FROM COM_CC50051 C WITH(NOLOCK)
                            WHERE ResignStatus=''Posted'' AND ResignType NOT IN(''Pending'',''Rejected'') 
                            AND DOResign IS NOT NULL AND DORelieve IS NOT NULL
                            AND STATUSID NOT IN(302,303,304)
                            AND DATEDIFF(D,GETDATE(),DORelieve)<0'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:48:03.846 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTQ0NjQ2NzAsImV4cCI6MTc1NDQ5MzQ3MCwiaWF0IjoxNzU0NDY0NjcwfQ.gljUKQcmH2LwsrOd4YZw3YAwYmpvShtkPwZUROHaj90'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:48:04.220 | General Service|:: CompanyIndex:175 SpName: spCOM_GetFavorites 
 'GETLIST0'
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:48:04.220 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTQ0NjQ2NzAsImV4cCI6MTc1NDQ5MzQ3MCwiaWF0IjoxNzU0NDY0NjcwfQ.gljUKQcmH2LwsrOd4YZw3YAwYmpvShtkPwZUROHaj90'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:48:04.283 | General Service|:: CompanyIndex:175 SpName: spCOM_GetFavorites 
 'VIEW'
 ,1
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:48:04.283 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTQ0NjQ2NzAsImV4cCI6MTc1NDQ5MzQ3MCwiaWF0IjoxNzU0NDY0NjcwfQ.gljUKQcmH2LwsrOd4YZw3YAwYmpvShtkPwZUROHaj90'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:48:04.689 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:48:04.705 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTQ0NjQ2NzAsImV4cCI6MTc1NDQ5MzQ3MCwiaWF0IjoxNzU0NDY0NjcwfQ.gljUKQcmH2LwsrOd4YZw3YAwYmpvShtkPwZUROHaj90'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:48:11.047 | General Service|:: CompanyIndex:7 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.56] DEBUG | 08-06-2025 12:48:11.047 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsNywxIiwibmJmIjoxNzU0NDYzNzgyLCJleHAiOjE3NTQ0OTI1ODIsImlhdCI6MTc1NDQ2Mzc4Mn0.9KypghGFg7B7MqF70r9PZzncStq8QTbC8cpYxxvPXzM'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-06-2025 12:48:58.381 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-06-2025 12:48:58.381 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDQ2NDYxNSwiZXhwIjoxNzU0NDkzNDE1LCJpYXQiOjE3NTQ0NjQ2MTV9.iKjtqChgxXZKVahsAuFt7SXlOzjj0djKlWRjOhCAMlA'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:49:03.913 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:49:03.913 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTQ0NjQ2NzAsImV4cCI6MTc1NDQ5MzQ3MCwiaWF0IjoxNzU0NDY0NjcwfQ.gljUKQcmH2LwsrOd4YZw3YAwYmpvShtkPwZUROHaj90'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-06-2025 12:49:45.463 | General Service|:: CompanyIndex:0 SpName: spADM_GetClientUserDetails2C 
 'admin'
 ,1
 ,0
[System: 192.168.1.77] DEBUG | 08-06-2025 12:49:45.542 | General Service|:: CompanyIndex:0 SpName: spADM_UserLoginCheck 
 2
 ,'admin'
 ,0
 ,'192.168.1.77'
 ,'192.168.1.77'
 ,''
 ,'Web'
 ,1
[System: 192.168.1.77] DEBUG | 08-06-2025 12:49:51.259 | General Service|:: CompanyIndex:75 SpName: spADM_GetClientUserDetails 
 'admin'
 ,1
 ,'26.2.3'
 ,0
[System: 192.168.1.77] DEBUG | 08-06-2025 12:49:51.337 | General Service|:: CompanyIndex:0 SpName: spADM_UserLoginCheck 
 2
 ,'admin'
 ,75
 ,'192.168.1.77'
 ,'192.168.1.77'
 ,''
 ,'Web'
 ,1
[System: 192.168.1.77] DEBUG | 08-06-2025 12:49:51.353 | General Service|:: CompanyIndex:0 SpName: spADM_Login 
 1
 ,''
 ,''
 ,''
 ,''
 ,''
 ,75
[System: 192.168.1.77] DEBUG | 08-06-2025 12:49:51.368 | General Service|:: CompanyIndex:75 SpName: spADM_GetDataSet 
 'select Value from ADM_GlobalPreferences with (nolock) where name =''EnableReLogin'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-06-2025 12:49:51.368 | General Service|:: CompanyIndex:75 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNzUsMSIsIm5iZiI6MTc1NDQ2NDc5MSwiZXhwIjoxNzU0NDkzNTkxLCJpYXQiOjE3NTQ0NjQ3OTF9.cQ3JWFRpzsG9oGvET-pzVltLb1GUT9xNv4wYuuNWGhA'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-06-2025 12:49:51.400 | General Service|:: CompanyIndex:0 SpName: spADM_Login 
 4
 ,''
 ,''
 ,''
 ,'declare @Cnt int,@ExpiredGUID nvarchar(50),@AllowSession int,@GUID nvarchar(50),@CurrDate float,@UserID INT,@Instances INT,@InstancesExists INT,@LCDBIndex int
set @CurrDate= convert(float,dateadd(minute,-21,getdate()))
set @AllowSession=0
set @GUID=''0eb11d64-db94-41f4-a8f6-a3102d008431''
set @LCDBIndex=0
select top 1 @UserID=UserID,@Instances=InstanceCount from ADM_Users with(nolock) where UserName=''admin''
if exists(select [GUID] from ADM_Login with(nolock) where [GUID]=@GUID)
begin
	update ADM_Login 
	set LastAccessTime=convert(float,getdate()),UserID=@UserID
	where [GUID]=@GUID
    set @AllowSession=1
end
else
begin
	select @Cnt=count(*) from ADM_Login with(nolock) where LCDBIndex=@LCDBIndex and [GUID]!=''ACCESSRIGHTS'' and AP =''WEB''
    if(@Cnt<100)
		set @AllowSession=1
	else
	begin
		select top 1 @ExpiredGUID=[GUID] from ADM_Login with(nolock)
		where [GUID]!=''ACCESSRIGHTS'' and LCDBIndex=@LCDBIndex and LastAccessTime<@CurrDate  and AP =''WEB''
        order by LastAccessTime asc
		if @ExpiredGUID is not null
		begin
			delete from ADM_Login where [GUID]=@ExpiredGUID
			set @AllowSession=1
		end
	end
	if @AllowSession=1
	begin
        select @InstancesExists=COUNT(*) from ADM_Login with(nolock)
		where [GUID]!=''ACCESSRIGHTS'' and LCDBIndex=@LCDBIndex and LastAccessTime>=@CurrDate and UserID=@UserID and AP =''WEB''
		if(@Instances!=0 and @Instances<=@InstancesExists)
			set @AllowSession=2
		else
		    INSERT INTO ADM_Login([GUID],[SysName],IPAddress,[Status],LoginTime,LastAccessTime,AccessRights,UserID,DBIndex,LCDBIndex,AP)
		    VALUES(@GUID,''WEB'',''192.168.1.77'',1,convert(float,getdate()),convert(float,getdate()),null,@UserID,75,@LCDBIndex, ''WEB'')
	end
end

select @AllowSession AllowSession,@Instances Instances,@InstancesExists InstancesExists
'
 ,''
 ,0
[System: 192.168.1.77] DEBUG | 08-06-2025 12:49:51.400 | General Service|:: CompanyIndex:75 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNzUsMSIsIm5iZiI6MTc1NDQ2NDc5MSwiZXhwIjoxNzU0NDkzNTkxLCJpYXQiOjE3NTQ0NjQ3OTF9.cQ3JWFRpzsG9oGvET-pzVltLb1GUT9xNv4wYuuNWGhA'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-06-2025 12:49:51.431 | General Service|:: CompanyIndex:75 SpName: spADM_GetDataSet 
 'SELECT (SELECT COUNT(*) FROM COM_Location L WITH(NOLOCK) JOIN COM_Status S WITH(NOLOCK) ON S.StatusID=L.StatusID WHERE L.IsGroup=0 AND S.[Status]=''Active'') ML
,(SELECT COUNT(*) FROM ADM_Features WITH(NOLOCK) WHERE ((FeatureID>50000 AND FeatureID<=50050) OR FeatureID>=51000) AND IsEnabled=1) MD
,(SELECT ISNULL(COUNT(*),0) FROM ADM_RevenUReports WITH(NOLOCK) WHERE IsGroup=0 AND ReportID>10000 AND StaticReportType IN (0,-1)) MR'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-06-2025 12:49:51.431 | General Service|:: CompanyIndex:75 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNzUsMSIsIm5iZiI6MTc1NDQ2NDc5MSwiZXhwIjoxNzU0NDkzNTkxLCJpYXQiOjE3NTQ0NjQ3OTF9.cQ3JWFRpzsG9oGvET-pzVltLb1GUT9xNv4wYuuNWGhA'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-06-2025 12:49:51.462 | General Service|:: CompanyIndex:75 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.77] DEBUG | 08-06-2025 12:49:51.462 | General Service|:: CompanyIndex:75 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNzUsMSIsIm5iZiI6MTc1NDQ2NDc5MSwiZXhwIjoxNzU0NDkzNTkxLCJpYXQiOjE3NTQ0NjQ3OTF9.cQ3JWFRpzsG9oGvET-pzVltLb1GUT9xNv4wYuuNWGhA'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-06-2025 12:49:51.618 | General Service|:: CompanyIndex:75 SpName: spADM_GetRibbonView 
 1
 ,1
 ,1
 ,1
 ,0
 ,''
[System: 192.168.1.77] DEBUG | 08-06-2025 12:49:51.618 | General Service|:: CompanyIndex:75 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNzUsMSIsIm5iZiI6MTc1NDQ2NDc5MSwiZXhwIjoxNzU0NDkzNTkxLCJpYXQiOjE3NTQ0NjQ3OTF9.cQ3JWFRpzsG9oGvET-pzVltLb1GUT9xNv4wYuuNWGhA'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-06-2025 12:49:51.853 | General Service|:: CompanyIndex:75 SpName: spADM_GetDashBoard 
 2
 ,0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.77] DEBUG | 08-06-2025 12:49:51.853 | General Service|:: CompanyIndex:75 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNzUsMSIsIm5iZiI6MTc1NDQ2NDc5MSwiZXhwIjoxNzU0NDkzNTkxLCJpYXQiOjE3NTQ0NjQ3OTF9.cQ3JWFRpzsG9oGvET-pzVltLb1GUT9xNv4wYuuNWGhA'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-06-2025 12:49:51.869 | General Service|:: CompanyIndex:75 SpName: spCOM_ConfigValues 
 1
 ,'LandingDocs'
 ,'1'
[System: 192.168.1.77] DEBUG | 08-06-2025 12:49:51.869 | General Service|:: CompanyIndex:75 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNzUsMSIsIm5iZiI6MTc1NDQ2NDc5MSwiZXhwIjoxNzU0NDkzNTkxLCJpYXQiOjE3NTQ0NjQ3OTF9.cQ3JWFRpzsG9oGvET-pzVltLb1GUT9xNv4wYuuNWGhA'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-06-2025 12:49:51.931 | General Service|:: CompanyIndex:75 SpName: spADM_GetAllListViewsDef 
 1
 ,1
[System: 192.168.1.77] DEBUG | 08-06-2025 12:49:51.931 | General Service|:: CompanyIndex:75 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNzUsMSIsIm5iZiI6MTc1NDQ2NDc5MSwiZXhwIjoxNzU0NDkzNTkxLCJpYXQiOjE3NTQ0NjQ3OTF9.cQ3JWFRpzsG9oGvET-pzVltLb1GUT9xNv4wYuuNWGhA'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-06-2025 12:49:52.040 | General Service|:: CompanyIndex:75 SpName: spADM_GetAllListViewsDef 
 1
 ,1
[System: 192.168.1.77] DEBUG | 08-06-2025 12:49:52.040 | General Service|:: CompanyIndex:75 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNzUsMSIsIm5iZiI6MTc1NDQ2NDc5MSwiZXhwIjoxNzU0NDkzNTkxLCJpYXQiOjE3NTQ0NjQ3OTF9.cQ3JWFRpzsG9oGvET-pzVltLb1GUT9xNv4wYuuNWGhA'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-06-2025 12:49:52.134 | General Service|:: CompanyIndex:75 SpName: spADM_GetDataSet 
 'Select CostCenterID,CostCenterColID,CostCenterName,SysTableName,UserColumnName,SysColumnName,ISNULL(UserDefaultValue,'''') UserDefaultValue
From AdM_CostCenterDef WITH(NOLOCK)
Where SysColumnName IN(''CreditAccount'',''DebitAccount'',''ProductID'') 
AND CostCenterID>40000 AND CostCenterID<50000 

SELECT * FROM ADM_Features WITH(NOLOCK) '
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-06-2025 12:49:52.134 | General Service|:: CompanyIndex:75 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNzUsMSIsIm5iZiI6MTc1NDQ2NDc5MSwiZXhwIjoxNzU0NDkzNTkxLCJpYXQiOjE3NTQ0NjQ3OTF9.cQ3JWFRpzsG9oGvET-pzVltLb1GUT9xNv4wYuuNWGhA'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-06-2025 12:49:52.181 | General Service|:: CompanyIndex:75 SpName: spADM_GetDataSet 
 '  SELECT * FROM PAY_PayrollPreferences WITH(NOLOCK) '
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-06-2025 12:49:52.181 | General Service|:: CompanyIndex:75 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNzUsMSIsIm5iZiI6MTc1NDQ2NDc5MSwiZXhwIjoxNzU0NDkzNTkxLCJpYXQiOjE3NTQ0NjQ3OTF9.cQ3JWFRpzsG9oGvET-pzVltLb1GUT9xNv4wYuuNWGhA'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-06-2025 12:49:52.228 | General Service|:: CompanyIndex:75 SpName: spADM_GetDataSet 
 '  --0
                                Select * FROM COM_CC50051 WITH(NOLOCK) WHERE IsGroup=0 AND LoginUserID=''admin''
                                --1                                
                                Select * FROM COM_CC50051 WITH(NOLOCK) WHERE RptManager IN (Select NodeID FROM COM_CC50051 WITH(NOLOCK) WHERE IsGroup=0 AND LoginUserID=''admin'')
                                UNION ALL
                                Select * FROM COM_CC50051 WITH(NOLOCK) WHERE RptManager IN 
                                (
	                                Select NodeID FROM COM_CC50051 WITH(NOLOCK) 
	                                WHERE IsGroup=0 AND LoginUserID IN
	                                (
	                                SELECT fe.LoginUserID
	                                FROM INV_DocDetails a WITH(NOLOCK) 
	                                JOIN COM_DocCCData b WITH(NOLOCK) ON b.InvDocDetailsID=a.InvDocDetailsID
	                                JOIN COM_DocNumData c WITH(NOLOCK) ON c.InvDocDetailsID=a.InvDocDetailsID
	                                JOIN COM_DocTextData d WITH(NOLOCK) ON d.InvDocDetailsID=a.InvDocDetailsID
	                                JOIN COM_CC50051 fe WITH(NOLOCK) on fe.NodeID=b.dcCCNID51
	                                JOIN COM_CC50051 te WITH(NOLOCK) on CONVERT(NVARCHAR,te.NodeID)=d.dcAlpha1
	                                WHERE a.CostCenterID=40098 and a.StatusID=369 AND d.dcAlpha3=''Temporary''
	                                AND te.LoginUserID=''admin'' 
	                                AND ISDATE(d.dcAlpha4)=1 AND ISDATE(d.dcAlpha5)=1 
	                                AND CONVERT(DATETIME,''06 Aug 2025'') BETWEEN CONVERT(DATETIME,d.dcAlpha4) AND CONVERT(DATETIME,d.dcAlpha5)
	                                )
                                )
                                --2
                                Select * FROM ADM_USERS WITH(NOLOCK) WHERE USERID=1
                                --3
                                Select * FROM COM_CostCenterCostCenterMap WITH(NOLOCK) WHERE ParentCostCenterID=7 AND ParentNodeID=1
                                --4                                
                                Select * FROM COM_CostCenterCostCenterMap WITH(NOLOCK) WHERE ParentCostCenterID=7 AND ParentNodeID=1
                                AND CostCenterID IN(Select ColumnCostCenterID From ADM_CostCenterDef Where CostCenterID=50051 AND IsColumnInUse=1 AND SysColumnName LIKE ''CCNID%'')
                                --5
                                Select * from COM_Files WITH(NOLOCK) WHERE FeatureID=50051 AND FeaturePK IN (Select NodeID FROM COM_CC50051 WITH(NOLOCK) WHERE IsGroup=0 AND LoginUserID=''admin'')                         
'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-06-2025 12:49:52.228 | General Service|:: CompanyIndex:75 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNzUsMSIsIm5iZiI6MTc1NDQ2NDc5MSwiZXhwIjoxNzU0NDkzNTkxLCJpYXQiOjE3NTQ0NjQ3OTF9.cQ3JWFRpzsG9oGvET-pzVltLb1GUT9xNv4wYuuNWGhA'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-06-2025 12:49:52.243 | General Service|:: CompanyIndex:75 SpName: spADM_GetDataSet 
 'UPDATE C SET STATUSID=CASE WHEN ResignType=''Resigned'' THEN 302 WHEN ResignType=''Terminated With Cause'' THEN 303 WHEN ResignType=''Terminated Without Cause'' THEN 304 END 
                            FROM COM_CC50051 C WITH(NOLOCK)
                            WHERE ResignStatus=''Posted'' AND ResignType NOT IN(''Pending'',''Rejected'') 
                            AND DOResign IS NOT NULL AND DORelieve IS NOT NULL
                            AND STATUSID NOT IN(302,303,304)
                            AND DATEDIFF(D,GETDATE(),DORelieve)<0'
 ,1
 ,1
 message=Cannot insert the value NULL into column 'StatusID', table 'PACT2C75.dbo.COM_CC50051'; column does not allow nulls. UPDATE fails.
[System: 192.168.1.77] DEBUG | 08-06-2025 12:49:52.243 | General Service|:: CompanyIndex:75 SpName: spADM_GetDataSet 
 'UPDATE C SET STATUSID=CASE WHEN ResignType=''Resigned'' THEN 302 WHEN ResignType=''Terminated With Cause'' THEN 303 WHEN ResignType=''Terminated Without Cause'' THEN 304 END 
                            FROM COM_CC50051 C WITH(NOLOCK)
                            WHERE ResignStatus=''Posted'' AND ResignType NOT IN(''Pending'',''Rejected'') 
                            AND DOResign IS NOT NULL AND DORelieve IS NOT NULL
                            AND STATUSID NOT IN(302,303,304)
                            AND DATEDIFF(D,GETDATE(),DORelieve)<0'
 ,1
 ,1
 message=Problem in processing your request, Please contact administrator.
[System: 192.168.1.77] INFO | 08-06-2025 12:49:52.243 | OnStartup: Logger Instance Created Successfully
[System: 192.168.1.77] INFO | 08-06-2025 12:49:52.243 | OnStartup: Application Starting...
[System: 192.168.1.77] ERROR | 08-06-2025 12:49:52.243 | General Service|:: CompanyIndex:75 SpName: spADM_GetDataSetParameters :
 'UPDATE C SET STATUSID=CASE WHEN ResignType=''Resigned'' THEN 302 WHEN ResignType=''Terminated With Cause'' THEN 303 WHEN ResignType=''Terminated Without Cause'' THEN 304 END 
                            FROM COM_CC50051 C WITH(NOLOCK)
                            WHERE ResignStatus=''Posted'' AND ResignType NOT IN(''Pending'',''Rejected'') 
                            AND DOResign IS NOT NULL AND DORelieve IS NOT NULL
                            AND STATUSID NOT IN(302,303,304)
                            AND DATEDIFF(D,GETDATE(),DORelieve)<0'
 ,1
 ,1|Cannot insert the value NULL into column 'StatusID', table 'PACT2C75.dbo.COM_CC50051'; column does not allow nulls. UPDATE fails.
[System: 192.168.1.77] DEBUG | 08-06-2025 12:49:52.243 | General Service|:: CompanyIndex:75 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNzUsMSIsIm5iZiI6MTc1NDQ2NDc5MSwiZXhwIjoxNzU0NDkzNTkxLCJpYXQiOjE3NTQ0NjQ3OTF9.cQ3JWFRpzsG9oGvET-pzVltLb1GUT9xNv4wYuuNWGhA'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-06-2025 12:49:52.431 | General Service|:: CompanyIndex:75 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-06-2025 12:49:52.431 | General Service|:: CompanyIndex:75 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNzUsMSIsIm5iZiI6MTc1NDQ2NDc5MSwiZXhwIjoxNzU0NDkzNTkxLCJpYXQiOjE3NTQ0NjQ3OTF9.cQ3JWFRpzsG9oGvET-pzVltLb1GUT9xNv4wYuuNWGhA'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-06-2025 12:49:52.603 | General Service|:: CompanyIndex:75 SpName: spCOM_GetFavorites 
 'GETLIST0'
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.77] DEBUG | 08-06-2025 12:49:52.603 | General Service|:: CompanyIndex:75 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNzUsMSIsIm5iZiI6MTc1NDQ2NDc5MSwiZXhwIjoxNzU0NDkzNTkxLCJpYXQiOjE3NTQ0NjQ3OTF9.cQ3JWFRpzsG9oGvET-pzVltLb1GUT9xNv4wYuuNWGhA'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-06-2025 12:49:52.634 | General Service|:: CompanyIndex:75 SpName: spCOM_GetFavorites 
 'VIEW'
 ,71
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.77] DEBUG | 08-06-2025 12:49:52.634 | General Service|:: CompanyIndex:75 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNzUsMSIsIm5iZiI6MTc1NDQ2NDc5MSwiZXhwIjoxNzU0NDkzNTkxLCJpYXQiOjE3NTQ0NjQ3OTF9.cQ3JWFRpzsG9oGvET-pzVltLb1GUT9xNv4wYuuNWGhA'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:49:54.712 | General Service|:: CompanyIndex:175 SpName: spADM_GetDashBoard 
 1
 ,36
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:49:54.712 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTQ0NjQ2NzAsImV4cCI6MTc1NDQ5MzQ3MCwiaWF0IjoxNzU0NDY0NjcwfQ.gljUKQcmH2LwsrOd4YZw3YAwYmpvShtkPwZUROHaj90'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:49:54.744 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60554
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:49:54.759 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60553
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:49:54.759 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTQ0NjQ2NzAsImV4cCI6MTc1NDQ5MzQ3MCwiaWF0IjoxNzU0NDY0NjcwfQ.gljUKQcmH2LwsrOd4YZw3YAwYmpvShtkPwZUROHaj90'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:49:54.759 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTQ0NjQ2NzAsImV4cCI6MTc1NDQ5MzQ3MCwiaWF0IjoxNzU0NDY0NjcwfQ.gljUKQcmH2LwsrOd4YZw3YAwYmpvShtkPwZUROHaj90'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:49:54.759 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60552
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:49:54.759 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTQ0NjQ2NzAsImV4cCI6MTc1NDQ5MzQ3MCwiaWF0IjoxNzU0NDY0NjcwfQ.gljUKQcmH2LwsrOd4YZw3YAwYmpvShtkPwZUROHaj90'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:49:54.775 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60573
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:49:54.775 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTQ0NjQ2NzAsImV4cCI6MTc1NDQ5MzQ3MCwiaWF0IjoxNzU0NDY0NjcwfQ.gljUKQcmH2LwsrOd4YZw3YAwYmpvShtkPwZUROHaj90'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:49:54.775 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:49:54.775 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTQ0NjQ2NzAsImV4cCI6MTc1NDQ5MzQ3MCwiaWF0IjoxNzU0NDY0NjcwfQ.gljUKQcmH2LwsrOd4YZw3YAwYmpvShtkPwZUROHaj90'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:49:54.775 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60554
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:49:54.775 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60555
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:49:54.775 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60553
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:49:54.775 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTQ0NjQ2NzAsImV4cCI6MTc1NDQ5MzQ3MCwiaWF0IjoxNzU0NDY0NjcwfQ.gljUKQcmH2LwsrOd4YZw3YAwYmpvShtkPwZUROHaj90'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:49:54.790 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTQ0NjQ2NzAsImV4cCI6MTc1NDQ5MzQ3MCwiaWF0IjoxNzU0NDY0NjcwfQ.gljUKQcmH2LwsrOd4YZw3YAwYmpvShtkPwZUROHaj90'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:49:54.790 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60574
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:49:54.790 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTQ0NjQ2NzAsImV4cCI6MTc1NDQ5MzQ3MCwiaWF0IjoxNzU0NDY0NjcwfQ.gljUKQcmH2LwsrOd4YZw3YAwYmpvShtkPwZUROHaj90'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:49:54.790 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTQ0NjQ2NzAsImV4cCI6MTc1NDQ5MzQ3MCwiaWF0IjoxNzU0NDY0NjcwfQ.gljUKQcmH2LwsrOd4YZw3YAwYmpvShtkPwZUROHaj90'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:49:54.790 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60573
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:49:54.790 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:49:54.790 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTQ0NjQ2NzAsImV4cCI6MTc1NDQ5MzQ3MCwiaWF0IjoxNzU0NDY0NjcwfQ.gljUKQcmH2LwsrOd4YZw3YAwYmpvShtkPwZUROHaj90'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:49:54.790 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60552
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:49:54.790 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTQ0NjQ2NzAsImV4cCI6MTc1NDQ5MzQ3MCwiaWF0IjoxNzU0NDY0NjcwfQ.gljUKQcmH2LwsrOd4YZw3YAwYmpvShtkPwZUROHaj90'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:49:54.790 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTQ0NjQ2NzAsImV4cCI6MTc1NDQ5MzQ3MCwiaWF0IjoxNzU0NDY0NjcwfQ.gljUKQcmH2LwsrOd4YZw3YAwYmpvShtkPwZUROHaj90'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:49:54.790 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60555
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:49:54.806 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTQ0NjQ2NzAsImV4cCI6MTc1NDQ5MzQ3MCwiaWF0IjoxNzU0NDY0NjcwfQ.gljUKQcmH2LwsrOd4YZw3YAwYmpvShtkPwZUROHaj90'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:49:54.806 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,60574
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:49:54.806 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:49:54.806 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTQ0NjQ2NzAsImV4cCI6MTc1NDQ5MzQ3MCwiaWF0IjoxNzU0NDY0NjcwfQ.gljUKQcmH2LwsrOd4YZw3YAwYmpvShtkPwZUROHaj90'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:49:54.806 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTQ0NjQ2NzAsImV4cCI6MTc1NDQ5MzQ3MCwiaWF0IjoxNzU0NDY0NjcwfQ.gljUKQcmH2LwsrOd4YZw3YAwYmpvShtkPwZUROHaj90'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:49:54.822 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:49:54.822 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTQ0NjQ2NzAsImV4cCI6MTc1NDQ5MzQ3MCwiaWF0IjoxNzU0NDY0NjcwfQ.gljUKQcmH2LwsrOd4YZw3YAwYmpvShtkPwZUROHaj90'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:49:54.822 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:49:54.822 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTQ0NjQ2NzAsImV4cCI6MTc1NDQ5MzQ3MCwiaWF0IjoxNzU0NDY0NjcwfQ.gljUKQcmH2LwsrOd4YZw3YAwYmpvShtkPwZUROHaj90'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:49:54.837 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:49:54.837 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTQ0NjQ2NzAsImV4cCI6MTc1NDQ5MzQ3MCwiaWF0IjoxNzU0NDY0NjcwfQ.gljUKQcmH2LwsrOd4YZw3YAwYmpvShtkPwZUROHaj90'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:49:54.837 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:49:54.837 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTQ0NjQ2NzAsImV4cCI6MTc1NDQ5MzQ3MCwiaWF0IjoxNzU0NDY0NjcwfQ.gljUKQcmH2LwsrOd4YZw3YAwYmpvShtkPwZUROHaj90'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:49:54.853 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:49:54.853 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTQ0NjQ2NzAsImV4cCI6MTc1NDQ5MzQ3MCwiaWF0IjoxNzU0NDY0NjcwfQ.gljUKQcmH2LwsrOd4YZw3YAwYmpvShtkPwZUROHaj90'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:49:54.853 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:49:54.853 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTQ0NjQ2NzAsImV4cCI6MTc1NDQ5MzQ3MCwiaWF0IjoxNzU0NDY0NjcwfQ.gljUKQcmH2LwsrOd4YZw3YAwYmpvShtkPwZUROHaj90'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:49:54.869 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:49:54.869 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTQ0NjQ2NzAsImV4cCI6MTc1NDQ5MzQ3MCwiaWF0IjoxNzU0NDY0NjcwfQ.gljUKQcmH2LwsrOd4YZw3YAwYmpvShtkPwZUROHaj90'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:49:54.869 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:49:54.869 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTQ0NjQ2NzAsImV4cCI6MTc1NDQ5MzQ3MCwiaWF0IjoxNzU0NDY0NjcwfQ.gljUKQcmH2LwsrOd4YZw3YAwYmpvShtkPwZUROHaj90'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:49:54.884 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReport 
 0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:49:54.884 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTQ0NjQ2NzAsImV4cCI6MTc1NDQ5MzQ3MCwiaWF0IjoxNzU0NDY0NjcwfQ.gljUKQcmH2LwsrOd4YZw3YAwYmpvShtkPwZUROHaj90'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:49:54.962 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60573'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:49:54.962 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTQ0NjQ2NzAsImV4cCI6MTc1NDQ5MzQ3MCwiaWF0IjoxNzU0NDY0NjcwfQ.gljUKQcmH2LwsrOd4YZw3YAwYmpvShtkPwZUROHaj90'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:49:55.119 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReportCategoryandField 
 -1
 ,0
 ,1
 ,0
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:49:55.119 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTQ0NjQ2NzAsImV4cCI6MTc1NDQ5MzQ3MCwiaWF0IjoxNzU0NDY0NjcwfQ.gljUKQcmH2LwsrOd4YZw3YAwYmpvShtkPwZUROHaj90'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:49:55.400 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReportFields 
 400
 ,0
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:49:55.400 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTQ0NjQ2NzAsImV4cCI6MTc1NDQ5MzQ3MCwiaWF0IjoxNzU0NDY0NjcwfQ.gljUKQcmH2LwsrOd4YZw3YAwYmpvShtkPwZUROHaj90'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:49:55.494 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReportFields 
 50010
 ,0
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:49:55.509 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTQ0NjQ2NzAsImV4cCI6MTc1NDQ5MzQ3MCwiaWF0IjoxNzU0NDY0NjcwfQ.gljUKQcmH2LwsrOd4YZw3YAwYmpvShtkPwZUROHaj90'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:49:55.556 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReportFields 
 110
 ,0
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:49:55.556 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTQ0NjQ2NzAsImV4cCI6MTc1NDQ5MzQ3MCwiaWF0IjoxNzU0NDY0NjcwfQ.gljUKQcmH2LwsrOd4YZw3YAwYmpvShtkPwZUROHaj90'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:49:55.619 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReportFields 
 41000
 ,0
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:49:55.619 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTQ0NjQ2NzAsImV4cCI6MTc1NDQ5MzQ3MCwiaWF0IjoxNzU0NDY0NjcwfQ.gljUKQcmH2LwsrOd4YZw3YAwYmpvShtkPwZUROHaj90'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:49:55.681 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60554'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:49:55.696 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTQ0NjQ2NzAsImV4cCI6MTc1NDQ5MzQ3MCwiaWF0IjoxNzU0NDY0NjcwfQ.gljUKQcmH2LwsrOd4YZw3YAwYmpvShtkPwZUROHaj90'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:49:55.728 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReportFields 
 400
 ,0
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:49:55.728 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTQ0NjQ2NzAsImV4cCI6MTc1NDQ5MzQ3MCwiaWF0IjoxNzU0NDY0NjcwfQ.gljUKQcmH2LwsrOd4YZw3YAwYmpvShtkPwZUROHaj90'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:49:55.743 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT INV.VoucherNo [Doc No],INV.VersionNo [Doc NoVer],CONVERT(DATETIME,INV.DocDate) [Doc Date],T2.Name [Tower],T3.Name [Unit],T5.Name [C9371808ba938457e833ae2c7f6d9c941],T6.Name [Tenant],T7.Name [Type Of Work],T8.Name [Technician],T11.Name [MO Status]
 FROM INV_DocDetails INV with(nolock) left join COM_DocCCData TDCC with(nolock) on INV.InvDocDetailsID=TDCC.InvDocDetailsID left join COM_CC50009 T2 with(nolock) on TDCC.dcCCNID9=T2.NodeID left join COM_CC50010 T3 with(nolock) on TDCC.dcCCNID10=T3.NodeID left join COM_CCCCDATA T4 with(nolock) on T3.NodeID=T4.NodeID AND T4.CostCenterID=50010 left join COM_CC50018 T5 with(nolock) on T4.CCNID18=T5.NodeID left join COM_CC50011 T6 with(nolock) on TDCC.dcCCNID11=T6.NodeID left join COM_CC50026 T7 with(nolock) on TDCC.dcCCNID26=T7.NodeID left join COM_CC50028 T8 with(nolock) on TDCC.dcCCNID28=T8.NodeID left join COM_CC50036 T11 with(nolock) on TDCC.dcCCNID36=T11.NodeID
 WHERE TDCC.dcCCNID2 IN (1,22,10,11,25,26,27,28,29,30,31) AND (INV.CostCenterID=41000) AND CONVERT(DATETIME,INV.DocDate) BETWEEN ''04 Jun 2015'' AND ''06 Aug 2025'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:49:55.743 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTQ0NjQ2NzAsImV4cCI6MTc1NDQ5MzQ3MCwiaWF0IjoxNzU0NDY0NjcwfQ.gljUKQcmH2LwsrOd4YZw3YAwYmpvShtkPwZUROHaj90'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:49:55.775 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReportFields 
 50010
 ,0
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:49:55.775 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTQ0NjQ2NzAsImV4cCI6MTc1NDQ5MzQ3MCwiaWF0IjoxNzU0NDY0NjcwfQ.gljUKQcmH2LwsrOd4YZw3YAwYmpvShtkPwZUROHaj90'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:49:55.790 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReportFields 
 110
 ,0
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:49:55.806 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTQ0NjQ2NzAsImV4cCI6MTc1NDQ5MzQ3MCwiaWF0IjoxNzU0NDY0NjcwfQ.gljUKQcmH2LwsrOd4YZw3YAwYmpvShtkPwZUROHaj90'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:49:55.821 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReportFields 
 41000
 ,0
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:49:55.821 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTQ0NjQ2NzAsImV4cCI6MTc1NDQ5MzQ3MCwiaWF0IjoxNzU0NDY0NjcwfQ.gljUKQcmH2LwsrOd4YZw3YAwYmpvShtkPwZUROHaj90'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:49:55.868 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60555'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:49:55.868 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTQ0NjQ2NzAsImV4cCI6MTc1NDQ5MzQ3MCwiaWF0IjoxNzU0NDY0NjcwfQ.gljUKQcmH2LwsrOd4YZw3YAwYmpvShtkPwZUROHaj90'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:49:55.884 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReportFields 
 400
 ,0
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:49:55.900 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTQ0NjQ2NzAsImV4cCI6MTc1NDQ5MzQ3MCwiaWF0IjoxNzU0NDY0NjcwfQ.gljUKQcmH2LwsrOd4YZw3YAwYmpvShtkPwZUROHaj90'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:49:55.900 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT INV.VoucherNo [Doc No],INV.VersionNo [Doc NoVer],CONVERT(DATETIME,INV.DocDate) [Doc Date],T2.Name [Tower],T3.Name [Unit],T5.Name [C9371808ba938457e833ae2c7f6d9c941],T6.Name [Tenant],T7.Name [Type Of Work],T8.Name [Technician],T11.Name [MO Status]
 FROM INV_DocDetails INV with(nolock) left join COM_DocCCData TDCC with(nolock) on INV.InvDocDetailsID=TDCC.InvDocDetailsID left join COM_CC50009 T2 with(nolock) on TDCC.dcCCNID9=T2.NodeID left join COM_CC50010 T3 with(nolock) on TDCC.dcCCNID10=T3.NodeID left join COM_CCCCDATA T4 with(nolock) on T3.NodeID=T4.NodeID AND T4.CostCenterID=50010 left join COM_CC50018 T5 with(nolock) on T4.CCNID18=T5.NodeID left join COM_CC50011 T6 with(nolock) on TDCC.dcCCNID11=T6.NodeID left join COM_CC50026 T7 with(nolock) on TDCC.dcCCNID26=T7.NodeID left join COM_CC50028 T8 with(nolock) on TDCC.dcCCNID28=T8.NodeID left join COM_CC50036 T11 with(nolock) on TDCC.dcCCNID36=T11.NodeID
 WHERE TDCC.dcCCNID2 IN (1,22,10,11,25,26,27,28,29,30,31) AND (INV.CostCenterID=41000) AND CONVERT(DATETIME,INV.DocDate) BETWEEN ''04 Jun 2015'' AND ''06 Aug 2025'' AND T11.NodeID=1'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:49:55.915 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTQ0NjQ2NzAsImV4cCI6MTc1NDQ5MzQ3MCwiaWF0IjoxNzU0NDY0NjcwfQ.gljUKQcmH2LwsrOd4YZw3YAwYmpvShtkPwZUROHaj90'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:49:55.931 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReportFields 
 50010
 ,0
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:49:55.946 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTQ0NjQ2NzAsImV4cCI6MTc1NDQ5MzQ3MCwiaWF0IjoxNzU0NDY0NjcwfQ.gljUKQcmH2LwsrOd4YZw3YAwYmpvShtkPwZUROHaj90'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:49:55.962 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReportFields 
 110
 ,0
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:49:55.978 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTQ0NjQ2NzAsImV4cCI6MTc1NDQ5MzQ3MCwiaWF0IjoxNzU0NDY0NjcwfQ.gljUKQcmH2LwsrOd4YZw3YAwYmpvShtkPwZUROHaj90'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:49:55.993 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReportFields 
 41000
 ,0
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:49:55.993 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTQ0NjQ2NzAsImV4cCI6MTc1NDQ5MzQ3MCwiaWF0IjoxNzU0NDY0NjcwfQ.gljUKQcmH2LwsrOd4YZw3YAwYmpvShtkPwZUROHaj90'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:49:56.025 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60553'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:49:56.025 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTQ0NjQ2NzAsImV4cCI6MTc1NDQ5MzQ3MCwiaWF0IjoxNzU0NDY0NjcwfQ.gljUKQcmH2LwsrOd4YZw3YAwYmpvShtkPwZUROHaj90'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:49:56.040 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT INV.VoucherNo [Doc No],INV.VersionNo [Doc NoVer],CONVERT(DATETIME,INV.DocDate) [Doc Date],T2.Name [Tower],T3.Name [Unit],T5.Name [C9371808ba938457e833ae2c7f6d9c941],T6.Name [Tenant],T7.Name [Type Of Work],T8.Name [Technician],T11.Name [MO Status]
 FROM INV_DocDetails INV with(nolock) left join COM_DocCCData TDCC with(nolock) on INV.InvDocDetailsID=TDCC.InvDocDetailsID left join COM_CC50009 T2 with(nolock) on TDCC.dcCCNID9=T2.NodeID left join COM_CC50010 T3 with(nolock) on TDCC.dcCCNID10=T3.NodeID left join COM_CCCCDATA T4 with(nolock) on T3.NodeID=T4.NodeID AND T4.CostCenterID=50010 left join COM_CC50018 T5 with(nolock) on T4.CCNID18=T5.NodeID left join COM_CC50011 T6 with(nolock) on TDCC.dcCCNID11=T6.NodeID left join COM_CC50026 T7 with(nolock) on TDCC.dcCCNID26=T7.NodeID left join COM_CC50028 T8 with(nolock) on TDCC.dcCCNID28=T8.NodeID left join COM_CC50036 T11 with(nolock) on TDCC.dcCCNID36=T11.NodeID
 WHERE TDCC.dcCCNID2 IN (1,22,10,11,25,26,27,28,29,30,31) AND (INV.CostCenterID=41000) AND CONVERT(DATETIME,INV.DocDate) BETWEEN ''04 Jun 2015'' AND ''06 Aug 2025'' AND T11.NodeID=6'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:49:56.040 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTQ0NjQ2NzAsImV4cCI6MTc1NDQ5MzQ3MCwiaWF0IjoxNzU0NDY0NjcwfQ.gljUKQcmH2LwsrOd4YZw3YAwYmpvShtkPwZUROHaj90'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:49:56.071 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReportFields 
 400
 ,0
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:49:56.071 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTQ0NjQ2NzAsImV4cCI6MTc1NDQ5MzQ3MCwiaWF0IjoxNzU0NDY0NjcwfQ.gljUKQcmH2LwsrOd4YZw3YAwYmpvShtkPwZUROHaj90'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:49:56.118 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReportFields 
 50010
 ,0
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:49:56.118 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTQ0NjQ2NzAsImV4cCI6MTc1NDQ5MzQ3MCwiaWF0IjoxNzU0NDY0NjcwfQ.gljUKQcmH2LwsrOd4YZw3YAwYmpvShtkPwZUROHaj90'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:49:56.150 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReportFields 
 110
 ,0
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:49:56.150 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTQ0NjQ2NzAsImV4cCI6MTc1NDQ5MzQ3MCwiaWF0IjoxNzU0NDY0NjcwfQ.gljUKQcmH2LwsrOd4YZw3YAwYmpvShtkPwZUROHaj90'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:49:56.181 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReportFields 
 41000
 ,0
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:49:56.181 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTQ0NjQ2NzAsImV4cCI6MTc1NDQ5MzQ3MCwiaWF0IjoxNzU0NDY0NjcwfQ.gljUKQcmH2LwsrOd4YZw3YAwYmpvShtkPwZUROHaj90'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:49:56.243 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60552'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:49:56.243 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTQ0NjQ2NzAsImV4cCI6MTc1NDQ5MzQ3MCwiaWF0IjoxNzU0NDY0NjcwfQ.gljUKQcmH2LwsrOd4YZw3YAwYmpvShtkPwZUROHaj90'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:49:56.259 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT INV.VoucherNo [Doc No],INV.VersionNo [Doc NoVer],CONVERT(DATETIME,INV.DocDate) [Doc Date],T2.Name [Tower],T3.Name [Unit],T5.Name [C9371808ba938457e833ae2c7f6d9c941],T6.Name [Tenant],T7.Name [Type Of Work],T8.Name [Technician],T11.Name [MO Status]
 FROM INV_DocDetails INV with(nolock) left join COM_DocCCData TDCC with(nolock) on INV.InvDocDetailsID=TDCC.InvDocDetailsID left join COM_CC50009 T2 with(nolock) on TDCC.dcCCNID9=T2.NodeID left join COM_CC50010 T3 with(nolock) on TDCC.dcCCNID10=T3.NodeID left join COM_CCCCDATA T4 with(nolock) on T3.NodeID=T4.NodeID AND T4.CostCenterID=50010 left join COM_CC50018 T5 with(nolock) on T4.CCNID18=T5.NodeID left join COM_CC50011 T6 with(nolock) on TDCC.dcCCNID11=T6.NodeID left join COM_CC50026 T7 with(nolock) on TDCC.dcCCNID26=T7.NodeID left join COM_CC50028 T8 with(nolock) on TDCC.dcCCNID28=T8.NodeID left join COM_CC50036 T11 with(nolock) on TDCC.dcCCNID36=T11.NodeID
 WHERE TDCC.dcCCNID2 IN (1,22,10,11,25,26,27,28,29,30,31) AND (INV.CostCenterID=41000) AND CONVERT(DATETIME,INV.DocDate) BETWEEN ''04 Jun 2015'' AND ''06 Aug 2025'' AND T11.NodeID=7'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:49:56.274 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTQ0NjQ2NzAsImV4cCI6MTc1NDQ5MzQ3MCwiaWF0IjoxNzU0NDY0NjcwfQ.gljUKQcmH2LwsrOd4YZw3YAwYmpvShtkPwZUROHaj90'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:49:56.274 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReportFields 
 400
 ,0
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:49:56.274 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTQ0NjQ2NzAsImV4cCI6MTc1NDQ5MzQ3MCwiaWF0IjoxNzU0NDY0NjcwfQ.gljUKQcmH2LwsrOd4YZw3YAwYmpvShtkPwZUROHaj90'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:49:56.321 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReportFields 
 50010
 ,0
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:49:56.321 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTQ0NjQ2NzAsImV4cCI6MTc1NDQ5MzQ3MCwiaWF0IjoxNzU0NDY0NjcwfQ.gljUKQcmH2LwsrOd4YZw3YAwYmpvShtkPwZUROHaj90'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:49:56.337 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReportFields 
 110
 ,0
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:49:56.337 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTQ0NjQ2NzAsImV4cCI6MTc1NDQ5MzQ3MCwiaWF0IjoxNzU0NDY0NjcwfQ.gljUKQcmH2LwsrOd4YZw3YAwYmpvShtkPwZUROHaj90'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:49:56.368 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReportFields 
 41000
 ,0
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:49:56.384 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTQ0NjQ2NzAsImV4cCI6MTc1NDQ5MzQ3MCwiaWF0IjoxNzU0NDY0NjcwfQ.gljUKQcmH2LwsrOd4YZw3YAwYmpvShtkPwZUROHaj90'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:49:56.415 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60574'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:49:56.415 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTQ0NjQ2NzAsImV4cCI6MTc1NDQ5MzQ3MCwiaWF0IjoxNzU0NDY0NjcwfQ.gljUKQcmH2LwsrOd4YZw3YAwYmpvShtkPwZUROHaj90'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:49:56.431 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT INV.VoucherNo [Doc No],INV.VersionNo [Doc NoVer],CONVERT(DATETIME,INV.DocDate) [Doc Date],T2.Name [Tower],T3.Name [Unit],T5.Name [C9371808ba938457e833ae2c7f6d9c941],T6.Name [Tenant],T7.Name [Type Of Work],T8.Name [Technician],T11.Name [MO Status]
 FROM INV_DocDetails INV with(nolock) left join COM_DocCCData TDCC with(nolock) on INV.InvDocDetailsID=TDCC.InvDocDetailsID left join COM_CC50009 T2 with(nolock) on TDCC.dcCCNID9=T2.NodeID left join COM_CC50010 T3 with(nolock) on TDCC.dcCCNID10=T3.NodeID left join COM_CCCCDATA T4 with(nolock) on T3.NodeID=T4.NodeID AND T4.CostCenterID=50010 left join COM_CC50018 T5 with(nolock) on T4.CCNID18=T5.NodeID left join COM_CC50011 T6 with(nolock) on TDCC.dcCCNID11=T6.NodeID left join COM_CC50026 T7 with(nolock) on TDCC.dcCCNID26=T7.NodeID left join COM_CC50028 T8 with(nolock) on TDCC.dcCCNID28=T8.NodeID left join COM_CC50036 T11 with(nolock) on TDCC.dcCCNID36=T11.NodeID
 WHERE TDCC.dcCCNID2 IN (1,22,10,11,25,26,27,28,29,30,31) AND (INV.CostCenterID=41000) AND CONVERT(DATETIME,INV.DocDate) BETWEEN ''04 Jun 2015'' AND ''06 Aug 2025'' AND T11.NodeID=8'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:49:56.431 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTQ0NjQ2NzAsImV4cCI6MTc1NDQ5MzQ3MCwiaWF0IjoxNzU0NDY0NjcwfQ.gljUKQcmH2LwsrOd4YZw3YAwYmpvShtkPwZUROHaj90'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:49:56.446 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReportFields 
 400
 ,0
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:49:56.446 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTQ0NjQ2NzAsImV4cCI6MTc1NDQ5MzQ3MCwiaWF0IjoxNzU0NDY0NjcwfQ.gljUKQcmH2LwsrOd4YZw3YAwYmpvShtkPwZUROHaj90'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:49:56.478 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReportFields 
 50010
 ,0
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:49:56.493 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTQ0NjQ2NzAsImV4cCI6MTc1NDQ5MzQ3MCwiaWF0IjoxNzU0NDY0NjcwfQ.gljUKQcmH2LwsrOd4YZw3YAwYmpvShtkPwZUROHaj90'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:49:56.524 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReportFields 
 110
 ,0
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:49:56.524 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTQ0NjQ2NzAsImV4cCI6MTc1NDQ5MzQ3MCwiaWF0IjoxNzU0NDY0NjcwfQ.gljUKQcmH2LwsrOd4YZw3YAwYmpvShtkPwZUROHaj90'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:49:56.540 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReportFields 
 41000
 ,0
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:49:56.556 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTQ0NjQ2NzAsImV4cCI6MTc1NDQ5MzQ3MCwiaWF0IjoxNzU0NDY0NjcwfQ.gljUKQcmH2LwsrOd4YZw3YAwYmpvShtkPwZUROHaj90'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:49:56.587 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60573'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:49:56.587 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTQ0NjQ2NzAsImV4cCI6MTc1NDQ5MzQ3MCwiaWF0IjoxNzU0NDY0NjcwfQ.gljUKQcmH2LwsrOd4YZw3YAwYmpvShtkPwZUROHaj90'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:49:56.618 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT INV.VoucherNo [Doc No],INV.VersionNo [Doc NoVer],CONVERT(DATETIME,INV.DocDate) [Doc Date],T2.Name [Tower],T3.Name [Unit],T5.Name [C9371808ba938457e833ae2c7f6d9c941],T6.Name [Tenant],T7.Name [Type Of Work],T8.Name [Technician],T11.Name [MO Status]
 FROM INV_DocDetails INV with(nolock) left join COM_DocCCData TDCC with(nolock) on INV.InvDocDetailsID=TDCC.InvDocDetailsID left join COM_CC50009 T2 with(nolock) on TDCC.dcCCNID9=T2.NodeID left join COM_CC50010 T3 with(nolock) on TDCC.dcCCNID10=T3.NodeID left join COM_CCCCDATA T4 with(nolock) on T3.NodeID=T4.NodeID AND T4.CostCenterID=50010 left join COM_CC50018 T5 with(nolock) on T4.CCNID18=T5.NodeID left join COM_CC50011 T6 with(nolock) on TDCC.dcCCNID11=T6.NodeID left join COM_CC50026 T7 with(nolock) on TDCC.dcCCNID26=T7.NodeID left join COM_CC50028 T8 with(nolock) on TDCC.dcCCNID28=T8.NodeID left join COM_CC50036 T11 with(nolock) on TDCC.dcCCNID36=T11.NodeID
 WHERE TDCC.dcCCNID2 IN (1,22,10,11,25,26,27,28,29,30,31) AND (INV.CostCenterID=41000) AND CONVERT(DATETIME,INV.DocDate) BETWEEN ''04 Jun 2015'' AND ''06 Aug 2025'' AND T11.NodeID=5'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:49:56.618 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTQ0NjQ2NzAsImV4cCI6MTc1NDQ5MzQ3MCwiaWF0IjoxNzU0NDY0NjcwfQ.gljUKQcmH2LwsrOd4YZw3YAwYmpvShtkPwZUROHaj90'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:49:56.618 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReportFields 
 400
 ,0
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:49:56.618 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTQ0NjQ2NzAsImV4cCI6MTc1NDQ5MzQ3MCwiaWF0IjoxNzU0NDY0NjcwfQ.gljUKQcmH2LwsrOd4YZw3YAwYmpvShtkPwZUROHaj90'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:49:56.665 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReportFields 
 50010
 ,0
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:49:56.665 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTQ0NjQ2NzAsImV4cCI6MTc1NDQ5MzQ3MCwiaWF0IjoxNzU0NDY0NjcwfQ.gljUKQcmH2LwsrOd4YZw3YAwYmpvShtkPwZUROHaj90'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:49:56.681 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReportFields 
 110
 ,0
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:49:56.681 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTQ0NjQ2NzAsImV4cCI6MTc1NDQ5MzQ3MCwiaWF0IjoxNzU0NDY0NjcwfQ.gljUKQcmH2LwsrOd4YZw3YAwYmpvShtkPwZUROHaj90'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:49:56.712 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReportFields 
 41000
 ,0
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:49:56.712 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTQ0NjQ2NzAsImV4cCI6MTc1NDQ5MzQ3MCwiaWF0IjoxNzU0NDY0NjcwfQ.gljUKQcmH2LwsrOd4YZw3YAwYmpvShtkPwZUROHaj90'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:49:56.743 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT INV.VoucherNo [Doc No],INV.VersionNo [Doc NoVer],CONVERT(DATETIME,INV.DocDate) [Doc Date],T2.Name [Tower],T3.Name [Unit],T5.Name [C9371808ba938457e833ae2c7f6d9c941],T6.Name [Tenant],T7.Name [Type Of Work],T8.Name [Technician],T11.Name [MO Status]
 FROM INV_DocDetails INV with(nolock) left join COM_DocCCData TDCC with(nolock) on INV.InvDocDetailsID=TDCC.InvDocDetailsID left join COM_CC50009 T2 with(nolock) on TDCC.dcCCNID9=T2.NodeID left join COM_CC50010 T3 with(nolock) on TDCC.dcCCNID10=T3.NodeID left join COM_CCCCDATA T4 with(nolock) on T3.NodeID=T4.NodeID AND T4.CostCenterID=50010 left join COM_CC50018 T5 with(nolock) on T4.CCNID18=T5.NodeID left join COM_CC50011 T6 with(nolock) on TDCC.dcCCNID11=T6.NodeID left join COM_CC50026 T7 with(nolock) on TDCC.dcCCNID26=T7.NodeID left join COM_CC50028 T8 with(nolock) on TDCC.dcCCNID28=T8.NodeID left join COM_CC50036 T11 with(nolock) on TDCC.dcCCNID36=T11.NodeID
 WHERE TDCC.dcCCNID2 IN (1,22,10,11,25,26,27,28,29,30,31) AND (INV.CostCenterID=41000) AND CONVERT(DATETIME,INV.DocDate) BETWEEN ''04 Jun 2015'' AND ''06 Aug 2025'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:49:56.743 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60554'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:49:56.743 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTQ0NjQ2NzAsImV4cCI6MTc1NDQ5MzQ3MCwiaWF0IjoxNzU0NDY0NjcwfQ.gljUKQcmH2LwsrOd4YZw3YAwYmpvShtkPwZUROHaj90'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:49:56.743 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTQ0NjQ2NzAsImV4cCI6MTc1NDQ5MzQ3MCwiaWF0IjoxNzU0NDY0NjcwfQ.gljUKQcmH2LwsrOd4YZw3YAwYmpvShtkPwZUROHaj90'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:49:56.775 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReportFields 
 400
 ,0
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:49:56.775 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTQ0NjQ2NzAsImV4cCI6MTc1NDQ5MzQ3MCwiaWF0IjoxNzU0NDY0NjcwfQ.gljUKQcmH2LwsrOd4YZw3YAwYmpvShtkPwZUROHaj90'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:49:56.821 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReportFields 
 50010
 ,0
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:49:56.821 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTQ0NjQ2NzAsImV4cCI6MTc1NDQ5MzQ3MCwiaWF0IjoxNzU0NDY0NjcwfQ.gljUKQcmH2LwsrOd4YZw3YAwYmpvShtkPwZUROHaj90'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:49:56.852 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReportFields 
 110
 ,0
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:49:56.852 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTQ0NjQ2NzAsImV4cCI6MTc1NDQ5MzQ3MCwiaWF0IjoxNzU0NDY0NjcwfQ.gljUKQcmH2LwsrOd4YZw3YAwYmpvShtkPwZUROHaj90'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:49:56.868 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReportFields 
 41000
 ,0
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:49:56.868 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTQ0NjQ2NzAsImV4cCI6MTc1NDQ5MzQ3MCwiaWF0IjoxNzU0NDY0NjcwfQ.gljUKQcmH2LwsrOd4YZw3YAwYmpvShtkPwZUROHaj90'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:49:56.899 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT INV.VoucherNo [Doc No],INV.VersionNo [Doc NoVer],CONVERT(DATETIME,INV.DocDate) [Doc Date],T2.Name [Tower],T3.Name [Unit],T5.Name [C9371808ba938457e833ae2c7f6d9c941],T6.Name [Tenant],T7.Name [Type Of Work],T8.Name [Technician],T11.Name [MO Status]
 FROM INV_DocDetails INV with(nolock) left join COM_DocCCData TDCC with(nolock) on INV.InvDocDetailsID=TDCC.InvDocDetailsID left join COM_CC50009 T2 with(nolock) on TDCC.dcCCNID9=T2.NodeID left join COM_CC50010 T3 with(nolock) on TDCC.dcCCNID10=T3.NodeID left join COM_CCCCDATA T4 with(nolock) on T3.NodeID=T4.NodeID AND T4.CostCenterID=50010 left join COM_CC50018 T5 with(nolock) on T4.CCNID18=T5.NodeID left join COM_CC50011 T6 with(nolock) on TDCC.dcCCNID11=T6.NodeID left join COM_CC50026 T7 with(nolock) on TDCC.dcCCNID26=T7.NodeID left join COM_CC50028 T8 with(nolock) on TDCC.dcCCNID28=T8.NodeID left join COM_CC50036 T11 with(nolock) on TDCC.dcCCNID36=T11.NodeID
 WHERE TDCC.dcCCNID2 IN (1,22,10,11,25,26,27,28,29,30,31) AND (INV.CostCenterID=41000) AND CONVERT(DATETIME,INV.DocDate) BETWEEN ''04 Jun 2015'' AND ''06 Aug 2025'' AND T11.NodeID=1'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:49:56.899 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTQ0NjQ2NzAsImV4cCI6MTc1NDQ5MzQ3MCwiaWF0IjoxNzU0NDY0NjcwfQ.gljUKQcmH2LwsrOd4YZw3YAwYmpvShtkPwZUROHaj90'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:49:56.899 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60555'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:49:56.899 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTQ0NjQ2NzAsImV4cCI6MTc1NDQ5MzQ3MCwiaWF0IjoxNzU0NDY0NjcwfQ.gljUKQcmH2LwsrOd4YZw3YAwYmpvShtkPwZUROHaj90'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:49:56.931 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReportFields 
 400
 ,0
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:49:56.931 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTQ0NjQ2NzAsImV4cCI6MTc1NDQ5MzQ3MCwiaWF0IjoxNzU0NDY0NjcwfQ.gljUKQcmH2LwsrOd4YZw3YAwYmpvShtkPwZUROHaj90'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:49:56.962 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReportFields 
 50010
 ,0
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:49:56.962 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTQ0NjQ2NzAsImV4cCI6MTc1NDQ5MzQ3MCwiaWF0IjoxNzU0NDY0NjcwfQ.gljUKQcmH2LwsrOd4YZw3YAwYmpvShtkPwZUROHaj90'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:49:56.993 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReportFields 
 110
 ,0
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:49:56.993 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTQ0NjQ2NzAsImV4cCI6MTc1NDQ5MzQ3MCwiaWF0IjoxNzU0NDY0NjcwfQ.gljUKQcmH2LwsrOd4YZw3YAwYmpvShtkPwZUROHaj90'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:49:57.009 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReportFields 
 41000
 ,0
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:49:57.024 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTQ0NjQ2NzAsImV4cCI6MTc1NDQ5MzQ3MCwiaWF0IjoxNzU0NDY0NjcwfQ.gljUKQcmH2LwsrOd4YZw3YAwYmpvShtkPwZUROHaj90'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:49:57.040 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT INV.VoucherNo [Doc No],INV.VersionNo [Doc NoVer],CONVERT(DATETIME,INV.DocDate) [Doc Date],T2.Name [Tower],T3.Name [Unit],T5.Name [C9371808ba938457e833ae2c7f6d9c941],T6.Name [Tenant],T7.Name [Type Of Work],T8.Name [Technician],T11.Name [MO Status]
 FROM INV_DocDetails INV with(nolock) left join COM_DocCCData TDCC with(nolock) on INV.InvDocDetailsID=TDCC.InvDocDetailsID left join COM_CC50009 T2 with(nolock) on TDCC.dcCCNID9=T2.NodeID left join COM_CC50010 T3 with(nolock) on TDCC.dcCCNID10=T3.NodeID left join COM_CCCCDATA T4 with(nolock) on T3.NodeID=T4.NodeID AND T4.CostCenterID=50010 left join COM_CC50018 T5 with(nolock) on T4.CCNID18=T5.NodeID left join COM_CC50011 T6 with(nolock) on TDCC.dcCCNID11=T6.NodeID left join COM_CC50026 T7 with(nolock) on TDCC.dcCCNID26=T7.NodeID left join COM_CC50028 T8 with(nolock) on TDCC.dcCCNID28=T8.NodeID left join COM_CC50036 T11 with(nolock) on TDCC.dcCCNID36=T11.NodeID
 WHERE TDCC.dcCCNID2 IN (1,22,10,11,25,26,27,28,29,30,31) AND (INV.CostCenterID=41000) AND CONVERT(DATETIME,INV.DocDate) BETWEEN ''04 Jun 2015'' AND ''06 Aug 2025'' AND T11.NodeID=6'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:49:57.056 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60553'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:49:57.056 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTQ0NjQ2NzAsImV4cCI6MTc1NDQ5MzQ3MCwiaWF0IjoxNzU0NDY0NjcwfQ.gljUKQcmH2LwsrOd4YZw3YAwYmpvShtkPwZUROHaj90'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:49:57.056 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTQ0NjQ2NzAsImV4cCI6MTc1NDQ5MzQ3MCwiaWF0IjoxNzU0NDY0NjcwfQ.gljUKQcmH2LwsrOd4YZw3YAwYmpvShtkPwZUROHaj90'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:49:57.087 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReportFields 
 400
 ,0
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:49:57.087 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTQ0NjQ2NzAsImV4cCI6MTc1NDQ5MzQ3MCwiaWF0IjoxNzU0NDY0NjcwfQ.gljUKQcmH2LwsrOd4YZw3YAwYmpvShtkPwZUROHaj90'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:49:57.134 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReportFields 
 50010
 ,0
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:49:57.134 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTQ0NjQ2NzAsImV4cCI6MTc1NDQ5MzQ3MCwiaWF0IjoxNzU0NDY0NjcwfQ.gljUKQcmH2LwsrOd4YZw3YAwYmpvShtkPwZUROHaj90'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:49:57.165 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReportFields 
 110
 ,0
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:49:57.181 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTQ0NjQ2NzAsImV4cCI6MTc1NDQ5MzQ3MCwiaWF0IjoxNzU0NDY0NjcwfQ.gljUKQcmH2LwsrOd4YZw3YAwYmpvShtkPwZUROHaj90'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:49:57.196 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReportFields 
 41000
 ,0
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:49:57.212 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTQ0NjQ2NzAsImV4cCI6MTc1NDQ5MzQ3MCwiaWF0IjoxNzU0NDY0NjcwfQ.gljUKQcmH2LwsrOd4YZw3YAwYmpvShtkPwZUROHaj90'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:49:57.243 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT INV.VoucherNo [Doc No],INV.VersionNo [Doc NoVer],CONVERT(DATETIME,INV.DocDate) [Doc Date],T2.Name [Tower],T3.Name [Unit],T5.Name [C9371808ba938457e833ae2c7f6d9c941],T6.Name [Tenant],T7.Name [Type Of Work],T8.Name [Technician],T11.Name [MO Status]
 FROM INV_DocDetails INV with(nolock) left join COM_DocCCData TDCC with(nolock) on INV.InvDocDetailsID=TDCC.InvDocDetailsID left join COM_CC50009 T2 with(nolock) on TDCC.dcCCNID9=T2.NodeID left join COM_CC50010 T3 with(nolock) on TDCC.dcCCNID10=T3.NodeID left join COM_CCCCDATA T4 with(nolock) on T3.NodeID=T4.NodeID AND T4.CostCenterID=50010 left join COM_CC50018 T5 with(nolock) on T4.CCNID18=T5.NodeID left join COM_CC50011 T6 with(nolock) on TDCC.dcCCNID11=T6.NodeID left join COM_CC50026 T7 with(nolock) on TDCC.dcCCNID26=T7.NodeID left join COM_CC50028 T8 with(nolock) on TDCC.dcCCNID28=T8.NodeID left join COM_CC50036 T11 with(nolock) on TDCC.dcCCNID36=T11.NodeID
 WHERE TDCC.dcCCNID2 IN (1,22,10,11,25,26,27,28,29,30,31) AND (INV.CostCenterID=41000) AND CONVERT(DATETIME,INV.DocDate) BETWEEN ''04 Jun 2015'' AND ''06 Aug 2025'' AND T11.NodeID=7'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:49:57.243 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60552'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:49:57.243 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTQ0NjQ2NzAsImV4cCI6MTc1NDQ5MzQ3MCwiaWF0IjoxNzU0NDY0NjcwfQ.gljUKQcmH2LwsrOd4YZw3YAwYmpvShtkPwZUROHaj90'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:49:57.243 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTQ0NjQ2NzAsImV4cCI6MTc1NDQ5MzQ3MCwiaWF0IjoxNzU0NDY0NjcwfQ.gljUKQcmH2LwsrOd4YZw3YAwYmpvShtkPwZUROHaj90'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:49:57.274 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReportFields 
 400
 ,0
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:49:57.290 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTQ0NjQ2NzAsImV4cCI6MTc1NDQ5MzQ3MCwiaWF0IjoxNzU0NDY0NjcwfQ.gljUKQcmH2LwsrOd4YZw3YAwYmpvShtkPwZUROHaj90'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:49:57.321 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReportFields 
 50010
 ,0
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:49:57.321 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTQ0NjQ2NzAsImV4cCI6MTc1NDQ5MzQ3MCwiaWF0IjoxNzU0NDY0NjcwfQ.gljUKQcmH2LwsrOd4YZw3YAwYmpvShtkPwZUROHaj90'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:49:57.352 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReportFields 
 110
 ,0
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:49:57.352 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTQ0NjQ2NzAsImV4cCI6MTc1NDQ5MzQ3MCwiaWF0IjoxNzU0NDY0NjcwfQ.gljUKQcmH2LwsrOd4YZw3YAwYmpvShtkPwZUROHaj90'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:49:57.368 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReportFields 
 41000
 ,0
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:49:57.384 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTQ0NjQ2NzAsImV4cCI6MTc1NDQ5MzQ3MCwiaWF0IjoxNzU0NDY0NjcwfQ.gljUKQcmH2LwsrOd4YZw3YAwYmpvShtkPwZUROHaj90'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:49:57.415 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT INV.VoucherNo [Doc No],INV.VersionNo [Doc NoVer],CONVERT(DATETIME,INV.DocDate) [Doc Date],T2.Name [Tower],T3.Name [Unit],T5.Name [C9371808ba938457e833ae2c7f6d9c941],T6.Name [Tenant],T7.Name [Type Of Work],T8.Name [Technician],T11.Name [MO Status]
 FROM INV_DocDetails INV with(nolock) left join COM_DocCCData TDCC with(nolock) on INV.InvDocDetailsID=TDCC.InvDocDetailsID left join COM_CC50009 T2 with(nolock) on TDCC.dcCCNID9=T2.NodeID left join COM_CC50010 T3 with(nolock) on TDCC.dcCCNID10=T3.NodeID left join COM_CCCCDATA T4 with(nolock) on T3.NodeID=T4.NodeID AND T4.CostCenterID=50010 left join COM_CC50018 T5 with(nolock) on T4.CCNID18=T5.NodeID left join COM_CC50011 T6 with(nolock) on TDCC.dcCCNID11=T6.NodeID left join COM_CC50026 T7 with(nolock) on TDCC.dcCCNID26=T7.NodeID left join COM_CC50028 T8 with(nolock) on TDCC.dcCCNID28=T8.NodeID left join COM_CC50036 T11 with(nolock) on TDCC.dcCCNID36=T11.NodeID
 WHERE TDCC.dcCCNID2 IN (1,22,10,11,25,26,27,28,29,30,31) AND (INV.CostCenterID=41000) AND CONVERT(DATETIME,INV.DocDate) BETWEEN ''04 Jun 2015'' AND ''06 Aug 2025'' AND T11.NodeID=8'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:49:57.415 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=60574'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:49:57.415 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTQ0NjQ2NzAsImV4cCI6MTc1NDQ5MzQ3MCwiaWF0IjoxNzU0NDY0NjcwfQ.gljUKQcmH2LwsrOd4YZw3YAwYmpvShtkPwZUROHaj90'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:49:57.415 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTQ0NjQ2NzAsImV4cCI6MTc1NDQ5MzQ3MCwiaWF0IjoxNzU0NDY0NjcwfQ.gljUKQcmH2LwsrOd4YZw3YAwYmpvShtkPwZUROHaj90'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:49:57.446 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReportFields 
 400
 ,0
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:49:57.446 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTQ0NjQ2NzAsImV4cCI6MTc1NDQ5MzQ3MCwiaWF0IjoxNzU0NDY0NjcwfQ.gljUKQcmH2LwsrOd4YZw3YAwYmpvShtkPwZUROHaj90'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:49:57.477 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReportFields 
 50010
 ,0
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:49:57.493 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTQ0NjQ2NzAsImV4cCI6MTc1NDQ5MzQ3MCwiaWF0IjoxNzU0NDY0NjcwfQ.gljUKQcmH2LwsrOd4YZw3YAwYmpvShtkPwZUROHaj90'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:49:57.509 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReportFields 
 110
 ,0
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:49:57.509 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTQ0NjQ2NzAsImV4cCI6MTc1NDQ5MzQ3MCwiaWF0IjoxNzU0NDY0NjcwfQ.gljUKQcmH2LwsrOd4YZw3YAwYmpvShtkPwZUROHaj90'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:49:57.540 | General Service|:: CompanyIndex:175 SpName: spRPT_GetReportFields 
 41000
 ,0
 ,'1'
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:49:57.540 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTQ0NjQ2NzAsImV4cCI6MTc1NDQ5MzQ3MCwiaWF0IjoxNzU0NDY0NjcwfQ.gljUKQcmH2LwsrOd4YZw3YAwYmpvShtkPwZUROHaj90'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:49:57.555 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'SELECT INV.VoucherNo [Doc No],INV.VersionNo [Doc NoVer],CONVERT(DATETIME,INV.DocDate) [Doc Date],T2.Name [Tower],T3.Name [Unit],T5.Name [C9371808ba938457e833ae2c7f6d9c941],T6.Name [Tenant],T7.Name [Type Of Work],T8.Name [Technician],T11.Name [MO Status]
 FROM INV_DocDetails INV with(nolock) left join COM_DocCCData TDCC with(nolock) on INV.InvDocDetailsID=TDCC.InvDocDetailsID left join COM_CC50009 T2 with(nolock) on TDCC.dcCCNID9=T2.NodeID left join COM_CC50010 T3 with(nolock) on TDCC.dcCCNID10=T3.NodeID left join COM_CCCCDATA T4 with(nolock) on T3.NodeID=T4.NodeID AND T4.CostCenterID=50010 left join COM_CC50018 T5 with(nolock) on T4.CCNID18=T5.NodeID left join COM_CC50011 T6 with(nolock) on TDCC.dcCCNID11=T6.NodeID left join COM_CC50026 T7 with(nolock) on TDCC.dcCCNID26=T7.NodeID left join COM_CC50028 T8 with(nolock) on TDCC.dcCCNID28=T8.NodeID left join COM_CC50036 T11 with(nolock) on TDCC.dcCCNID36=T11.NodeID
 WHERE TDCC.dcCCNID2 IN (1,22,10,11,25,26,27,28,29,30,31) AND (INV.CostCenterID=41000) AND CONVERT(DATETIME,INV.DocDate) BETWEEN ''04 Jun 2015'' AND ''06 Aug 2025'' AND T11.NodeID=5'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:49:57.571 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTQ0NjQ2NzAsImV4cCI6MTc1NDQ5MzQ3MCwiaWF0IjoxNzU0NDY0NjcwfQ.gljUKQcmH2LwsrOd4YZw3YAwYmpvShtkPwZUROHaj90'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-06-2025 12:49:58.384 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-06-2025 12:49:58.384 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDQ2NDYxNSwiZXhwIjoxNzU0NDkzNDE1LCJpYXQiOjE3NTQ0NjQ2MTV9.iKjtqChgxXZKVahsAuFt7SXlOzjj0djKlWRjOhCAMlA'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:50:04.039 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:50:04.055 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTQ0NjQ2NzAsImV4cCI6MTc1NDQ5MzQ3MCwiaWF0IjoxNzU0NDY0NjcwfQ.gljUKQcmH2LwsrOd4YZw3YAwYmpvShtkPwZUROHaj90'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-06-2025 12:50:06.305 | General Service|:: CompanyIndex:75 SpName: spADM_GetCostCenterGridViewList 
 200
 ,1
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-06-2025 12:50:06.320 | General Service|:: CompanyIndex:75 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNzUsMSIsIm5iZiI6MTc1NDQ2NDc5MSwiZXhwIjoxNzU0NDkzNTkxLCJpYXQiOjE3NTQ0NjQ3OTF9.cQ3JWFRpzsG9oGvET-pzVltLb1GUT9xNv4wYuuNWGhA'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-06-2025 12:50:06.383 | General Service|:: CompanyIndex:75 SpName: spCom_GetCostCenterSummary 
 267
 ,-1
 ,1000
 ,''
 ,''
 ,''
 ,0
 ,'06-Aug-2025'
 ,NULL
 ,''
 ,1
 ,1
 ,0
 ,0
 ,False
 ,1
[System: 192.168.1.77] DEBUG | 08-06-2025 12:50:06.383 | General Service|:: CompanyIndex:75 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNzUsMSIsIm5iZiI6MTc1NDQ2NDc5MSwiZXhwIjoxNzU0NDkzNTkxLCJpYXQiOjE3NTQ0NjQ3OTF9.cQ3JWFRpzsG9oGvET-pzVltLb1GUT9xNv4wYuuNWGhA'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-06-2025 12:50:11.733 | General Service|:: CompanyIndex:75 SpName: spCom_GetCostCenterQuickViewDefn 
 200
 ,'329'
 ,200
 ,1
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-06-2025 12:50:11.733 | General Service|:: CompanyIndex:75 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNzUsMSIsIm5iZiI6MTc1NDQ2NDc5MSwiZXhwIjoxNzU0NDkzNTkxLCJpYXQiOjE3NTQ0NjQ3OTF9.cQ3JWFRpzsG9oGvET-pzVltLb1GUT9xNv4wYuuNWGhA'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-06-2025 12:50:11.890 | General Service|:: CompanyIndex:75 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=329'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-06-2025 12:50:11.890 | General Service|:: CompanyIndex:75 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNzUsMSIsIm5iZiI6MTc1NDQ2NDc5MSwiZXhwIjoxNzU0NDkzNTkxLCJpYXQiOjE3NTQ0NjQ3OTF9.cQ3JWFRpzsG9oGvET-pzVltLb1GUT9xNv4wYuuNWGhA'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-06-2025 12:50:11.921 | General Service|:: CompanyIndex:75 SpName: spRPT_GetReport 
 0
 ,329
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.77] DEBUG | 08-06-2025 12:50:11.921 | General Service|:: CompanyIndex:75 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNzUsMSIsIm5iZiI6MTc1NDQ2NDc5MSwiZXhwIjoxNzU0NDkzNTkxLCJpYXQiOjE3NTQ0NjQ3OTF9.cQ3JWFRpzsG9oGvET-pzVltLb1GUT9xNv4wYuuNWGhA'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-06-2025 12:50:11.952 | General Service|:: CompanyIndex:75 SpName: spDOC_GetVPTPrintCopies 
 4
 ,50
 ,329
 ,2
 ,4
 ,'View~admin'
 ,'admin'
 ,1
[System: 192.168.1.77] DEBUG | 08-06-2025 12:50:11.952 | General Service|:: CompanyIndex:75 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNzUsMSIsIm5iZiI6MTc1NDQ2NDc5MSwiZXhwIjoxNzU0NDkzNTkxLCJpYXQiOjE3NTQ0NjQ3OTF9.cQ3JWFRpzsG9oGvET-pzVltLb1GUT9xNv4wYuuNWGhA'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-06-2025 12:50:12.155 | General Service|:: CompanyIndex:75 SpName: spRPT_GetReportCategoryandField 
 -1
 ,0
 ,1
 ,0
 ,'1'
 ,1
[System: 192.168.1.77] DEBUG | 08-06-2025 12:50:12.155 | General Service|:: CompanyIndex:75 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNzUsMSIsIm5iZiI6MTc1NDQ2NDc5MSwiZXhwIjoxNzU0NDkzNTkxLCJpYXQiOjE3NTQ0NjQ3OTF9.cQ3JWFRpzsG9oGvET-pzVltLb1GUT9xNv4wYuuNWGhA'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-06-2025 12:50:12.218 | General Service|:: CompanyIndex:75 SpName: spADM_GetCostCenterGridViewList 
 50051
 ,1
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-06-2025 12:50:12.218 | General Service|:: CompanyIndex:75 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNzUsMSIsIm5iZiI6MTc1NDQ2NDc5MSwiZXhwIjoxNzU0NDkzNTkxLCJpYXQiOjE3NTQ0NjQ3OTF9.cQ3JWFRpzsG9oGvET-pzVltLb1GUT9xNv4wYuuNWGhA'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-06-2025 12:50:12.296 | General Service|:: CompanyIndex:75 SpName: spCom_GetCostCenterSummary 
 350
 ,-1
 ,1000
 ,' 1=1 '
 ,''
 ,''
 ,0
 ,'06-Aug-2025'
 ,NULL
 ,''
 ,1
 ,1
 ,0
 ,0
 ,False
 ,1
[System: 192.168.1.77] DEBUG | 08-06-2025 12:50:12.296 | General Service|:: CompanyIndex:75 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNzUsMSIsIm5iZiI6MTc1NDQ2NDc5MSwiZXhwIjoxNzU0NDkzNTkxLCJpYXQiOjE3NTQ0NjQ3OTF9.cQ3JWFRpzsG9oGvET-pzVltLb1GUT9xNv4wYuuNWGhA'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-06-2025 12:50:12.358 | General Service|:: CompanyIndex:75 SpName: spADM_GetLocationRole 
 50002
 ,1
 message=Saved Succesfully
[System: 192.168.1.77] DEBUG | 08-06-2025 12:50:12.358 | General Service|:: CompanyIndex:75 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNzUsMSIsIm5iZiI6MTc1NDQ2NDc5MSwiZXhwIjoxNzU0NDkzNTkxLCJpYXQiOjE3NTQ0NjQ3OTF9.cQ3JWFRpzsG9oGvET-pzVltLb1GUT9xNv4wYuuNWGhA'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-06-2025 12:50:12.374 | General Service|:: CompanyIndex:75 SpName: spADM_GetDataSet 
 'SELECT CL.RESOURCEDATA Name FROM [ADM_Features] ADF WITH(NOLOCK),COM_LANGUAGERESOURCES CL WITH(NOLOCK) WHERE ADF.RESOURCEID=CL.RESOURCEID AND ADF.FeatureID=50002 AND CL.LanguageID=1'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-06-2025 12:50:12.374 | General Service|:: CompanyIndex:75 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNzUsMSIsIm5iZiI6MTc1NDQ2NDc5MSwiZXhwIjoxNzU0NDkzNTkxLCJpYXQiOjE3NTQ0NjQ3OTF9.cQ3JWFRpzsG9oGvET-pzVltLb1GUT9xNv4wYuuNWGhA'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-06-2025 12:50:12.499 | General Service|:: CompanyIndex:75 SpName: spCom_GetCostCenterSummary 
 350
 ,1000
 ,1000
 ,' 1=1 '
 ,''
 ,''
 ,1998
 ,'06-Aug-2025'
 ,NULL
 ,''
 ,1
 ,1
 ,0
 ,0
 ,False
 ,1
[System: 192.168.1.77] DEBUG | 08-06-2025 12:50:12.499 | General Service|:: CompanyIndex:75 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNzUsMSIsIm5iZiI6MTc1NDQ2NDc5MSwiZXhwIjoxNzU0NDkzNTkxLCJpYXQiOjE3NTQ0NjQ3OTF9.cQ3JWFRpzsG9oGvET-pzVltLb1GUT9xNv4wYuuNWGhA'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-06-2025 12:50:12.624 | General Service|:: CompanyIndex:75 SpName: spCom_GetCostCenterSummary 
 350
 ,2000
 ,1000
 ,' 1=1 '
 ,''
 ,''
 ,3998
 ,'06-Aug-2025'
 ,NULL
 ,''
 ,1
 ,1
 ,0
 ,0
 ,False
 ,1
[System: 192.168.1.77] DEBUG | 08-06-2025 12:50:12.624 | General Service|:: CompanyIndex:75 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNzUsMSIsIm5iZiI6MTc1NDQ2NDc5MSwiZXhwIjoxNzU0NDkzNTkxLCJpYXQiOjE3NTQ0NjQ3OTF9.cQ3JWFRpzsG9oGvET-pzVltLb1GUT9xNv4wYuuNWGhA'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-06-2025 12:50:12.702 | General Service|:: CompanyIndex:75 SpName: spCom_GetCostCenterSummary 
 350
 ,3000
 ,1000
 ,' 1=1 '
 ,''
 ,''
 ,5998
 ,'06-Aug-2025'
 ,NULL
 ,''
 ,1
 ,1
 ,0
 ,0
 ,False
 ,1
[System: 192.168.1.77] DEBUG | 08-06-2025 12:50:12.718 | General Service|:: CompanyIndex:75 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNzUsMSIsIm5iZiI6MTc1NDQ2NDc5MSwiZXhwIjoxNzU0NDkzNTkxLCJpYXQiOjE3NTQ0NjQ3OTF9.cQ3JWFRpzsG9oGvET-pzVltLb1GUT9xNv4wYuuNWGhA'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-06-2025 12:50:12.827 | General Service|:: CompanyIndex:75 SpName: spCom_GetCostCenterSummary 
 350
 ,4000
 ,1000
 ,' 1=1 '
 ,''
 ,''
 ,7998
 ,'06-Aug-2025'
 ,NULL
 ,''
 ,1
 ,1
 ,0
 ,0
 ,False
 ,1
[System: 192.168.1.77] DEBUG | 08-06-2025 12:50:12.827 | General Service|:: CompanyIndex:75 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNzUsMSIsIm5iZiI6MTc1NDQ2NDc5MSwiZXhwIjoxNzU0NDkzNTkxLCJpYXQiOjE3NTQ0NjQ3OTF9.cQ3JWFRpzsG9oGvET-pzVltLb1GUT9xNv4wYuuNWGhA'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-06-2025 12:50:12.921 | General Service|:: CompanyIndex:75 SpName: spCom_GetCostCenterSummary 
 350
 ,5000
 ,1000
 ,' 1=1 '
 ,''
 ,''
 ,9998
 ,'06-Aug-2025'
 ,NULL
 ,''
 ,1
 ,1
 ,0
 ,0
 ,False
 ,1
[System: 192.168.1.77] DEBUG | 08-06-2025 12:50:12.921 | General Service|:: CompanyIndex:75 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNzUsMSIsIm5iZiI6MTc1NDQ2NDc5MSwiZXhwIjoxNzU0NDkzNTkxLCJpYXQiOjE3NTQ0NjQ3OTF9.cQ3JWFRpzsG9oGvET-pzVltLb1GUT9xNv4wYuuNWGhA'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-06-2025 12:50:12.983 | General Service|:: CompanyIndex:75 SpName: spCom_GetCostCenterSummary 
 350
 ,6000
 ,1000
 ,' 1=1 '
 ,''
 ,''
 ,11998
 ,'06-Aug-2025'
 ,NULL
 ,''
 ,1
 ,1
 ,0
 ,0
 ,False
 ,1
[System: 192.168.1.77] DEBUG | 08-06-2025 12:50:12.999 | General Service|:: CompanyIndex:75 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNzUsMSIsIm5iZiI6MTc1NDQ2NDc5MSwiZXhwIjoxNzU0NDkzNTkxLCJpYXQiOjE3NTQ0NjQ3OTF9.cQ3JWFRpzsG9oGvET-pzVltLb1GUT9xNv4wYuuNWGhA'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-06-2025 12:50:13.046 | General Service|:: CompanyIndex:75 SpName: spCom_GetCostCenterSummary 
 350
 ,7000
 ,1000
 ,' 1=1 '
 ,''
 ,''
 ,13998
 ,'06-Aug-2025'
 ,NULL
 ,''
 ,1
 ,1
 ,0
 ,0
 ,False
 ,1
[System: 192.168.1.77] DEBUG | 08-06-2025 12:50:13.046 | General Service|:: CompanyIndex:75 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNzUsMSIsIm5iZiI6MTc1NDQ2NDc5MSwiZXhwIjoxNzU0NDkzNTkxLCJpYXQiOjE3NTQ0NjQ3OTF9.cQ3JWFRpzsG9oGvET-pzVltLb1GUT9xNv4wYuuNWGhA'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-06-2025 12:50:42.101 | General Service|:: CompanyIndex:75 SpName: spADM_GetDataSet 
 '
 
 SELECT C51.NODEID,C51.CODE,C51.NAME FROM 
 COM_CC50051 C51 WITH(NOLOCK) 
 LEFT JOIN COM_CCCCDATA CC WITH (NOLOCK) ON CC.NodeID=C51.NodeID AND CC.CostCenterID=50051
  
 WHERE C51.IsGroup=0 AND C51.NodeID>1 AND C51.StatusID NOT IN (251,300,301)
 AND (ISNULL(C51.DORelieve,'''')<>'''' OR ISNULL(CONVERT(DATETIME,C51.DORelieve),''01-JAN-1990'')<=''31 Jul 2025'') AND C51.NodeID=7768'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-06-2025 12:50:42.101 | General Service|:: CompanyIndex:75 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNzUsMSIsIm5iZiI6MTc1NDQ2NDc5MSwiZXhwIjoxNzU0NDkzNTkxLCJpYXQiOjE3NTQ0NjQ3OTF9.cQ3JWFRpzsG9oGvET-pzVltLb1GUT9xNv4wYuuNWGhA'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-06-2025 12:50:42.195 | General Service|:: CompanyIndex:75 SpName: spPAY_AttendanceReportData 
 '7768'
 ,'01 Jul 2025'
 ,'31 Jul 2025'
 ,''
 ,'67'
[System: 192.168.1.77] DEBUG | 08-06-2025 12:50:42.195 | General Service|:: CompanyIndex:75 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNzUsMSIsIm5iZiI6MTc1NDQ2NDc5MSwiZXhwIjoxNzU0NDkzNTkxLCJpYXQiOjE3NTQ0NjQ3OTF9.cQ3JWFRpzsG9oGvET-pzVltLb1GUT9xNv4wYuuNWGhA'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-06-2025 12:50:52.788 | General Service|:: CompanyIndex:75 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-06-2025 12:50:52.788 | General Service|:: CompanyIndex:75 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNzUsMSIsIm5iZiI6MTc1NDQ2NDc5MSwiZXhwIjoxNzU0NDkzNTkxLCJpYXQiOjE3NTQ0NjQ3OTF9.cQ3JWFRpzsG9oGvET-pzVltLb1GUT9xNv4wYuuNWGhA'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-06-2025 12:50:58.531 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-06-2025 12:50:58.531 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDQ2NDYxNSwiZXhwIjoxNzU0NDkzNDE1LCJpYXQiOjE3NTQ0NjQ2MTV9.iKjtqChgxXZKVahsAuFt7SXlOzjj0djKlWRjOhCAMlA'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:51:04.078 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:51:04.094 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTQ0NjQ2NzAsImV4cCI6MTc1NDQ5MzQ3MCwiaWF0IjoxNzU0NDY0NjcwfQ.gljUKQcmH2LwsrOd4YZw3YAwYmpvShtkPwZUROHaj90'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-06-2025 12:51:53.029 | General Service|:: CompanyIndex:75 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-06-2025 12:51:53.029 | General Service|:: CompanyIndex:75 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNzUsMSIsIm5iZiI6MTc1NDQ2NDc5MSwiZXhwIjoxNzU0NDkzNTkxLCJpYXQiOjE3NTQ0NjQ3OTF9.cQ3JWFRpzsG9oGvET-pzVltLb1GUT9xNv4wYuuNWGhA'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-06-2025 12:51:57.363 | General Service|:: CompanyIndex:53 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.99] DEBUG | 08-06-2025 12:51:57.379 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDQ2NDYxNSwiZXhwIjoxNzU0NDkzNDE1LCJpYXQiOjE3NTQ0NjQ2MTV9.iKjtqChgxXZKVahsAuFt7SXlOzjj0djKlWRjOhCAMlA'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:52:04.790 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:52:04.806 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTQ0NjQ2NzAsImV4cCI6MTc1NDQ5MzQ3MCwiaWF0IjoxNzU0NDY0NjcwfQ.gljUKQcmH2LwsrOd4YZw3YAwYmpvShtkPwZUROHaj90'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-06-2025 12:52:15.395 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-06-2025 12:52:15.504 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDQ2NDYxNSwiZXhwIjoxNzU0NDkzNDE1LCJpYXQiOjE3NTQ0NjQ2MTV9.iKjtqChgxXZKVahsAuFt7SXlOzjj0djKlWRjOhCAMlA'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-06-2025 12:52:52.910 | General Service|:: CompanyIndex:75 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-06-2025 12:52:52.910 | General Service|:: CompanyIndex:75 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNzUsMSIsIm5iZiI6MTc1NDQ2NDc5MSwiZXhwIjoxNzU0NDkzNTkxLCJpYXQiOjE3NTQ0NjQ3OTF9.cQ3JWFRpzsG9oGvET-pzVltLb1GUT9xNv4wYuuNWGhA'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:52:54.786 | General Service|:: CompanyIndex:175 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.56] DEBUG | 08-06-2025 12:52:54.786 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTQ0NjQ2NzAsImV4cCI6MTc1NDQ5MzQ3MCwiaWF0IjoxNzU0NDY0NjcwfQ.gljUKQcmH2LwsrOd4YZw3YAwYmpvShtkPwZUROHaj90'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:53:04.786 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:53:04.801 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTQ0NjQ2NzAsImV4cCI6MTc1NDQ5MzQ3MCwiaWF0IjoxNzU0NDY0NjcwfQ.gljUKQcmH2LwsrOd4YZw3YAwYmpvShtkPwZUROHaj90'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:53:05.754 | General Service|:: CompanyIndex:7 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.56] DEBUG | 08-06-2025 12:53:05.770 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsNywxIiwibmJmIjoxNzU0NDYzNzgyLCJleHAiOjE3NTQ0OTI1ODIsImlhdCI6MTc1NDQ2Mzc4Mn0.9KypghGFg7B7MqF70r9PZzncStq8QTbC8cpYxxvPXzM'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-06-2025 12:53:15.385 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-06-2025 12:53:15.401 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDQ2NDYxNSwiZXhwIjoxNzU0NDkzNDE1LCJpYXQiOjE3NTQ0NjQ2MTV9.iKjtqChgxXZKVahsAuFt7SXlOzjj0djKlWRjOhCAMlA'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-06-2025 12:53:52.904 | General Service|:: CompanyIndex:75 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-06-2025 12:53:52.904 | General Service|:: CompanyIndex:75 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNzUsMSIsIm5iZiI6MTc1NDQ2NDc5MSwiZXhwIjoxNzU0NDkzNTkxLCJpYXQiOjE3NTQ0NjQ3OTF9.cQ3JWFRpzsG9oGvET-pzVltLb1GUT9xNv4wYuuNWGhA'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:54:04.800 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:54:04.800 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTQ0NjQ2NzAsImV4cCI6MTc1NDQ5MzQ3MCwiaWF0IjoxNzU0NDY0NjcwfQ.gljUKQcmH2LwsrOd4YZw3YAwYmpvShtkPwZUROHaj90'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-06-2025 12:54:15.386 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-06-2025 12:54:15.401 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDQ2NDYxNSwiZXhwIjoxNzU0NDkzNDE1LCJpYXQiOjE3NTQ0NjQ2MTV9.iKjtqChgxXZKVahsAuFt7SXlOzjj0djKlWRjOhCAMlA'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-06-2025 12:54:51.912 | General Service|:: CompanyIndex:75 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.77] DEBUG | 08-06-2025 12:54:51.912 | General Service|:: CompanyIndex:75 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNzUsMSIsIm5iZiI6MTc1NDQ2NDc5MSwiZXhwIjoxNzU0NDkzNTkxLCJpYXQiOjE3NTQ0NjQ3OTF9.cQ3JWFRpzsG9oGvET-pzVltLb1GUT9xNv4wYuuNWGhA'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-06-2025 12:54:52.802 | General Service|:: CompanyIndex:75 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-06-2025 12:54:52.818 | General Service|:: CompanyIndex:75 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNzUsMSIsIm5iZiI6MTc1NDQ2NDc5MSwiZXhwIjoxNzU0NDkzNTkxLCJpYXQiOjE3NTQ0NjQ3OTF9.cQ3JWFRpzsG9oGvET-pzVltLb1GUT9xNv4wYuuNWGhA'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:55:03.917 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:55:03.917 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTQ0NjQ2NzAsImV4cCI6MTc1NDQ5MzQ3MCwiaWF0IjoxNzU0NDY0NjcwfQ.gljUKQcmH2LwsrOd4YZw3YAwYmpvShtkPwZUROHaj90'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-06-2025 12:55:15.386 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-06-2025 12:55:15.386 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDQ2NDYxNSwiZXhwIjoxNzU0NDkzNDE1LCJpYXQiOjE3NTQ0NjQ2MTV9.iKjtqChgxXZKVahsAuFt7SXlOzjj0djKlWRjOhCAMlA'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-06-2025 12:55:53.910 | General Service|:: CompanyIndex:75 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-06-2025 12:55:53.926 | General Service|:: CompanyIndex:75 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNzUsMSIsIm5iZiI6MTc1NDQ2NDc5MSwiZXhwIjoxNzU0NDkzNTkxLCJpYXQiOjE3NTQ0NjQ3OTF9.cQ3JWFRpzsG9oGvET-pzVltLb1GUT9xNv4wYuuNWGhA'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:56:03.911 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:56:03.911 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTQ0NjQ2NzAsImV4cCI6MTc1NDQ5MzQ3MCwiaWF0IjoxNzU0NDY0NjcwfQ.gljUKQcmH2LwsrOd4YZw3YAwYmpvShtkPwZUROHaj90'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-06-2025 12:56:15.375 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-06-2025 12:56:15.391 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDQ2NDYxNSwiZXhwIjoxNzU0NDkzNDE1LCJpYXQiOjE3NTQ0NjQ2MTV9.iKjtqChgxXZKVahsAuFt7SXlOzjj0djKlWRjOhCAMlA'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-06-2025 12:56:54.930 | General Service|:: CompanyIndex:75 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-06-2025 12:56:54.930 | General Service|:: CompanyIndex:75 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNzUsMSIsIm5iZiI6MTc1NDQ2NDc5MSwiZXhwIjoxNzU0NDkzNTkxLCJpYXQiOjE3NTQ0NjQ3OTF9.cQ3JWFRpzsG9oGvET-pzVltLb1GUT9xNv4wYuuNWGhA'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-06-2025 12:56:57.345 | General Service|:: CompanyIndex:53 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.99] DEBUG | 08-06-2025 12:56:57.345 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDQ2NDYxNSwiZXhwIjoxNzU0NDkzNDE1LCJpYXQiOjE3NTQ0NjQ2MTV9.iKjtqChgxXZKVahsAuFt7SXlOzjj0djKlWRjOhCAMlA'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:57:03.915 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:57:03.915 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTQ0NjQ2NzAsImV4cCI6MTc1NDQ5MzQ3MCwiaWF0IjoxNzU0NDY0NjcwfQ.gljUKQcmH2LwsrOd4YZw3YAwYmpvShtkPwZUROHaj90'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-06-2025 12:57:15.377 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-06-2025 12:57:15.393 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDQ2NDYxNSwiZXhwIjoxNzU0NDkzNDE1LCJpYXQiOjE3NTQ0NjQ2MTV9.iKjtqChgxXZKVahsAuFt7SXlOzjj0djKlWRjOhCAMlA'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:57:54.756 | General Service|:: CompanyIndex:175 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.56] DEBUG | 08-06-2025 12:57:54.756 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTQ0NjQ2NzAsImV4cCI6MTc1NDQ5MzQ3MCwiaWF0IjoxNzU0NDY0NjcwfQ.gljUKQcmH2LwsrOd4YZw3YAwYmpvShtkPwZUROHaj90'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-06-2025 12:57:55.958 | General Service|:: CompanyIndex:75 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-06-2025 12:57:55.958 | General Service|:: CompanyIndex:75 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNzUsMSIsIm5iZiI6MTc1NDQ2NDc5MSwiZXhwIjoxNzU0NDkzNTkxLCJpYXQiOjE3NTQ0NjQ3OTF9.cQ3JWFRpzsG9oGvET-pzVltLb1GUT9xNv4wYuuNWGhA'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:58:04.797 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:58:04.797 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTQ0NjQ2NzAsImV4cCI6MTc1NDQ5MzQ3MCwiaWF0IjoxNzU0NDY0NjcwfQ.gljUKQcmH2LwsrOd4YZw3YAwYmpvShtkPwZUROHaj90'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:58:05.781 | General Service|:: CompanyIndex:7 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.56] DEBUG | 08-06-2025 12:58:05.781 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsNywxIiwibmJmIjoxNzU0NDYzNzgyLCJleHAiOjE3NTQ0OTI1ODIsImlhdCI6MTc1NDQ2Mzc4Mn0.9KypghGFg7B7MqF70r9PZzncStq8QTbC8cpYxxvPXzM'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-06-2025 12:58:15.375 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-06-2025 12:58:15.375 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDQ2NDYxNSwiZXhwIjoxNzU0NDkzNDE1LCJpYXQiOjE3NTQ0NjQ2MTV9.iKjtqChgxXZKVahsAuFt7SXlOzjj0djKlWRjOhCAMlA'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-06-2025 12:58:58.521 | General Service|:: CompanyIndex:0 SpName: spADM_GetClientUserDetails2C 
 'admin'
 ,1
 ,0
[System: 192.168.1.77] DEBUG | 08-06-2025 12:58:58.584 | General Service|:: CompanyIndex:0 SpName: spADM_UserLoginCheck 
 2
 ,'admin'
 ,0
 ,'192.168.1.77'
 ,'192.168.1.77'
 ,''
 ,'Web'
 ,1
[System: 192.168.1.77] DEBUG | 08-06-2025 12:59:02.448 | General Service|:: CompanyIndex:75 SpName: spADM_GetClientUserDetails 
 'admin'
 ,1
 ,'26.2.3'
 ,0
[System: 192.168.1.77] DEBUG | 08-06-2025 12:59:02.542 | General Service|:: CompanyIndex:0 SpName: spADM_UserLoginCheck 
 2
 ,'admin'
 ,75
 ,'192.168.1.77'
 ,'192.168.1.77'
 ,''
 ,'Web'
 ,1
[System: 192.168.1.77] DEBUG | 08-06-2025 12:59:02.558 | General Service|:: CompanyIndex:0 SpName: spADM_Login 
 1
 ,''
 ,''
 ,''
 ,''
 ,''
 ,75
[System: 192.168.1.77] DEBUG | 08-06-2025 12:59:02.573 | General Service|:: CompanyIndex:75 SpName: spADM_GetDataSet 
 'select Value from ADM_GlobalPreferences with (nolock) where name =''EnableReLogin'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-06-2025 12:59:02.573 | General Service|:: CompanyIndex:75 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNzUsMSIsIm5iZiI6MTc1NDQ2NTM0MiwiZXhwIjoxNzU0NDk0MTQyLCJpYXQiOjE3NTQ0NjUzNDJ9.tiA6ECZqRT23xNQPNgAGyjkGkFEDMwgsTUvYkf0EhQo'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-06-2025 12:59:02.605 | General Service|:: CompanyIndex:0 SpName: spADM_Login 
 4
 ,''
 ,''
 ,''
 ,'declare @Cnt int,@ExpiredGUID nvarchar(50),@AllowSession int,@GUID nvarchar(50),@CurrDate float,@UserID INT,@Instances INT,@InstancesExists INT,@LCDBIndex int
set @CurrDate= convert(float,dateadd(minute,-21,getdate()))
set @AllowSession=0
set @GUID=''d22f9460-0153-4de0-b877-405d16b46962''
set @LCDBIndex=0
select top 1 @UserID=UserID,@Instances=InstanceCount from ADM_Users with(nolock) where UserName=''admin''
if exists(select [GUID] from ADM_Login with(nolock) where [GUID]=@GUID)
begin
	update ADM_Login 
	set LastAccessTime=convert(float,getdate()),UserID=@UserID
	where [GUID]=@GUID
    set @AllowSession=1
end
else
begin
	select @Cnt=count(*) from ADM_Login with(nolock) where LCDBIndex=@LCDBIndex and [GUID]!=''ACCESSRIGHTS'' and AP =''WEB''
    if(@Cnt<100)
		set @AllowSession=1
	else
	begin
		select top 1 @ExpiredGUID=[GUID] from ADM_Login with(nolock)
		where [GUID]!=''ACCESSRIGHTS'' and LCDBIndex=@LCDBIndex and LastAccessTime<@CurrDate  and AP =''WEB''
        order by LastAccessTime asc
		if @ExpiredGUID is not null
		begin
			delete from ADM_Login where [GUID]=@ExpiredGUID
			set @AllowSession=1
		end
	end
	if @AllowSession=1
	begin
        select @InstancesExists=COUNT(*) from ADM_Login with(nolock)
		where [GUID]!=''ACCESSRIGHTS'' and LCDBIndex=@LCDBIndex and LastAccessTime>=@CurrDate and UserID=@UserID and AP =''WEB''
		if(@Instances!=0 and @Instances<=@InstancesExists)
			set @AllowSession=2
		else
		    INSERT INTO ADM_Login([GUID],[SysName],IPAddress,[Status],LoginTime,LastAccessTime,AccessRights,UserID,DBIndex,LCDBIndex,AP)
		    VALUES(@GUID,''WEB'',''192.168.1.77'',1,convert(float,getdate()),convert(float,getdate()),null,@UserID,75,@LCDBIndex, ''WEB'')
	end
end

select @AllowSession AllowSession,@Instances Instances,@InstancesExists InstancesExists
'
 ,''
 ,0
[System: 192.168.1.77] DEBUG | 08-06-2025 12:59:02.605 | General Service|:: CompanyIndex:75 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNzUsMSIsIm5iZiI6MTc1NDQ2NTM0MiwiZXhwIjoxNzU0NDk0MTQyLCJpYXQiOjE3NTQ0NjUzNDJ9.tiA6ECZqRT23xNQPNgAGyjkGkFEDMwgsTUvYkf0EhQo'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-06-2025 12:59:02.651 | General Service|:: CompanyIndex:75 SpName: spADM_GetDataSet 
 'SELECT (SELECT COUNT(*) FROM COM_Location L WITH(NOLOCK) JOIN COM_Status S WITH(NOLOCK) ON S.StatusID=L.StatusID WHERE L.IsGroup=0 AND S.[Status]=''Active'') ML
,(SELECT COUNT(*) FROM ADM_Features WITH(NOLOCK) WHERE ((FeatureID>50000 AND FeatureID<=50050) OR FeatureID>=51000) AND IsEnabled=1) MD
,(SELECT ISNULL(COUNT(*),0) FROM ADM_RevenUReports WITH(NOLOCK) WHERE IsGroup=0 AND ReportID>10000 AND StaticReportType IN (0,-1)) MR'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-06-2025 12:59:02.651 | General Service|:: CompanyIndex:75 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNzUsMSIsIm5iZiI6MTc1NDQ2NTM0MiwiZXhwIjoxNzU0NDk0MTQyLCJpYXQiOjE3NTQ0NjUzNDJ9.tiA6ECZqRT23xNQPNgAGyjkGkFEDMwgsTUvYkf0EhQo'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-06-2025 12:59:02.683 | General Service|:: CompanyIndex:75 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.77] DEBUG | 08-06-2025 12:59:02.683 | General Service|:: CompanyIndex:75 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNzUsMSIsIm5iZiI6MTc1NDQ2NTM0MiwiZXhwIjoxNzU0NDk0MTQyLCJpYXQiOjE3NTQ0NjUzNDJ9.tiA6ECZqRT23xNQPNgAGyjkGkFEDMwgsTUvYkf0EhQo'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-06-2025 12:59:02.823 | General Service|:: CompanyIndex:75 SpName: spADM_GetRibbonView 
 1
 ,1
 ,1
 ,1
 ,0
 ,''
[System: 192.168.1.77] DEBUG | 08-06-2025 12:59:02.823 | General Service|:: CompanyIndex:75 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNzUsMSIsIm5iZiI6MTc1NDQ2NTM0MiwiZXhwIjoxNzU0NDk0MTQyLCJpYXQiOjE3NTQ0NjUzNDJ9.tiA6ECZqRT23xNQPNgAGyjkGkFEDMwgsTUvYkf0EhQo'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-06-2025 12:59:02.995 | General Service|:: CompanyIndex:75 SpName: spADM_GetDashBoard 
 2
 ,0
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.77] DEBUG | 08-06-2025 12:59:02.995 | General Service|:: CompanyIndex:75 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNzUsMSIsIm5iZiI6MTc1NDQ2NTM0MiwiZXhwIjoxNzU0NDk0MTQyLCJpYXQiOjE3NTQ0NjUzNDJ9.tiA6ECZqRT23xNQPNgAGyjkGkFEDMwgsTUvYkf0EhQo'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-06-2025 12:59:03.011 | General Service|:: CompanyIndex:75 SpName: spCOM_ConfigValues 
 1
 ,'LandingDocs'
 ,'1'
[System: 192.168.1.77] DEBUG | 08-06-2025 12:59:03.026 | General Service|:: CompanyIndex:75 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNzUsMSIsIm5iZiI6MTc1NDQ2NTM0MiwiZXhwIjoxNzU0NDk0MTQyLCJpYXQiOjE3NTQ0NjUzNDJ9.tiA6ECZqRT23xNQPNgAGyjkGkFEDMwgsTUvYkf0EhQo'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-06-2025 12:59:03.073 | General Service|:: CompanyIndex:75 SpName: spADM_GetAllListViewsDef 
 1
 ,1
[System: 192.168.1.77] DEBUG | 08-06-2025 12:59:03.073 | General Service|:: CompanyIndex:75 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNzUsMSIsIm5iZiI6MTc1NDQ2NTM0MiwiZXhwIjoxNzU0NDk0MTQyLCJpYXQiOjE3NTQ0NjUzNDJ9.tiA6ECZqRT23xNQPNgAGyjkGkFEDMwgsTUvYkf0EhQo'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-06-2025 12:59:03.183 | General Service|:: CompanyIndex:75 SpName: spADM_GetAllListViewsDef 
 1
 ,1
[System: 192.168.1.77] DEBUG | 08-06-2025 12:59:03.183 | General Service|:: CompanyIndex:75 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNzUsMSIsIm5iZiI6MTc1NDQ2NTM0MiwiZXhwIjoxNzU0NDk0MTQyLCJpYXQiOjE3NTQ0NjUzNDJ9.tiA6ECZqRT23xNQPNgAGyjkGkFEDMwgsTUvYkf0EhQo'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-06-2025 12:59:03.308 | General Service|:: CompanyIndex:75 SpName: spADM_GetDataSet 
 'Select CostCenterID,CostCenterColID,CostCenterName,SysTableName,UserColumnName,SysColumnName,ISNULL(UserDefaultValue,'''') UserDefaultValue
From AdM_CostCenterDef WITH(NOLOCK)
Where SysColumnName IN(''CreditAccount'',''DebitAccount'',''ProductID'') 
AND CostCenterID>40000 AND CostCenterID<50000 

SELECT * FROM ADM_Features WITH(NOLOCK) '
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-06-2025 12:59:03.308 | General Service|:: CompanyIndex:75 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNzUsMSIsIm5iZiI6MTc1NDQ2NTM0MiwiZXhwIjoxNzU0NDk0MTQyLCJpYXQiOjE3NTQ0NjUzNDJ9.tiA6ECZqRT23xNQPNgAGyjkGkFEDMwgsTUvYkf0EhQo'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-06-2025 12:59:03.355 | General Service|:: CompanyIndex:75 SpName: spADM_GetDataSet 
 '  SELECT * FROM PAY_PayrollPreferences WITH(NOLOCK) '
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-06-2025 12:59:03.370 | General Service|:: CompanyIndex:75 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNzUsMSIsIm5iZiI6MTc1NDQ2NTM0MiwiZXhwIjoxNzU0NDk0MTQyLCJpYXQiOjE3NTQ0NjUzNDJ9.tiA6ECZqRT23xNQPNgAGyjkGkFEDMwgsTUvYkf0EhQo'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-06-2025 12:59:03.448 | General Service|:: CompanyIndex:75 SpName: spADM_GetDataSet 
 '  --0
                                Select * FROM COM_CC50051 WITH(NOLOCK) WHERE IsGroup=0 AND LoginUserID=''admin''
                                --1                                
                                Select * FROM COM_CC50051 WITH(NOLOCK) WHERE RptManager IN (Select NodeID FROM COM_CC50051 WITH(NOLOCK) WHERE IsGroup=0 AND LoginUserID=''admin'')
                                UNION ALL
                                Select * FROM COM_CC50051 WITH(NOLOCK) WHERE RptManager IN 
                                (
	                                Select NodeID FROM COM_CC50051 WITH(NOLOCK) 
	                                WHERE IsGroup=0 AND LoginUserID IN
	                                (
	                                SELECT fe.LoginUserID
	                                FROM INV_DocDetails a WITH(NOLOCK) 
	                                JOIN COM_DocCCData b WITH(NOLOCK) ON b.InvDocDetailsID=a.InvDocDetailsID
	                                JOIN COM_DocNumData c WITH(NOLOCK) ON c.InvDocDetailsID=a.InvDocDetailsID
	                                JOIN COM_DocTextData d WITH(NOLOCK) ON d.InvDocDetailsID=a.InvDocDetailsID
	                                JOIN COM_CC50051 fe WITH(NOLOCK) on fe.NodeID=b.dcCCNID51
	                                JOIN COM_CC50051 te WITH(NOLOCK) on CONVERT(NVARCHAR,te.NodeID)=d.dcAlpha1
	                                WHERE a.CostCenterID=40098 and a.StatusID=369 AND d.dcAlpha3=''Temporary''
	                                AND te.LoginUserID=''admin'' 
	                                AND ISDATE(d.dcAlpha4)=1 AND ISDATE(d.dcAlpha5)=1 
	                                AND CONVERT(DATETIME,''06 Aug 2025'') BETWEEN CONVERT(DATETIME,d.dcAlpha4) AND CONVERT(DATETIME,d.dcAlpha5)
	                                )
                                )
                                --2
                                Select * FROM ADM_USERS WITH(NOLOCK) WHERE USERID=1
                                --3
                                Select * FROM COM_CostCenterCostCenterMap WITH(NOLOCK) WHERE ParentCostCenterID=7 AND ParentNodeID=1
                                --4                                
                                Select * FROM COM_CostCenterCostCenterMap WITH(NOLOCK) WHERE ParentCostCenterID=7 AND ParentNodeID=1
                                AND CostCenterID IN(Select ColumnCostCenterID From ADM_CostCenterDef Where CostCenterID=50051 AND IsColumnInUse=1 AND SysColumnName LIKE ''CCNID%'')
                                --5
                                Select * from COM_Files WITH(NOLOCK) WHERE FeatureID=50051 AND FeaturePK IN (Select NodeID FROM COM_CC50051 WITH(NOLOCK) WHERE IsGroup=0 AND LoginUserID=''admin'')                         
'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-06-2025 12:59:03.448 | General Service|:: CompanyIndex:75 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNzUsMSIsIm5iZiI6MTc1NDQ2NTM0MiwiZXhwIjoxNzU0NDk0MTQyLCJpYXQiOjE3NTQ0NjUzNDJ9.tiA6ECZqRT23xNQPNgAGyjkGkFEDMwgsTUvYkf0EhQo'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-06-2025 12:59:03.464 | General Service|:: CompanyIndex:75 SpName: spADM_GetDataSet 
 'UPDATE C SET STATUSID=CASE WHEN ResignType=''Resigned'' THEN 302 WHEN ResignType=''Terminated With Cause'' THEN 303 WHEN ResignType=''Terminated Without Cause'' THEN 304 END 
                            FROM COM_CC50051 C WITH(NOLOCK)
                            WHERE ResignStatus=''Posted'' AND ResignType NOT IN(''Pending'',''Rejected'') 
                            AND DOResign IS NOT NULL AND DORelieve IS NOT NULL
                            AND STATUSID NOT IN(302,303,304)
                            AND DATEDIFF(D,GETDATE(),DORelieve)<0'
 ,1
 ,1
 message=Cannot insert the value NULL into column 'StatusID', table 'PACT2C75.dbo.COM_CC50051'; column does not allow nulls. UPDATE fails.
[System: 192.168.1.77] DEBUG | 08-06-2025 12:59:03.464 | General Service|:: CompanyIndex:75 SpName: spADM_GetDataSet 
 'UPDATE C SET STATUSID=CASE WHEN ResignType=''Resigned'' THEN 302 WHEN ResignType=''Terminated With Cause'' THEN 303 WHEN ResignType=''Terminated Without Cause'' THEN 304 END 
                            FROM COM_CC50051 C WITH(NOLOCK)
                            WHERE ResignStatus=''Posted'' AND ResignType NOT IN(''Pending'',''Rejected'') 
                            AND DOResign IS NOT NULL AND DORelieve IS NOT NULL
                            AND STATUSID NOT IN(302,303,304)
                            AND DATEDIFF(D,GETDATE(),DORelieve)<0'
 ,1
 ,1
 message=Problem in processing your request, Please contact administrator.
[System: 192.168.1.77] INFO | 08-06-2025 12:59:03.464 | OnStartup: Logger Instance Created Successfully
[System: 192.168.1.77] INFO | 08-06-2025 12:59:03.464 | OnStartup: Application Starting...
[System: 192.168.1.77] ERROR | 08-06-2025 12:59:03.464 | General Service|:: CompanyIndex:75 SpName: spADM_GetDataSetParameters :
 'UPDATE C SET STATUSID=CASE WHEN ResignType=''Resigned'' THEN 302 WHEN ResignType=''Terminated With Cause'' THEN 303 WHEN ResignType=''Terminated Without Cause'' THEN 304 END 
                            FROM COM_CC50051 C WITH(NOLOCK)
                            WHERE ResignStatus=''Posted'' AND ResignType NOT IN(''Pending'',''Rejected'') 
                            AND DOResign IS NOT NULL AND DORelieve IS NOT NULL
                            AND STATUSID NOT IN(302,303,304)
                            AND DATEDIFF(D,GETDATE(),DORelieve)<0'
 ,1
 ,1|Cannot insert the value NULL into column 'StatusID', table 'PACT2C75.dbo.COM_CC50051'; column does not allow nulls. UPDATE fails.
[System: 192.168.1.77] DEBUG | 08-06-2025 12:59:03.479 | General Service|:: CompanyIndex:75 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNzUsMSIsIm5iZiI6MTc1NDQ2NTM0MiwiZXhwIjoxNzU0NDk0MTQyLCJpYXQiOjE3NTQ0NjUzNDJ9.tiA6ECZqRT23xNQPNgAGyjkGkFEDMwgsTUvYkf0EhQo'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-06-2025 12:59:03.511 | General Service|:: CompanyIndex:75 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-06-2025 12:59:03.511 | General Service|:: CompanyIndex:75 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNzUsMSIsIm5iZiI6MTc1NDQ2NTM0MiwiZXhwIjoxNzU0NDk0MTQyLCJpYXQiOjE3NTQ0NjUzNDJ9.tiA6ECZqRT23xNQPNgAGyjkGkFEDMwgsTUvYkf0EhQo'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-06-2025 12:59:03.830 | General Service|:: CompanyIndex:75 SpName: spCOM_GetFavorites 
 'GETLIST0'
 ,0
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.77] DEBUG | 08-06-2025 12:59:03.830 | General Service|:: CompanyIndex:75 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNzUsMSIsIm5iZiI6MTc1NDQ2NTM0MiwiZXhwIjoxNzU0NDk0MTQyLCJpYXQiOjE3NTQ0NjUzNDJ9.tiA6ECZqRT23xNQPNgAGyjkGkFEDMwgsTUvYkf0EhQo'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-06-2025 12:59:03.861 | General Service|:: CompanyIndex:75 SpName: spCOM_GetFavorites 
 'VIEW'
 ,71
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.77] DEBUG | 08-06-2025 12:59:03.861 | General Service|:: CompanyIndex:75 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNzUsMSIsIm5iZiI6MTc1NDQ2NTM0MiwiZXhwIjoxNzU0NDk0MTQyLCJpYXQiOjE3NTQ0NjUzNDJ9.tiA6ECZqRT23xNQPNgAGyjkGkFEDMwgsTUvYkf0EhQo'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:59:04.783 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 12:59:04.798 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTQ0NjQ2NzAsImV4cCI6MTc1NDQ5MzQ3MCwiaWF0IjoxNzU0NDY0NjcwfQ.gljUKQcmH2LwsrOd4YZw3YAwYmpvShtkPwZUROHaj90'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-06-2025 12:59:10.111 | General Service|:: CompanyIndex:75 SpName: spADM_GetCostCenterGridViewList 
 200
 ,1
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-06-2025 12:59:10.111 | General Service|:: CompanyIndex:75 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNzUsMSIsIm5iZiI6MTc1NDQ2NTM0MiwiZXhwIjoxNzU0NDk0MTQyLCJpYXQiOjE3NTQ0NjUzNDJ9.tiA6ECZqRT23xNQPNgAGyjkGkFEDMwgsTUvYkf0EhQo'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-06-2025 12:59:10.157 | General Service|:: CompanyIndex:75 SpName: spCom_GetCostCenterSummary 
 267
 ,-1
 ,1000
 ,''
 ,''
 ,''
 ,0
 ,'06-Aug-2025'
 ,NULL
 ,''
 ,1
 ,1
 ,0
 ,0
 ,False
 ,1
[System: 192.168.1.77] DEBUG | 08-06-2025 12:59:10.157 | General Service|:: CompanyIndex:75 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNzUsMSIsIm5iZiI6MTc1NDQ2NTM0MiwiZXhwIjoxNzU0NDk0MTQyLCJpYXQiOjE3NTQ0NjUzNDJ9.tiA6ECZqRT23xNQPNgAGyjkGkFEDMwgsTUvYkf0EhQo'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-06-2025 12:59:14.954 | General Service|:: CompanyIndex:75 SpName: spCom_GetCostCenterQuickViewDefn 
 200
 ,'329'
 ,200
 ,1
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-06-2025 12:59:14.954 | General Service|:: CompanyIndex:75 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNzUsMSIsIm5iZiI6MTc1NDQ2NTM0MiwiZXhwIjoxNzU0NDk0MTQyLCJpYXQiOjE3NTQ0NjUzNDJ9.tiA6ECZqRT23xNQPNgAGyjkGkFEDMwgsTUvYkf0EhQo'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-06-2025 12:59:15.126 | General Service|:: CompanyIndex:75 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=329'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-06-2025 12:59:15.126 | General Service|:: CompanyIndex:75 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNzUsMSIsIm5iZiI6MTc1NDQ2NTM0MiwiZXhwIjoxNzU0NDk0MTQyLCJpYXQiOjE3NTQ0NjUzNDJ9.tiA6ECZqRT23xNQPNgAGyjkGkFEDMwgsTUvYkf0EhQo'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-06-2025 12:59:15.157 | General Service|:: CompanyIndex:75 SpName: spRPT_GetReport 
 0
 ,329
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.77] DEBUG | 08-06-2025 12:59:15.157 | General Service|:: CompanyIndex:75 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNzUsMSIsIm5iZiI6MTc1NDQ2NTM0MiwiZXhwIjoxNzU0NDk0MTQyLCJpYXQiOjE3NTQ0NjUzNDJ9.tiA6ECZqRT23xNQPNgAGyjkGkFEDMwgsTUvYkf0EhQo'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-06-2025 12:59:15.173 | General Service|:: CompanyIndex:75 SpName: spDOC_GetVPTPrintCopies 
 4
 ,50
 ,329
 ,2
 ,4
 ,'View~admin'
 ,'admin'
 ,1
[System: 192.168.1.77] DEBUG | 08-06-2025 12:59:15.188 | General Service|:: CompanyIndex:75 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNzUsMSIsIm5iZiI6MTc1NDQ2NTM0MiwiZXhwIjoxNzU0NDk0MTQyLCJpYXQiOjE3NTQ0NjUzNDJ9.tiA6ECZqRT23xNQPNgAGyjkGkFEDMwgsTUvYkf0EhQo'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-06-2025 12:59:15.391 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-06-2025 12:59:15.391 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDQ2NDYxNSwiZXhwIjoxNzU0NDkzNDE1LCJpYXQiOjE3NTQ0NjQ2MTV9.iKjtqChgxXZKVahsAuFt7SXlOzjj0djKlWRjOhCAMlA'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-06-2025 12:59:15.407 | General Service|:: CompanyIndex:75 SpName: spRPT_GetReportCategoryandField 
 -1
 ,0
 ,1
 ,0
 ,'1'
 ,1
[System: 192.168.1.77] DEBUG | 08-06-2025 12:59:15.407 | General Service|:: CompanyIndex:75 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNzUsMSIsIm5iZiI6MTc1NDQ2NTM0MiwiZXhwIjoxNzU0NDk0MTQyLCJpYXQiOjE3NTQ0NjUzNDJ9.tiA6ECZqRT23xNQPNgAGyjkGkFEDMwgsTUvYkf0EhQo'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-06-2025 12:59:15.485 | General Service|:: CompanyIndex:75 SpName: spADM_GetCostCenterGridViewList 
 50051
 ,1
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-06-2025 12:59:15.485 | General Service|:: CompanyIndex:75 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNzUsMSIsIm5iZiI6MTc1NDQ2NTM0MiwiZXhwIjoxNzU0NDk0MTQyLCJpYXQiOjE3NTQ0NjUzNDJ9.tiA6ECZqRT23xNQPNgAGyjkGkFEDMwgsTUvYkf0EhQo'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-06-2025 12:59:15.579 | General Service|:: CompanyIndex:75 SpName: spCom_GetCostCenterSummary 
 350
 ,-1
 ,1000
 ,' 1=1 '
 ,''
 ,''
 ,0
 ,'06-Aug-2025'
 ,NULL
 ,''
 ,1
 ,1
 ,0
 ,0
 ,False
 ,1
[System: 192.168.1.77] DEBUG | 08-06-2025 12:59:15.579 | General Service|:: CompanyIndex:75 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNzUsMSIsIm5iZiI6MTc1NDQ2NTM0MiwiZXhwIjoxNzU0NDk0MTQyLCJpYXQiOjE3NTQ0NjUzNDJ9.tiA6ECZqRT23xNQPNgAGyjkGkFEDMwgsTUvYkf0EhQo'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-06-2025 12:59:15.641 | General Service|:: CompanyIndex:75 SpName: spADM_GetLocationRole 
 50002
 ,1
 message=Saved Succesfully
[System: 192.168.1.77] DEBUG | 08-06-2025 12:59:15.641 | General Service|:: CompanyIndex:75 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNzUsMSIsIm5iZiI6MTc1NDQ2NTM0MiwiZXhwIjoxNzU0NDk0MTQyLCJpYXQiOjE3NTQ0NjUzNDJ9.tiA6ECZqRT23xNQPNgAGyjkGkFEDMwgsTUvYkf0EhQo'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-06-2025 12:59:15.657 | General Service|:: CompanyIndex:75 SpName: spADM_GetDataSet 
 'SELECT CL.RESOURCEDATA Name FROM [ADM_Features] ADF WITH(NOLOCK),COM_LANGUAGERESOURCES CL WITH(NOLOCK) WHERE ADF.RESOURCEID=CL.RESOURCEID AND ADF.FeatureID=50002 AND CL.LanguageID=1'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-06-2025 12:59:15.657 | General Service|:: CompanyIndex:75 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNzUsMSIsIm5iZiI6MTc1NDQ2NTM0MiwiZXhwIjoxNzU0NDk0MTQyLCJpYXQiOjE3NTQ0NjUzNDJ9.tiA6ECZqRT23xNQPNgAGyjkGkFEDMwgsTUvYkf0EhQo'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-06-2025 12:59:15.750 | General Service|:: CompanyIndex:75 SpName: spCom_GetCostCenterSummary 
 350
 ,1000
 ,1000
 ,' 1=1 '
 ,''
 ,''
 ,1998
 ,'06-Aug-2025'
 ,NULL
 ,''
 ,1
 ,1
 ,0
 ,0
 ,False
 ,1
[System: 192.168.1.77] DEBUG | 08-06-2025 12:59:15.750 | General Service|:: CompanyIndex:75 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNzUsMSIsIm5iZiI6MTc1NDQ2NTM0MiwiZXhwIjoxNzU0NDk0MTQyLCJpYXQiOjE3NTQ0NjUzNDJ9.tiA6ECZqRT23xNQPNgAGyjkGkFEDMwgsTUvYkf0EhQo'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-06-2025 12:59:15.875 | General Service|:: CompanyIndex:75 SpName: spCom_GetCostCenterSummary 
 350
 ,2000
 ,1000
 ,' 1=1 '
 ,''
 ,''
 ,3998
 ,'06-Aug-2025'
 ,NULL
 ,''
 ,1
 ,1
 ,0
 ,0
 ,False
 ,1
[System: 192.168.1.77] DEBUG | 08-06-2025 12:59:15.875 | General Service|:: CompanyIndex:75 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNzUsMSIsIm5iZiI6MTc1NDQ2NTM0MiwiZXhwIjoxNzU0NDk0MTQyLCJpYXQiOjE3NTQ0NjUzNDJ9.tiA6ECZqRT23xNQPNgAGyjkGkFEDMwgsTUvYkf0EhQo'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-06-2025 12:59:15.953 | General Service|:: CompanyIndex:75 SpName: spCom_GetCostCenterSummary 
 350
 ,3000
 ,1000
 ,' 1=1 '
 ,''
 ,''
 ,5998
 ,'06-Aug-2025'
 ,NULL
 ,''
 ,1
 ,1
 ,0
 ,0
 ,False
 ,1
[System: 192.168.1.77] DEBUG | 08-06-2025 12:59:15.953 | General Service|:: CompanyIndex:75 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNzUsMSIsIm5iZiI6MTc1NDQ2NTM0MiwiZXhwIjoxNzU0NDk0MTQyLCJpYXQiOjE3NTQ0NjUzNDJ9.tiA6ECZqRT23xNQPNgAGyjkGkFEDMwgsTUvYkf0EhQo'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-06-2025 12:59:16.032 | General Service|:: CompanyIndex:75 SpName: spCom_GetCostCenterSummary 
 350
 ,4000
 ,1000
 ,' 1=1 '
 ,''
 ,''
 ,7998
 ,'06-Aug-2025'
 ,NULL
 ,''
 ,1
 ,1
 ,0
 ,0
 ,False
 ,1
[System: 192.168.1.77] DEBUG | 08-06-2025 12:59:16.032 | General Service|:: CompanyIndex:75 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNzUsMSIsIm5iZiI6MTc1NDQ2NTM0MiwiZXhwIjoxNzU0NDk0MTQyLCJpYXQiOjE3NTQ0NjUzNDJ9.tiA6ECZqRT23xNQPNgAGyjkGkFEDMwgsTUvYkf0EhQo'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-06-2025 12:59:16.094 | General Service|:: CompanyIndex:75 SpName: spCom_GetCostCenterSummary 
 350
 ,5000
 ,1000
 ,' 1=1 '
 ,''
 ,''
 ,9998
 ,'06-Aug-2025'
 ,NULL
 ,''
 ,1
 ,1
 ,0
 ,0
 ,False
 ,1
[System: 192.168.1.77] DEBUG | 08-06-2025 12:59:16.094 | General Service|:: CompanyIndex:75 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNzUsMSIsIm5iZiI6MTc1NDQ2NTM0MiwiZXhwIjoxNzU0NDk0MTQyLCJpYXQiOjE3NTQ0NjUzNDJ9.tiA6ECZqRT23xNQPNgAGyjkGkFEDMwgsTUvYkf0EhQo'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-06-2025 12:59:16.157 | General Service|:: CompanyIndex:75 SpName: spCom_GetCostCenterSummary 
 350
 ,6000
 ,1000
 ,' 1=1 '
 ,''
 ,''
 ,11998
 ,'06-Aug-2025'
 ,NULL
 ,''
 ,1
 ,1
 ,0
 ,0
 ,False
 ,1
[System: 192.168.1.77] DEBUG | 08-06-2025 12:59:16.172 | General Service|:: CompanyIndex:75 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNzUsMSIsIm5iZiI6MTc1NDQ2NTM0MiwiZXhwIjoxNzU0NDk0MTQyLCJpYXQiOjE3NTQ0NjUzNDJ9.tiA6ECZqRT23xNQPNgAGyjkGkFEDMwgsTUvYkf0EhQo'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-06-2025 12:59:16.219 | General Service|:: CompanyIndex:75 SpName: spCom_GetCostCenterSummary 
 350
 ,7000
 ,1000
 ,' 1=1 '
 ,''
 ,''
 ,13998
 ,'06-Aug-2025'
 ,NULL
 ,''
 ,1
 ,1
 ,0
 ,0
 ,False
 ,1
[System: 192.168.1.77] DEBUG | 08-06-2025 12:59:16.219 | General Service|:: CompanyIndex:75 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNzUsMSIsIm5iZiI6MTc1NDQ2NTM0MiwiZXhwIjoxNzU0NDk0MTQyLCJpYXQiOjE3NTQ0NjUzNDJ9.tiA6ECZqRT23xNQPNgAGyjkGkFEDMwgsTUvYkf0EhQo'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-06-2025 12:59:31.409 | General Service|:: CompanyIndex:75 SpName: spADM_GetDataSet 
 '
 
 SELECT C51.NODEID,C51.CODE,C51.NAME FROM 
 COM_CC50051 C51 WITH(NOLOCK) 
 LEFT JOIN COM_CCCCDATA CC WITH (NOLOCK) ON CC.NodeID=C51.NodeID AND CC.CostCenterID=50051
  
 WHERE C51.IsGroup=0 AND C51.NodeID>1 AND C51.StatusID NOT IN (251,300,301)
 AND (ISNULL(C51.DORelieve,'''')<>'''' OR ISNULL(CONVERT(DATETIME,C51.DORelieve),''01-JAN-1990'')<=''31 Jul 2025'') AND C51.NodeID=7768'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-06-2025 12:59:31.409 | General Service|:: CompanyIndex:75 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNzUsMSIsIm5iZiI6MTc1NDQ2NTM0MiwiZXhwIjoxNzU0NDk0MTQyLCJpYXQiOjE3NTQ0NjUzNDJ9.tiA6ECZqRT23xNQPNgAGyjkGkFEDMwgsTUvYkf0EhQo'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-06-2025 12:59:31.502 | General Service|:: CompanyIndex:75 SpName: spPAY_AttendanceReportData 
 '7768'
 ,'01 Jul 2025'
 ,'31 Jul 2025'
 ,''
 ,'67'
[System: 192.168.1.77] DEBUG | 08-06-2025 12:59:31.502 | General Service|:: CompanyIndex:75 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNzUsMSIsIm5iZiI6MTc1NDQ2NTM0MiwiZXhwIjoxNzU0NDk0MTQyLCJpYXQiOjE3NTQ0NjUzNDJ9.tiA6ECZqRT23xNQPNgAGyjkGkFEDMwgsTUvYkf0EhQo'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-06-2025 13:00:03.680 | General Service|:: CompanyIndex:75 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-06-2025 13:00:03.680 | General Service|:: CompanyIndex:75 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNzUsMSIsIm5iZiI6MTc1NDQ2NTM0MiwiZXhwIjoxNzU0NDk0MTQyLCJpYXQiOjE3NTQ0NjUzNDJ9.tiA6ECZqRT23xNQPNgAGyjkGkFEDMwgsTUvYkf0EhQo'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 13:00:05.795 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 13:00:05.795 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTQ0NjQ2NzAsImV4cCI6MTc1NDQ5MzQ3MCwiaWF0IjoxNzU0NDY0NjcwfQ.gljUKQcmH2LwsrOd4YZw3YAwYmpvShtkPwZUROHaj90'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-06-2025 13:00:15.374 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-06-2025 13:00:15.374 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDQ2NDYxNSwiZXhwIjoxNzU0NDkzNDE1LCJpYXQiOjE3NTQ0NjQ2MTV9.iKjtqChgxXZKVahsAuFt7SXlOzjj0djKlWRjOhCAMlA'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-06-2025 13:01:03.926 | General Service|:: CompanyIndex:75 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-06-2025 13:01:03.941 | General Service|:: CompanyIndex:75 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNzUsMSIsIm5iZiI6MTc1NDQ2NTM0MiwiZXhwIjoxNzU0NDk0MTQyLCJpYXQiOjE3NTQ0NjUzNDJ9.tiA6ECZqRT23xNQPNgAGyjkGkFEDMwgsTUvYkf0EhQo'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 13:01:06.795 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 13:01:06.795 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTQ0NjQ2NzAsImV4cCI6MTc1NDQ5MzQ3MCwiaWF0IjoxNzU0NDY0NjcwfQ.gljUKQcmH2LwsrOd4YZw3YAwYmpvShtkPwZUROHaj90'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-06-2025 13:01:15.387 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-06-2025 13:01:15.387 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDQ2NDYxNSwiZXhwIjoxNzU0NDkzNDE1LCJpYXQiOjE3NTQ0NjQ2MTV9.iKjtqChgxXZKVahsAuFt7SXlOzjj0djKlWRjOhCAMlA'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-06-2025 13:01:56.357 | General Service|:: CompanyIndex:0 SpName: spADM_Login 
 4
 ,''
 ,''
 ,''
 ,'declare @AllowSession bit,@GUID nvarchar(50)
set @AllowSession=0
set @GUID=''3b73cbf0-5b10-47a6-b624-6ae52886a3e6''
if exists(select [GUID] from ADM_Login with(nolock) where [GUID]=@GUID)
begin
    update ADM_Login  set LastAccessTime=convert(float,getdate()) where [GUID]=@GUID
    set @AllowSession=1
end
select @AllowSession AllowSession
'
 ,''
 ,0
[System: 192.168.1.99] DEBUG | 08-06-2025 13:01:56.357 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDQ2NDYxNSwiZXhwIjoxNzU0NDkzNDE1LCJpYXQiOjE3NTQ0NjQ2MTV9.iKjtqChgxXZKVahsAuFt7SXlOzjj0djKlWRjOhCAMlA'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-06-2025 13:01:57.341 | General Service|:: CompanyIndex:53 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.99] DEBUG | 08-06-2025 13:01:57.341 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDQ2NDYxNSwiZXhwIjoxNzU0NDkzNDE1LCJpYXQiOjE3NTQ0NjQ2MTV9.iKjtqChgxXZKVahsAuFt7SXlOzjj0djKlWRjOhCAMlA'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-06-2025 13:02:03.931 | General Service|:: CompanyIndex:75 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-06-2025 13:02:03.947 | General Service|:: CompanyIndex:75 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNzUsMSIsIm5iZiI6MTc1NDQ2NTM0MiwiZXhwIjoxNzU0NDk0MTQyLCJpYXQiOjE3NTQ0NjUzNDJ9.tiA6ECZqRT23xNQPNgAGyjkGkFEDMwgsTUvYkf0EhQo'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 13:02:07.789 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 13:02:07.789 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTQ0NjQ2NzAsImV4cCI6MTc1NDQ5MzQ3MCwiaWF0IjoxNzU0NDY0NjcwfQ.gljUKQcmH2LwsrOd4YZw3YAwYmpvShtkPwZUROHaj90'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-06-2025 13:02:15.388 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-06-2025 13:02:15.388 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDQ2NDYxNSwiZXhwIjoxNzU0NDkzNDE1LCJpYXQiOjE3NTQ0NjQ2MTV9.iKjtqChgxXZKVahsAuFt7SXlOzjj0djKlWRjOhCAMlA'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 13:02:51.805 | General Service|:: CompanyIndex:0 SpName: spADM_Login 
 4
 ,''
 ,''
 ,''
 ,'declare @AllowSession bit,@GUID nvarchar(50)
set @AllowSession=0
set @GUID=''c430baf9-a1c5-4bc3-87b9-1649017ff51a''
if exists(select [GUID] from ADM_Login with(nolock) where [GUID]=@GUID)
begin
    update ADM_Login  set LastAccessTime=convert(float,getdate()) where [GUID]=@GUID
    set @AllowSession=1
end
select @AllowSession AllowSession
'
 ,''
 ,0
[System: 192.168.1.56] DEBUG | 08-06-2025 13:02:51.805 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTQ0NjQ2NzAsImV4cCI6MTc1NDQ5MzQ3MCwiaWF0IjoxNzU0NDY0NjcwfQ.gljUKQcmH2LwsrOd4YZw3YAwYmpvShtkPwZUROHaj90'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 13:02:54.758 | General Service|:: CompanyIndex:175 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.56] DEBUG | 08-06-2025 13:02:54.758 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTQ0NjQ2NzAsImV4cCI6MTc1NDQ5MzQ3MCwiaWF0IjoxNzU0NDY0NjcwfQ.gljUKQcmH2LwsrOd4YZw3YAwYmpvShtkPwZUROHaj90'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-06-2025 13:02:59.851 | General Service|:: CompanyIndex:75 SpName: spADM_GetDataSet 
 'SELECT StaticReportType FROM ADM_RevenUReports WITH(NOLOCK) WHERE ReportID=307'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-06-2025 13:02:59.851 | General Service|:: CompanyIndex:75 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNzUsMSIsIm5iZiI6MTc1NDQ2NTM0MiwiZXhwIjoxNzU0NDk0MTQyLCJpYXQiOjE3NTQ0NjUzNDJ9.tiA6ECZqRT23xNQPNgAGyjkGkFEDMwgsTUvYkf0EhQo'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-06-2025 13:02:59.914 | General Service|:: CompanyIndex:75 SpName: spRPT_GetReport 
 0
 ,307
 ,'1'
 ,'1'
 ,1
[System: 192.168.1.77] DEBUG | 08-06-2025 13:02:59.914 | General Service|:: CompanyIndex:75 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNzUsMSIsIm5iZiI6MTc1NDQ2NTM0MiwiZXhwIjoxNzU0NDk0MTQyLCJpYXQiOjE3NTQ0NjUzNDJ9.tiA6ECZqRT23xNQPNgAGyjkGkFEDMwgsTUvYkf0EhQo'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-06-2025 13:02:59.929 | General Service|:: CompanyIndex:75 SpName: spDOC_GetVPTPrintCopies 
 4
 ,50
 ,307
 ,2
 ,4
 ,'View~admin'
 ,'admin'
 ,1
[System: 192.168.1.77] DEBUG | 08-06-2025 13:02:59.945 | General Service|:: CompanyIndex:75 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNzUsMSIsIm5iZiI6MTc1NDQ2NTM0MiwiZXhwIjoxNzU0NDk0MTQyLCJpYXQiOjE3NTQ0NjUzNDJ9.tiA6ECZqRT23xNQPNgAGyjkGkFEDMwgsTUvYkf0EhQo'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-06-2025 13:02:59.992 | General Service|:: CompanyIndex:75 SpName: spADM_GetCostCenterGridViewList 
 50051
 ,1
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-06-2025 13:02:59.992 | General Service|:: CompanyIndex:75 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNzUsMSIsIm5iZiI6MTc1NDQ2NTM0MiwiZXhwIjoxNzU0NDk0MTQyLCJpYXQiOjE3NTQ0NjUzNDJ9.tiA6ECZqRT23xNQPNgAGyjkGkFEDMwgsTUvYkf0EhQo'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-06-2025 13:03:00.054 | General Service|:: CompanyIndex:75 SpName: spCom_GetCostCenterSummary 
 350
 ,-1
 ,1000
 ,' 1=1 '
 ,''
 ,''
 ,0
 ,'06-Aug-2025'
 ,NULL
 ,''
 ,1
 ,1
 ,0
 ,0
 ,False
 ,1
[System: 192.168.1.77] DEBUG | 08-06-2025 13:03:00.054 | General Service|:: CompanyIndex:75 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNzUsMSIsIm5iZiI6MTc1NDQ2NTM0MiwiZXhwIjoxNzU0NDk0MTQyLCJpYXQiOjE3NTQ0NjUzNDJ9.tiA6ECZqRT23xNQPNgAGyjkGkFEDMwgsTUvYkf0EhQo'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-06-2025 13:03:02.395 | General Service|:: CompanyIndex:75 SpName: spADM_GetLocationRole 
 50002
 ,1
 message=Saved Succesfully
[System: 192.168.1.77] DEBUG | 08-06-2025 13:03:02.411 | General Service|:: CompanyIndex:75 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNzUsMSIsIm5iZiI6MTc1NDQ2NTM0MiwiZXhwIjoxNzU0NDk0MTQyLCJpYXQiOjE3NTQ0NjUzNDJ9.tiA6ECZqRT23xNQPNgAGyjkGkFEDMwgsTUvYkf0EhQo'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-06-2025 13:03:02.426 | General Service|:: CompanyIndex:75 SpName: spADM_GetDataSet 
 'SELECT CL.RESOURCEDATA Name FROM [ADM_Features] ADF WITH(NOLOCK),COM_LANGUAGERESOURCES CL WITH(NOLOCK) WHERE ADF.RESOURCEID=CL.RESOURCEID AND ADF.FeatureID=50002 AND CL.LanguageID=1'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-06-2025 13:03:02.426 | General Service|:: CompanyIndex:75 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNzUsMSIsIm5iZiI6MTc1NDQ2NTM0MiwiZXhwIjoxNzU0NDk0MTQyLCJpYXQiOjE3NTQ0NjUzNDJ9.tiA6ECZqRT23xNQPNgAGyjkGkFEDMwgsTUvYkf0EhQo'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-06-2025 13:03:02.504 | General Service|:: CompanyIndex:75 SpName: spCom_GetCostCenterSummary 
 350
 ,1000
 ,1000
 ,' 1=1 '
 ,''
 ,''
 ,1998
 ,'06-Aug-2025'
 ,NULL
 ,''
 ,1
 ,1
 ,0
 ,0
 ,False
 ,1
[System: 192.168.1.77] DEBUG | 08-06-2025 13:03:02.504 | General Service|:: CompanyIndex:75 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNzUsMSIsIm5iZiI6MTc1NDQ2NTM0MiwiZXhwIjoxNzU0NDk0MTQyLCJpYXQiOjE3NTQ0NjUzNDJ9.tiA6ECZqRT23xNQPNgAGyjkGkFEDMwgsTUvYkf0EhQo'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-06-2025 13:03:02.629 | General Service|:: CompanyIndex:75 SpName: spCom_GetCostCenterSummary 
 350
 ,2000
 ,1000
 ,' 1=1 '
 ,''
 ,''
 ,3998
 ,'06-Aug-2025'
 ,NULL
 ,''
 ,1
 ,1
 ,0
 ,0
 ,False
 ,1
[System: 192.168.1.77] DEBUG | 08-06-2025 13:03:02.629 | General Service|:: CompanyIndex:75 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNzUsMSIsIm5iZiI6MTc1NDQ2NTM0MiwiZXhwIjoxNzU0NDk0MTQyLCJpYXQiOjE3NTQ0NjUzNDJ9.tiA6ECZqRT23xNQPNgAGyjkGkFEDMwgsTUvYkf0EhQo'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-06-2025 13:03:02.723 | General Service|:: CompanyIndex:75 SpName: spCom_GetCostCenterSummary 
 350
 ,3000
 ,1000
 ,' 1=1 '
 ,''
 ,''
 ,5998
 ,'06-Aug-2025'
 ,NULL
 ,''
 ,1
 ,1
 ,0
 ,0
 ,False
 ,1
[System: 192.168.1.77] DEBUG | 08-06-2025 13:03:02.723 | General Service|:: CompanyIndex:75 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNzUsMSIsIm5iZiI6MTc1NDQ2NTM0MiwiZXhwIjoxNzU0NDk0MTQyLCJpYXQiOjE3NTQ0NjUzNDJ9.tiA6ECZqRT23xNQPNgAGyjkGkFEDMwgsTUvYkf0EhQo'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-06-2025 13:03:02.817 | General Service|:: CompanyIndex:75 SpName: spCom_GetCostCenterSummary 
 350
 ,4000
 ,1000
 ,' 1=1 '
 ,''
 ,''
 ,7998
 ,'06-Aug-2025'
 ,NULL
 ,''
 ,1
 ,1
 ,0
 ,0
 ,False
 ,1
[System: 192.168.1.77] DEBUG | 08-06-2025 13:03:02.817 | General Service|:: CompanyIndex:75 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNzUsMSIsIm5iZiI6MTc1NDQ2NTM0MiwiZXhwIjoxNzU0NDk0MTQyLCJpYXQiOjE3NTQ0NjUzNDJ9.tiA6ECZqRT23xNQPNgAGyjkGkFEDMwgsTUvYkf0EhQo'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-06-2025 13:03:02.926 | General Service|:: CompanyIndex:75 SpName: spCom_GetCostCenterSummary 
 350
 ,5000
 ,1000
 ,' 1=1 '
 ,''
 ,''
 ,9998
 ,'06-Aug-2025'
 ,NULL
 ,''
 ,1
 ,1
 ,0
 ,0
 ,False
 ,1
[System: 192.168.1.77] DEBUG | 08-06-2025 13:03:02.926 | General Service|:: CompanyIndex:75 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNzUsMSIsIm5iZiI6MTc1NDQ2NTM0MiwiZXhwIjoxNzU0NDk0MTQyLCJpYXQiOjE3NTQ0NjUzNDJ9.tiA6ECZqRT23xNQPNgAGyjkGkFEDMwgsTUvYkf0EhQo'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-06-2025 13:03:03.051 | General Service|:: CompanyIndex:75 SpName: spCom_GetCostCenterSummary 
 350
 ,6000
 ,1000
 ,' 1=1 '
 ,''
 ,''
 ,11998
 ,'06-Aug-2025'
 ,NULL
 ,''
 ,1
 ,1
 ,0
 ,0
 ,False
 ,1
[System: 192.168.1.77] DEBUG | 08-06-2025 13:03:03.051 | General Service|:: CompanyIndex:75 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNzUsMSIsIm5iZiI6MTc1NDQ2NTM0MiwiZXhwIjoxNzU0NDk0MTQyLCJpYXQiOjE3NTQ0NjUzNDJ9.tiA6ECZqRT23xNQPNgAGyjkGkFEDMwgsTUvYkf0EhQo'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-06-2025 13:03:03.129 | General Service|:: CompanyIndex:75 SpName: spCom_GetCostCenterSummary 
 350
 ,7000
 ,1000
 ,' 1=1 '
 ,''
 ,''
 ,13998
 ,'06-Aug-2025'
 ,NULL
 ,''
 ,1
 ,1
 ,0
 ,0
 ,False
 ,1
[System: 192.168.1.77] DEBUG | 08-06-2025 13:03:03.129 | General Service|:: CompanyIndex:75 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNzUsMSIsIm5iZiI6MTc1NDQ2NTM0MiwiZXhwIjoxNzU0NDk0MTQyLCJpYXQiOjE3NTQ0NjUzNDJ9.tiA6ECZqRT23xNQPNgAGyjkGkFEDMwgsTUvYkf0EhQo'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-06-2025 13:03:04.181 | General Service|:: CompanyIndex:75 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-06-2025 13:03:04.197 | General Service|:: CompanyIndex:75 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNzUsMSIsIm5iZiI6MTc1NDQ2NTM0MiwiZXhwIjoxNzU0NDk0MTQyLCJpYXQiOjE3NTQ0NjUzNDJ9.tiA6ECZqRT23xNQPNgAGyjkGkFEDMwgsTUvYkf0EhQo'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 13:03:05.766 | General Service|:: CompanyIndex:7 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.56] DEBUG | 08-06-2025 13:03:05.781 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsNywxIiwibmJmIjoxNzU0NDYzNzgyLCJleHAiOjE3NTQ0OTI1ODIsImlhdCI6MTc1NDQ2Mzc4Mn0.9KypghGFg7B7MqF70r9PZzncStq8QTbC8cpYxxvPXzM'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-06-2025 13:03:07.843 | General Service|:: CompanyIndex:75 SpName: spADM_GetDataSet 
 '

SELECT C51.NODEID,C51.CODE,C51.NAME FROM 
COM_CC50051 C51 WITH(NOLOCK) 
LEFT JOIN COM_CCCCDATA CC WITH (NOLOCK) ON CC.NodeID=C51.NodeID AND CC.CostCenterID=50051
 
WHERE C51.IsGroup=0 AND C51.NodeID>1 AND C51.StatusID NOT IN (251,300,301)
AND (ISNULL(C51.DORelieve,'''')<>'''' OR ISNULL(CONVERT(DATETIME,C51.DORelieve),''01-JAN-1990'')<=''31 Aug 2025'') AND C51.NodeID=7774 
                --TABLE 1                
                SELECT C54.ComponentID,C52.Name FROM COM_CC50054 C54 WITH(NOLOCK) 
                JOIN COM_CC50052 C52 WITH(NOLOCK) ON C52.NodeID=C54.ComponentID
                WHERE GradeID=1 AND Type=1 AND FieldType=''OverTime'' AND PayrollDate IN (SELECT MAX(PayrollDate) FROM COM_CC50054 WITH(NOLOCK) WHERE GradeID=1 AND CONVERT(datetime,PAYROLLDATE)<=CONVERT(DATETIME,''01 Aug 2025''))'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-06-2025 13:03:07.859 | General Service|:: CompanyIndex:75 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNzUsMSIsIm5iZiI6MTc1NDQ2NTM0MiwiZXhwIjoxNzU0NDk0MTQyLCJpYXQiOjE3NTQ0NjUzNDJ9.tiA6ECZqRT23xNQPNgAGyjkGkFEDMwgsTUvYkf0EhQo'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 13:03:08.796 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 13:03:08.796 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTQ0NjQ2NzAsImV4cCI6MTc1NDQ5MzQ3MCwiaWF0IjoxNzU0NDY0NjcwfQ.gljUKQcmH2LwsrOd4YZw3YAwYmpvShtkPwZUROHaj90'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-06-2025 13:03:09.437 | General Service|:: CompanyIndex:75 SpName: spPAY_RptGetDailyAttendanceCalendarStatic 
 '7774'
 ,'01 Aug 2025'
 ,'31 Aug 2025'
 ,''
 ,'<Leaves/><Vacation/><Weekoff/><Holiday/>'
[System: 192.168.1.77] DEBUG | 08-06-2025 13:03:09.437 | General Service|:: CompanyIndex:75 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNzUsMSIsIm5iZiI6MTc1NDQ2NTM0MiwiZXhwIjoxNzU0NDk0MTQyLCJpYXQiOjE3NTQ0NjUzNDJ9.tiA6ECZqRT23xNQPNgAGyjkGkFEDMwgsTUvYkf0EhQo'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-06-2025 13:03:10.109 | General Service|:: CompanyIndex:75 SpName: spADM_GetDataSet 
 'Select * FROM COM_CC50051 WITH(NOLOCK)'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-06-2025 13:03:10.109 | General Service|:: CompanyIndex:75 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNzUsMSIsIm5iZiI6MTc1NDQ2NTM0MiwiZXhwIjoxNzU0NDk0MTQyLCJpYXQiOjE3NTQ0NjUzNDJ9.tiA6ECZqRT23xNQPNgAGyjkGkFEDMwgsTUvYkf0EhQo'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-06-2025 13:03:15.383 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-06-2025 13:03:15.383 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDQ2NDYxNSwiZXhwIjoxNzU0NDkzNDE1LCJpYXQiOjE3NTQ0NjQ2MTV9.iKjtqChgxXZKVahsAuFt7SXlOzjj0djKlWRjOhCAMlA'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-06-2025 13:04:02.676 | General Service|:: CompanyIndex:75 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.77] DEBUG | 08-06-2025 13:04:02.676 | General Service|:: CompanyIndex:75 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNzUsMSIsIm5iZiI6MTc1NDQ2NTM0MiwiZXhwIjoxNzU0NDk0MTQyLCJpYXQiOjE3NTQ0NjUzNDJ9.tiA6ECZqRT23xNQPNgAGyjkGkFEDMwgsTUvYkf0EhQo'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-06-2025 13:04:03.520 | General Service|:: CompanyIndex:75 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-06-2025 13:04:03.535 | General Service|:: CompanyIndex:75 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNzUsMSIsIm5iZiI6MTc1NDQ2NTM0MiwiZXhwIjoxNzU0NDk0MTQyLCJpYXQiOjE3NTQ0NjUzNDJ9.tiA6ECZqRT23xNQPNgAGyjkGkFEDMwgsTUvYkf0EhQo'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 13:04:09.786 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 13:04:09.786 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTQ0NjQ2NzAsImV4cCI6MTc1NDQ5MzQ3MCwiaWF0IjoxNzU0NDY0NjcwfQ.gljUKQcmH2LwsrOd4YZw3YAwYmpvShtkPwZUROHaj90'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-06-2025 13:04:15.363 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-06-2025 13:04:15.363 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDQ2NDYxNSwiZXhwIjoxNzU0NDkzNDE1LCJpYXQiOjE3NTQ0NjQ2MTV9.iKjtqChgxXZKVahsAuFt7SXlOzjj0djKlWRjOhCAMlA'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-06-2025 13:05:03.529 | General Service|:: CompanyIndex:75 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-06-2025 13:05:03.529 | General Service|:: CompanyIndex:75 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNzUsMSIsIm5iZiI6MTc1NDQ2NTM0MiwiZXhwIjoxNzU0NDk0MTQyLCJpYXQiOjE3NTQ0NjUzNDJ9.tiA6ECZqRT23xNQPNgAGyjkGkFEDMwgsTUvYkf0EhQo'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 13:05:10.808 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 13:05:10.808 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTQ0NjQ2NzAsImV4cCI6MTc1NDQ5MzQ3MCwiaWF0IjoxNzU0NDY0NjcwfQ.gljUKQcmH2LwsrOd4YZw3YAwYmpvShtkPwZUROHaj90'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-06-2025 13:05:15.386 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-06-2025 13:05:15.386 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDQ2NDYxNSwiZXhwIjoxNzU0NDkzNDE1LCJpYXQiOjE3NTQ0NjQ2MTV9.iKjtqChgxXZKVahsAuFt7SXlOzjj0djKlWRjOhCAMlA'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-06-2025 13:06:03.804 | General Service|:: CompanyIndex:75 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-06-2025 13:06:03.804 | General Service|:: CompanyIndex:75 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNzUsMSIsIm5iZiI6MTc1NDQ2NTM0MiwiZXhwIjoxNzU0NDk0MTQyLCJpYXQiOjE3NTQ0NjUzNDJ9.tiA6ECZqRT23xNQPNgAGyjkGkFEDMwgsTUvYkf0EhQo'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 13:06:11.795 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 13:06:11.795 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTQ0NjQ2NzAsImV4cCI6MTc1NDQ5MzQ3MCwiaWF0IjoxNzU0NDY0NjcwfQ.gljUKQcmH2LwsrOd4YZw3YAwYmpvShtkPwZUROHaj90'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-06-2025 13:06:15.378 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-06-2025 13:06:15.378 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDQ2NDYxNSwiZXhwIjoxNzU0NDkzNDE1LCJpYXQiOjE3NTQ0NjQ2MTV9.iKjtqChgxXZKVahsAuFt7SXlOzjj0djKlWRjOhCAMlA'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-06-2025 13:06:57.342 | General Service|:: CompanyIndex:53 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.99] DEBUG | 08-06-2025 13:06:57.342 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDQ2NDYxNSwiZXhwIjoxNzU0NDkzNDE1LCJpYXQiOjE3NTQ0NjQ2MTV9.iKjtqChgxXZKVahsAuFt7SXlOzjj0djKlWRjOhCAMlA'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-06-2025 13:07:04.797 | General Service|:: CompanyIndex:75 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-06-2025 13:07:04.813 | General Service|:: CompanyIndex:75 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNzUsMSIsIm5iZiI6MTc1NDQ2NTM0MiwiZXhwIjoxNzU0NDk0MTQyLCJpYXQiOjE3NTQ0NjUzNDJ9.tiA6ECZqRT23xNQPNgAGyjkGkFEDMwgsTUvYkf0EhQo'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 13:07:12.790 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 13:07:12.790 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTQ0NjQ2NzAsImV4cCI6MTc1NDQ5MzQ3MCwiaWF0IjoxNzU0NDY0NjcwfQ.gljUKQcmH2LwsrOd4YZw3YAwYmpvShtkPwZUROHaj90'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-06-2025 13:07:15.373 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-06-2025 13:07:15.373 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDQ2NDYxNSwiZXhwIjoxNzU0NDkzNDE1LCJpYXQiOjE3NTQ0NjQ2MTV9.iKjtqChgxXZKVahsAuFt7SXlOzjj0djKlWRjOhCAMlA'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 13:07:55.342 | General Service|:: CompanyIndex:175 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.56] DEBUG | 08-06-2025 13:07:55.342 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTQ0NjQ2NzAsImV4cCI6MTc1NDQ5MzQ3MCwiaWF0IjoxNzU0NDY0NjcwfQ.gljUKQcmH2LwsrOd4YZw3YAwYmpvShtkPwZUROHaj90'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 13:08:05.766 | General Service|:: CompanyIndex:7 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.56] DEBUG | 08-06-2025 13:08:05.766 | General Service|:: CompanyIndex:7 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IkFkbWluLDEsNywxIiwibmJmIjoxNzU0NDYzNzgyLCJleHAiOjE3NTQ0OTI1ODIsImlhdCI6MTc1NDQ2Mzc4Mn0.9KypghGFg7B7MqF70r9PZzncStq8QTbC8cpYxxvPXzM'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-06-2025 13:08:05.797 | General Service|:: CompanyIndex:75 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-06-2025 13:08:05.813 | General Service|:: CompanyIndex:75 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNzUsMSIsIm5iZiI6MTc1NDQ2NTM0MiwiZXhwIjoxNzU0NDk0MTQyLCJpYXQiOjE3NTQ0NjUzNDJ9.tiA6ECZqRT23xNQPNgAGyjkGkFEDMwgsTUvYkf0EhQo'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 13:08:13.784 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 13:08:13.800 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTQ0NjQ2NzAsImV4cCI6MTc1NDQ5MzQ3MCwiaWF0IjoxNzU0NDY0NjcwfQ.gljUKQcmH2LwsrOd4YZw3YAwYmpvShtkPwZUROHaj90'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-06-2025 13:08:15.378 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-06-2025 13:08:15.378 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDQ2NDYxNSwiZXhwIjoxNzU0NDkzNDE1LCJpYXQiOjE3NTQ0NjQ2MTV9.iKjtqChgxXZKVahsAuFt7SXlOzjj0djKlWRjOhCAMlA'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-06-2025 13:09:02.774 | General Service|:: CompanyIndex:75 SpName: spCOM_ConfigValues 
 1
 ,'NotifTime'
 ,''
[System: 192.168.1.77] DEBUG | 08-06-2025 13:09:02.774 | General Service|:: CompanyIndex:75 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNzUsMSIsIm5iZiI6MTc1NDQ2NTM0MiwiZXhwIjoxNzU0NDk0MTQyLCJpYXQiOjE3NTQ0NjUzNDJ9.tiA6ECZqRT23xNQPNgAGyjkGkFEDMwgsTUvYkf0EhQo'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-06-2025 13:09:06.804 | General Service|:: CompanyIndex:75 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-06-2025 13:09:06.804 | General Service|:: CompanyIndex:75 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNzUsMSIsIm5iZiI6MTc1NDQ2NTM0MiwiZXhwIjoxNzU0NDk0MTQyLCJpYXQiOjE3NTQ0NjUzNDJ9.tiA6ECZqRT23xNQPNgAGyjkGkFEDMwgsTUvYkf0EhQo'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 13:09:14.805 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 13:09:14.805 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTQ0NjQ2NzAsImV4cCI6MTc1NDQ5MzQ3MCwiaWF0IjoxNzU0NDY0NjcwfQ.gljUKQcmH2LwsrOd4YZw3YAwYmpvShtkPwZUROHaj90'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-06-2025 13:09:15.368 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-06-2025 13:09:15.368 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDQ2NDYxNSwiZXhwIjoxNzU0NDkzNDE1LCJpYXQiOjE3NTQ0NjQ2MTV9.iKjtqChgxXZKVahsAuFt7SXlOzjj0djKlWRjOhCAMlA'''
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-06-2025 13:10:07.799 | General Service|:: CompanyIndex:75 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.77] DEBUG | 08-06-2025 13:10:07.815 | General Service|:: CompanyIndex:75 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNzUsMSIsIm5iZiI6MTc1NDQ2NTM0MiwiZXhwIjoxNzU0NDk0MTQyLCJpYXQiOjE3NTQ0NjUzNDJ9.tiA6ECZqRT23xNQPNgAGyjkGkFEDMwgsTUvYkf0EhQo'''
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-06-2025 13:10:15.377 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.99] DEBUG | 08-06-2025 13:10:15.377 | General Service|:: CompanyIndex:53 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsNTMsMSIsIm5iZiI6MTc1NDQ2NDYxNSwiZXhwIjoxNzU0NDkzNDE1LCJpYXQiOjE3NTQ0NjQ2MTV9.iKjtqChgxXZKVahsAuFt7SXlOzjj0djKlWRjOhCAMlA'''
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 13:10:15.799 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'declare @UserID int,@RoleID int,@UserName NVARCHAR(100),@where nvarchar(max),@query nvarchar(max)
set @UserID=1
set @RoleID=1-- Employee:-1
SELECT @UserName=UserName From ADM_Users WITH(NOLOCK) WHERE UserID=@UserID
exec [fnGet_GetAssignedDims] @UserID,@RoleID,@where output
 create table #TblUsrWF(WID int,LevelID int,Type int,CtWef float,LvWef int)
EXEC spRPT_GetReportData @Type=8,@Param1=@UserID,@strXML=null,@RoleID=@RoleID set @query=''  SELECT DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory,count(*) CNT
FROM (
 SELECT INV.CostCenterID
FROM INV_DocDetails INV with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on INV.INVDocDetailsid=d.INVDocDetailsid''	

set @query=@query+'' ,#TblUsrWF WF
WHERE WF.WID=INV.WorkflowID and (WF.LevelID>INV.WorkFlowLevel or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372)) and (INV.StatusID=371 or INV.StatusID=372 or INV.StatusID=441) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=372) or (WF.LevelID+1=INV.WorkFlowLevel and INV.StatusID=372) or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) ''+@where+''
GROUP BY INV.CostCenterID,INV.VoucherNo
UNION ALL
SELECT ACC.CostCenterID
FROM ACC_DocDetails ACC with(nolock)''
if(@where<>'''')
	set @query=@query+'' join com_docccdata d with(nolock) on ACC.ACCDocDetailsid=d.ACCDocDetailsid''	

set @query=@query+'',#TblUsrWF WF
WHERE ACC.LinkedAccDocDetailsID is null and ACC.InvDocDetailsID is null and WF.WID=ACC.WorkflowID and (WF.LevelID>ACC.WorkFlowLevel or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372)) and (ACC.StatusID=371 or ACC.StatusID=372 or ACC.StatusID=441) AND (WF.Type=1 or (ACC.WorkFlowLevel+1=WF.LevelID and ACC.StatusID!=372) or (WF.LevelID+1=ACC.WorkFlowLevel and ACC.StatusID=372) or (WF.CtWef is not null and ACC.WorkFlowLevel>=WF.LvWef
and ACC.CreatedDate+WF.CtWef<=convert(float,getdate())))''+@where+''
GROUP BY ACC.CostCenterID,ACC.VoucherNo  ) AS T
JOIN ADM_DocumentTypes DT with(nolock) ON T.CostCenterID=DT.CostCenterID
GROUP BY DT.CostCenterID,DT.DocumentName,DT.DocumentType,DT.IsInventory  
UNION ALL
SELECT DT.FeatureID CostCenterID,DT.Name DocumentName,-DT.FeatureID DocumentType,0 IsInventory,count(*) CNT
FROM (
SELECT INV.CostCenterID FROM REN_Contract INV WITH(NOLOCK),#TblUsrWF WF
WHERE  WF.WID=INV.WorkflowID and WF.LevelID>INV.WorkFlowLevel and (INV.StatusID=440 or INV.StatusID=470 or INV.StatusID=466) AND (WF.Type=1 or (INV.WorkFlowLevel+1=WF.LevelID and INV.StatusID!=470)  or (WF.CtWef is not null and INV.WorkFlowLevel>=WF.LvWef
 and INV.CreatedDate+WF.CtWef<=convert(float,getdate()))) AND INV.RefContractID=0 ) AS T
JOIN ADM_Features DT with(nolock) ON T.CostCenterID=DT.FeatureID
GROUP BY DT.FeatureID,DT.Name 
ORDER BY DocumentName''
exec(@query)

DROP TABLE #TblUsrWF
'
 ,1
 ,1
[System: 192.168.1.56] DEBUG | 08-06-2025 13:10:15.799 | General Service|:: CompanyIndex:175 SpName: spADM_GetDataSet 
 'select * from COM_TokenHistory WITH(NOLOCK) where JwtToken=''eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFkbWluLDEsMTc1LDEiLCJuYmYiOjE3NTQ0NjQ2NzAsImV4cCI6MTc1NDQ5MzQ3MCwiaWF0IjoxNzU0NDY0NjcwfQ.gljUKQcmH2LwsrOd4YZw3YAwYmpvShtkPwZUROHaj90'''
 ,1
 ,1
